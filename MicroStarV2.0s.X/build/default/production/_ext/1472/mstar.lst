MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE  1


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00001 ;**********************************************************************
                      00002 ;                                                                     *
                      00003 ;**********************************************************************
                      00004 ;  
                      00005 ;    Filename: MStar.asm 
                      00006 ; 
                      00007 ;    Author:  Gordon Anderson
                      00008 ;    Company: GAA Custom Electronics
                      00009 ;
                      00010 ;    The MicroStar 2000 is a model airplane encoder. An encoder reads
                      00011 ;    the joy stick pots and the switches and generates the modulation
                      00012 ;    signal sent to the RF deck, the other significant part of a
                      00013 ;    transmitter.
                      00014 ;
                      00015 ;    This project started in 2000 with the first software release in January
                      00016 ;    of 2001.
                      00017 ;
                      00018 ;    The PIC processor has several pages or banks of ram. Each is 256
                      00019 ;    bytes long. These banks are used as follows:
                      00020 ;    Bank0:
                      00021 ;          Contains all of the working variables. None of this information
                      00022 ;          is saved, and on powerup its in a undefined state.
                      00023 ;    Bank1:
                      00024 ;          Used for misc variables.
                      00025 ;    Bank2:
                      00026 ;          This bank contains all of the general parameters. These are
                      00027 ;          the parameters that are constant for all aircraft settings,
                      00028 ;          like joy stick calibration. This information is saved in the
                      00029 ;          configuration area of flash memory.
                      00030 ;    Bank3 and Bank4:
                      00031 ;          These banks contain the aircraft specific data. These 
                      00032 ;          parameters are read from the flash memory on powerup or when
                      00033 ;          a new aircraft configuration is selected.
                      00034 ;    Bank5:
                      00035 ;          This bank holds a working copy of all EEprom parameters.
                      00036 ;    Bank6 and Bank7:
                      00037 ;          These banks are used to hold the aircraft specfic data used when
                      00038 ;          alternate aircraaft mode.
                      00039 ;    Bank8:
                      00040 ;          This bank is used for the aircraft name function.
                      00041 ;
                      00042 ;
                      00043 ;    Flash memory
                      00044 ;       The flash memory is used to store general parameters and aircraft specific
                      00045 ;       setup parameters. 256 bytes are used for general parameters, This
                      00046 ;       is the size of bank 2 and all general parameters are in bank 2.
                      00047 ;       512 bytes are also used for each of the 96 aircraft setups that 
                      00048 ;       can be saved in the flash. The aircraft setting are saved in banks
                      00049 ;       3 and 4. On powerup the general parameters are loaded then the aircraft
                      00050 ;       specified is loaded.
                      00051 ;       This flash memory is the same memory used to hold the MicroStar PIC application
                      00052 ;       code.
                      00053 ;
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE  2


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00054 ;    Startup options:
                      00055 ;
                      00056 ;       Press OPTION + PRESET   = Start the IO test routine
                      00057 ;       Press PRESET + AUTOTRIM = bypass sprom load and load from
                      00058 ;                                 default table. This is designed 
                      00059 ;                                 for initial startup with a new sprom.
                      00060 ;       Press OPTION            = Servo output position monitor mode.
                      00061 ;       Press AUTO TRIM         = Auto trim position monitor mode.
                      00062 ;
                      00063 ; BUG report:
                      00064 ;
                      00065 ; Revision History:
                      00066 ;       All of the version 1.0 revesions were for the orginal Encoder design that had
                      00067 ;       a final hardware revision of 3.0. Versions 2.0 are all designed for the hardware
                      00068 ;       revision 4.0 and beyond. This revision uses the PIC 18F8722 PIC. The orginal 
                      00069 ;       encoder used a 17C766 PIC and the version 2.0 series is not compatable with that
                      00070 ;       PIC.
                      00071 ;
                      00072 ;       Version 1.0b
                      00073 ;               First release, Jan 2001
                      00074 ;       Version 1.0c
                      00075 ;               Fixed a few minor bugs and finished the dual SPROM
                      00076 ;               support
                      00077 ;       Version 1.0d, Jan 28, 2001
                      00078 ;               Fixed a timming bug in the SPROM read function.
                      00079 ;       Version 1.0E, April 16,2001
                      00080 ;               Fixed the interface to RF deck, added support for
                      00081 ;               50MHz, 53MHz, and 72MHz.         
                      00082 ;               Added support for the receiver battery test function.
                      00083 ;       Version 1.0F, May 5, 2001
                      00084 ;               Placed the PLL in high current mode.
                      00085 ;               Fixed a display bug in the LCD52 drivers.   
                      00086 ;               Small display bug in 4x12 display driver.
                      00087 ;       Version 1.0G, October 21, 2001
                      00088 ;               Added programmable channel output order
                      00089 ;               Added Programmable trim assignment
                      00090 ;               Added support for Futaba type buddy box
                      00091 ;               Added new Auto Trim mode, where full adjustment is made when button
                      00092 ;               is pressed
                      00093 ;               Added enable switch to timer and throttle trigger to timer
                      00094 ;               Added up counter mode
                      00095 ;       Version 1.0H, March 17, 2002
                      00096 ;               Fixed a bug in the throttle trim, the percentage value used
                      00097 ;               was from the rudder!
                      00098 ;               Added a timer option to stop at zero on down counting.
                      00099 ;               Fixed bug in UP counter.
                      00100 ;       Version 1.0I, August 18, 2002
                      00101 ;               1.) Servo limits changed to .750 mS and 2.250 mS
                      00102 ;               2.) Snap PB changed to % and done after normalization
                      00103 ;               3.) CROW added
                      00104 ;       Version 1.0J, November 30, 2003
                      00105 ;               1.) Fixed a bug in the table edit mode that would not
                      00106 ;                   allow you to edit the last position.
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE  3


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00107 ;               2.) Fixed the Fixed First Mixer bug.
                      00108 ;       Version 1.1a, December 2004
                      00109 ;               1.) Added high and low rate expo to A,E,R (tested)
                      00110 ;               2.) Fixed the alt aircraft timer problem (tested)
                      00111 ;               3.) Added the Throttle low point adjust feature (tested)
                      00112 ;               4.) Added second alternate aircraft switch (tested)
                      00113 ;               5.) Add set model to default parameters (tested)
                      00114 ;               6.) Add buttons to set time values in min and max as short cuts.
                      00115 ;                   use snap right and snap left buttons. (tested)
                      00116 ;               6.) Add battery timer (tested)
                      00117 ;               7.) Add FMS flight simulator support (tested)
                      00118 ;               8.) Channel trigger points (tested)
                      00119 ;               9.) Add battery alarm level adjustment (tested)
                      00120 ;               10.)Reorder the menus into a more logical order (tested)
                      00121 ;               11.)Add 4 more tables (tested)
                      00122 ;               12.)Move Shift setting to Aircraft area (tested)
                      00123 ;               13.)Fix bug in the Frequency selection function, can not 
                      00124 ;                   select OFF as an option. (tested)
                      00125 ;               14.)Changed the way Mixer 2 works. (tested)
                      00126 ;               15.)Bug that causes the transmitter to crash in CAL mode when
                      00127 ;                   a mixer is on. I think it was the select chan functions mult.
                      00128 ;                   (tested)
                      00129 ;       Version 1.1b, January 14, 2005, bug fixes only
                      00130 ;               1.) Fixed a EPROM space bug
                      00131 ;               2.) Det defaults for min and max value
                      00132 ;               3.) Fixed AUXOUT on top line of display
                      00133 ;       Version 1.1c, Feburary 12 2005, bug fix
                      00134 ;               1.) Fixed bug in AutoTrim one shot mode if you have full
                      00135 ;                   stick deflection.
                      00136 ;       Version 1.1d, July 7 2005, requests, not yet implemented
                      00137 ;               Found and fixed a servo position editing bug. This had
                      00138 ;               to do with block move using wrong radix. 
                      00139 ;       Version 1.1e, July 24 2005
                      00140 ;               Found and fixed a aileron differential bug
                      00141 ;       Version 1.1f, December 10 2005
                      00142 ;               Found and fixed a channel 8 bug that caused the programed values to
                      00143 ;               be off by a factor of two from center
                      00144 ;
                      00145 ;       Version 2.0a, December 2006.
                      00146 ;               1.) Move channel order to aircraft memory area
                      00147 ;               2.) Auto Trim range increase to +- 20 percent
                      00148 ;               3.) Use preset button as an exit from UI
                      00149 ;               4.) Move tables to Aircraft area (2 tables added, 22 bytes)
                      00150 ;               5.) Add fixed mixers (12 bytes total)
                      00151 ;                       - Ail to rudder, 2 bytes
                      00152 ;                       - Rud to ail, 2 bytes
                      00153 ;                       - Rud to ele, 2 bytes
                      00154 ;                       - Throttle to ele, 1 byte
                      00155 ;                       - Dual elevator, 2 bytes
                      00156 ;               6.) Add sub trims, 8 bytes
                      00157 ;               7.) Fix the format flash functions to sync with ppm signal output
                      00158 ;               8.) Change invert function to say, positive/negative
                      00159 ;       Version 2.0b, January 2007
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE  4


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00160 ;               1.) Fixed bug with both LEDs
                      00161 ;               2.) Fixed bug in transmitter voltage adjust
                      00162 ;               3.) Fixed bug in throttle servo position set
                      00163 ;               4.) Added the Adapter assembley switch
                      00164 ;       Version 2.0c, March 2007
                      00165 ;               1.) Fixed bug in copy aircraft, limited aircraft number to 8.
                      00166 ;               2.) Added the frequency band selection menu options to replance jumpers,
                      00167 ;       Version 2.0d, April 8 2007
                      00168 ;               1.) Alternate aircraft number problem. 0 is allowed, look at copy 
                      00169 ;                   function as well. Fixed copy bug, 0 is OK in alt aircraft define
                      00170 ;                   zero disables function
                      00171 ;               2.) Power up student mode throttle adjust lockup, added clear to TTflag
                      00172 ;                   on powerup
                      00173 ;               3.) Elevon bug, aileron channel is dead
                      00174 ;               4.) VTAIL bug, rudder is dead
                      00175 ;               5.) For elevaon and vtail remove the code to divide throws in half
                      00176 ;       Version 2.0e
                      00177 ;               1.) Added variable rate to mS change function
                      00178 ;               2.) Fixed subtrim bug, they were not working at all due to indirect reg being
                      00179 ;                   overwritten
                      00180 ;               3.) Bug with the on time counter, in process need to add init to format function
                      00181 ;               4.) Fixed ADC reference problems
                      00182 ;               5.) Test auto trims
                      00183 ;               6.) Changed channel 5,6,7, and 8 to be -1000 to 1000 range. This makes mixing
                      00184 ;                    better and allows the end points adjustments to work on dual A and E.
                      00185 ;       Version 2.0e2, Feb 3, 2008
                      00186 ;               1.) Fix a bug with the joystick center determination function. It was before the 
                      00187 ;                   configuration parameters were read causing a bug when the ref is changed to 
                      00188 ;                   5 volts.
                      00189 ;       Version 2.0e3, March 16 2008
                      00190 ;               1.) Added an option to invert the buzzer polarity. This is to allow a vibrator to
                      00191 ;                   be used in place of the buzzer on the rev 4.0 encoder.
                      00192 ;       Version 2.0f, July 13 2008
                      00193 ;               1.) change snap buttons to allow sticks to still function, A,E,R only.
                      00194 ;               2.) Fixed bug in the throttle stick timer enable.
                      00195 ;               3.) Auto trim bugs, no errors found.
                      00196 ;               4.) Fix the slew speed.
                      00197 ;               5.) Fixed bug in the stick position switch function.
                      00198 ;               6.) Added stick speed control to select aircraft and percentage.
                      00199 ;               7.) Add message to indicate you are in student mode.
                      00200 ;               8.) Beep when the trims are set to zero.
                      00201 ;               9.) Added servo slew rate control to channel 5 and 8.
                      00202 ;               10.) Allow the user to select the RF deck ref osc frequency.
                      00203 ;               11.) Allow adjustment of the framming rate and frame time defect.
                      00204 ;               12.) Added the configureation option to EEPROM. This allows the firmware
                      00205 ;                    modes to be selected via flags and only one set of firmware is needed.
                      00206 ;       Version 2.0g, August 2 2008
                      00207 ;               1.) Added the CCPM mixing.
                      00208 ;               2.) Fixed init bug on servo rates.
                      00209 ;               3.) Added port B to the TEST IO mode 2nd line.
                      00210 ;               4.) Added hysistress to trim beep.
                      00211 ;               5.) Added digital trims.
                      00212 ;               6.) Fixed FMS simulator bug.
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE  5


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00213 ;               7.) Added Serial send mode, USART2 38400 baud.
                      00214 ;               8.) Fixed trim center beep bug.
                      00215 ;       Version 2.0h, October 11, 2008
                      00216 ;               1.) Fixed a bug that caused the transmitter to lockup when the tach was 
                      00217 ;                   pluged in.
                      00218 ;       Version 2.0i, December 6, 2008
                      00219 ;               1.) Add servo reversing function.
                      00220 ;                       - Add the reverse option to each servo's set of options
                      00221 ;                       - Do this by looking and the sign of the channels gain, positive gain 
                      00222 ;                         indicates non reversed channel.
                      00223 ;               2.) Add center beep option for throttle trim and CH6 and CH7
                      00224 ;               3.) Fixed the DOG display bugs in the digial trim display
                      00225 ;               4.) Fixed a center beep bug on the digitial trims
                      00226 ;               5.) Upgrade to the 12bit ADC pic, The Encoder will now auto detect CPU.
                      00227 ;               6.) Added function to allow user to adjust digital trim update rate
                      00228 ;               7.) Added clear all sub trims function.
                      00229 ;       Version 2.0j, December 25 2008
                      00230 ;               1.) Copied the ADC normalized position data to bank 8 for the PC interface.
                      00231 ;               2.) Read the receiver voltage raw ADC values in cal mode for PC interface
                      00232 ;               3.) Add a servo position monitor function. Press and hold option button
                      00233 ;                   on power up to enter this mode.
                      00234 ;       Version 2.0k, May 3, 2009
                      00235 ;               1.) Changed the order of calls in the run and cal mode, moved the slew rate
                      00236 ;                   function before the sub trims.
                      00237 ;               2.) Changed the mix functions to use the slewrate limited values for CH8 and
                      00238 ;                   CH5.
                      00239 ;               3.) Added FMS on UART 1 or UART 2, June 12, 2009
                      00240 ;       Version 2.0l, November 2009
                      00241 ;               1.) Fixed bugs in the futaba buddy box modes
                      00242 ;               2.) Addded a delay between channels on the MicroStar buddybox mode to 
                      00243 ;                   allow UARTs to sync up when the osc freq is a little different.
                      00244 ;       Version 2.0m, November 29 2009
                      00245 ;               1.) Fixed a rounding problem with the servo calibration routines
                      00246 ;               2.) Improved the OPTION button debouncing logic
                      00247 ;       Version 2.0n, January 11, 2010
                      00248 ;               This version has significant updates to the helicopter mode thanks to
                      00249 ;               input from Jack Dice.
                      00250 ;               1.) Added a helicopter mode enable
                      00251 ;               2.) Use CH8 switch as flight modes, A=Normal, B=Stunt 1, C= Stunt 2.
                      00252 ;                   Normal is really defined by no other mode being active.
                      00253 ;               3.) Treat Throttle Hold as a 4th flight mode that overrides other modes
                      00254 ;               4.) Use a table for Throttle, definable in each mode
                      00255 ;               5.) Use a table for Pitch, definable in each mode
                      00256 ;               6.) Use CH6 control as pitch trim and seperate from throttle
                      00257 ;               7.) Each mode provides gyro sensitivity constant but programable output,
                      00258 ;                   this signal is output on CH5
                      00259 ;               8.) Added helicopter option to main cal menu to adjust parameters
                      00260 ;               9.) Added flight mode display to helicopter mode
                      00261 ;               10.) fixed an error in the CH8 servo monitor display, A and C were
                      00262 ;                    reversed.
                      00263 ;               11.) Fixed the tables to support negative values.
                      00264 ;               12.) Fixed a minor display bug in the servo monitor function
                      00265 ;               13.) Added the gyro tune sensitivity adjust mode
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE  6


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00266 ;               14.) Expanded the servo monitor to include output pulse width data as well.
                      00267 ;               15.) Fixed a bug in the mixers when a slew rate controlled channel is
                      00268 ;                    mixed to itself.
                      00269 ;               16.) Initial restructuring of the code for the MicroProStar and addition
                      00270 ;                    of the drivers. First release of the MicroProStar.
                      00271 ;               17.) The default for the throttle servo range was in the reverse direction, 
                      00272 ;                    I fliped it in this release.
                      00273 ;               18.) The MicroStar buddybox mode had a baudrate error.
                      00274 ;               19.) Updated the AUXOUT logic so that shift invert will change the PPM
                      00275 ;                    signal as it does the RF deck modulation pin.
                      00276 ;       Version 2.0o, August 1, 2010
                      00277 ;               1.) Fixed a table numeric range bug, a rare issue that only happen at
                      00278 ;                   extreme stick and trim limits.
                      00279 ;               2.) Added remap function and table to Advanced menu.
                      00280 ;               3.) Added displays modes to the MPS.
                      00281 ;               4.) Move number of channels to aircraft memory area.
                      00282 ;               5.) Decreased the stick sensitivity for the Auto Trim function.
                      00283 ;               6.) Fixed a very minor bug on the tables.
                      00284 ;               7.) Fixed the init routine and stop sending the initial PPM pulse train.
                      00285 ;               8.) Fixed SNAPL to work like SNAPR, so that controls influence the positions.
                      00286 ;               9.) Change default servo limits and position to 900 and 2100 for the system 
                      00287 ;                   maximums and 1100 and 1900 for the servo starting points
                      00288 ;               10.) Added a new ADC read mode for the MPS. This mode reads the joystick using 
                      00289 ;                    the 5 volt ref and does battery voltage correct as well as insuring that
                      00290 ;                    the battery supply is stable.
                      00291 ;               11.) Fixed a mixer programming bug caused by the CalServoUpdate flag not being 
                      00292 ;                    cleared on power up.
                      00293 ;               12.) Add canned output order, ACE = EART5678, Futaba = AETR5678, 
                      00294 ;                    Airtronics = EATR5678, JR = TAER5678
                      00295 ;               13.) Make the ADC test mode display in decimal.
                      00296 ;               14.) Added the version number to the general data storage area.
                      00297 ;               15.) Added threshold adjustment to Auto Trim stick positions. 6/19/10
                      00298 ;               16.) Test the throttle adjust function and make sure its OK. Tested OK
                      00299 ;               17.) Added auto trim disable option
                      00300 ;               18.) Format flash bug in UI, when slect no it reloaded all settings.
                      00301 ;               19.) MPS format flash display bug
                      00302 ;               20.) Changed MPS display default to alternate
                      00303 ;       Version 2.0p, December 2010
                      00304 ;               1.) Allow user to define PPM logic level of AUXOUT
                      00305 ;               2.) Add Move Mix function, also ask to clear the mixer we moved from.
                      00306 ;               3.) Add Apply to all option on a number of global functions, channel order
                      00307 ;               4.) Add a filter to the battery voltage monitor. Use a difference equation
                      00308 ;                   Vbat * N = Vbat(t-1) * (N - 1) + Vbat(t). Where N = filter time constant.
                      00309 ;                   This filter is scalled by 256 to prevent round off errors.
                      00310 ;               5.) Add a servo monitor display of position in percentage to allow transfer to
                      00311 ;                   mixer gain. Change all labels to three chars and add % to display.
                      00312 ;               6.) Fixed a bug on the mixers that only happens on throttle, CH5, or CH8 when
                      00313 ;                   mixed to itself.
                      00314 ;               7.) DOG-M contrast adjustment to the system setup menu.
                      00315 ;               8.) Initalized DriveCh when not used
                      00316 ;       Version 2.0q, January 2011
                      00317 ;               1.) Fixed the DOG contrast adjust function, it actually has 64 levels. I expanded
                      00318 ;                   the range a bit.
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE  7


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00319 ;               2.) Fixed a rounding issue on throttle servo end point adjustment.
                      00320 ;               3.) Fixed a bug introduced in 2.0p that killed the servo position update in
                      00321 ;                   the servo setup routine.
                      00322 ;       Version 2.0r, Februray 2011
                      00323 ;               1.) Fixed a bug in entering table position using the transmitter UI.
                      00324 ;               2.) Fixed a bug that caused the auto trim value to be reset when the servo
                      00325 ;                   cal menu is entered.
                      00326 ;       Version 2.0s, June 2011, in progress
                      00327 ;               1.) Added CCPM reverse options for Ail and Ele
                      00328 ;               2.) Added display monitor for auto trim position. Hold the auto trim button down
                      00329 ;                   on power up to enter the auto trim monitor mode.
                      00330 ;               3.) Fixed a strange fixed mixer bug with the Rud to Ele mixer only when negative
                      00331 ;                   gains are used. 12/19/2011
                      00332 ;               4.) Fixed the mstar.asm file to define the config blocks using cblock
                      00333 ;
                      00334 ;       Version 2.0x, to do list
                      00335 ;               A.) Make the display interface work in 4 bit mode. Use 2 of the freed bits for
                      00336 ;                   display control. One for display mode, and the other to advance sub mode.
                      00337 ;               B.) Fix the retract warning to work even without my RF deck and hold off the
                      00338 ;                   modulation signal.
                      00339 ;               C.) Look into a minor display bug in the channel order options. The UI does
                      00340 ;                   reflect the currently select channel order.
                      00341 ;               D.) Add the ability to control the servo positions from the PC
                      00342 ;                   application. Also add an API so a user can control with his own
                      00343 ;                   application.
                      00344 ;               1.) Add more aircraft specific tables, 7 total. Can't have more than 7
                      00345 ;                   aircraft tables. here is what needs to be done for this change:
                      00346 ;                       a.) Move the aircraft tables to the end of page 4 in the aircraft setup area.
                      00347 ;                           reserve the old space so we don't have to adjust pointers.
                      00348 ;                       b.) Add the 5 additional entries in the data.asm file
                      00349 ;                       c.) Edit the PC app to support the new tables and set defaults
                      00350 ;                       d.) Test this function
                      00351 ;               2.) and i just remembered another thing i don't find so user friendly:  
                      00352 ;                   whenever i need to adjust something in one of the alternate aircraft 
                      00353 ;                   memories i have to first call up and select that memory.  with the new 
                      00354 ;                   version's 6 alternates this could turn into a real nighmare.  could it 
                      00355 ;                   be changed so that whenever you switch to CAL mode you're automatically 
                      00356 ;                   in the menu of whatever memory was currently being used and displayed on 
                      00357 ;                   the LCD when the switch was hit?
                      00358 ;               3.) Allow no confirm of RF at startup. Do this by adding a EEPROM config function
                      00359 ;                   to the bootloader. Allow the following types of functions or at least consider
                      00360 ;                   these functions:
                      00361 ;                       a.) The no RF confirm option
                      00362 ;                       b.) Oversampling
                      00363 ;               4.) Trims carries across alternate aircraft. This should be optional and
                      00364 ;                   selectable trim by trim
                      00365 ;               5.) Additional channels for generated channels
                      00366 ;               6.) Have the transmitter broadcast the position information during adjustment
                      00367 ;                   of the table values.
                      00368 ;               7.) Digitial trim issues
                      00369 ;                       - The system doesn't seem to save to the *.CFG file the actual position
                      00370 ;                         of digital trims, and then, when loading the file using another MS2K
                      00371 ;                         radio, they are lost.;
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE  8


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00372 ;                       -When I set up an alternative aircraft and it happens to need a
                      00373 ;                        different trim position than the master has, that is, when I need
                      00374 ;                        different flight phases with different trimmings, digital trims do not
                      00375 ;                        act independently, but on all the phases at once.
                      00376 ;               8.) Allow auto trim to automatically go to trim zero thus more total range and
                      00377 ;                   no need to go to cal menus.
                      00378 ;               9.) Smooth transistion and timed when changing modes using alternate aircraft.
                      00379 ;               10.) Add a new mixer that allows you to define an output channel via writing
                      00380 ;                    an equation. This should also support "if" logic.
                      00381 ;               11.) Simplify the alternate aircraft setup options.
                      00382 ;               12.) Look at the CROW function and update it as per the MP8000
                      00383 ;               13.) Add switch functions to CH6 and CH7
                      00384 ;
                      00385 ; Bugs and problems reported:
                      00386 ;       1.) Reported by Jack Dice 3/7/2009
                      00387 ;               It takes three models to define this glider, a main definition and two alternate 
                      00388 ;               A/C's, Both alt A/C's are operated by the ch8 switch, one on posA, the other on 
                      00389 ;               posC. I needed to change the elev trim on the Alt A/C in posA so I went to cal, 
                      00390 ;               selected the model of the alt a/c of interest and made a change to the elevator 
                      00391 ;               sub-trim. I backed out of that menu and then went to "select A/C" to get back to 
                      00392 ;               the main model definition.  When I returned to "run" the alt A/C definitions were 
                      00393 ;               dead, ie moving the ch8 switch did nothing, no A indication in the display 
                      00394 ;               (although only one of the alt A/c's show up as an A on the display) and no change 
                      00395 ;               in the airplane's control settings. The solution to the problem was to turn the 
                      00396 ;               transmitter off and then back on again, after which everything worked as expected. 
                      00397 ;               I would have thought the system would not require a re-boot after making changes 
                      00398 ;               to the alt A/C models but maybe that is the way it works!
                      00399 ;       2.) Jon Crick requests, feb 20, 2010
                      00400 ;               -How about a menu scroll slow-down when holding the Auto-trim or Preset button?
                      00401 ;               -Holding a digital trim for two seconds or longer increments at a faster rate.
                      00402 ;       
                      00403 ; MicroProStar bugs and requests:
                      00404 ;       1.) From danny Miller, 3/6/2011
                      00405 ;               - Buzzer is on for 1 to 2 secs on power up, this is random.
                      00406 ;               - Allow the display line alternate time delay to be adjusted.
                      00407 ;
                      00408 ; Upgrade ideas (many of these are user ideas, some I will implement some I will not.)
                      00409 ;       1.) New trainer mode where the master can influence the student...
                      00410 ;       2.) Programmable delay when switching between flight configurations.
                      00411 ;       3.) it would be nice that when entering cal mode you were in the programming menus 
                      00412 ;           for the model#  that appeared on the display when you hit the switch.  as it is 
                      00413 ;           (or was as i haven't played with this on ver.2) you can be on one of the alts, 
                      00414 ;           hit the cal switch and you'll be editing the master and not the alt.  only way 
                      00415 ;           to edit the alt is to select that specific memory and then cal...can be almost 
                      00416 ;           as confusing as what i just wrote and now we've got 6 alts instead of just two. 
                      00417 ;
                      00418 ; Rev 6.0 notes / needs
                      00419 ;       1.) Reserve the A19 signal for use as a USB / RS232 selection signal.
                      00420 ;
                      00421 ; 
                      00422 ; ***********************************************************************
                      00423 ; *
                      00424 ; *                       GAA Custom Electronics                        
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE  9


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00425 ; *                     SOFTWARE LICENSE AGREEMENT
                      00426 ; *
                      00427 ; *
                      00428 ; *     BY USING THIS SOFTWARE, YOU ARE AGREEING TO BE BOUND BY THE TERMS
                      00429 ; *     OF THIS AGREEMENT.  DO NOT USE THE SOFTWARE UNTIL YOU HAVE CAREFULLY
                      00430 ; *     READ AND AGREED TO THE FOLLOWING TERMS AND CONDITIONS.  IF YOU DO
                      00431 ; *     NOT AGREE TO THE TERMS OF THIS AGREEMENT, PROMPTLY RETURN THE
                      00432 ; *     SOFTWARE PACKAGE AND ANY ACCOMPANYING ITEMS.
                      00433 ; *
                      00434 ; *     IF YOU USE THIS SOFTWARE, YOU WILL BE BOUND BY THE TERMS OF THIS
                      00435 ; *     AGREEMENT
                      00436 ; *
                      00437 ; *     LICENSE: GAA Custom Electronics ("GAACE") grants you the non-exclusive
                      00438 ; *     right to use the enclosed software program ("Software").  You will
                      00439 ; *     not use, copy, modify, rent, sell or transfer the Software or any
                      00440 ; *     portion thereof, except as provided in this Agreement.
                      00441 ; *
                      00442 ; *     User System Developers may:
                      00443 ; *
                      00444 ; *     1.      Copy the Software for support, backup or archival purposes;
                      00445 ; *     2.      Install, use, or distribute GAACE owned Software in object
                      00446 ; *             code only for use on a single computer system; 
                      00447 ; *     3.      Modify and/or use Software source code that GAACE directly
                      00448 ; *             ships to you for your personal use only.
                      00449 ; *     4.      Install, use, modify, distribute, and/or make or have made 
                      00450 ; *             derivatives ("Derivatives") of GAACE owned Software under the 
                      00451 ; *             terms and conditions in this Agreement, ONLY if you are an
                      00452 ; *             an end-user.
                      00453 ; *
                      00454 ; *
                      00455 ; *     RESTRICTIONS:
                      00456 ; *
                      00457 ; *     YOU WILL NOT:
                      00458 ; *
                      00459 ; *     1.     Copy the Software, in whole or in part, except as provided 
                      00460 ; *            for in this Agreement;
                      00461 ; *     2.     Decompile or reverse engineer Software provided in object code
                      00462 ; *            format;
                      00463 ; *
                      00464 ; *     TRANSFER:  You may transfer the Software to another party if the
                      00465 ; *     receiving party agrees to the terms of this Agreement at the sole
                      00466 ; *     risk of any receiving party.
                      00467 ; *
                      00468 ; *     OWNERSHIP AND COPYRIGHT OF SOFTWARE:  Title to the Software and all
                      00469 ; *     copies thereof remain with GAA Custom Electronics.  The Software
                      00470 ; *     copyright has been filed and will be protected by United States and 
                      00471 ; *     international copyright laws.  You will not remove the copyright 
                      00472 ; *     notice from the Software.  
                      00473 ; *     You agree to prevent any unauthorized copying of the Software.
                      00474 ; *
                      00475 ; *     DERIVATIVE WORK:  Users that make or have made Derivatives will not be 
                      00476 ; *     required to provide GAACE with a copy of the source or object code. 
                      00477 ; *     Users are not authorized to market, sell, and/or distribute 
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 10


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00478 ; *     derivatives works without the written permission of GAACE.
                      00479 ; *
                      00480 ; *     WARRANTY:  GAACE warrants that it has the right to license you to
                      00481 ; *     use, modify, or distribute the Software as provided in this Agreement.
                      00482 ; *     The Software is provided "AS IS". GAACE warrants that the media on
                      00483 ; *     which the Software is furnished will be free from defects in material
                      00484 ; *     and workmanship for a period of one (1) year from the date of 
                      00485 ; *     purchase. Upon return of such defective media, GAACE's entire 
                      00486 ; *     liability and your exclusive remedy shall be the replacement of the 
                      00487 ; *     Software.
                      00488 ; *
                      00489 ; *     THE ABOVE WARRANTIES ARE THE ONLY WARRANTIES OF ANY KIND EITHER
                      00490 ; *     EXPRESS OR IMPLIED INCLUDING WARRANTIES OF MERCHANTABILITY OR FITNESS
                      00491 ; *     FOR ANY PARTICULAR PURPOSE.
                      00492 ; *
                      00493 ; *     LIMITATION OF LIABILITY:    NEITHER GAACE NOR ITS VENDORS OR AGENTS
                      00494 ; *     SHALL BE LIABLE FOR ANY LOSS OF PROFITS, LOSS OF USE, LOSS OF DATA,
                      00495 ; *     INTERRUPTION OF BUSINESS, NOR FOR INDIRECT, SPECIAL, INCIDENTAL OR
                      00496 ; *     CONSEQUENTIAL DAMAGES OF ANY KIND WHETHER UNDER THIS AGREEMENT OR
                      00497 ; *     OTHERWISE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGES.
                      00498 ; *
                      00499 ; *     TERMINATION OF THIS LICENSE:  GAACE reserves the right to conduct or
                      00500 ; *     have conducted audits to verify your compliance with this Agreement.
                      00501 ; *     GAACE may terminate this Agreement at any time if you are in breach
                      00502 ; *     of any of its terms and conditions.  Upon termination, you will
                      00503 ; *     immediately destroy, and certify in writing the destruction of, the
                      00504 ; *     Software or return all copies of the Software and documentation to
                      00505 ; *     GAACE.
                      00506 ; *
                      00507 ; ************************************************************************
                      00508 ;
                      00509 
                      00510         list      p=18F8722, f=INHX32   ; list directive to define processor
                      00511         #include <P18F8722.INC>         ; processor specific variable definitions
                      00001         LIST
                      00002 
                      00003 ;==========================================================================
                      00004 ;  $Id: P18F8722.INC,v 1.4.2.3 2005/10/18 21:44:56 curtiss Exp $
                      00005 ;  MPASM PIC18F8722 processor include
                      00006 ; 
                      00007 ;  (c) Copyright 1999-2005 Microchip Technology, All rights reserved
                      00008 ;==========================================================================
                      00009 
                      02264         LIST
                      00512         errorlevel 2
                      00513         
                      00514 ;       CONFIG   OSC = HS,BOR = ON,PWRT = OFF,WDT = OFF,MODE = MC,OSCS = ON,DEBUG = OFF
                      00515 ;
                      00516 ; Configuration register values
                      00517 ;       300001 = 02
                      00518 ;       300002 = 1F
                      00519 ;       300003 = 1E
                      00520 ;       300004 = F3
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 11


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00521 ;       300005 = 83
                      00522 ;       300006 = 81
                      00523 ;       300008 = FF
                      00524 ;       300009 = C0
                      00525 ;       30000A = FF
                      00526 ;       30000B = E0
                      00527 ;       30000C = FF
                      00528 ;       30000D = 40
                      00529 
                      00530 ; '__CONFIG' directive is used to embed configuration data within .asm file.
                      00531 ; The lables following the directive are located in the respective .inc file.
                      00532 ; See respective data sheet for additional information on configuration word.
                      00533 
                      00534 ;******************************************************************************
                      00535 ;******************************************************************************
                      00536 ;******************************************************************************
                      00537 ;
                      00538 ; MicroStar configuration options
                      00539 ;
                      00540 ;      These are switches that you can use to define the type MicroStar
                      00541 ;      firmware you wish to build. After you set these options you need
                      00542 ;      to rebuild the application using MPLAB from microchip.
                      00543 ;
                      00544 ; The display type is defined by un-commenting one of the following three
                      00545 ; lines, only one can be un-commented!
                      00546 ;
                      00547  #define                LCD52display
                      00548 ; #define               SED1230display
                      00549 ; #define               ECMA1010display
                      00550 
                      00551 ;
                      00552 #define OPTION_BUTTON PORTE,OPTION
                      00553 ;#define OPTION_BUTTON PORTH,RECCOMM
                      00554 
                      00555 ; Language option
                      00556 ; #define                       Catalan
                      00557 
                      00558 ; #define               MicroProStar
                      00559 ;
                      00560 ; Misc options
                      00561 ; #define               CountOn         ; Turns on timer on powerup
                      00562 ; #define               TestADChex      ; Causes the TestIO mode to display ADC values in hex
                      00563 ; #define               NOTACHENA       ; Causes the tach function to be disabled regardless of the
                      00564                                         ; enable line status
                      00565 ;
                      00566 ;******************************************************************************
                      00567 ;******************************************************************************
                      00568 ;******************************************************************************
                      00569 
                      00570         Include <Constants.asm>
                      00001 #define         MOVFP   MOVF
                      00002 #define         MOVLR   MOVLB
                      00003 #define         MOVPF   MOVFF
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 12


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00004 #define         ALUSTA  STATUS
                      00005 
  00000200            00006 OFFSET  EQU     0x200           ; For use with the bootloader
                      00007 ;OFFSET EQU     0x0             ; For stand along operation
                      00008 
                      00009 ; ADC channel assignments
                      00010 ;
                      00011 ;       CH      Use
                      00012 ;       0       Vpos monitor
                      00013 ;       1       Gnd
                      00014 ;       2       CH7
                      00015 ;       3       CH6
                      00016 ;       4       Aileron
                      00017 ;       5       Elevator
                      00018 ;       6       Rudder
                      00019 ;       7       Throttle
                      00020 ;       8       Aileron trim
                      00021 ;       9       Elevator trim
                      00022 ;       10      Rudder trim
                      00023 ;       11      Throttle trim
                      00024 ;       12      +5 volt monitor 
                      00025 ;       13      Receiver voltage monitor
                      00026 ;
                      00027 
  00000060            00028 NumAircraft     EQU     D'96'
                      00029 
  00000100            00030 BNK1    EQU     100
  00000200            00031 BNK2    EQU     200
  00000300            00032 BNK3    EQU     300
  00000400            00033 BNK4    EQU     400
                      00034 
                      00035 ; Misc constants
  00000190            00036 StickThres      EQU     D'400'
  00000028            00037 AutoTrimOStime  EQU     D'40'
  00002260            00038 VoltageLimit    EQU     D'8800'
                      00039 
                      00040 ; PLL constants
  00000010            00041 HICUR   EQU     10
                      00042 
                      00043 ; Display Line numbers
                      00044 ifdef           LCD52display
  00000080            00045 LINE1      EQU       080
  000000C0            00046 LINE2      EQU       0C0
  000000C0            00047 LINE3      EQU       0C0
  00000008            00048 LCDRIGHT   EQU       08
  0000000E            00049 CURSORON   EQU       0E
  0000000C            00050 CURSOROFF  EQU       0C
  00000008            00051 YPOS       EQU       08
  0000000C            00052 YNPOS      EQU       0C
  0000000F            00053 NPOS       EQU       0F
  0000000D            00054 ACFTPOS    EQU       0D
  0000000D            00055 BYTEPOS    EQU       0D
  0000000B            00056 PERCENTPOS EQU       0B
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 13


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

  00000009            00057 uSPOS      EQU       09
  0000000B            00058 INTPOS     EQU       0B
  0000000C            00059 SELCHPOS   EQU       0C
  0000000B            00060 CVMPOS     EQU       0B
  0000000B            00061 ONTIMEPOS  EQU       0B
  00000008            00062 CH53POS    EQU       08
  0000000E            00063 CH50POS    EQU       0E
  0000000D            00064 CH72POS    EQU       0D
  00000004            00065 CH50MHZPOS EQU       04
  00000004            00066 CH72MHZPOS EQU       04
  00000007            00067 TESTCHPOS  EQU       07
  0000000C            00068 TESTVALPOS EQU       0C
  0000000B            00069 TACHRPMPOS EQU       0B
  0000000B            00070 RECVPOS    EQU       0B
                      00071 endif
                      00072 
                      00073 ifdef           MicroProStar
                      00074 LINE1      EQU       080
                      00075 LINE2      EQU       088
                      00076 LINE3      EQU       088
                      00077 LCDRIGHT   EQU       040
                      00078 CURSORON   EQU       0E
                      00079 CURSOROFF  EQU       0C
                      00080 YPOS       EQU       040
                      00081 YNPOS      EQU       044
                      00082 NPOS       EQU       047
                      00083 ACFTPOS    EQU       045
                      00084 BYTEPOS    EQU       045
                      00085 PERCENTPOS EQU       043
                      00086 uSPOS      EQU       041
                      00087 INTPOS     EQU       043
                      00088 SELCHPOS   EQU       044
                      00089 CVMPOS     EQU       043
                      00090 ONTIMEPOS  EQU       043
                      00091 CH53POS    EQU       040
                      00092 CH50POS    EQU       046
                      00093 CH72POS    EQU       045
                      00094 CH50MHZPOS EQU       04
                      00095 CH72MHZPOS EQU       04
                      00096 TESTCHPOS  EQU       07
                      00097 TESTVALPOS EQU       044
                      00098 TACHRPMPOS EQU       043
                      00099 RECVPOS    EQU       043
                      00100 endif
                      00101 
                      00102 ifdef           SED1230display
                      00103 LINE1      EQU       0B0
                      00104 LINE2      EQU       0C0
                      00105 LINE3      EQU       0C0
                      00106 LCDRIGHT   EQU       08
                      00107 CURSORON   EQU       03F
                      00108 CURSOROFF  EQU       031
                      00109 YPOS       EQU       08
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 14


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00110 YNPOS      EQU       0C
                      00111 NPOS       EQU       0F
                      00112 ACFTPOS    EQU       0D
                      00113 BYTEPOS    EQU       0D
                      00114 PERCENTPOS EQU       0B
                      00115 uSPOS      EQU       09
                      00116 INTPOS     EQU       0B
                      00117 SELCHPOS   EQU       0C
                      00118 CVMPOS     EQU       0B
                      00119 ONTIMEPOS  EQU       0B
                      00120 CH53POS    EQU       08
                      00121 CH50POS    EQU       0E
                      00122 CH72POS    EQU       0D
                      00123 CH50MHZPOS EQU       04
                      00124 CH72MHZPOS EQU       04
                      00125 TESTCHPOS  EQU       07
                      00126 TESTVALPOS EQU       0C
                      00127 TACHRPMPOS EQU       0B
                      00128 RECVPOS    EQU       0B
                      00129 endif
                      00130 
                      00131 ifdef           ECMA1010display
                      00132 LINE1     EQU        0B0
                      00133 LINE2     EQU        0C0
                      00134 LINE3     EQU        0D0
                      00135 LINE4     EQU        0E0
                      00136 CURSORON  EQU        03F
                      00137 CURSOROFF EQU        031
                      00138 YPOS      EQU        07
                      00139 YNPOS     EQU        09
                      00140 NPOS      EQU        0B
                      00141 ACFTPOS    EQU       0A
                      00142 BYTEPOS    EQU       09
                      00143 PERCENTPOS EQU       07
                      00144 uSPOS      EQU       05
                      00145 INTPOS     EQU       07
                      00146 SELCHPOS   EQU       08
                      00147 CVMPOS     EQU       07
                      00148 ONTIMEPOS  EQU       07
                      00149 CH53POS    EQU       05
                      00150 CH50POS    EQU       0B
                      00151 CH72POS    EQU       0A
                      00152 CH50MHZPOS EQU       03
                      00153 CH72MHZPOS EQU       03
                      00154 TESTCHPOS  EQU       05
                      00155 TESTVALPOS EQU       08
                      00156 TACHRPMPOS EQU       07  
                      00157 RECVPOS    EQU       07
                      00158 endif
                      00159 
                      00160 ; Button and signal definitions for the Transmitter controls
                      00161 ; PortA bits
  00000004            00162 BUZZER  EQU     4
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 15


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00163 
                      00164 ; PortB bits
  00000001            00165 TACHIN  EQU     1
  00000002            00166 LED2    EQU     2
  00000006            00167 PLLRST  EQU     6               ; PIC reset on RFDECK
  00000007            00168 SDObit  EQU     7               ; Serial data out
                      00169 
                      00170 ; PortC bits
  00000002            00171 CFGMEM2 EQU     2
  00000003            00172 LED1    EQU     3
  00000004            00173 SDIbit  EQU     4
  00000005            00174 CLK     EQU     5               ; Clock for PLL and config mem
                      00175 
                      00176 ; PortD bits
  00000000            00177 AilDR   EQU     0
  00000001            00178 EleDR   EQU     1
  00000002            00179 RudDR   EQU     2
  00000003            00180 PRESET  EQU     3
  00000004            00181 MIX1    EQU     4
  00000005            00182 MIX2    EQU     5
  00000006            00183 MIX3    EQU     6
  00000007            00184 CH5     EQU     7
                      00185 
                      00186 ; PortE bits
  00000000            00187 RUNCAL  EQU     0
  00000001            00188 AUTOT   EQU     1
  00000002            00189 OPTION  EQU     2
  00000003            00190 CH8A    EQU     3
  00000004            00191 CH8C    EQU     4
  00000005            00192 ALTAFK  EQU     5
  00000006            00193 SNAPR   EQU     6
  00000007            00194 SNAPL   EQU     7
                      00195 
                      00196 ; PortF bits
  00000007            00197 MOD     EQU     7
                      00198 
                      00199 ; PortG bits
  00000000            00200 CFGMEM1 EQU     0
  00000003            00201 PLLCS   EQU     3
                      00202 
                      00203 ; PortH bits
  00000000            00204 AUXOUT  EQU     0
  00000001            00205 TACHENA EQU     1
  00000002            00206 RECCOMM EQU     2
                      00207 
                      00208 ; LCD PORTS
  00000F88            00209 LCDDATA         EQU     PORTJ
  00000F9A            00210 LCDDATADIR      EQU     DDRJ
  00000F81            00211 LCDCTRL         EQU     PORTB
  00000F93            00212 LCDCTRLDIR      EQU     DDRB
                      00213 
                      00214 ; ADC channel assignments
  00000000            00215 ADCch6          EQU     00
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 16


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

  00000001            00216 ADCch7          EQU     01
  00000002            00217 ADCgnd          EQU     02
  00000003            00218 ADCref          EQU     03
  00000004            00219 ADCail          EQU     04
  00000005            00220 ADCele          EQU     05
  00000006            00221 ADCrud          EQU     06
  00000007            00222 ADCthr          EQU     07
  00000008            00223 ADCailTrim      EQU     08
  00000009            00224 ADCeleTrim      EQU     09
  0000000A            00225 ADCrudTrim      EQU     0A
  0000000B            00226 ADCthrTrim      EQU     0B
  0000000C            00227 ADCtest         EQU     0C
  0000000D            00228 ADCrec          EQU     0D
                      00229 
  00000800            00230 NOMINALBAT      EQU     0x800
                      00231 
                      00571         Include <RAM.asm>
                      00001 ;******* BANK0 variables
                      00002 Bank0           udata_acs       0x00
                      00003 ;*******    INTERRUPT CONTEXT SAVE/RESTORE VARIABLES
000000                00004 TEMP_WREG       RES     1
000001                00005 TEMP_ALUSTA     RES     1
000002                00006 TEMP_BSR        RES     1
000003                00007 TEMP_PRODL      RES     1
000004                00008 TEMP_PRODH      RES     1
000005                00009 TEMP_WREG_L     RES     1
000006                00010 TEMP_ALUSTA_L   RES     1
000007                00011 TEMP_BSR_L      RES     1
000008                00012 TEMP_PRODL_L    RES     1
000009                00013 TEMP_PRODH_L    RES     1
00000A                00014 Areg            RES     1       ; General purpose registers
00000B                00015 Breg            RES     1
00000C                00016 Creg            RES     1
                      00017 ;
                      00018 ; Gereral variables
                      00019 ;
00000D                00020 AXreg           RES     2       ; 16 bit register
00000F                00021 BXreg           RES     2       ; 16 bit register
000011                00022 CXreg           RES     2       ; 16 bit register
000013                00023 CEXreg          RES     4       ; 32 bit regester
000017                00024 DEXreg          RES     4       ; 32 bit regester
00001B                00025 EEXreg          RES     4       ; 32 bit regester
00001F                00026 Atemp           RES     1
000020                00027 Btemp           RES     1
000021                00028 FSR1Lsave       RES     1
000022                00029 FSR1Hsave       RES     1
000023                00030 FPFLAGS         RES     1
000024                00031 SIGN            RES     1
000025                00032 Buffer          RES     D'10'
00002F                00033 ISRtemp         RES     1       ; Interrupt temp variable
000030                00034 PORTDimage      RES     1       ; PortD debounced
000031                00035 PORTDlast       RES     1
000032                00036 PORTDlatch      RES     1
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 17


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

000033                00037 PORTEimage      RES     1       ; PortE debounced
000034                00038 PORTElast       RES     1
000035                00039 PORTElatch      RES     1
                      00040 ;
000036                00041 Mode            RES     1       ; Defines the system mode
  00000001            00042 modeRUN         EQU     1
  00000002            00043 modeCAL         EQU     2
000037                00044 Cmd             RES     1       ; This flag is set by a host PC to
                      00045                                 ; request an action. Valid commands are:
                      00046                                 ;       31 = Read general data from sprom
                      00047                                 ;       32 = Read selected aircraft data from sprom
                      00048                                 ;       33 = Write general data to sprom
                      00049                                 ;       34 = Write selected aircraft data to sprom
000038                00050 CycleCounts     RES     2       ; D'2000000'/TICKSPER, The number of timer counts in one frame
                      00051 
                      00052 ;
                      00053 ; The following array holds the channel times for the PPM signal.
                      00054 ; One 16 bit word for each channel,8 channels plus one checksum channel 
00003A                00055 CHtimes         RES     2       ; First word is for sync
00003C                00056 chELE           RES     2
00003E                00057 chAIL           RES     2
000040                00058 chRUD           RES     2
000042                00059 chTHT           RES     2
000044                00060 chCH5           RES     2
000046                00061 chCH6           RES     2
000048                00062 chCH7           RES     2
00004A                00063 chCH8           RES     2
00004C                00064                 RES     2       ; Checksum channel
                      00065 ;
                      00066 
00004E                00067 Pstate          RES     1       ; State variable
00004F                00068 NumChan         RES     1       ; Number of transmit channels times two
000050                00069 NextTime        RES     2       ; The timers next compare reg value
000052                00070 Psum            RES     2       ; Total pulse time from start of output
000054                00071 Sync            RES     2       ; Sync pulse width.
                      00072 ; The following variables are involved in time keeping
000056                00073 Cmode           RES     1       ; Counter mode, 0 = count up, 1 = timer
000057                00074 Tick            RES     1       ; Tick counter
000058                00075 Secs            RES     1       ; Seconds sence reset
000059                00076 Mins            RES     1       ; Minutes sence reset
00005A                00077 Dsecs           RES     1       ; Timer Seconds 
00005B                00078 Dmins           RES     1       ; Timer Minutes 
00005C                00079 DsecsLatch      RES     1       ; Timer Seconds 
00005D                00080 BeepTicks       RES     1       ; This is used to create a beep. The RTI will
                      00081                                 ; turn off the buzzer after this many ticks
00005E                00082 BeepCtr         RES     1       ; Working counter...
00005F                00083 BeepCyl         RES     1       ; Number of cycles
                      00084 Bank0a          udata   0x060
000060                00085 TimeOut         RES     1       ; This is a timeout counter. the RTI will dec this
                      00086                                 ; if its not zero. Used by the serial rec routine
000061                00087 TimeOut1        RES     1       
000062                00088 TimeOut2        RES     1
                      00089 ; The following variables are used by USART1 serial receiver. Receive messages
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 18


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00090 ; are in the following format:
                      00091 ;               1 byte, start of message = 0x55
                      00092 ;               1 byte, message type
                      00093 ;               1 byte, Bank address
                      00094 ;               1 byte, location
                      00095 ;               1 byte, data length
                      00096 ;               (optional data block if its a receive message)
                      00097 ;               1 byte, mod 256 checksum
                      00098 ; Valid message types are:
                      00099 ;       1 = Reveive message, from host
                      00100 ;       2 = Send message, to host
  00000001            00101 RECMESS         EQU     1
  00000002            00102 SENDMESS        EQU     2
  0000000C            00103 ACK             EQU     D'12'
  0000000D            00104 NAK             EQU     D'13'
                      00105 
000063                00106 MessState       RES     1       ; defines the message receive state
000064                00107 MessStart       RES     1
000065                00108 MessType        RES     1
000066                00109 MessBank        RES     1
000067                00110 MessLoc         RES     1
000068                00111 MessLen         RES     1
000069                00112 MessCHK         RES     1
00006A                00113 CheckSum        RES     1
                      00114 ; Generic channel work space
00006B                00115 Pos             RES     2       ; Pot position
00006D                00116 Gh              RES     2       ; High side gain
00006F                00117 Ct              RES     2       ; Center position
000071                00118 Gl              RES     2       ; Low side gain
000073                00119 Npos            RES     2       ; Normalized position
                      00120 ; Normalized channel positions, centering channels go -1000 to 1000
                      00121 ; and non centering channels go 0 to 1000
000075                00122 Apos            RES     2
000077                00123 Epos            RES     2
000079                00124 Rpos            RES     2
00007B                00125 Tpos            RES     2
00007D                00126 CH5pos          RES     2
00007F                00127 CH6pos          RES     2
000081                00128 CH7pos          RES     2
000083                00129 CH8pos          RES     2
000085                00130 Atrim           RES     2
000087                00131 Etrim           RES     2
000089                00132 Rtrim           RES     2
00008B                00133 Ttrim           RES     2
00008D                00134 Vbat            RES     2
                      00135 ; Actual output position information for the channels that have slew rate control
00008F                00136 CH5posActual    RES     2
000091                00137 CH8posActual    RES     2
                      00138 ; Mixed channel positions
000093                00139 AposM           RES     2
000095                00140 EposM           RES     2
000097                00141 RposM           RES     2
000099                00142 TposM           RES     2
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 19


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

00009B                00143 CH5posM         RES     2
00009D                00144 CH6posM         RES     2
00009F                00145 CH7posM         RES     2
0000A1                00146 CH8posM         RES     2
                      00147 ; More variables...
                      00148 ; In many cases there are multiple variable names for the same
                      00149 ; physical memory, basicaly overloading. 
0000A3                00150 Ctemp           RES     1
0000A4                00151 Dtemp           RES     1
0000A5                00152 Etemp           RES     1
0000A6                00153 Ftemp           RES     1
0000A7                00154 TimeOut3        RES     1       ; This timeer is used by the sync up function
0000A8                00155 TimeOut4        RES     1
0000A9                00156 TimeOut5        RES     1
0000AA                00157 TEMPB3          RES     1
0000AB                00158 DefaultAircraft RES     1       ; Default Aircraft number
0000AC                00159 SPROMAircraft   RES     2       ; SPROM adress to start of current Aircraft data
0000AE                00160 MasterState     RES     1       ; State variable used by the Buddy box system
0000AF                00161 MasterPos       RES     2       ; Position variable
0000B1                00162 MApos           RES     2
0000B3                00163 MEpos           RES     2
0000B5                00164 MRpos           RES     2
0000B7                00165 MTpos           RES     2
0000B9                00166 Dst             RES     2       ; Destination address
0000BB                00167 Src             RES     2       ; Source address
0000BD                00168 Cnt             RES     1       ; Number of bytes to move
0000BE                00169 DriveCh         RES     1       ;
0000BF                00170 MinValue
0000BF                00171 MinTime
0000BF                00172 MinByte         RES     2
0000C1                00173 MaxValue
0000C1                00174 MaxTime
0000C1                00175 MaxByte         RES     2
0000C3                00176 OVERRUN         RES     1       ; This flag is set if data is not updated
                      00177                                 ; within one frame time
0000C4                00178 SymSet          RES     1       ; This flag is set during the servo cal
                      00179                                 ; function if the user wants to set the
                      00180                                 ; channel symeterical about its center.
0000C5                00181 SWID            RES     2
0000C7                00182 BladeTime       RES     2       ; Timer counts for aprox 1 sec worth of blade counts
0000C9                00183 BladeDet        RES     2       ; Counts prop blade detections
0000CB                00184 AilCenter       RES     2       ; Ailron channel pot center position
0000CD                00185 EleCenter       RES     2       ; Elevator channel pot center position        
0000CF                00186 EnaSecSprom     RES     1       ; This flag is set if a secondary Sprom is enabled
0000D0                00187 Usecs           RES     1       ; Up counter seconds value
0000D1                00188 Umins           RES     1       ; Up counter minutes value
                      00189 
0000D2                00190 TTflag          RES     1       ; Flag set if in the Throttle trim adjust mode
                      00191 ; Variables used by the calibrate servos functions, and misc UI functions
0000D3                00192 EXIT            RES     1
0000D4                00193 DXreg           RES     2
0000D6                00194 CalTable
0000D6                00195 SWselect
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 20


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00196 ; Do not move or reorder this block, used for servo position editing
0000D6                00197 RTDWN           RES     2
0000D8                00198 CENTER          RES     2
0000DA                00199 LTUP            RES     2
0000DC                00200 DRP             RES     1
0000DD                00201 TRIMP           RES     1
0000DE                00202 ATRM            RES     1
0000DF                00203 EXPOHI          RES     1
0000E0                00204 EXPOLOW         RES     1
                      00205 ; End of fixed block
0000E1                00206 YESNO           RES     1
0000E2                00207 STRIM
0000E2                00208 ServoREV                        ; This is a word flag used by the servo reverse logic
                      00209 ; Temp variables used by Mixer and servo UI reoutines
0000E2                00210 Mfrom           RES     1
0000E3                00211 Mto             RES     1
0000E4                00212 ATRST
0000E4                00213 Mzp             RES     1
0000E5                00214 Mpg             RES     1
0000E6                00215 Mng             RES     1
0000E7                00216 Mpi             RES     1
0000E8                00217 Mni             RES     1
0000E9                00218 Mreplace        RES     1
0000EA                00219 Mtbl            RES     1
0000EB                00220 AUXSTATE        RES     1       ; State of AUXOUT signal.
0000EC                00221 SelSprom        RES     1       ; Used by the Sprom Write functions the selected
                      00222                                 ; devices Bit is set.      
0000ED                00223 TimerCount      RES     1       ; This flag is set (FF) if the timer counting is 
                      00224                                 ; Enabled. This flag is set in the TemerEnable 
                      00225                                 ; Subroutine.
0000EE                00226 DPflag          RES     1       ; Flag set to display a decimal point in the adjust
                      00227                                 ; byte function
0000EF                00228 FMSflag         RES     1       ; Flag set when in the FMS flight simulator mode, UART2
0000F0                00229 FMSflagU1       RES     1       ; Flag set when in the FMS flight simulator mode. UART1
                      00230 
0000F1                00231 PostCall        RES     2       ; Pointer to a post call function used by the UI functions
0000F3                00232 PreCall         RES     2       ; Pointer to a pre call function used by the UI functions
0000F5                00233 FutabaStudent   RES     1       ; This flag is set when in the Futaba student mode and the
                      00234                                 ; the student button is pressed.
0000F6                00235 CalServoUpdate  RES     1       ; The flag CalServoUpdate must be set or this function will
                      00236                                 ; exit with no action.
0000F7                00237 IncTime         RES     1       ; This value hold the number of ADC counts over threshold for 
                      00238                                 ; use in the variable value increment time
0000F8                00239 PIC18F8723      RES     1       ; Flag set if 8723 PIC is detected
                      00240 ; These variables were added in December 2009 to improve the debounce logic on the Option 
                      00241 ; button
0000F9                00242 PORTDlatchLow   RES     1
0000FA                00243 PORTElatchLow   RES     1
                      00244 
                      00245 ; The following variables are only used in helicopter mode.
0000FB                00246 GyroTune        RES     1       ; This is a flag used in the helicopter mode to enable
                      00247                                 ; the gyro sensitivity adjust mode. This flag is reset on 
                      00248                                 ; powerup
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 21


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00249 ; Actual output position information for the throttle channel, used only in helicopter
                      00250 ; mode.
0000FC                00251 TposActual      RES     2
0000FE                00252 TholdState      RES     1       ; Flag used to save throttle hold switch state, needed of slew 
                      00253                                 ; rate control when flight mode is selected.
0000FF                00254 TMR4intNum      RES     1       ; Counter used by the timer 4 interrupt
                      00255 
                      00256 
                      00257 
                      00258 
                      00259 ;******* BANK1 variables
                      00260 Bank1           udata   0x100
                      00261 ; LMX2306 PLL setup parameters
                      00262 ; For the 50 MHz band
                      00263 ;       PDF     = 20
                      00264 ;       FCF     = 50800
                      00265 ;       FCN     = 0
                      00266 ;       NUMFREQ = 10
                      00267 ; For the 72 NHz band
                      00268 ;       PDF     = 10
                      00269 ;       FCF     = 72010
                      00270 ;       FCN     = 11
                      00271 ;       NUMFREQ = 60
000100                00272 Nreg            RES     3       ; 21 bit register
000103                00273 Rreg            RES     3       ; 21 Bit register
000106                00274 Freg            RES     3       ; 20 bit register
000109                00275 PDF             RES     2       ; Phase detector frequency, in KHz
00010B                00276 FCF             RES     3       ; First channel frequency, in KHz
00010E                00277 FCN             RES     1       ; First channel number   
00010F                00278 PMUL            RES     1       ; Phase clock multiplier
000110                00279 NUMFREQ         RES     1       ; Number of freq channel
                      00280 
                      00281 ; Misc variables
000111                00282 LValarm         RES     1       ; Flag set after the low voltage alarm is given
                      00283 
                      00284 ; Temp data block, used to save data vars
000112                00285 TempBlock       RES     8       ; 8 Bytes of storage
                      00286 
                      00287 ; Temp variables used for the Throttle Trim mode
00011A                00288 TTBH            RES     2
00011C                00289 TTMH            RES     2
                      00290 
                      00291 ; These variables are used by the User Interface routines
00011E                00292 CalOption       RES     2
000120                00293 CalMenu         RES     2
000122                00294 CalMenu1        RES     2
000124                00295 CalMenu2        RES     2
                      00296 
000126                00297 PostCallLevel1  RES     2
000128                00298 PostCallLevel2  RES     2
00012A                00299 PostCallLevel3  RES     2         
                      00300 
00012C                00301 AXregS          RES     2
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 22


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

00012E                00302 BXregS          RES     2
000130                00303 CXregS          RES     2
000132                00304 DXregS          RES     2
                      00305   
                      00306 ; Four main channels position information used for the trigger point switch routines
000134                00307 ATpos           RES     2
000136                00308 ETpos           RES     2
000138                00309 RTpos           RES     2
00013A                00310 TTpos           RES     2
                      00311 
                      00312 ; Temp Alt Aircraft numbers
00013C                00313 TAltA1          RES     1
00013D                00314 TAltA2          RES     1
                      00315 
                      00316 ; Temporary storage for FSR1 reg set
00013E                00317 SaveFSR1L       RES     1
00013F                00318 SaveFSR1H       RES     1
                      00319 
000140                00320 Units           RES     1               ; Used to store units character for UI routines
000141                00321 LCDwreg         RES     1               ; temp storage for the WREG in the LCD routine
                      00322 
                      00323 ; Digital trim working variables
000142                00324 DTdataAil       RES     2
000144                00325 DTdataEle       RES     2
000146                00326 DTdataRud       RES     2
000148                00327 DTdataTht       RES     2
                      00328 
00014A                00329 DTdisplay       RES     1               ; Display flag
                      00330 ; Last trim normalized positions for A,E, and R. Used for center beep
                      00331 ; logic
00014B                00332 AtrimLast       RES     2
00014D                00333 EtrimLast       RES     2
00014F                00334 RtrimLast       RES     2
000151                00335 TtrimLast       RES     2
000153                00336 CH6Last         RES     2
000155                00337 CH7Last         RES     2
000157                00338 TrimBeepSignChange      RES     1
                      00339 ; This is a version number variable used to provide PC application compatability
000158                00340 Version         RES     3               ; Format is ASCII, X.YZ for example 2,0,i
00015B                00341 RecVADC         RES     2               ; Contains the receiver voltage monitor raw ADC
                      00342                                         ; values. Used by PC application
00015D                00343 MonFlag         RES     1               ; Flag set if in the channel monitor mode.
                      00344                                         ; 0 = flag is clear
                      00345                                         ; 1 = Servo position monitor mode
                      00346                                         ; 2 = Auto trim monitor mode
00015E                00347 MonChan         RES     1               ; Monitor channel number
                      00348 
00015F                00349 LCDcgFlag       RES     1               ; This flag is set when a character generator
                      00350                                         ; address commend is given to the LCD display.
                      00351                                         ; This is used by the MicroProStar LCD drivers.
000160                00352 ActiveDisplayLine RES   1               ; This variable defines the active display line, 
                      00353                                         ; used in MPS mode.
000161                00354 ADCsum          RES     3               ; This variable holds the summed ADC value from 
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 23


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00355                                         ; ADCread256 function.
                      00356 ; The following variables are used to save the contents of shared registers in the
                      00357 ; MPS ADC routine
000164                00358 AXregSave       RES     2
000166                00359 BXregSave       RES     2
000168                00360 CEXregSave      RES     4
                      00361 
                      00362 ; transmitter voltage display filter accumunation register
00016C                00363 Vbat256         RES     3
                      00364 
                      00365 
                      00366 ;******* BANK2 variables
                      00367 ; 
                      00368 ; This area contains general setup parameters. This area is read from
                      00369 ; the serial prom on power up and these parameters apply to all aircraft.
                      00370 ; These parameters can not be reordered!
                      00371 ;
                      00372 Bank2           udata   0x200
000200                00373 Aircraft        RES     1       ; Aircraft number 0 thru 7
                      00374 ; LMX2306 PLL setup parameters, R and F regs values
                      00375 ; for 50,53 and 72MHz bands
000201                00376 Rreg50          RES     3
000204                00377 Freg50          RES     3
000207                00378 Rreg53          RES     3
00020A                00379 Freg53          RES     3
00020D                00380 Rreg72          RES     3
000210                00381 Freg72          RES     3
                      00382 
                      00383 ; Voltage monitor gains, (Raw adc counts)* gain = millivolts
000213                00384 VmonG           RES     2       ; Gain
                      00385 ; Joy stick calibration parameters. The gains are all times 256
                      00386 ; - first the centering sticks...
000215                00387 AHG             RES     2       ; High side gain
000217                00388 ACT             RES     2       ; Center counts
000219                00389 ALG             RES     2       ; Low side gain
                      00390 
00021B                00391 EHG             RES     2       ; High side gain
00021D                00392 ECT             RES     2       ; Center counts
00021F                00393 ELG             RES     2       ; Low side gain
                      00394 
000221                00395 RHG             RES     2       ; High side gain
000223                00396 RCT             RES     2       ; Center counts
000225                00397 RLG             RES     2       ; Low side gain
                      00398 ; The non centering sticks...
000227                00399 THG             RES     2       ; High side gain
000229                00400 TCT             RES     2       ; Center counts
                      00401 
00022B                00402 AtrimHG         RES     2       ; High side gain
00022D                00403 AtrimCT         RES     2       ; Center counts
                      00404 
00022F                00405 EtrimHG         RES     2       ; High side gain
000231                00406 EtrimCT         RES     2       ; Center counts
                      00407 
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 24


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

000233                00408 RtrimHG         RES     2       ; High side gain
000235                00409 RtrimCT         RES     2       ; Center counts
                      00410 
000237                00411 TtrimHG         RES     2       ; High side gain
000239                00412 TtrimCT         RES     2       ; Center counts
                      00413 
00023B                00414 CH6HG           RES     2       ; High side gain
00023D                00415 CH6CT           RES     2       ; Center counts
                      00416 
00023F                00417 CH7HG           RES     2       ; High side gain
000241                00418 CH7CT           RES     2       ; Center counts
                      00419 
000243                00420                 RES     3
                      00421 
                      00422 ; Translation tables
000246                00423 Table1          RES     D'11'
000251                00424 Table2          RES     D'11'
00025C                00425 Table3          RES     D'11'
000267                00426 Table4          RES     D'11'
000272                00427 Table5          RES     D'11'
00027D                00428 Table6          RES     D'11'
000288                00429 Table7          RES     D'11'
000293                00430 Table8          RES     D'11'
                      00431 
00029E                00432 AutoTrimStep    RES     1       ; Auto Trim step size
00029F                00433 AutoTrimTime    RES     1       ; Auto Trim adjust time in ticks
                      00434 
0002A0                00435 Student         RES     1       ; This flag is set if this transmitter
                      00436                                 ; will be used as a slave in the buddy box
                      00437                                 ; system. 0 = clear, FF = set
0002A1                00438 Master          RES     1       ; This flag is set if this transmitter will
                      00439                                 ; be used as a master in the buddy box
                      00440                                 ; system. 0 = clear, FF = set.
0002A2                00441                 RES     1       
0002A3                00442 SyncWidth       RES     2       ; Sync pulse width, in .5uS units
0002A5                00443 SelFreq         RES     1       ; Selected frequency
                      00444                                 ; 0FF = off
0002A6                00445                 RES     1       
0002A7                00446 Signature       RES     2       ; This is a formatted signature, it must be A5 E7 or you
                      00447                                 ; will be asked if you want to format the Sprom.
0002A9                00448 VRmonG          RES     2       ; Gain for the receiver voltage monitor ADC channel
0002AB                00449 PLLinitWORD     RES     3       ; This is the PLL initialization word, use to shut the
                      00450                                 ; PLL down
0002AE                00451 ServoMin        RES     2       ; Servo minimum limit
0002B0                00452 ServoMax        RES     2       ; Servo maximum limit    
                      00453 
                      00454 ; Trim table. This table is used to define witch trim adjustment is used
                      00455 ; for each flight control.
                      00456 ; Valid values are:
                      00457 ;       0 = none
                      00458 ;       1 = Ail trim
                      00459 ;       2 = Ele trim
                      00460 ;       3 = Rud trim
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 25


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00461 ;       4 = Tht trim
                      00462 ; The same registers define the digitial trims. The codes are as follows:
                      00463 ;       16 = Ail trim
                      00464 ;       32 = Ele trim
                      00465 ;       48 = Rud trim
                      00466 ;       64 = Tht trim
0002B2                00467 AilTrimCh       RES     1
0002B3                00468 EleTrimCh       RES     1
0002B4                00469 RudTrimCh       RES     1
0002B5                00470 ThtTrimCh       RES     1   
                      00471 
0002B6                00472 ATmode          RES     1       ; Auto trim mode, 0 = incremental, 1 = one shot
0002B7                00473 MasterMode      RES     1       ; Master mode, 0 = MicroStar, 1 = Futaba
                      00474 
0002B8                00475 BTflag          RES     1       ; This flag is set when its time to update the
                      00476                                 ; battery timer value
0002B9                00477 BattAlarm       RES     1       ; Battery alarm voltage level in .1 volt units
0002BA                00478 AUXMODE         RES     1       ; Defines the channel to output on the
                      00479                                 ; AUXOUT pin used for direct servo drive.
                      00480                                 ; Setting the MSB defines the output to be
                      00481                                 ; the encoded pulse train. To output a channel
                      00482                                 ; set this variable to the channel number times
                      00483                                 ; 2 plus 1.
                      00484 ; This is the ADC address table. This table is 16 bytes long and each byte selects
                      00485 ; the ADC multiplexer address and the ADC refrence. The reference is selected by the MSB 
                      00486 ; of each entery, 0 = external ref and 1 = 5 volt ref
0002BB                00487 ADCaddTbl               RES     16
                      00488 
                      00489 ; This is a flag byte used to define the frequency band for the RF deck. 
                      00490 ; Bit definitions:
                      00491 ;       Bit             Definition
                      00492 ;       0               Set for 50 MHz
                      00493 ;       1               Set for 53 MHz
                      00494 ; If both bits 0 and 1 are set then the 72 MHz band is selected
0002D1                00495 Fband                   RES     1
                      00496 ; Buzzer polarity
0002D2                00497 BuzPol                  RES     1       ; 0 = normal sense, 0xFF = inverted
                      00498 ; Trim Center Beep flag, this is for A,E, and R trims only
0002D3                00499 TrimCenterBeepFlag      RES     1       ; 0 = off, no beep, 0xFF = on, beep on center cross
                      00500 ; The following variables are used for the generation of the
                      00501 ; PPM output pulse train. All times are in .5uS units, 2MHz
                      00502 ; internal clock used by timer. Timer3 is used for this pulse
                      00503 ; generation.
0002D4                00504 TicksPer                RES     1       ; Ticks per second, default = 40
0002D5                00505 FrameDefect             RES     1       ; Frame time defect, allows the pilot to enter a frame time erro
                            r
                      00506                                         ; theu making the frame time unique to this transmitter
0002D6                00507 SerialSend              RES     1       ; This flag is set to cause the ppm data to be send using USART 
                      00508                                         ; port 2. The data is sent at full resolution.
                      00509 ; Trim Center Beep flag for throttle trim and channels 6&7
0002D7                00510 ThtTCenterBeepFlag      RES     1       ; 0 = off, no beep, 0xFF = on, beep on center cross
0002D8                00511 CH67CenterBeepFlag      RES     1       ; 0 = off, no beep, 0xFF = on, beep on center cross
                      00512 ; This variable is used to define the digital trim update rate when the trim button is held down
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 26


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

0002D9                00513 DTrimAdjustDelay        RES     1
                      00514 ; Display mode for the MPS
0002DA                00515 DisplayMode             RES     1       ; Two modes are supported:
                      00516                                         ; 0  = Altenate mode
                      00517                                         ; 0FF = Auto Trim select display line
0002DB                00518 DisplayLine             RES     1       ; Indicates the line to display
                      00519                                         ; 0   = line 1
                      00520                                         ; 0FF = line 2
0002DC                00521 ADCfixThres             RES     1       ; This is the ADC stability threshold used for the MPS
                      00522                                         ; to remove glitching due to power pulses from the RF deck.
0002DD                00523 Gversion                RES     3       ; Format is ASCII, X.YZ for example 2,0,i
0002E0                00524 ATthreshold             RES     1       ; Auto Trim stick position threshold
0002E1                00525 DOGcontrast             RES     1       ; Contrast setting for DOG display
                      00526 
                      00527 ;******* BANK3 variables 
                      00528 ;
                      00529 ; This area contains aircraft specific setup parameters. The serial
                      00530 ; prom contains 8 total setup, the selected aircraft's parameters are
                      00531 ; copied into this block. These parameters can not be reordered!
                      00532 ;
                      00533 Bank3           udata   0x300
                      00534 ; Channel specfic data.
                      00535 ; Gereral data
000300                00536 Name            RES     D'16'   ; Aircraft name for display!
000310                00537 Reserved        RES     1       ; 
                      00538 ; Aielron
000311                00539 AM1H            RES     2       ; Right gain
000313                00540 AB              RES     2       ; Offset
000315                00541 AM2H            RES     2       ; Left gain
000317                00542 ALR             RES     1       ; Low rate, in percent
000318                00543 APT             RES     1       ; Percent trim
000319                00544 AAT             RES     1       ; Autotrim offset
00031A                00545 AEXHI           RES     1       ; Expo high rate percentage
00031B                00546 AEXLOW          RES     1       ; Expo low rate percentage
                      00547 ; Elevator
00031C                00548 EM1H            RES     2       ; Up gain
00031E                00549 EB              RES     2       ; Offset
000320                00550 EM2H            RES     2       ; Down gain
000322                00551 ELR             RES     1       ; Low rate, in percent
000323                00552 EPT             RES     1       ; Percent trim
000324                00553 EAT             RES     1       ; Autotrim offset
000325                00554 EEXHI           RES     1       ; Expo high rate percentage
000326                00555 EEXLOW          RES     1       ; Expo low rate percentage
                      00556 ; Rudder
000327                00557 RM1H            RES     2       ; Right gain
000329                00558 RB              RES     2       ; Offset
00032B                00559 RM2H            RES     2       ; Left
00032D                00560 RLR             RES     1       ; Low rate, in percent
00032E                00561 RPT             RES     1       ; Percent trim
00032F                00562 RAT             RES     1       ; Autotrim offset
000330                00563 REXHI           RES     1       ; Expo high rate percentage
000331                00564 REXLOW          RES     1       ; Expo low rate percentage
                      00565 ; Throttle
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 27


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

000332                00566 TMH             RES     2       ; Gain and offset
000334                00567 TBH             RES     2
000336                00568 TPT             RES     1       ; Percent trim
000337                00569 TMODE           RES     1       ; Trim mode
000338                00570 Tpreset         RES     2       ; Preset servo position
                      00571 ; CH5, retract
00033A                00572 CH5MH           RES     2
00033C                00573 CH5BH           RES     2
                      00574 ; CH6
00033E                00575 CH6MH           RES     2       ; Gain and offset
000340                00576 CH6BH           RES     2
                      00577 ; CH7
000342                00578 CH7MH           RES     2       ; Gain and offset
000344                00579 CH7BH           RES     2
                      00580 ; CH8, three position, A,B,C
000346                00581 CH8_A           RES     2
000348                00582 CH8_B           RES     2
00034A                00583 CH8_C           RES     2
                      00584 ; Snap right
00034C                00585 SR_A            RES     2
00034E                00586 SR_E            RES     2
000350                00587 SR_R            RES     2
000352                00588 SR_T            RES     2
                      00589 ; Snap left
000354                00590 SL_A            RES     2
000356                00591 SL_E            RES     2
000358                00592 SL_R            RES     2
00035A                00593 SL_T            RES     2
                      00594 ; Mixers, 3 total
                      00595 ; 1
00035C                00596 M1Afrom         RES     1
00035D                00597 M1Ato           RES     1
00035E                00598 M1Azp           RES     1
00035F                00599 M1Aur           RES     1
000360                00600 M1Adl           RES     1
000361                00601 M1Bfrom         RES     1
000362                00602 M1Bto           RES     1
000363                00603 M1Bzp           RES     1
000364                00604 M1Bur           RES     1
000365                00605 M1Bdl           RES     1
000366                00606 M1Cfrom         RES     1
000367                00607 M1Cto           RES     1
000368                00608 M1Czp           RES     1
000369                00609 M1Cur           RES     1
00036A                00610 M1Cdl           RES     1
00036B                00611 M1Dfrom         RES     1
00036C                00612 M1Dto           RES     1
00036D                00613 M1Dzp           RES     1
00036E                00614 M1Dur           RES     1
00036F                00615 M1Ddl           RES     1
                      00616 ; 2
000370                00617 M2Afrom         RES     1
000371                00618 M2Ato           RES     1
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 28


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

000372                00619 M2Azp           RES     1
000373                00620 M2Aur           RES     1
000374                00621 M2Adl           RES     1
000375                00622 M2Bfrom         RES     1
000376                00623 M2Bto           RES     1
000377                00624 M2Bzp           RES     1
000378                00625 M2Bur           RES     1
000379                00626 M2Bdl           RES     1
00037A                00627 M2Cfrom         RES     1
00037B                00628 M2Cto           RES     1
00037C                00629 M2Czp           RES     1
00037D                00630 M2Cur           RES     1
00037E                00631 M2Cdl           RES     1
00037F                00632 M2Dfrom         RES     1
000380                00633 M2Dto           RES     1
000381                00634 M2Dzp           RES     1
000382                00635 M2Dur           RES     1
000383                00636 M2Ddl           RES     1
                      00637 ; 3
000384                00638 M3Afrom         RES     1
000385                00639 M3Ato           RES     1
000386                00640 M3Azp           RES     1
000387                00641 M3Aur           RES     1
000388                00642 M3Adl           RES     1
000389                00643 M3Bfrom         RES     1
00038A                00644 M3Bto           RES     1
00038B                00645 M3Bzp           RES     1
00038C                00646 M3Bur           RES     1
00038D                00647 M3Bdl           RES     1
00038E                00648 M3Cfrom         RES     1
00038F                00649 M3Cto           RES     1
000390                00650 M3Czp           RES     1
000391                00651 M3Cur           RES     1
000392                00652 M3Cdl           RES     1
000393                00653 M3Dfrom         RES     1
000394                00654 M3Dto           RES     1
000395                00655 M3Dzp           RES     1
000396                00656 M3Dur           RES     1
000397                00657 M3Ddl           RES     1
                      00658 ; Fixed mix functions.
000398                00659 VTAIL           RES     1       ; 0=off and FF=on
000399                00660 ELEVON          RES     1       ; 0=off and FF=on
00039A                00661 DUALA           RES     1       ; 0=off and FF=on
00039B                00662 FPgainN         RES     1       ; Amount of flaps, negative gain
00039C                00663 DIFFA           RES     1       ; Percentage of differential, 0 = off
00039D                00664 FPgain          RES     1       ; Amount of flaps, positive gain
00039E                00665                 RES     2       ; Reserved to preserve alignment
0003A0                00666 IDLEUP          RES     1       ; Idle up flag, FF = On
0003A1                00667 IDLEUPpA        RES     1       ; Idle up percentage A
0003A2                00668 IDLEUPpB        RES     1       ; Idle up percentage B
0003A3                00669                 RES     1       
0003A4                00670 FixedFirst      RES     1       ; If this flag is set (FF) then the fixed mixer
                      00671                                 ; functions are completed before the general mixers.
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 29


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

0003A5                00672 NumBlades       RES     1       ; Number of prop blades, used by Tach
0003A6                00673 RetractsWarning RES     1       ; This flag is set if you want a retracts up warning
                      00674 
                      00675 ; The following variables hold the trim zero values. These variables are used to recenter
                      00676 ; the trims. 
                      00677 
0003A7                00678 TrimZeroAil     RES     2
0003A9                00679 TrimZeroEle     RES     2
0003AB                00680 TrimZeroRud     RES     2
                      00681 
0003AD                00682 ModelChannel    RES     1       ; This models fraquency channel
                      00683 
                      00684 ; Switch selections
0003AE                00685 SWAILDR         RES     1
0003AF                00686 SWELEDR         RES     1
0003B0                00687 SWRUDDR         RES     1
0003B1                00688 SWPRESET        RES     1
0003B2                00689 SWMIX1          RES     1
0003B3                00690 SWMIX2          RES     1
0003B4                00691 SWMIX3          RES     1
0003B5                00692 SWCH5           RES     1
0003B6                00693 SWATRIM         RES     1
0003B7                00694 SWCH8A          RES     1
0003B8                00695 SWCH8B          RES     1
0003B9                00696 SWCH8C          RES     1
0003BA                00697                 RES     1
0003BB                00698 SWSNAPR         RES     1
0003BC                00699 SWSNAPL         RES     1 
                      00700 
                      00701 ; Timer variables...
0003BD                00702 CNTmode         RES     1       ; 0 = On time only, 1 = DWN timer
0003BE                00703 DWNSecs         RES     1
0003BF                00704 DWNMins         RES     1
0003C0                00705 TEnaSW          RES     1       ; Switch used to enable timer
0003C1                00706 Tthres          RES     1       ; Throttle threshold for timer
                      00707 
                      00708 ; More switch selections
0003C2                00709                 RES     1       ; Reserved to preserve alignment
0003C3                00710 SWIDLEUP1       RES     1
0003C4                00711 SWIDLEUP2       RES     1
                      00712 
                      00713 ; Additions for the CROW function
0003C5                00714 SWCROW          RES     1       ; The Crow switch, by default is Mixer 1 switch
0003C6                00715 CROWENA         RES     1       ; Flag set if CROW is enabled.
                      00716 
0003C7                00717                 RES     1       
0003C8                00718                 RES     1       
                      00719 
                      00720 ; Control stick trigger positions
0003C9                00721 ATP             RES     1
0003CA                00722 ETP             RES     1
0003CB                00723 RTP             RES     1
0003CC                00724 TTP             RES     1
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 30


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00725 
0003CD                00726 SHIFT           RES     1       ; Set to FF for ACE shift
                      00727 
                      00728 ; Alternate aircraft array, 6 entries, each entry is:
                      00729 ;   First byte =  Switch ID
                      00730 ;   Second byte = Aircraft number
  00000006            00731 NumAlt          EQU     6
0003CE                00732 AltAircraft     RES     2 * 6
                      00733 
                      00734 ; Aircraft specific translation tables
0003DA                00735 Atable1         RES     D'11'
0003E5                00736 Atable2         RES     D'11'
                      00737 
                      00738 ;******* BANK4 variables 
                      00739 ;
                      00740 ; This page holds the second 256 byte page of the aircraft specific memory
                      00741 ;
                      00742 Bank4           udata   0x400
                      00743 ; Output order. This table defines the output channel order. The user can
                      00744 ; configure any order he likes. You can even repeat the same channel if
                      00745 ; required for your application
000400                00746 ChannelOrder    RES     8
                      00747 ; The following table supports subtrims. This allows the pilot to set the servo 
                      00748 ; center position of any cannel independently
000408                00749 SubTrim         RES     8
                      00750 ; The following variables support additional fixed mixers that are commonly 
                      00751 ; used by pilots
                      00752 ;                       - Ail to rudder, 2 bytes
                      00753 ;                       - Rud to ail, 2 bytes
                      00754 ;                       - Rud to ele, 2 bytes
                      00755 ;                       - Throttle to ele, 1 byte
                      00756 ;                       - Dual elevator, 2 bytes
000410                00757 AilRudPos       RES     1
000411                00758 AilRudNeg       RES     1
                      00759 
000412                00760 RudAilPos       RES     1
000413                00761 RudAilNeg       RES     1
                      00762 
000414                00763 RudElePos       RES     1
000415                00764 RudEleNeg       RES     1
                      00765 
000416                00766 ThtEle          RES     1
                      00767 
000417                00768 DualE           RES     1       ; Flag, 0=off, FF=on
000418                00769                 RES     1       
                      00770                 
                      00771 ; Slew rate limits servo speed control
000419                00772 CH5stepSize     RES     2
00041B                00773 CH8stepSize     RES     2
                      00774 
                      00775 ; Helicopter CCPM mixing flag
                      00776 ;       0 = off
                      00777 ;       1 = 3 servos 120 degrees
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 31


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00778 ;       2 = 3 servos 140 degrees
                      00779 ;       3 = 3 servos 90 degrees
00041D                00780 CCPMmode        RES     1
                      00781 
                      00782 ; Digitial trim values, these variables save an aircraft specific copy of the digital
                      00783 ; trim values. The working values are saved in EEPROM and these are updated when
                      00784 ; the aircraft is saved.
00041E                00785 DTailA          RES     2
000420                00786 DTeleA          RES     2
000422                00787 DTrudA          RES     2
000424                00788 DTthtA          RES     2
                      00789 
                      00790 ;
                      00791 ; The following variables are used for the Helicopter modes.
                      00792 ; CH6 is used for pitch control
                      00793 ; CH5 outputs gyro sensitivity, When the GyroTune mode is active then CH7
                      00794 ; defines the gyro sensitivity on CH5 output and pressing the option button
                      00795 ; will save the position in the proper variable.
                      00796 ; CH6 control is used for pitch trim
                      00797 ; 3 flight modes and throttle hold mode is supported
                      00798 ;
000426                00799 Henable         RES     1       ; Non zero value enables the helicopter mode
000427                00800 Tnorm           RES     2       ; This value contains the throttle normalized position before
                      00801                                 ; Any trims are applied. This is needed for trim speration from
                      00802                                 ; the pitch control. CH6 control is used for pitch trim adjust
000429                00803 HPrev           RES     1       ; Pitch reverse flag
                      00804 ; Normal mode parameters:
00042A                00805 HSen            RES     1       ; Gyro sensitivity, output on CH5
00042B                00806 HTht            RES     1       ; Table for throttle curve
00042C                00807 HPitch          RES     1       ; Table of pitch curve
00042D                00808 SWIDLEUPN       RES     1       ; Idle up switch for normal mode
00042E                00809 IdleUpNorm      RES     1       ; Idle up throttle position
                      00810 ; Throttle hold parameters:
00042F                00811 SWTHOLD         RES     1       ; Switch to activate throttle hold mode
000430                00812 THOLDp          RES     1       ; Throttle hold percentage
000431                00813 HthtSen         RES     1       ; Gyro sensitivity, output on CH5
000432                00814 HthtPitch       RES     1       ; Table of pitch curve
                      00815 ; Stunt mode 1 parameters:
000433                00816 SWSTUNT1        RES     1       ; Switch to activate stunt mode 1
000434                00817 Hst1Sen         RES     1       ; Gyro sensitivity, output on CH5
000435                00818 Hst1Tht         RES     1       ; Table for throttle curve
000436                00819 Hst1Pitch       RES     1       ; Table of pitch curve
000437                00820 SWIDLEUPST1     RES     1       ; Idle up switch for stunt mode 1
000438                00821 IdleUpST1       RES     1       ; Idle up throttle position
                      00822 ; Stunt mode 2 parameters:
000439                00823 SWSTUNT2        RES     1       ; Switch to activate stunt mode 2
00043A                00824 Hst2Sen         RES     1       ; Gyro sensitivity, output on CH5
00043B                00825 Hst2Tht         RES     1       ; Table for throttle curve
00043C                00826 Hst2Pitch       RES     1       ; Table of pitch curve
00043D                00827 SWIDLEUPST2     RES     1       ; Idle up switch for stunt mode 2
00043E                00828 IdleUpST2       RES     1       ; Idle up throttle position
                      00829 
                      00830 ; Throttle hold slew rate control valiables
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 32


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

00043F                00831 TstepSize       RES     2       ; Servo motion step size for each tick. This is set via the 
                      00832                                 ; helicopter function when the throttle hold mode is changed.
000441                00833 TtransistionT   RES     2       ; Throttle hold transistion time. This is user programmed.
                      00834 
                      00835 ; Analog control remap tables
000443                00836 AILremap        RES     1
000444                00837 ELEremap        RES     1
000445                00838 RUDremap        RES     1
000446                00839 THTremap        RES     1
000447                00840 CH6remap        RES     1
000448                00841 CH7remap        RES     1
                      00842 
000449                00843 MaxChannels     RES     1       ; Number of transmit channels
                      00844 
                      00845 ; Helicopter CCPM reversal flags
00044A                00846 HArev           RES     1       ; Aileron reversal
00044B                00847 HErev           RES     1       ; Elevator reversal
                      00848 
00044C                00849 Debug           RES     2
                      00850 
                      00851 ;******* BANK5 variables 
                      00852 ;
                      00853 ; This area is backed up in EEPROM memory
                      00854 ;
                      00855 Bank5           udata   0x500
000500                00856 BatteryTimer    RES     2       ; This variable holds the total "on" time of the
                      00857                                 ; transmitter. This value is saved in the EEPROM.
                      00858 ; System cofiguration Options
000502                00859 Adapter         RES     1       ; This flag is set for the Adapter mode
000503                00860 Dog162          RES     1       ; This flag is set for the DOG 162 display
                      00861 
                      00862 Bank5a          udata   0x580   ; Save space for more config flags
                      00863 ; These are the digital trim working variables. These values are uppdated when the aircraft 
                      00864 ; is saved/changed. These are the variables that save the active trim settings
000580                00865 DTail           RES     2
000582                00866 DTele           RES     2
000584                00867 DTrud           RES     2
000586                00868 DTtht           RES     2
                      00869 
                      00870 ; This buffer if used for the apply to all aircraft option
000588                00871 BlkBuf          RES     D'64'
                      00872 
                      00873 ;
                      00874 ; This page holds a copy of the primary aircraft setup variables. This data is used by
                      00875 ; the alternate aircraft function. The switch data held in this area is used to contol
                      00876 ; the selection.
                      00877 ;
                      00878 Bank6           udata   0x600
000600                00879 Backup          RES     D'256'
                      00880 
                      00881 ;
                      00882 ; This page holds the second backup 256 byte page of aircraft setup variables.
                      00883 ;
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 33


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00884 Bank7           udata   0x700
                      00885 
                      00886 ;
                      00887 ; This page is used for the save aircraft name function
                      00888 ;
                      00889 Bank8           udata   0x800
                      00572         Include <Macros.asm>
                      00001 ;
                      00002 ; MACROS.asm
                      00003 ;
                      00004 ; This file contains the marcos used by the MicroStar application.
                      00005 ;
                      00006 ; Gordon Anderson
                      00007 ;
                      00008  
                      00009 GOTOF           MACRO   ADDRS
                      00010                 GOTO    ADDRS
                      00011                 ENDM
                      00012 
                      00013 CALLF           MACRO   ADDRS
                      00014                 CALL    (ADDRS)
                      00015                 ENDM
                      00016 
                      00017 CALLFL          MACRO   ADDRS,VAL
                      00018                 MOVLW   (VAL)
                      00019                 CALL    (ADDRS)
                      00020                 ENDM
                      00021 
                      00022 CALLFW          MACRO   ADDRS
                      00023                 CALL    (ADDRS)
                      00024                 ENDM
                      00025 
                      00026 CALLFF          MACRO   ADDRS,VAL
                      00027                 MOVFP   (VAL),WREG
                      00028                 CALL    (ADDRS)
                      00029                 ENDM
                      00030 
                      00031 PUSHREGS        MACRO                 ;macro for saving registers, used in high priority ISRs
                      00032                 MOVFF   ALUSTA,TEMP_ALUSTA
                      00033                 MOVFF   BSR,TEMP_BSR
                      00034                 MOVWF   TEMP_WREG
                      00035                 MOVFF   PRODL, TEMP_PRODL
                      00036                 MOVFF   PRODH, TEMP_PRODH
                      00037                 ENDM
                      00038 
                      00039 POPREGS         MACRO                 ;macro for restoring registers, used in high priority ISRs
                      00040                 MOVFF   TEMP_PRODL, PRODL
                      00041                 MOVFF   TEMP_PRODH, PRODH
                      00042                 MOVF    TEMP_WREG,W
                      00043                 MOVFF   TEMP_BSR,BSR
                      00044                 MOVFF   TEMP_ALUSTA,ALUSTA
                      00045                 ENDM
                      00046 
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 34


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00047 PUSHREGSLOW     MACRO                 ;macro for saving registers, used in low priority ISRs
                      00048                 MOVFF   ALUSTA,TEMP_ALUSTA_L
                      00049                 MOVFF   WREG,TEMP_WREG_L
                      00050                 MOVFF   BSR,TEMP_BSR_L
                      00051                 MOVFF   PRODL, TEMP_PRODL_L
                      00052                 MOVFF   PRODH, TEMP_PRODH_L
                      00053                 ENDM
                      00054 
                      00055 
                      00056 POPREGSLOW      MACRO                 ;macro for restoring registers, used in low priority ISRs
                      00057                 MOVFF   TEMP_PRODL_L, PRODL
                      00058                 MOVFF   TEMP_PRODH_L, PRODH
                      00059                 MOVFF   TEMP_BSR_L,BSR
                      00060                 MOVFF   TEMP_WREG_L,WREG
                      00061                 MOVFF   TEMP_ALUSTA_L,ALUSTA
                      00062                 ENDM
                      00063 
                      00064 PrintMess       MACRO   MESSAGE
                      00065                 MOVLW   UPPER (MESSAGE)
                      00066                 MOVWF   TBLPTRU,A
                      00067                 MOVLW   HIGH (MESSAGE)
                      00068                 MOVWF   TBLPTRH,A
                      00069                 MOVLW   LOW (MESSAGE)
                      00070                 MOVWF   TBLPTRL,A
                      00071                 CALL    LCDsendMess
                      00072                 ENDM
                      00073 
                      00074 PrintMessN      MACRO   MESSAGE
                      00075                 MOVFF   WREG,Areg
                      00076                 MOVLW   UPPER (MESSAGE)
                      00077                 MOVWF   TBLPTRU,A
                      00078                 MOVLW   HIGH (MESSAGE)
                      00079                 MOVWF   TBLPTRH,A
                      00080                 MOVLW   LOW (MESSAGE)
                      00081                 MOVWF   TBLPTRL,A
                      00082                 MOVFF   Areg,WREG
                      00083                 CALL    LCDsendMessN
                      00084                 ENDM
                      00085 
                      00086 ifdef   MicroProStar
                      00087 ; This macro sets the carry flag if the port's bit is set
                      00088 State           MACRO   PORT,BIT
                      00089                 if      PORT == PORTD
                      00090                 CALL    MP8KreadD
                      00091                 endif
                      00092                 if      PORT == PORTE
                      00093                 CALL    MP8KreadE
                      00094                 endif
                      00095                 BCF     ALUSTA,C
                      00096                 BTFSC   WREG,BIT
                      00097                 BSF     ALUSTA,C
                      00098                 ENDM
                      00099 ; Carry flag is cleared if the button is pressed and remains pressed
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 35


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00100 ; 10 mSec later
                      00101 Pressed         MACRO   PORT,BIT
                      00102                 Local   Done
                      00103                 State   PORT,BIT
                      00104                 BTFSC   ALUSTA,C
                      00105                 GOTO    Done
                      00106                 MOVLW   D'10'
                      00107                 CALL    Delay1mS
                      00108                 State   PORT,BIT
                      00109 Done
                      00110                 ENDM
                      00111 ; Waits for a button to be released and stay released for 10 mSec
                      00112 Release         MACRO   PORT,BIT
                      00113                 Local   Wait
                      00114 Wait
                      00115                 State   PORT,BIT
                      00116                 BTFSS   ALUSTA,C
                      00117                 GOTO    Wait
                      00118                 MOVLW   D'10'
                      00119                 CALL    Delay1mS
                      00120                 State   PORT,BIT
                      00121                 BTFSS   ALUSTA,C
                      00122                 GOTO    Wait
                      00123                 ENDM
                      00124 else
                      00125 ; This macro sets the carry flag if the port's bit is set
                      00126 State           MACRO   PORT,BIT
                      00127                 MOVLB   HIGH PORT
                      00128                 BCF     ALUSTA,C
                      00129                 BTFSC   PORT,BIT
                      00130                 BSF     ALUSTA,C
                      00131                 ENDM
                      00132 
                      00133 ; Carry flag is cleared if the button is pressed and remains pressed
                      00134 ; 10 mSec later
                      00135 Pressed         MACRO   PORT,BIT
                      00136                 State   PORT,BIT
                      00137                 BTFSC   ALUSTA,C
                      00138                 GOTO    $ + D'14'
                      00139                 MOVLW   D'10'
                      00140                 CALL    Delay1mS
                      00141                 State   PORT,BIT
                      00142                 ENDM
                      00143 
                      00144 ; Waits for a button to be released and stay released for 10 mSec
                      00145 Release         MACRO   PORT,BIT
                      00146                 State   PORT,BIT
                      00147                 BTFSS   ALUSTA,C
                      00148                 GOTO    $ - D'10'
                      00149                 MOVLW   D'10'
                      00150                 CALL    Delay1mS
                      00151                 State   PORT,BIT
                      00152                 BTFSS   ALUSTA,C
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 36


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00153                 GOTO    $ - D'30'
                      00154                 ENDM
                      00155 endif
                      00156 
                      00157 MOVEB           MACRO   REG1,REG2
                      00158                 MOVFF   REG1,REG2
                      00159                 ENDM
                      00160                 
                      00161 MOVE16          MACRO   REG1,REG2
                      00162                 MOVFF   REG1,REG2
                      00163                 MOVFF   (REG1+1),(REG2+1)
                      00164                 ENDM
                      00165                 
                      00166 MOVE            MACRO   REG1,REG2
                      00167                 MOVFF   REG1,REG2
                      00168                 MOVFF   (REG1+1),(REG2+1)
                      00169                 ENDM
                      00170 
                      00171 MOVE24          MACRO   REG1,REG2
                      00172                 MOVFF   REG1,REG2
                      00173                 MOVFF   (REG1+1),(REG2+1)
                      00174                 MOVFF   (REG1+2),(REG2+2)
                      00175                 ENDM
                      00176 
                      00177 MOVE32          MACRO   REG1,REG2
                      00178                 MOVFF   REG1,REG2
                      00179                 MOVFF   (REG1+1),(REG2+1)
                      00180                 MOVFF   (REG1+2),(REG2+2)
                      00181                 MOVFF   (REG1+3),(REG2+3)
                      00182                 ENDM
                      00183                 
                      00184 MOVEC           MACRO   CONST,REG1
                      00185                 MOVLR   HIGH (REG1)
                      00186                 MOVLW   LOW (CONST)
                      00187                 MOVWF   (REG1)
                      00188                 MOVLW   HIGH (CONST)
                      00189                 MOVWF   (REG1+1)
                      00190                 ENDM     
                      00191                 
                      00192 MOVEC24         MACRO   CONST,REG
                      00193                 MOVLR   HIGH (REG)
                      00194                 MOVLW   LOW (CONST)
                      00195                 MOVWF   (REG)
                      00196                 MOVLW   HIGH (CONST)
                      00197                 MOVWF   (REG+1)
                      00198                 MOVLW   UPPER (CONST)
                      00199                 MOVWF   (REG+2)
                      00200                 ENDM
                      00201 
                      00202 MOVEC32         MACRO   CONST,REG
                      00203                 MOVLR   HIGH (REG)
                      00204                 MOVLW   LOW (CONST)
                      00205                 MOVWF   (REG)
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 37


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00206                 MOVLW   LOW (CONST/100)
                      00207                 MOVWF   (REG+1)
                      00208                 MOVLW   HIGH (CONST/100)
                      00209                 MOVWF   (REG+2)
                      00210                 MOVLW   UPPER (CONST/100)
                      00211                 MOVWF   (REG+3)
                      00212                 ENDM
                      00213 
                      00214 ; The following macros support indirect word movements
                      00215 
                      00216         ; Move from address to word
                      00217 MOVEIW          MACRO   ADD,REG
                      00218                 MOVLW   0F
                      00219                 ANDWF   BSR,F
                      00220                 MOVLR   HIGH ADD
                      00221                 MOVFP   ADD,FSR1
                      00222                 MOVFP   ADD+1,WREG
                      00223                 SWAPF   WREG
                      00224                 IORWF   BSR,F
                      00225                 BCF     ALUSTA,FS3
                      00226                 BSF     ALUSTA,FS2
                      00227                 MOVPF   INDF1,REG
                      00228                 MOVPF   INDF1,REG+1
                      00229                 ENDM
                      00230                 
                      00231         ; Move from word to address
                      00232 MOVEWI          MACRO   REG,ADD
                      00233                 MACRO   ADD,REG
                      00234                 MOVLW   0F
                      00235                 ANDWF   BSR,F
                      00236                 MOVLR   HIGH ADD
                      00237                 MOVFP   ADD,FSR1
                      00238                 MOVFP   ADD+1,WREG
                      00239                 SWAPF   WREG
                      00240                 IORWF   BSR,F
                      00241                 BCF     ALUSTA,FS3
                      00242                 BSF     ALUSTA,FS2
                      00243                 MOVFP   REG,INDF1
                      00244                 MOVFP   REG+1,INDF1
                      00245                 ENDM  
                      00246                 
                      00247         ; Move from address to byte
                      00248 MOVEIB          MACRO   ADD,REG
                      00249                 MOVLW   0F
                      00250                 ANDWF   BSR,F
                      00251                 MOVLR   HIGH ADD
                      00252                 MOVFP   ADD,FSR1
                      00253                 MOVFP   ADD+1,WREG
                      00254                 SWAPF   WREG
                      00255                 IORWF   BSR,F
                      00256                 MOVPF   INDF1,WREG
                      00257                 MOVLR   HIGH REG
                      00258                 MOVWF   REG
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 38


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00259                 ENDM
                      00260                 
                      00261         ; Move from byte to address
                      00262 MOVEBI          MACRO   REG,ADD
                      00263                 MOVLR   HIGH REG
                      00264                 MOVFP   REG,PRODH
                      00265                 MOVLW   0F
                      00266                 ANDWF   BSR,F
                      00267                 MOVLR   HIGH ADD
                      00268                 MOVFP   ADD,FSR1
                      00269                 MOVFP   ADD+1,WREG
                      00270                 SWAPF   WREG
                      00271                 IORWF   BSR,F
                      00272                 MOVFP   PRODH,INDF1
                      00273                 ENDM
                      00274 
                      00275 ifdef           MicroProStar
                      00276 ; The following set of macros support the flagging system used to mark
                      00277 ; the IO system as busy and test if its busy.
                      00278 ; Also LCD display macros are included.
                      00279 MP8K_SetBusy    MACRO
                      00280                 BSF     LATG,4,A
                      00281                 ENDM
                      00282                 
                      00283 MP8K_ResetBusy  MACRO
                      00284                 BCF     LATG,4,A
                      00285                 ENDM
                      00286                 
                      00287 ; Returns with the carry flag set if busy
                      00288 MP8K_IsBusy     MACRO
                      00289                 BCF     ALUSTA,C
                      00290                 BTFSC   LATG,4,A
                      00291                 BSF     ALUSTA,C
                      00292                 ENDM
                      00293                 
                      00294 ; Display macros
                      00295 SingleLine      MACRO
                      00296                 BCF     PIE3,TMR4IE,A   ; disable the interrupt
                      00297                 ENDM            
                      00298 DualLine        MACRO
                      00299                 BSF     PIE3,TMR4IE,A   ; enable the interrupt
                      00300                 BCF     PIR3,TMR4IF,A   ; Clear the interupt flag
                      00301                 ENDM
                      00302 ShowLine1       MACRO
                      00303                 CALL    LCDshowLine1
                      00304                 ENDM
                      00305 ShowLine2       MACRO
                      00306                 CALL    LCDshowLine2
                      00307                 SETF    WREG            ; Make sure we point to line two of the display
                      00308                 MOVFF   WREG,DisplayLine
                      00309                 ENDM
                      00310 NoAddCorrection MACRO
                      00311                 SETF    WREG
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 39


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00312                 MOVFF   WREG,LCDcgFlag
                      00313                 ENDM
                      00314 AddCorrection   MACRO
                      00315                 CLRF    WREG
                      00316                 MOVFF   WREG,LCDcgFlag
                      00317                 ENDM
                      00318 else
                      00319 
                      00320 ; Display macros, these macros do nothing they are included to keep
                      00321 ; code compatibility with the MicroStar version.
                      00322 SingleLine      MACRO
                      00323                 ENDM    
                      00324 DualLine        MACRO
                      00325                 ENDM
                      00326 ShowLine1       MACRO
                      00327                 ENDM
                      00328 ShowLine2       MACRO
                      00329                 ENDM
                      00330 NoAddCorrection MACRO
                      00331                 ENDM
                      00332 AddCorrection   MACRO
                      00333                 ENDM
                      00334 endif
                      00335 
                      00573         
                      00574 ResetEntry      code            0x0000 + OFFSET
000200 EF?? F???      00575                 goto   start
                      00576 
                      00577 
                      00578 ;************   High Priority INTERRUPT VECTOR
                      00579 HPinterrupt     code            0x0008 + OFFSET
000208 EF?? F???      00580                 goto            HIGHISRS
                      00581 
                      00582 ;************   Low Priority INTERRUPT VECTOR
                      00583 LPinterrupt     code            0x0018 + OFFSET
000218 EF?? F???      00584                 goto            LOWISRS
                      00585 
                      00586 
                      00587 ; High priority interrupt handeler
00021C                00588 HIGHISRS
                      00589                 PUSHREGS                        ;save specific registers
00021C CFD8 F???          M                 MOVFF   ALUSTA,TEMP_ALUSTA
000220 CFE0 F???          M                 MOVFF   BSR,TEMP_BSR
000224 6E??               M                 MOVWF   TEMP_WREG
000226 CFF3 F???          M                 MOVFF   PRODL, TEMP_PRODL
00022A CFF4 F???          M                 MOVFF   PRODH, TEMP_PRODH
                      00590         ; Test if this is a hardware interrupt 1. This is used for the tach and 
                      00591         ; the futaba trainer system
00022E ACF0           00592                 BTFSS   INTCON3,INT1IP,A        ; If INT1 is set to low priority then do not test
000230 EF?? F???      00593                 GOTO    HIGHISRS0               ; if its active
000234 B0F0           00594                 BTFSC   INTCON3,INT1IF,A
000236 EC?? F???      00595                 CALL    INT1ISR
                      00596         ; Test if this is a timer3 interrupt, compare reg 2
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 40


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

00023A A0A2           00597 HIGHISRS0       BTFSS   IPR2,CCP2IP,A           ; If Timer3 is set to low priority then do not test
00023C EF?? F???      00598                 GOTO    HIGHISRS1               ; if its active
000240 B0A1           00599                 BTFSC   PIR2,CCP2IF,A
000242 EC?? F???      00600                 CALL    TIMER3ISR
                      00601         ; Exit
                      00602 HIGHISRS1       POPREGS                         ;restore specific registers
000246 C??? FFF3          M                 MOVFF   TEMP_PRODL, PRODL
00024A C??? FFF4          M                 MOVFF   TEMP_PRODH, PRODH
00024E 50??               M                 MOVF    TEMP_WREG,W
000250 C??? FFE0          M                 MOVFF   TEMP_BSR,BSR
000254 C??? FFD8          M                 MOVFF   TEMP_ALUSTA,ALUSTA
000258 0010           00603                 retfie                          ;return from interrupt
                      00604                
                      00605 ; Low priority interrupt handeler
00025A                00606 LOWISRS
                      00607                 PUSHREGSLOW                     ;save specific registers
00025A CFD8 F???          M                 MOVFF   ALUSTA,TEMP_ALUSTA_L
00025E CFE8 F???          M                 MOVFF   WREG,TEMP_WREG_L
000262 CFE0 F???          M                 MOVFF   BSR,TEMP_BSR_L
000266 CFF3 F???          M                 MOVFF   PRODL, TEMP_PRODL_L
00026A CFF4 F???          M                 MOVFF   PRODH, TEMP_PRODH_L
                      00608         ; Test if this is a hardware interrupt 1. This is used for the tach and 
                      00609         ; the futaba trainer system
00026E BCF0           00610                 BTFSC   INTCON3,INT1IP,A        ; If INT1 is set to high priority then do not test
000270 EF?? F???      00611                 GOTO    LOWISRS0                ; if its active
000274 B0F0           00612                 BTFSC   INTCON3,INT1IF,A
000276 EC?? F???      00613                 CALL    INT1ISR
                      00614         ; Test if this is a timer3 interrupt
00027A B0A2           00615 LOWISRS0        BTFSC   IPR2,CCP2IP,A           ; If Timer3 is set to high priority then do not test
00027C EF?? F???      00616                 GOTO    LOWISRS1                ; if its active
000280 B0A1           00617                 BTFSC   PIR2,CCP2IF,A
000282 EC?? F???      00618                 CALL    TIMER3ISR
                      00619         ; Test for COMM port interrupts, call service routine if active
000286                00620 LOWISRS1        
                      00621         ; If Timer3 ISR is low priority then don't call the USART functions.
                      00622         ; Read the USARTS and exit.
000286 B0A2           00623                 BTFSC   IPR2,CCP2IP,A
000288 EF?? F???      00624                 GOTO    LOWISR2
00028C CFAE FFE8      00625                 MOVFF   RCREG1,WREG
000290 CF6E FFE8      00626                 MOVFF   RCREG2,WREG
000294 EF?? F???      00627                 GOTO    LOWISR3
                      00628         ; Here to process the USARTS
000298                00629 LOWISR2
000298 BA9E           00630                 BTFSC   PIR1,RC1IF,A
00029A EC?? F???      00631                 CALL    USART1rec
00029E BAA4           00632                 BTFSC   PIR3,RC2IF,A
0002A0 EC?? F???      00633                 CALL    SendStudent
0002A4                00634 LOWISR3
                      00635 ifdef           MicroProStar
                      00636         ; Test for Timer4 interrupt and process
                      00637                 BTFSC   PIR3,TMR4IF
                      00638                 CALL    Timer4ISR
                      00639 endif
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 41


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00640         ; Exit  
                      00641                 POPREGSLOW                      ;restore specific registers
0002A4 C??? FFF3          M                 MOVFF   TEMP_PRODL_L, PRODL
0002A8 C??? FFF4          M                 MOVFF   TEMP_PRODH_L, PRODH
0002AC C??? FFE0          M                 MOVFF   TEMP_BSR_L,BSR
0002B0 C??? FFE8          M                 MOVFF   TEMP_WREG_L,WREG
0002B4 C??? FFD8          M                 MOVFF   TEMP_ALUSTA_L,ALUSTA
0002B8 0010           00642                 retfie                          ;return from interrupt
                      00643 
                      00644 JumpTable1      code    0x0100 + OFFSET
                      00645 ;
                      00646 ; The following section contains Jump tables and Call tables. This tables are used
                      00647 ; to programmatically control return values.
                      00648 ; These tables must not be moved. The tables need to be contained in a 256 byte page.
                      00649 ;
                      00650 
                      00651 ; Calibration options. Called with an offset value in CXreg. This funtion
                      00652 ; will add the offset to the program counter to index into the jump 
                      00653 ; table.
000300                00654 CALoptions
000300 50F9           00655                 MOVF    PCL,W,A         ; Refresh the latch regs
000302 01??           00656                 MOVLB   HIGH CXreg
000304 50??           00657                 MOVF    CXreg,W
000306 26F9           00658                 ADDWF   PCL
000308 EF?? F???      00659                 GOTO    CalSelectAircraft
00030C EF?? F???      00660                 GOTO    CalAircraftName
000310 EF?? F???      00661                 GOTO    CalTimer
000314 EF?? F???      00662                 GOTO    CalSnap
000318 EF?? F???      00663                 GOTO    CalServos
00031C EF?? F???      00664                 GOTO    CalMixers
000320 EF?? F???      00665                 GOTO    CalSwitch
000324 EF?? F???      00666                 GOTO    CalOptions
000328 EF?? F???      00667                 GOTO    CalSystemSetup
00032C EF?? F???      00668                 GOTO    CalSelectFrequency
000330 EF?? F???      00669                 GOTO    CalAdvanced
000334 EF?? F???      00670                 GOTO    CalHelicopter
000338 0012           00671                 RETURN                  ; Exit option, this return is never hit
                      00672                 
                      00673 ; This function will load BXreg with the trim value indexed by WREG.
                      00674 ; WREG              
                      00675 ;       0 = Set to 0, no trim
                      00676 ;       1 = Aileron
                      00677 ;       2 = Elevator
                      00678 ;       3 = Rudder
                      00679 ;       4 = Throttle 
                      00680 ; If the WREG defines a ditital trim then the BXreg reg is unchanged.
00033A                00681 SelectTrim
                      00682         ; Test if any of the 4 MSBs are set, if so exit
00033A B8E8           00683                 BTFSC   WREG,4,A
00033C 0012           00684                 RETURN
00033E BAE8           00685                 BTFSC   WREG,5,A
000340 0012           00686                 RETURN
000342 BCE8           00687                 BTFSC   WREG,6,A
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 42


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

000344 0012           00688                 RETURN
000346 BEE8           00689                 BTFSC   WREG,7,A
000348 0012           00690                 RETURN
                      00691         ; Here if not a ditital trim            
00034A 0B0F           00692                 ANDLW   0x0F
00034C A4D8           00693                 BTFSS   ALUSTA,Z
00034E EF?? F???      00694                 GOTO    ST1
                      00695                 MOVEC   0,BXreg
000352 01??               M                 MOVLR   HIGH (BXreg)
000354 0E00               M                 MOVLW   LOW (0)
000356 6E??               M                 MOVWF   (BXreg)
000358 0E00               M                 MOVLW   HIGH (0)
00035A 6E??               M                 MOVWF   (BXreg+1)
00035C 0012           00696                 RETURN
00035E                00697 ST1              
                      00698         ; Build index
00035E 06E8           00699                 DECF    WREG
000360 0B03           00700                 ANDLW   3
000362 0D0A           00701                 MULLW   D'10'
000364 CFF9 FFE8      00702                 MOVFF   PCL,WREG                ; Refresh the program counter latch
000368 50F3           00703                 MOVFP   PRODL,WREG
00036A 26F9           00704                 ADDWF   PCL
                      00705                 ; Aileron 
                      00706                 MOVE    Atrim,BXreg
00036C C??? F???          M                 MOVFF   Atrim,BXreg
000370 C??? F???          M                 MOVFF   (Atrim+1),(BXreg+1)
000374 0012           00707                 RETURN
                      00708                 ; Elevator
                      00709                 MOVE    Etrim,BXreg
000376 C??? F???          M                 MOVFF   Etrim,BXreg
00037A C??? F???          M                 MOVFF   (Etrim+1),(BXreg+1)
00037E 0012           00710                 RETURN
                      00711                 ; Rudder
                      00712                 MOVE    Rtrim,BXreg
000380 C??? F???          M                 MOVFF   Rtrim,BXreg
000384 C??? F???          M                 MOVFF   (Rtrim+1),(BXreg+1)
000388 0012           00713                 RETURN
                      00714                 ; Throttle
                      00715                 MOVE    Ttrim,BXreg
00038A C??? F???          M                 MOVFF   Ttrim,BXreg
00038E C??? F???          M                 MOVFF   (Ttrim+1),(BXreg+1)
000392 0012           00716                 RETURN   
                      00717 
                      00718 JumpTable2      code    0x0200 + OFFSET
                      00719                       
                      00720 ; This function returns the selected channel. WREG is the index into
                      00721 ; the ChannelOrder table. The indexed value is moved into NextTime. 
                      00722 ; Reg INDF0 contains the index value                     
000400                00723 SelectOutputChannel
                      00724         ; Build index
000400 CFEF FFE8      00725                 MOVFF   INDF0,WREG
000404 06E8           00726                 DECF    WREG
000406 0B07           00727                 ANDLW   7
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 43


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

000408 0D0A           00728                 MULLW   D'10'
00040A CFF9 FFE8      00729                 MOVFF   PCL,WREG                ; Refresh the program counter latch
00040E 50F3           00730                 MOVF    PRODL,W,A
000410 26F9           00731                 ADDWF   PCL     
                      00732 
                      00733                ; Aileron
                      00734                 MOVE16  chAIL,NextTime
000412 C??? F???          M                 MOVFF   chAIL,NextTime
000416 C??? F???          M                 MOVFF   (chAIL+1),(NextTime+1)
00041A 0012           00735                 RETURN
                      00736                 ; Elevator
                      00737                 MOVE16  chELE,NextTime
00041C C??? F???          M                 MOVFF   chELE,NextTime
000420 C??? F???          M                 MOVFF   (chELE+1),(NextTime+1)
000424 0012           00738                 RETURN
                      00739                 ; Rudder
                      00740                 MOVE16  chRUD,NextTime
000426 C??? F???          M                 MOVFF   chRUD,NextTime
00042A C??? F???          M                 MOVFF   (chRUD+1),(NextTime+1)
00042E 0012           00741                 RETURN
                      00742                 ; Throttle
                      00743                 MOVE16  chTHT,NextTime
000430 C??? F???          M                 MOVFF   chTHT,NextTime
000434 C??? F???          M                 MOVFF   (chTHT+1),(NextTime+1)
000438 0012           00744                 RETURN
                      00745                 ; CH5
                      00746                 MOVE16  chCH5,NextTime
00043A C??? F???          M                 MOVFF   chCH5,NextTime
00043E C??? F???          M                 MOVFF   (chCH5+1),(NextTime+1)
000442 0012           00747                 RETURN
                      00748                 ; CH6
                      00749                 MOVE16  chCH6,NextTime
000444 C??? F???          M                 MOVFF   chCH6,NextTime
000448 C??? F???          M                 MOVFF   (chCH6+1),(NextTime+1)
00044C 0012           00750                 RETURN
                      00751                 ; CH7
                      00752                 MOVE16  chCH7,NextTime
00044E C??? F???          M                 MOVFF   chCH7,NextTime
000452 C??? F???          M                 MOVFF   (chCH7+1),(NextTime+1)
000456 0012           00753                 RETURN
                      00754                 ; CH8
                      00755                 MOVE16  chCH8,NextTime
000458 C??? F???          M                 MOVFF   chCH8,NextTime
00045C C??? F???          M                 MOVFF   (chCH8+1),(NextTime+1)
000460 0012           00756                 RETURN
                      00757                 
                      00758 ; This function will load the ADC mux byte from the ADCaddTbl table located
                      00759 ; in the general data area, page 2.
                      00760 ; On call WREG contains the ADC channel request and on return the data is in 
                      00761 ; WREG.
000462                00762 ADClookup
                      00763    ; Compute the jump location
000462 0B0F           00764                 ANDLW   0F
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 44


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

000464 0D06           00765                 MULLW   6
000466 CFF9 FFE8      00766                 MOVFF   PCL,WREG                ; Refresh the program counter latch
00046A 50F3           00767                 MOVF    PRODL,W,A
00046C 26F9           00768                 ADDWF   PCL     
                      00769 
00046E C??? FFE8      00770                 MOVFF   ADCaddTbl, WREG
000472 0012           00771                 RETURN
000474 C??? FFE8      00772                 MOVFF   ADCaddTbl+1, WREG
000478 0012           00773                 RETURN
00047A C??? FFE8      00774                 MOVFF   ADCaddTbl+2, WREG
00047E 0012           00775                 RETURN
000480 C??? FFE8      00776                 MOVFF   ADCaddTbl+3, WREG
000484 0012           00777                 RETURN
000486 C??? FFE8      00778                 MOVFF   ADCaddTbl+4, WREG
00048A 0012           00779                 RETURN
00048C C??? FFE8      00780                 MOVFF   ADCaddTbl+5, WREG
000490 0012           00781                 RETURN
000492 C??? FFE8      00782                 MOVFF   ADCaddTbl+6, WREG
000496 0012           00783                 RETURN
000498 C??? FFE8      00784                 MOVFF   ADCaddTbl+7, WREG
00049C 0012           00785                 RETURN
00049E C??? FFE8      00786                 MOVFF   ADCaddTbl+8, WREG
0004A2 0012           00787                 RETURN
0004A4 C??? FFE8      00788                 MOVFF   ADCaddTbl+9, WREG
0004A8 0012           00789                 RETURN
0004AA C??? FFE8      00790                 MOVFF   ADCaddTbl+0A, WREG
0004AE 0012           00791                 RETURN
0004B0 C??? FFE8      00792                 MOVFF   ADCaddTbl+0B, WREG
0004B4 0012           00793                 RETURN
0004B6 C??? FFE8      00794                 MOVFF   ADCaddTbl+0C, WREG
0004BA 0012           00795                 RETURN
0004BC C??? FFE8      00796                 MOVFF   ADCaddTbl+0D, WREG
0004C0 0012           00797                 RETURN
0004C2 C??? FFE8      00798                 MOVFF   ADCaddTbl+0E, WREG
0004C6 0012           00799                 RETURN
0004C8 C??? FFE8      00800                 MOVFF   ADCaddTbl+0F, WREG
0004CC 0012           00801                 RETURN
                      00802 
                      00803 JumpTable3      code    0x0300 + OFFSET
                      00804 
                      00805 ; This function will return the channel number in reg AXreg. The
                      00806 ; channel number must be in WREG the channels are numbered 1 to 8.
                      00807 ; The position data is read from the mixed position array.
000500                00808 GetFrom
000500 01??           00809                 MOVLB   HIGH AposM
000502 06E8           00810                 DECF    WREG
000504 0B07           00811                 ANDLW   7
000506 0D0A           00812                 MULLW   D'10'
000508 CFF9 FFE8      00813                 MOVFF   PCL,WREG                ; Refresh the program counter latch
00050C 50F3           00814                 MOVF    PRODL,W,A
00050E 26F9           00815                 ADDWF   PCL     
                      00816         ; Channel 1
000510 50??           00817                 MOVF    AposM,W
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 45


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

000512 6E??           00818                 MOVWF   AXreg
000514 50??           00819                 MOVF    AposM+1,W
000516 6E??           00820                 MOVWF   AXreg+1
000518 0012           00821                 RETURN
                      00822         ; Channel 2
00051A 50??           00823                 MOVF    EposM,W
00051C 6E??           00824                 MOVWF   AXreg
00051E 50??           00825                 MOVF    EposM+1,W
000520 6E??           00826                 MOVWF   AXreg+1
000522 0012           00827                 RETURN
                      00828         ; Channel 3
000524 50??           00829                 MOVF    RposM,W
000526 6E??           00830                 MOVWF   AXreg
000528 50??           00831                 MOVF    RposM+1,W
00052A 6E??           00832                 MOVWF   AXreg+1
00052C 0012           00833                 RETURN
                      00834         ; Channel 4
00052E 50??           00835                 MOVF    TposM,W
000530 6E??           00836                 MOVWF   AXreg
000532 50??           00837                 MOVF    TposM+1,W
000534 6E??           00838                 MOVWF   AXreg+1
000536 0012           00839                 RETURN
                      00840         ; Channel 5
000538 50??           00841                 MOVF    CH5posM,W
00053A 6E??           00842                 MOVWF   AXreg
00053C 50??           00843                 MOVF    CH5posM+1,W
00053E 6E??           00844                 MOVWF   AXreg+1
000540 0012           00845                 RETURN
                      00846         ; Channel 6
000542 50??           00847                 MOVF    CH6posM,W
000544 6E??           00848                 MOVWF   AXreg
000546 50??           00849                 MOVF    CH6posM+1,W
000548 6E??           00850                 MOVWF   AXreg+1
00054A 0012           00851                 RETURN
                      00852         ; Channel 7
00054C 50??           00853                 MOVF    CH7posM,W
00054E 6E??           00854                 MOVWF   AXreg
000550 50??           00855                 MOVF    CH7posM+1,W
000552 6E??           00856                 MOVWF   AXreg+1
000554 0012           00857                 RETURN
                      00858         ; Channel 8
000556 50??           00859                 MOVF    CH8posM,W
000558 6E??           00860                 MOVWF   AXreg
00055A 50??           00861                 MOVF    CH8posM+1,W
00055C 6E??           00862                 MOVWF   AXreg+1
00055E 0012           00863                 RETURN
                      00864 
                      00865 JumpTable4      code    0x0400 + OFFSET
                      00866 
                      00867 ; This function will sum the value in AXreg with the channel number defined
                      00868 ; in the WREG. This sum is performed on the position variable array. If the
                      00869 ; MSB is set then the value is AXreg replaces the old position value, if the
                      00870 ; MSB is clear then AXreg is added to the position value
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 46


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

000600                00871 ApplyMix
000600 01??           00872                 MOVLB   HIGH Apos
000602 BEE8           00873                 BTFSC   WREG,7
000604 EF?? F???      00874                 GOTO    ApplyMixReplace
000608 06E8           00875                 DECF    WREG
00060A 0B07           00876                 ANDLW   7
00060C 0D0A           00877                 MULLW   D'10'
00060E CFF9 FFE8      00878                 MOVFF   PCL,WREG                ; Refresh the program counter latch
000612 50F3           00879                 MOVF    PRODL,W,A
000614 26F9           00880                 ADDWF   PCL     
                      00881         ; Channel 1
000616 50??           00882                 MOVF    AXreg,W
000618 26??           00883                 ADDWF   Apos,F
00061A 50??           00884                 MOVF    AXreg+1,W
00061C 22??           00885                 ADDWFC  Apos+1,F
00061E 0012           00886                 RETURN
                      00887         ; Channel 2
000620 50??           00888                 MOVF    AXreg,W
000622 26??           00889                 ADDWF   Epos,F
000624 50??           00890                 MOVF    AXreg+1,W
000626 22??           00891                 ADDWFC  Epos+1,F
000628 0012           00892                 RETURN
                      00893         ; Channel 3
00062A 50??           00894                 MOVF    AXreg,W
00062C 26??           00895                 ADDWF   Rpos,F
00062E 50??           00896                 MOVF    AXreg+1,W
000630 22??           00897                 ADDWFC  Rpos+1,F
000632 0012           00898                 RETURN
                      00899         ; Channel 4
000634 50??           00900                 MOVF    AXreg,W
000636 26??           00901                 ADDWF   Tpos,F
000638 50??           00902                 MOVF    AXreg+1,W
00063A 22??           00903                 ADDWFC  Tpos+1,F
00063C 0012           00904                 RETURN
                      00905         ; Channel 5
00063E 50??           00906                 MOVF    AXreg,W
000640 26??           00907                 ADDWF   CH5pos,F
000642 50??           00908                 MOVF    AXreg+1,W
000644 22??           00909                 ADDWFC  CH5pos+1,F
000646 0012           00910                 RETURN
                      00911         ; Channel 6
000648 50??           00912                 MOVF    AXreg,W
00064A 26??           00913                 ADDWF   CH6pos,F
00064C 50??           00914                 MOVF    AXreg+1,W
00064E 22??           00915                 ADDWFC  CH6pos+1,F
000650 0012           00916                 RETURN
                      00917         ; Channel 7
000652 50??           00918                 MOVF    AXreg,W
000654 26??           00919                 ADDWF   CH7pos,F
000656 50??           00920                 MOVF    AXreg+1,W
000658 22??           00921                 ADDWFC  CH7pos+1,F
00065A 0012           00922                 RETURN
                      00923         ; Channel 8
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 47


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

00065C 50??           00924                 MOVF    AXreg,W
00065E 26??           00925                 ADDWF   CH8pos,F
000660 50??           00926                 MOVF    AXreg+1,W
000662 22??           00927                 ADDWFC  CH8pos+1,F
000664 0012           00928                 RETURN
000666                00929 ApplyMixReplace
000666 06E8           00930                 DECF    WREG
000668 0B07           00931                 ANDLW   7
00066A 0D0A           00932                 MULLW   D'10'
00066C CFF9 FFE8      00933                 MOVFF   PCL,WREG                ; Refresh the program counter latch
000670 50F3           00934                 MOVF    PRODL,W,A
000672 26F9           00935                 ADDWF   PCL     
                      00936         ; Channel 1
000674 50??           00937                 MOVF    AXreg,W
000676 6E??           00938                 MOVWF   Apos
000678 50??           00939                 MOVF    AXreg+1,W
00067A 6E??           00940                 MOVWF   Apos+1
00067C 0012           00941                 RETURN
                      00942         ; Channel 2
00067E 50??           00943                 MOVF    AXreg,W
000680 6E??           00944                 MOVWF   Epos
000682 50??           00945                 MOVF    AXreg+1,W
000684 6E??           00946                 MOVWF   Epos+1
000686 0012           00947                 RETURN
                      00948         ; Channel 3
000688 50??           00949                 MOVF    AXreg,W
00068A 6E??           00950                 MOVWF   Rpos
00068C 50??           00951                 MOVF    AXreg+1,W
00068E 6E??           00952                 MOVWF   Rpos+1
000690 0012           00953                 RETURN
                      00954         ; Channel 4
000692 50??           00955                 MOVF    AXreg,W
000694 6E??           00956                 MOVWF   Tpos
000696 50??           00957                 MOVF    AXreg+1,W
000698 6E??           00958                 MOVWF   Tpos+1
00069A 0012           00959                 RETURN
                      00960         ; Channel 5
00069C 50??           00961                 MOVF    AXreg,W
00069E 6E??           00962                 MOVWF   CH5pos
0006A0 50??           00963                 MOVF    AXreg+1,W
0006A2 6E??           00964                 MOVWF   CH5pos+1
0006A4 0012           00965                 RETURN
                      00966         ; Channel 6
0006A6 50??           00967                 MOVF    AXreg,W
0006A8 6E??           00968                 MOVWF   CH6pos
0006AA 50??           00969                 MOVF    AXreg+1,W
0006AC 6E??           00970                 MOVWF   CH6pos+1
0006AE 0012           00971                 RETURN
                      00972         ; Channel 7
0006B0 50??           00973                 MOVF    AXreg,W
0006B2 6E??           00974                 MOVWF   CH7pos
0006B4 50??           00975                 MOVF    AXreg+1,W
0006B6 6E??           00976                 MOVWF   CH7pos+1
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 48


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

0006B8 0012           00977                 RETURN
                      00978         ; Channel 8
0006BA 50??           00979                 MOVF    AXreg,W
0006BC 6E??           00980                 MOVWF   CH8pos
0006BE 50??           00981                 MOVF    AXreg+1,W
0006C0 6E??           00982                 MOVWF   CH8pos+1
0006C2 0012           00983                 RETURN
                      00984                 
                      00985                 code
                      00986         
                      00987 ; This function will return after the PPM transmission has just completed.
                      00988 ; If the interrupts are not enabled this function will return without
                      00989 ; any delay.
000000                00990 SyncUp
                      00991    ; Test interrupts and return if disabled
000000 AEF2           00992                 BTFSS   INTCON,GIE
000002 0012           00993                 RETURN
                      00994    ; Set time out counter 3 to 1 and wait for it to reach 0
000004 01??           00995                 MOVLB   HIGH TimeOut3
000006 0E01           00996                 MOVLW   1
000008 6E??           00997                 MOVWF   TimeOut3
00000A                00998 SyncUp1                              
00000A 66??           00999                 TSTFSZ  TimeOut3
00000C EF?? F???      01000                 GOTO    SyncUp1
000010 0012           01001                 RETURN
                      01002                 
                      01003 ;************************************************************************
                      01004 ;************************************************************************
                      01005 ;                      ***** MAIN PROGRAM  *****
                      01006 ;************************************************************************
                      01007 ;************************************************************************
000012                01008 start
                      01009         ; Read EEPROM page to RAM page 5
000012 EC?? F???      01010                 CALL    EEPROMread
                      01011         ; kill the buzzer
000016 8892           01012                 BSF     DDRA,BUZZER,A           ; Set control pin as input to disable
                      01013                                                 ; Init the port after config is loaded
000018 C??? FFE8      01014                 MOVFF   Adapter,WREG
00001C 1EE8           01015                 COMF    WREG
00001E 66E8           01016                 TSTFSZ  WREG
000020 EF?? F???      01017                 GOTO    BuzOK
                      01018                 ; Here for Adapter mode INIT
000024 9892           01019                 BCF     DDRA,BUZZER,A           ; If its an adapter, assume normal buzzer
000026 9880           01020                 BCF     PORTA,BUZZER,A 
000028                01021 BuzOK
                      01022         ;
000028 9C93           01023                 BCF     DDRB,PLLRST,A
00002A 9C81           01024                 BCF     PORTB,PLLRST,A
00002C 01??           01025                 MOVLB   HIGH BeepTicks
00002E 6A??           01026                 CLRF    BeepTicks
000030 6A??           01027                 CLRF    BeepCtr
                      01028         ; Read the PIC type and set the PIC18F8723 flag if the processor is detected
000032 EC?? F???      01029                 CALL    ProcessorType
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 49


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      01030         ; Clear counter mode
000036 01??           01031                 MOVLB   HIGH Cmode
000038 6A??           01032                 CLRF    Cmode   
                      01033         ; 100 mS startup delay to let all systems stabilize
00003A 0E64           01034                 MOVLW   D'100'
00003C EC?? F???      01035                 CALL Delay1mS
                      01036 ifdef           MicroProStar
                      01037                 CALL    MP8Kinit
                      01038 endif
                      01039         ; Place usable data in the TicksPer and cyccleCounts variable, this will
                      01040         ; Allow the system to boot
000040 0E28           01041                 MOVLW   D'40'
000042 CFE8 F???      01042                 MOVFF   WREG,TicksPer
                      01043                 MOVEC   D'50000',CycleCounts
000046 01??               M                 MOVLR   HIGH (CycleCounts)
000048 0E50               M                 MOVLW   LOW (D'50000')
00004A 6E??               M                 MOVWF   (CycleCounts)
00004C 0EC3               M                 MOVLW   HIGH (D'50000')
00004E 6E??               M                 MOVWF   (CycleCounts+1)
                      01044         ; Init the port variables
                      01045                 ; Init port D debound variables
                      01046 ifdef           MicroProStar
                      01047                 CALL    MP8KreadD
                      01048 else
000050 CF83 FFE8      01049                 MOVFF   PORTD,WREG
                      01050 endif
000054 01??           01051                 MOVLR   HIGH PORTDimage
000056 6E??           01052                 MOVWF   PORTDimage
000058 6E??           01053                 MOVWF   PORTDlast
00005A 6E??           01054                 MOVWF   PORTDlatch
00005C 1EE8           01055                 COMF    WREG
00005E 6E??           01056                 MOVWF   PORTDlatchLow
                      01057                 ; Init port D debound variables
                      01058 ifdef           MicroProStar
                      01059                 CALL    MP8KreadE
                      01060 else
000060 CF84 FFE8      01061                 MOVFF   PORTE,WREG
                      01062                 
000064 94E8           01063                 BCF     WREG,OPTION
000066 B484           01064                 BTFSC   OPTION_BUTTON
000068 84E8           01065                 BSF     WREG,OPTION
                      01066 endif
00006A 01??           01067                 MOVLR   HIGH PORTEimage
00006C 6E??           01068                 MOVWF   PORTEimage
00006E 6E??           01069                 MOVWF   PORTElast
000070 6E??           01070                 MOVWF   PORTElatch
000072 1EE8           01071                 COMF    WREG
000074 6E??           01072                 MOVWF   PORTElatchLow
                      01073 
000076 010F           01074                 MOVLB   HIGH PORTH
000078 9099           01075                 BCF     DDRH,AUXOUT
00007A 8087           01076                 BSF     PORTH,AUXOUT            ; by default output the ppm pulse train
                      01077 ifndef          MicroProStar
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 50


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

00007C 9694           01078                 BCF     DDRC,LED1  
00007E 9493           01079                 BCF     DDRB,LED2  
000080 9682           01080                 BCF     PORTC,LED1  
000082 9481           01081                 BCF     PORTB,LED2
                      01082 endif
                      01083         ; Init math variables
                      01084                 MOVEC32 0,DEXreg
000084 01??               M                 MOVLR   HIGH (DEXreg)
000086 0E00               M                 MOVLW   LOW (0)
000088 6E??               M                 MOVWF   (DEXreg)
00008A 0E00               M                 MOVLW   LOW (0/100)
00008C 6E??               M                 MOVWF   (DEXreg+1)
00008E 0E00               M                 MOVLW   HIGH (0/100)
000090 6E??               M                 MOVWF   (DEXreg+2)
000092 0E00               M                 MOVLW   UPPER (0/100)
000094 6E??               M                 MOVWF   (DEXreg+3)
                      01085                 MOVEC32 0,EEXreg
000096 01??               M                 MOVLR   HIGH (EEXreg)
000098 0E00               M                 MOVLW   LOW (0)
00009A 6E??               M                 MOVWF   (EEXreg)
00009C 0E00               M                 MOVLW   LOW (0/100)
00009E 6E??               M                 MOVWF   (EEXreg+1)
0000A0 0E00               M                 MOVLW   HIGH (0/100)
0000A2 6E??               M                 MOVWF   (EEXreg+2)
0000A4 0E00               M                 MOVLW   UPPER (0/100)
0000A6 6E??               M                 MOVWF   (EEXreg+3)
                      01086                 MOVEC32 0,CEXreg
0000A8 01??               M                 MOVLR   HIGH (CEXreg)
0000AA 0E00               M                 MOVLW   LOW (0)
0000AC 6E??               M                 MOVWF   (CEXreg)
0000AE 0E00               M                 MOVLW   LOW (0/100)
0000B0 6E??               M                 MOVWF   (CEXreg+1)
0000B2 0E00               M                 MOVLW   HIGH (0/100)
0000B4 6E??               M                 MOVWF   (CEXreg+2)
0000B6 0E00               M                 MOVLW   UPPER (0/100)
0000B8 6E??               M                 MOVWF   (CEXreg+3)
                      01087         ; Init misc variables
                      01088                 MOVEC   0,MApos
0000BA 01??               M                 MOVLR   HIGH (MApos)
0000BC 0E00               M                 MOVLW   LOW (0)
0000BE 6E??               M                 MOVWF   (MApos)
0000C0 0E00               M                 MOVLW   HIGH (0)
0000C2 6E??               M                 MOVWF   (MApos+1)
                      01089                 MOVEC   0,MEpos
0000C4 01??               M                 MOVLR   HIGH (MEpos)
0000C6 0E00               M                 MOVLW   LOW (0)
0000C8 6E??               M                 MOVWF   (MEpos)
0000CA 0E00               M                 MOVLW   HIGH (0)
0000CC 6E??               M                 MOVWF   (MEpos+1)
                      01090                 MOVEC   0,MRpos
0000CE 01??               M                 MOVLR   HIGH (MRpos)
0000D0 0E00               M                 MOVLW   LOW (0)
0000D2 6E??               M                 MOVWF   (MRpos)
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 51


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

0000D4 0E00               M                 MOVLW   HIGH (0)
0000D6 6E??               M                 MOVWF   (MRpos+1)
                      01091                 MOVEC   0,MTpos
0000D8 01??               M                 MOVLR   HIGH (MTpos)
0000DA 0E00               M                 MOVLW   LOW (0)
0000DC 6E??               M                 MOVWF   (MTpos)
0000DE 0E00               M                 MOVLW   HIGH (0)
0000E0 6E??               M                 MOVWF   (MTpos+1)
                      01092                 MOVEC   0,MonFlag
0000E2 01??               M                 MOVLR   HIGH (MonFlag)
0000E4 0E00               M                 MOVLW   LOW (0)
0000E6 6E??               M                 MOVWF   (MonFlag)
0000E8 0E00               M                 MOVLW   HIGH (0)
0000EA 6E??               M                 MOVWF   (MonFlag+1)
                      01093                 MOVEC   0F,ADCfixThres
0000EC 01??               M                 MOVLR   HIGH (ADCfixThres)
0000EE 0E0F               M                 MOVLW   LOW (0F)
0000F0 6E??               M                 MOVWF   (ADCfixThres)
0000F2 0E00               M                 MOVLW   HIGH (0F)
0000F4 6E??               M                 MOVWF   (ADCfixThres+1)
0000F6 01??           01094                 MOVLB   HIGH TimeOut
0000F8 6A??           01095                 CLRF    TimeOut
0000FA 6A??           01096                 CLRF    TimeOut1
0000FC 6A??           01097                 CLRF    TimeOut2
0000FE 6A??           01098                 CLRF    TimeOut3
000100 6A??           01099                 CLRF    TimeOut4
000102 6A??           01100                 CLRF    TimeOut5   
000104 68??           01101                 SETF    TimerCount
000106 6A??           01102                 CLRF    FMSflag
000108 6A??           01103                 CLRF    FMSflagU1
00010A 6A??           01104                 CLRF    GyroTune
00010C 6A??           01105                 CLRF    TholdState
00010E 6AE8           01106                 CLRF    WREG
000110 CFE8 F???      01107                 MOVFF   WREG,DisplayLine
000114 CFE8 F???      01108                 MOVFF   WREG,TTflag
000118 CFE8 F???      01109                 MOVFF   WREG,LValarm
00011C CFE8 F???      01110                 MOVFF   WREG,AUXMODE
000120 CFE8 F???      01111                 MOVFF   WREG,ActiveDisplayLine
000124 CFE8 F???      01112                 MOVFF   WREG,CalServoUpdate
                      01113         ; Init the version variable
000128 0E??           01114                 MOVLW   UPPER (MES2+D'10')              ; Load pointer the the version number
00012A 6EF8           01115                 MOVWF   TBLPTRU,A
00012C 0E??           01116                 MOVLW   HIGH (MES2+D'10')
00012E 6EF7           01117                 MOVWF   TBLPTRH,A
000130 0E??           01118                 MOVLW   LOW (MES2+D'10')
000132 6EF6           01119                 MOVWF   TBLPTRL,A
                      01120                 ; Read the version number into RAM
000134 0009           01121                 TBLRD*+
000136 CFF5 F???      01122                 MOVFF   TABLAT,Version
00013A 0009           01123                 TBLRD*+
00013C 0009           01124                 TBLRD*+
00013E CFF5 F???      01125                 MOVFF   TABLAT,Version+1
000142 0009           01126                 TBLRD*+
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 52


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

000144 CFF5 F???      01127                 MOVFF   TABLAT,Version+2
                      01128         ; Load the defaults
000148 EC?? F???      01129                 CALL    LoadDefaults
                      01130                 ; Set DefaultAircraft equal to Aircraft
00014C 01??           01131                 MOVLB   HIGH Aircraft
00014E 50??           01132                 MOVF    Aircraft,W
000150 01??           01133                 MOVLB   HIGH DefaultAircraft
000152 6E??           01134                 MOVWF   DefaultAircraft
                      01135         ; Read the stick center positions
000154 0E04           01136                 MOVLW   ADCail
000156 EC?? F???      01137                 CALL    ADCread
00015A 0E04           01138                 MOVLW   ADCail
00015C EC?? F???      01139                 CALL    ADCread
000160 01??           01140                 MOVLB   HIGH AilCenter
000162 50C3           01141                 MOVF    ADRESL,W,A
000164 6E??           01142                 MOVWF   AilCenter
000166 50C4           01143                 MOVF    ADRESH,W,A
000168 6E??           01144                 MOVWF   AilCenter+1
00016A 0E05           01145                 MOVLW   ADCele
00016C EC?? F???      01146                 CALL    ADCread
000170 0E05           01147                 MOVLW   ADCele
000172 EC?? F???      01148                 CALL    ADCread
000176 01??           01149                 MOVLB   HIGH EleCenter
000178 50C3           01150                 MOVF    ADRESL,W,A
00017A 6E??           01151                 MOVWF   EleCenter
00017C 50C4           01152                 MOVF    ADRESH,W,A
00017E 6E??           01153                 MOVWF   EleCenter+1
                      01154         ; Initalize the Transmitter  battery voltage filter
000180 0E03           01155                 MOVLW   ADCref
000182 EC?? F???      01156                 CALL    ADCread
                      01157                 ; Save data in Vbat256
000186 C??? F???      01158                 MOVFF   Pos,Vbat256+1
00018A C??? F???      01159                 MOVFF   Pos+1,Vbat256+2
                      01160         ; Signon message
00018E EC?? F???      01161                 CALL    LCDinit
000192 0EFA           01162                 MOVLW   D'250'
000194 EC?? F???      01163                 CALL    Delay1mS
000198 0EFA           01164                 MOVLW   D'250'
00019A EC?? F???      01165                 CALL    Delay1mS
                      01166                 ShowLine2
00019E 0EFA           01167                 MOVLW   D'250'
0001A0 EC?? F???      01168                 CALL    Delay1mS
0001A4 0EFA           01169                 MOVLW   D'250'
0001A6 EC?? F???      01170                 CALL    Delay1mS
                      01171         ; Perform initializations...
0001AA EC?? F???      01172                 CALL    Timer3Init
0001AE EC?? F???      01173                 CALL    TachInit
0001B2 EC?? F???      01174                 CALL    USART1init
0001B6 EC?? F???      01175                 CALL    USART2init
0001BA EC?? F???      01176                 CALL    DigitalTrimInit
                      01177         ; Enable global interrups...
0001BE 8EF2           01178                 BSF     INTCON,GIE
0001C0 8CF2           01179                 BSF     INTCON,PEIE
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 53


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

0001C2 8ED0           01180                 BSF     RCON,IPEN
                      01181         ; Read the Flash general data into bank 2
                      01182                 ; If the PRESET and the AUTOTRIM button are pressed, then bypass...
                      01183                 Pressed PORTD,PRESET
                          M                 State   PORTD,PRESET
0001C4 010F               M                 MOVLB   HIGH PORTD
0001C6 90D8               M                 BCF     ALUSTA,C
0001C8 B683               M                 BTFSC   PORTD,PRESET
0001CA 80D8               M                 BSF     ALUSTA,C
0001CC B0D8               M                 BTFSC   ALUSTA,C
0001CE EF?? F???          M                 GOTO    $ + D'14'
0001D2 0E0A               M                 MOVLW   D'10'
0001D4 EC?? F???          M                 CALL    Delay1mS
                          M                 State   PORTD,PRESET
0001D8 010F               M                 MOVLB   HIGH PORTD
0001DA 90D8               M                 BCF     ALUSTA,C
0001DC B683               M                 BTFSC   PORTD,PRESET
0001DE 80D8               M                 BSF     ALUSTA,C
0001E0 B0D8           01184                 BTFSC   ALUSTA,C
0001E2 EF?? F???      01185                 GOTO    UseGeneral
                      01186                 Pressed PORTE,AUTOT
                          M                 State   PORTE,AUTOT
0001E6 010F               M                 MOVLB   HIGH PORTE
0001E8 90D8               M                 BCF     ALUSTA,C
0001EA B284               M                 BTFSC   PORTE,AUTOT
0001EC 80D8               M                 BSF     ALUSTA,C
0001EE B0D8               M                 BTFSC   ALUSTA,C
0001F0 EF?? F???          M                 GOTO    $ + D'14'
0001F4 0E0A               M                 MOVLW   D'10'
0001F6 EC?? F???          M                 CALL    Delay1mS
                          M                 State   PORTE,AUTOT
0001FA 010F               M                 MOVLB   HIGH PORTE
0001FC 90D8               M                 BCF     ALUSTA,C
0001FE B284               M                 BTFSC   PORTE,AUTOT
000200 80D8               M                 BSF     ALUSTA,C
000202 B0D8           01187                 BTFSC   ALUSTA,C
000204 EF?? F???      01188                 GOTO    UseGeneral
                      01189         ; Make sure the AUTOTRIM button is released before
                      01190         ; we continue...
                      01191                 Release PORTE,AUTOT             
                          M                 State   PORTE,AUTOT
000208 010F               M                 MOVLB   HIGH PORTE
00020A 90D8               M                 BCF     ALUSTA,C
00020C B284               M                 BTFSC   PORTE,AUTOT
00020E 80D8               M                 BSF     ALUSTA,C
000210 A0D8               M                 BTFSS   ALUSTA,C
000212 EF?? F???          M                 GOTO    $ - D'10'
000216 0E0A               M                 MOVLW   D'10'
000218 EC?? F???          M                 CALL    Delay1mS
                          M                 State   PORTE,AUTOT
00021C 010F               M                 MOVLB   HIGH PORTE
00021E 90D8               M                 BCF     ALUSTA,C
000220 B284               M                 BTFSC   PORTE,AUTOT
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 54


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

000222 80D8               M                 BSF     ALUSTA,C
000224 A0D8               M                 BTFSS   ALUSTA,C
000226 EF?? F???          M                 GOTO    $ - D'30'
00022A EF?? F???      01192                 GOTO    UseDefaults
                      01193                 ; Read the gereral aircraft data...
00022E                01194 UseGeneral
00022E EC?? F???      01195                 CALL    LoadGeneral
                      01196                 ; Test the Signature, if its not valid call FormatFlash
000232 01??           01197                 MOVLB   HIGH Signature
000234 0EA5           01198                 MOVLW   0A5
000236 62??           01199                 CPFSEQ  Signature
000238 EF?? F???      01200                 GOTO    FormatIt
00023C 0EE7           01201                 MOVLW   0E7
00023E 62??           01202                 CPFSEQ  Signature+1
000240 EF?? F???      01203                 GOTO    FormatIt
000244 EF?? F???      01204                 GOTO    FormatOK
000248                01205 FormatIt
                      01206 ifdef           MicroProStar
                      01207                 BSF     PORTA,BUZZER,A 
                      01208 endif
000248 EC?? F???      01209                 CALL    LoadDefaults
00024C EC?? F???      01210                 CALL    FormatFlash
000250                01211 FormatOK
                      01212                 ; Read this aircraft...into bank 3
000250 C??? FFE8      01213                 MOVFF   Aircraft,WREG
000254 EC?? F???      01214                 CALL    LoadAircraft
                      01215                 ; Move ModelChannel to SelFreq
000258 01??           01216                 MOVLB   HIGH ModelChannel
00025A 50??           01217                 MOVF    ModelChannel,W
00025C 01??           01218                 MOVLB   HIGH SelFreq
00025E 6E??           01219                 MOVWF   SelFreq
                      01220         ; Init the PLL and turn the RF off
                      01221 ifndef          MicroProStar
000260 EC?? F???      01222                 CALL    PLLinit    
000264 EC?? F???      01223                 CALL    PLLCalNreg
                      01224                 ; Set the LSB of Freg to F2 to turn off the RF
000268 01??           01225                 MOVLB   HIGH Freg
00026A 0EF2           01226                 MOVLW   0F2
00026C 6E??           01227                 MOVWF   Freg
00026E EC?? F???      01228                 CALL    PLLsetup
                      01229 endif
000272                01230 UseDefaults
                      01231         ; Init the buzzer and turn it off
000272 9880           01232                 BCF     PORTA,BUZZER,A 
000274 C??? FFE8      01233                 MOVFF   Adapter,WREG
000278 66E8           01234                 TSTFSZ  WREG
00027A 7880           01235                 BTG     PORTA,BUZZER,A
00027C C??? FFE8      01236                 MOVFF   BuzPol,WREG
000280 66E8           01237                 TSTFSZ  WREG
000282 EF?? F???      01238                 GOTO    BuzInited
000286 8880           01239                 BSF     PORTA,BUZZER,A 
000288 C??? FFE8      01240                 MOVFF   Adapter,WREG
00028C 66E8           01241                 TSTFSZ  WREG
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 55


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

00028E 7880           01242                 BTG     PORTA,BUZZER,A
000290                01243 BuzInited:
000290 9892           01244                 BCF     DDRA,BUZZER,A           ; Set control pin as ouput      
                      01245         ; Set the DOG display contrast
000292 EC?? F???      01246                 CALL    SetDOGcontrast
                      01247         ; Calculate the TicksPer and cyccleCounts values, this will
                      01248         ; Allow the system to boot
000296 0E1E           01249                 MOVLW   UPPER D'2000000'
000298 CFE8 F???      01250                 MOVFF   WREG, CEXreg+2
00029C 0E84           01251                 MOVLW   HIGH D'2000000'
00029E CFE8 F???      01252                 MOVFF   WREG, CEXreg+1
0002A2 0E80           01253                 MOVLW   LOW D'2000000'
0002A4 CFE8 F???      01254                 MOVFF   WREG, CEXreg
0002A8 C??? F???      01255                 MOVFF   TicksPer, DEXreg
0002AC 6AE8           01256                 CLRF    WREG
0002AE CFE8 F???      01257                 MOVFF   WREG,DEXreg+1
0002B2 EC?? F???      01258                 CALL    Divide2416
                      01259                 ; Now add the FrameDefect
0002B6 C??? FFE8      01260                 MOVFF   FrameDefect,WREG
0002BA 01??           01261                 MOVLR   HIGH CEXreg
0002BC 26??           01262                 ADDWF   CEXreg,F
0002BE 6AE8           01263                 CLRF    WREG
0002C0 22??           01264                 ADDWFC  CEXreg+1,F
                      01265                 ; Save the result
                      01266                 MOVE    CEXreg,CycleCounts
0002C2 C??? F???          M                 MOVFF   CEXreg,CycleCounts
0002C6 C??? F???          M                 MOVFF   (CEXreg+1),(CycleCounts+1)
                      01267         ; Reestablish the stick center positions
0002CA 0E04           01268                 MOVLW   ADCail
0002CC EC?? F???      01269                 CALL    ADCread
0002D0 0E04           01270                 MOVLW   ADCail
0002D2 EC?? F???      01271                 CALL    ADCread
0002D6 01??           01272                 MOVLB   HIGH AilCenter
0002D8 50C3           01273                 MOVF    ADRESL,W,A
0002DA 6E??           01274                 MOVWF   AilCenter
0002DC 50C4           01275                 MOVF    ADRESH,W,A
0002DE 6E??           01276                 MOVWF   AilCenter+1
0002E0 0E05           01277                 MOVLW   ADCele
0002E2 EC?? F???      01278                 CALL    ADCread
0002E6 0E05           01279                 MOVLW   ADCele
0002E8 EC?? F???      01280                 CALL    ADCread
0002EC 01??           01281                 MOVLB   HIGH EleCenter
0002EE 50C3           01282                 MOVF    ADRESL,W,A
0002F0 6E??           01283                 MOVWF   EleCenter
0002F2 50C4           01284                 MOVF    ADRESH,W,A
0002F4 6E??           01285                 MOVWF   EleCenter+1
                      01286         ; Test if the option button and the preset button are pressed
                      01287         ; If they are both pressed then enter the IO test routine
                      01288                 Pressed OPTION_BUTTON
                          M                 State   PORTE,OPTION
0002F6 010F               M                 MOVLB   HIGH PORTE
0002F8 90D8               M                 BCF     ALUSTA,C
0002FA B484               M                 BTFSC   PORTE,OPTION
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 56


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

0002FC 80D8               M                 BSF     ALUSTA,C
0002FE B0D8               M                 BTFSC   ALUSTA,C
000300 EF?? F???          M                 GOTO    $ + D'14'
000304 0E0A               M                 MOVLW   D'10'
000306 EC?? F???          M                 CALL    Delay1mS
                          M                 State   PORTE,OPTION
00030A 010F               M                 MOVLB   HIGH PORTE
00030C 90D8               M                 BCF     ALUSTA,C
00030E B484               M                 BTFSC   PORTE,OPTION
000310 80D8               M                 BSF     ALUSTA,C
000312 B0D8           01289                 BTFSC   ALUSTA,C
000314 EF?? F???      01290                 GOTO    mainStartup
                      01291                 Pressed PORTD,PRESET
                          M                 State   PORTD,PRESET
000318 010F               M                 MOVLB   HIGH PORTD
00031A 90D8               M                 BCF     ALUSTA,C
00031C B683               M                 BTFSC   PORTD,PRESET
00031E 80D8               M                 BSF     ALUSTA,C
000320 B0D8               M                 BTFSC   ALUSTA,C
000322 EF?? F???          M                 GOTO    $ + D'14'
000326 0E0A               M                 MOVLW   D'10'
000328 EC?? F???          M                 CALL    Delay1mS
                          M                 State   PORTD,PRESET
00032C 010F               M                 MOVLB   HIGH PORTD
00032E 90D8               M                 BCF     ALUSTA,C
000330 B683               M                 BTFSC   PORTD,PRESET
000332 80D8               M                 BSF     ALUSTA,C
000334 A0D8           01292                 BTFSS   ALUSTA,C
000336 EF?? F???      01293                 GOTO    TestIO
00033A                01294 mainStartup
                      01295         ; Clear the displayline variable
00033A 6AE8           01296                 CLRF    WREG
00033C CFE8 F???      01297                 MOVFF   WREG,DisplayLine
                      01298         ; If option button is pressed then set the monitor mode flag
                      01299                 Pressed OPTION_BUTTON
                          M                 State   PORTE,OPTION
000340 010F               M                 MOVLB   HIGH PORTE
000342 90D8               M                 BCF     ALUSTA,C
000344 B484               M                 BTFSC   PORTE,OPTION
000346 80D8               M                 BSF     ALUSTA,C
000348 B0D8               M                 BTFSC   ALUSTA,C
00034A EF?? F???          M                 GOTO    $ + D'14'
00034E 0E0A               M                 MOVLW   D'10'
000350 EC?? F???          M                 CALL    Delay1mS
                          M                 State   PORTE,OPTION
000354 010F               M                 MOVLB   HIGH PORTE
000356 90D8               M                 BCF     ALUSTA,C
000358 B484               M                 BTFSC   PORTE,OPTION
00035A 80D8               M                 BSF     ALUSTA,C
00035C 01??           01300                 MOVLB   HIGH MonFlag
00035E A0D8           01301                 BTFSS   ALUSTA,C
000360 80??           01302                 BSF     MonFlag,0
                      01303         ; If Auto trim button is pressed then set the monitor mode flag
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 57


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      01304                 Pressed PORTE,AUTOT
                          M                 State   PORTE,AUTOT
000362 010F               M                 MOVLB   HIGH PORTE
000364 90D8               M                 BCF     ALUSTA,C
000366 B284               M                 BTFSC   PORTE,AUTOT
000368 80D8               M                 BSF     ALUSTA,C
00036A B0D8               M                 BTFSC   ALUSTA,C
00036C EF?? F???          M                 GOTO    $ + D'14'
000370 0E0A               M                 MOVLW   D'10'
000372 EC?? F???          M                 CALL    Delay1mS
                          M                 State   PORTE,AUTOT
000376 010F               M                 MOVLB   HIGH PORTE
000378 90D8               M                 BCF     ALUSTA,C
00037A B284               M                 BTFSC   PORTE,AUTOT
00037C 80D8               M                 BSF     ALUSTA,C
00037E 01??           01305                 MOVLB   HIGH MonFlag
000380 A0D8           01306                 BTFSS   ALUSTA,C
000382 82??           01307                 BSF     MonFlag,1               
                      01308                 ; If student mode turn off RF
000384 01??           01309                 MOVLB   HIGH Student
000386 C??? F???      01310                 MOVFF   Student,Areg
00038A 01??           01311                 MOVLB   HIGH SelFreq
00038C 0EFF           01312                 MOVLW   0FF
00038E B0??           01313                 BTFSC   Areg,0
000390 6E??           01314                 MOVWF   SelFreq
000392 60??           01315                 CPFSLT  SelFreq
000394 EF?? F???      01316                 GOTO    Startup1
                      01317         ; If Retracks up warning is enabled and the retracts are up,
                      01318         ; issue a warning to the pilot
000398 01??           01319                 MOVLB   HIGH RetractsWarning
00039A A0??           01320                 BTFSS   RetractsWarning,0
00039C EF?? F???      01321                 GOTO    NoRetractWarn
0003A0 010F           01322                 MOVLB   HIGH PORTD
0003A2 BE83           01323                 BTFSC   PORTD,CH5
0003A4 EF?? F???      01324                 GOTO    NoRetractWarn
                      01325                 ; If here warn the pilot before the RF goes on!
0003A8 0E80           01326                 MOVLW   LINE1
0003AA EC?? F???      01327                 CALL    LCDsendCMD
                      01328                 PrintMess MES16
0003AE 0E??               M                 MOVLW   UPPER (MES16)
0003B0 6EF8               M                 MOVWF   TBLPTRU,A
0003B2 0E??               M                 MOVLW   HIGH (MES16)
0003B4 6EF7               M                 MOVWF   TBLPTRH,A
0003B6 0E??               M                 MOVLW   LOW (MES16)
0003B8 6EF6               M                 MOVWF   TBLPTRL,A
0003BA EC?? F???          M                 CALL    LCDsendMess
0003BE 0EC0           01329                 MOVLW   LINE2
0003C0 EC?? F???      01330                 CALL    LCDsendCMD
                      01331                 PrintMess MES8
0003C4 0E??               M                 MOVLW   UPPER (MES8)
0003C6 6EF8               M                 MOVWF   TBLPTRU,A
0003C8 0E??               M                 MOVLW   HIGH (MES8)
0003CA 6EF7               M                 MOVWF   TBLPTRH,A
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 58


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

0003CC 0E??               M                 MOVLW   LOW (MES8)
0003CE 6EF6               M                 MOVWF   TBLPTRL,A
0003D0 EC?? F???          M                 CALL    LCDsendMess
0003D4                01332 NRWwfo
                      01333                 Pressed OPTION_BUTTON
                          M                 State   PORTE,OPTION
0003D4 010F               M                 MOVLB   HIGH PORTE
0003D6 90D8               M                 BCF     ALUSTA,C
0003D8 B484               M                 BTFSC   PORTE,OPTION
0003DA 80D8               M                 BSF     ALUSTA,C
0003DC B0D8               M                 BTFSC   ALUSTA,C
0003DE EF?? F???          M                 GOTO    $ + D'14'
0003E2 0E0A               M                 MOVLW   D'10'
0003E4 EC?? F???          M                 CALL    Delay1mS
                          M                 State   PORTE,OPTION
0003E8 010F               M                 MOVLB   HIGH PORTE
0003EA 90D8               M                 BCF     ALUSTA,C
0003EC B484               M                 BTFSC   PORTE,OPTION
0003EE 80D8               M                 BSF     ALUSTA,C
0003F0 B0D8           01334                 BTFSC   ALUSTA,C
0003F2 EF?? F???      01335                 GOTO    NRWwfo
                      01336                 Release OPTION_BUTTON
                          M                 State   PORTE,OPTION
0003F6 010F               M                 MOVLB   HIGH PORTE
0003F8 90D8               M                 BCF     ALUSTA,C
0003FA B484               M                 BTFSC   PORTE,OPTION
0003FC 80D8               M                 BSF     ALUSTA,C
0003FE A0D8               M                 BTFSS   ALUSTA,C
000400 EF?? F???          M                 GOTO    $ - D'10'
000404 0E0A               M                 MOVLW   D'10'
000406 EC?? F???          M                 CALL    Delay1mS
                          M                 State   PORTE,OPTION
00040A 010F               M                 MOVLB   HIGH PORTE
00040C 90D8               M                 BCF     ALUSTA,C
00040E B484               M                 BTFSC   PORTE,OPTION
000410 80D8               M                 BSF     ALUSTA,C
000412 A0D8               M                 BTFSS   ALUSTA,C
000414 EF?? F???          M                 GOTO    $ - D'30'
000418 0EC8           01337                 MOVLW   D'200'
00041A EC?? F???      01338                 CALL    Delay1mS
00041E                01339 NoRetractWarn
                      01340         ; If Fband = 0 then no RF deck to control
00041E 01??           01341                 MOVLB   HIGH Fband
000420 B0??           01342                 BTFSC   Fband,0
000422 EF?? F???      01343                 GOTO    RFask
000426 A2??           01344                 BTFSS   Fband,1
000428 EF?? F???      01345                 GOTO    Startup1
                      01346         ; Display the Freq and ask pilot
00042C                01347 RFask
00042C 0E80           01348                 MOVLW   LINE1
00042E 01??           01349                 MOVLB   HIGH Ctemp
000430 6E??           01350                 MOVWF   Ctemp
000432 EC?? F???      01351                 CALL    DisplayFrequency
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 59


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

000436 90D8           01352                 BCF     ALUSTA,C
000438 EC?? F???      01353                 CALL    Accept
                      01354                 ; If no, set SelFreq=FF else turn on rf
00043C B0D8           01355                 BTFSC   ALUSTA,C
00043E EF?? F???      01356                 GOTO    Startup2
                      01357                 ; Here to leave rf off
000442 01??           01358                 MOVLB   HIGH SelFreq
000444 0EFF           01359                 MOVLW   0FF
000446 6E??           01360                 MOVWF   SelFreq
000448 EF?? F???      01361                 GOTO    Startup1
00044C                01362 Startup2        ; Here to turn on rf
00044C EC?? F???      01363                 CALL    PLLinit    
000450 EC?? F???      01364                 CALL    PLLCalNreg
000454 EC?? F???      01365                 CALL    PLLsetup
000458 0E0A           01366                 MOVLW   D'10'
00045A EC?? F???      01367                 CALL    Delay1mS
00045E                01368 Startup1
00045E 01??           01369                 MOVLB   HIGH Mode
000460 0E01           01370                 MOVLW   modeRUN
000462 6E??           01371                 MOVWF   Mode
                      01372         ; Read a few more setup parameters...
                      01373                 MOVE    SyncWidth,Sync
000464 C??? F???          M                 MOVFF   SyncWidth,Sync
000468 C??? F???          M                 MOVFF   (SyncWidth+1),(Sync+1)
00046C 01??           01374                 MOVLB   HIGH MaxChannels
00046E 50??           01375                 MOVF    MaxChannels,W
000470 01??           01376                 MOVLB   HIGH NumChan
000472 6E??           01377                 MOVWF   NumChan
                      01378         ; Init the button id byte
000474 EC?? F???      01379                 CALL    ButtonIDinit
000478 EC?? F???      01380                 CALL    BackupAircraft
                      01381         ; Flag the CH5, CH8, and throttle Active position values to force an init
00047C 0EC0           01382                 MOVLW   0xC0
00047E CFE8 F???      01383                 MOVFF   WREG,CH5posActual+1
000482 CFE8 F???      01384                 MOVFF   WREG,CH8posActual+1
000486 CFE8 F???      01385                 MOVFF   WREG,TposActual+1
                      01386 ;
                      01387 ; main program code goes here. There are two main loop
                      01388 ; modes, RUN and CAL. The mode is controlled by the RUN/CAL
                      01389 ; switch on the transmitter. The following functions are
                      01390 ; performed in each mode.
                      01391 ;
                      01392 ; RUN:
                      01393 ;       1.) Read all pots and perform the normalizations
                      01394 ;       2.) Calculate all servo position times
                      01395 ;       3.) Update display
                      01396 ;
                      01397 ; CALIBRATE:
                      01398 ;       1.) Look for received messages from host computer
                      01399 ;       2.) Process commands send from host
                      01400 ;       3.) Allow user to configure radio
                      01401 ;
                      01402 ; Every time around the main loop the run/cal switch is tested,
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 60


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      01403 ; if it remains the same for two passes then the mode is channged.
                      01404 ;
                      01405         ; Turn on the timer        
                      01406 ifdef   CountOn
                      01407                 MOVLB   HIGH Cmode
                      01408                 MOVLW   1
                      01409                 MOVWF   Cmode
                      01410                 MOVE    DWNSecs,Dsecs
                      01411                 CLRF    Usecs
                      01412                 CLRF    Umins
                      01413 endif
00048A                01414 main     
                      01415         ; Enable the MOD output pin
00048A 9E97           01416                 BCF     DDRF,MOD,A
                      01417         ; Test the stack overflow bit and light LED2 if its set!
00048C AEFC           01418                 BTFSS   STKPTR,STKFUL
00048E EF?? F???      01419                 GOTO    NoStackOverflow
000492 010F           01420                 MOVLB   HIGH DDRB
000494 9493           01421                 BCF     DDRB,LED2
000496 9481           01422                 BCF     PORTB,LED2
000498                01423 NoStackOverflow
                      01424         ; Test the run/cal switch...
000498 01??           01425                 MOVLB   HIGH PORTEimage
00049A B0??           01426                 BTFSC   PORTEimage,RUNCAL
00049C EF?? F???      01427                 GOTO    RUNmode
                      01428                 ; Here if in the CAL mode, test current system mode
0004A0 0E01           01429                 MOVLW   modeRUN
0004A2 62??           01430                 CPFSEQ  Mode
0004A4 EF?? F???      01431                 GOTO    CALmode
                      01432                 ; If here, beep three times and change to CAL mode
0004A8 01??           01433                 MOVLB   HIGH BeepCyl
0004AA 0E05           01434                 MOVLW   5
0004AC CFE8 F???      01435                 MOVFF   WREG,BeepCyl
0004B0 0E07           01436                 MOVLW   D'7'
0004B2 EC?? F???      01437                 CALL    Beep            ; Startup short beep!
0004B6 0E02           01438                 MOVLW   modeCAL
0004B8 6E??           01439                 MOVWF   Mode
                      01440                 SingleLine
                      01441                 ShowLine2
                      01442                 ; Make sure the default aircraft is loaded...
0004BA 01??           01443                 MOVLB   HIGH DefaultAircraft
0004BC 50??           01444                 MOVF    DefaultAircraft,W
0004BE 01??           01445                 MOVLB   HIGH Aircraft
0004C0 62??           01446                 CPFSEQ  Aircraft
0004C2 EF?? F???      01447                 GOTO    Reload
0004C6 EF?? F???      01448                 GOTO    CALmode
0004CA                01449 Reload
0004CA 6E??           01450                 MOVWF   Aircraft
0004CC EC?? F???      01451                 CALL    LoadAircraft
0004D0 EC?? F???      01452                 CALL    BackupAircraft
0004D4 EF?? F???      01453                 GOTO    CALmode
                      01454 ;**********************************************************************************
                      01455 ; R U N    M O D E
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 61


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      01456 ;**********************************************************************************
0004D8                01457 RUNmode
                      01458                 DualLine
0004D8 0E01           01459                 MOVLW   modeRUN
0004DA 6E??           01460                 MOVWF   Mode
0004DC EC?? F???      01461                 CALL    AlternateAircraft
0004E0 EC?? F???      01462                 CALL    CalculateNormalizedPositions 
0004E4 EC?? F???      01463                 CALL    UpdateLastPos                   ; This function support center beep options
0004E8 EC?? F???      01464                 CALL    TimerEnable
                      01465                 ; If master mode and AutoTrim button is pressed then
                      01466                 ; Apply positions from slave
0004EC 01??           01467                 MOVLB   HIGH Master
0004EE A0??           01468                 BTFSS   Master,0
0004F0 EF?? F???      01469                 GOTO    RUNmodeNotMaster
                      01470                 ; Is auto trim button pressed?
0004F4 01??           01471                 MOVLB   HIGH SWATRIM
0004F6 50??           01472                 MOVF    SWATRIM,W
0004F8 EC?? F???      01473                 CALL    SwitchTest
0004FC A0D8           01474                 BTFSS   ALUSTA,C
0004FE EF?? F???      01475                 GOTO    RUNmodeNotMaster
                      01476                 ; Test if this is the mode....
000502 01??           01477                 MOVLB   HIGH MasterMode
000504 66??           01478                 TSTFSZ  MasterMode
000506 EF?? F???      01479                 GOTO    FutabaMode
                      01480                 MOVE    MApos,Apos
00050A C??? F???          M                 MOVFF   MApos,Apos
00050E C??? F???          M                 MOVFF   (MApos+1),(Apos+1)
                      01481                 MOVE    MEpos,Epos
000512 C??? F???          M                 MOVFF   MEpos,Epos
000516 C??? F???          M                 MOVFF   (MEpos+1),(Epos+1)
                      01482                 MOVE    MRpos,Rpos
00051A C??? F???          M                 MOVFF   MRpos,Rpos
00051E C??? F???          M                 MOVFF   (MRpos+1),(Rpos+1)
                      01483                 MOVE    MTpos,Tpos
000522 C??? F???          M                 MOVFF   MTpos,Tpos
000526 C??? F???          M                 MOVFF   (MTpos+1),(Tpos+1)
00052A EF?? F???      01484                 GOTO    RUNmodeNotMaster
00052E                01485 FutabaMode
                      01486         ; Here if its Futaba mode and the student button (auto trim) is pressed
                      01487         ; Set INT1 to high priority and TMR3 to low
00052E 8CF0           01488                 BSF     INTCON3,INT1IP,A
000530 86F0           01489                 BSF     INTCON3,INT1IE,A
000532 90A2           01490                 BCF     IPR2,CCP2IP,A
                      01491         ; Set the FutabaStudent flag
000534 68E8           01492                 SETF    WREG
000536 CFE8 F???      01493                 MOVFF   WREG,FutabaStudent
00053A EF?? F???      01494                 GOTO    FutabaDone
00053E                01495 RUNmodeNotMaster
                      01496         ; Here if not in Futabe student mode
                      01497         ; Set INT1 to low priority and TMR3 to high
00053E 9CF0           01498                 BCF     INTCON3,INT1IP,A
000540 86F0           01499                 BSF     INTCON3,INT1IE,A
000542 80A2           01500                 BSF     IPR2,CCP2IP,A
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 62


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      01501         ; Clear the FutabaStudent flag
000544 6AE8           01502                 CLRF    WREG
000546 CFE8 F???      01503                 MOVFF   WREG,FutabaStudent
00054A                01504 FutabaDone
                      01505                 ; If we are in student mode, do no more processing!
00054A 01??           01506                 MOVLB   HIGH Student
00054C B0??           01507                 BTFSC   Student,0
00054E EF?? F???      01508                 GOTO    RUNmode3
000552 EC?? F???      01509                 CALL    ThrottleTrim
000556 B4D8           01510                 BTFSC   ALUSTA,Z
000558 EF?? F???      01511                 GOTO    RUNmode3
00055C EC?? F???      01512                 CALL    ApplyDualRates
000560 EC?? F???      01513                 CALL    ApplyExpo
000564 EC?? F???      01514                 CALL    ApplySnap
000568 EC?? F???      01515                 CALL    AutoTrim
00056C EC?? F???      01516                 CALL    CenterBeep
000570 EC?? F???      01517                 CALL    ApplyTrims
000574 EC?? F???      01518                 CALL    ApplyHelicopter
000578 EC?? F???      01519                 CALL    ApplyFixedMixersPrior
00057C EC?? F???      01520                 CALL    ApplyMixers
000580 EC?? F???      01521                 CALL    ApplyFixedMixers
000584 EC?? F???      01522                 CALL    CCPMmixer
000588 EC?? F???      01523                 CALL    ApplySlewRate
00058C EC?? F???      01524                 CALL    ApplySubTrims
000590 EC?? F???      01525                 CALL    ProcessDtrims
000594 01??           01526                 MOVLB   HIGH FMSflag
000596 66??           01527                 TSTFSZ  FMSflag
000598 EC?? F???      01528                 CALL    FMS
00059C 01??           01529                 MOVLB   HIGH FMSflagU1
00059E 66??           01530                 TSTFSZ  FMSflagU1
0005A0 EC?? F???      01531                 CALL    FMS
0005A4                01532 RUNmode3
                      01533                 ; Sync up with the PPM signal transmission.
                      01534                 ; This will insure we have time to update the channel times
                      01535                 ; before the ISR needs them
0005A4 EC?? F???      01536                 CALL    SyncUp
0005A8 EC?? F???      01537                 CALL    CalculateServoPositions
0005AC EC?? F???      01538                 CALL    SerialSendPositionData
0005B0 EC?? F???      01539                 CALL    ProcessCommand
                      01540                 ; We will update the display every 1/4 sec using timeout4
0005B4 01??           01541                 MOVLB   HIGH TimeOut4
0005B6 66??           01542                 TSTFSZ  TimeOut4
0005B8 EF?? F???      01543                 GOTO    RUNmode2
0005BC 0E0A           01544                 MOVLW   d'10'
0005BE 6E??           01545                 MOVWF   TimeOut4
0005C0 EC?? F???      01546                 CALL    Display
0005C4                01547 RUNmode2
0005C4 EF?? F???      01548                 GOTO    main
                      01549 ;**********************************************************************************
                      01550 ; C A L   M O D E
                      01551 ;**********************************************************************************
0005C8                01552 CALmode
                      01553         ; Display the CAL mode message...
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 63


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

0005C8 0E80           01554                 MOVLW   LINE1
0005CA EC?? F???      01555                 CALL    LCDsendCMD
                      01556                 PrintMess CALMES0
0005CE 0E??               M                 MOVLW   UPPER (CALMES0)
0005D0 6EF8               M                 MOVWF   TBLPTRU,A
0005D2 0E??               M                 MOVLW   HIGH (CALMES0)
0005D4 6EF7               M                 MOVWF   TBLPTRH,A
0005D6 0E??               M                 MOVLW   LOW (CALMES0)
0005D8 6EF6               M                 MOVWF   TBLPTRL,A
0005DA EC?? F???          M                 CALL    LCDsendMess
0005DE 0EC0           01557                 MOVLW   LINE2
0005E0 EC?? F???      01558                 CALL    LCDsendCMD
                      01559                 PrintMess MES8
0005E4 0E??               M                 MOVLW   UPPER (MES8)
0005E6 6EF8               M                 MOVWF   TBLPTRU,A
0005E8 0E??               M                 MOVLW   HIGH (MES8)
0005EA 6EF7               M                 MOVWF   TBLPTRH,A
0005EC 0E??               M                 MOVLW   LOW (MES8)
0005EE 6EF6               M                 MOVWF   TBLPTRL,A
0005F0 EC?? F???          M                 CALL    LCDsendMess
                      01560         ; Read Receiver voltage monitor ADC
0005F4 0E0D           01561                 MOVLW   ADCrec
0005F6 EC?? F???      01562                 CALL    ADCread         ; Results are in Pos
                      01563                 MOVE    Pos,RecVADC     
0005FA C??? F???          M                 MOVFF   Pos,RecVADC
0005FE C??? F???          M                 MOVFF   (Pos+1),(RecVADC+1)
                      01564         ; If option is pressed then enter the CAL function
000602 EC?? F???      01565                 CALL    Option
000606 A0D8           01566                 BTFSS   ALUSTA,C
000608 EF?? F???      01567                 GOTO    CalNotSel
00060C EC?? F???      01568                 CALL    Calibration
000610                01569 CalNotSel
                      01570         ;
000610 EC?? F???      01571                 CALL    CalculateNormalizedPositions
000614 EC?? F???      01572                 CALL    UpdateLastPos
000618 EC?? F???      01573                 CALL    ApplyDualRates
00061C EC?? F???      01574                 CALL    ApplyExpo
000620 EC?? F???      01575                 CALL    ApplySnap
000624 EC?? F???      01576                 CALL    AutoTrim
000628 EC?? F???      01577                 CALL    CenterBeep
00062C EC?? F???      01578                 CALL    ApplyTrims
000630 EC?? F???      01579                 CALL    ApplyHelicopter
000634 EC?? F???      01580                 CALL    ApplyFixedMixersPrior
000638 EC?? F???      01581                 CALL    ApplyMixers
00063C EC?? F???      01582                 CALL    ApplyFixedMixers
000640 EC?? F???      01583                 CALL    CCPMmixer
000644 EC?? F???      01584                 CALL    ApplySlewRate
000648 EC?? F???      01585                 CALL    ApplySubTrims
00064C EC?? F???      01586                 CALL    CalculateServoPositions
                      01587 
000650 EC?? F???      01588                 CALL    ProcessCommand
000654 EF?? F???      01589                 GOTO    main
                      01590 ;******************************************************************
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 64


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      01591 
                      01592 
                      01593 ; This function will print the aircraft model name on the second
                      01594 ; line of the LCD display.
000658                01595 DisplayAircraftName
000658 0100           01596                 MOVLB   0
                      01597         ; Display the aircraft name on the second line
00065A 0E10           01598                 MOVLW   D'16'
00065C 6E??           01599                 MOVWF   Breg
00065E 0EC0           01600                 MOVLW   LINE2
000660 EC?? F???      01601                 CALL    LCDsendCMD
000664 0E??           01602                 MOVLW   LOW Name
000666 6EE1           01603                 MOVWF   FSR1L
000668 0E??           01604                 MOVLW   HIGH Name
00066A 6EE2           01605                 MOVWF   FSR1H           
00066C                01606 Next_Char
00066C 50E6           01607                 MOVF    POSTINC1,W
00066E EC?? F???      01608                 CALL    LCDsendData
000672 2E??           01609                 DECFSZ  Breg
000674 EF?? F???      01610                 GOTO    Next_Char
000678 0012           01611                 RETURN
                      01612 ;
                      01613 ; This is the run mode display update subroutine. The routine
                      01614 ; displays all the information on the LCD display in the run 
                      01615 ; mode of the transmitter.
                      01616 ;
00067A                01617 Display
                      01618         ; Test the physical Auto Trim switch to see if it was just pressed,
                      01619         ; if so then toggle the DisplayLine variable. This variable is only
                      01620         ; used in the MicroProStar mode but the code is executed to all modes.
00067A 01??           01621                 MOVLB   HIGH PORTEimage
00067C B2??           01622                 BTFSC   PORTEimage,AUTOT
00067E EF?? F???      01623                 GOTO    DisplayModeDone
000682 A2??           01624                 BTFSS   PORTElatch,AUTOT
000684 EF?? F???      01625                 GOTO    DisplayModeDone
000688 92??           01626                 BCF     PORTElatch,AUTOT
                      01627                 ; Toggle the state of the DisplayLine flag
00068A 01??           01628                 MOVLB   HIGH DisplayLine
00068C 1E??           01629                 COMF    DisplayLine
00068E                01630 DisplayModeDone:
                      01631         ; Test if the monitor mode flag is set, if so
                      01632         ; jump to the proper monitoring routine.
00068E C??? FFE8      01633                 MOVFF   MonFlag,WREG
000692 B0E8           01634                 BTFSC   WREG,0
000694 EF?? F???      01635                 GOTO    Monitor
000698 B2E8           01636                 BTFSC   WREG,1
00069A EF?? F???      01637                 GOTO    AutoTrimMonitor
                      01638         ; Test if digitial trim data needs to be displayed, if so
                      01639         ; jump to the display routine.
00069E C??? FFE8      01640                 MOVFF   DTdisplay,WREG
0006A2 66E8           01641                 TSTFSZ  WREG
0006A4 EF?? F???      01642                 GOTO    DisplayTrim
0006A8 0100           01643                 MOVLB   0
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 65


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      01644         ; Display the Mixer states...
                      01645 ifdef   ECMA1010display
                      01646                 ; Turn on the RF output ICON if RF is on
                      01647                 MOVLB   HIGH SelFreq
                      01648                 BTFSC   SelFreq,7
                      01649                 GOTO    RFisOFF
                      01650                 MOVLW   0F7
                      01651                 CALL    LCDsendCMD
                      01652                 PrintMess MRFON
                      01653 RFisOFF
                      01654                 MOVLW   0DC
                      01655                 CALL    LCDsendCMD
                      01656                 MOVLR   HIGH Backup
                      01657                 MOVFP   AltAircraft,WREG
                      01658                 CALL    SwitchTest
                      01659                 MOVLW   99
                      01660                 BTFSS   ALUSTA,C
                      01661                 MOVLW   00
                      01662                 CALL    LCDsendData
                      01663                 MOVLW   LINE1+4
                      01664                 CALL    LCDsendCMD
                      01665 else
0006AA 0E84           01666                 MOVLW   LINE1+4
0006AC EC?? F???      01667                 CALL    LCDsendCMD
0006B0 0E20           01668                 MOVLW   ' '
0006B2 EC?? F???      01669                 CALL    LCDsendData
0006B6 01??           01670                 MOVLR   HIGH SelFreq
0006B8 0E52           01671                 MOVLW   'R'
0006BA BE??           01672                 BTFSC   SelFreq,7
0006BC 0E20           01673                 MOVLW   ' '
0006BE 0100           01674                 MOVLR   0
0006C0 EC?? F???      01675                 CALL    LCDsendData
0006C4 01??           01676                 MOVLR   HIGH Backup
0006C6 5000           01677                 MOVFP   AltAircraft,WREG
0006C8 EC?? F???      01678                 CALL    SwitchTest
0006CC 0E41           01679                 MOVLW   'A'
0006CE A0D8           01680                 BTFSS   ALUSTA,C
0006D0 0E20           01681                 MOVLW   ' '
0006D2 EC?? F???      01682                 CALL    LCDsendData
                      01683 endif
0006D6 01??           01684                 MOVLR   HIGH SWMIX1
0006D8 5000           01685                 MOVFP   SWMIX1,WREG
0006DA EC?? F???      01686                 CALL    SwitchTest
0006DE 0E4D           01687                 MOVLW   'M'
0006E0 A0D8           01688                 BTFSS   ALUSTA,C
0006E2 0E2D           01689                 MOVLW   '-'
0006E4 EC?? F???      01690                 CALL    LCDsendData
0006E8 01??           01691                 MOVLR   HIGH SWMIX2
0006EA 5000           01692                 MOVFP   SWMIX2,WREG
0006EC EC?? F???      01693                 CALL    SwitchTest
0006F0 0E4D           01694                 MOVLW   'M'
0006F2 A0D8           01695                 BTFSS   ALUSTA,C
0006F4 0E2D           01696                 MOVLW   '-'
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 66


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

0006F6 EC?? F???      01697                 CALL    LCDsendData
0006FA 01??           01698                 MOVLR   HIGH SWMIX3
0006FC 5000           01699                 MOVFP   SWMIX3,WREG
0006FE EC?? F???      01700                 CALL    SwitchTest
000702 0E4D           01701                 MOVLW   'M'
000704 A0D8           01702                 BTFSS   ALUSTA,C
000706 0E2D           01703                 MOVLW   '-'
000708 EC?? F???      01704                 CALL    LCDsendData
                      01705 ifndef  ECMA1010display
00070C 0E20           01706                 MOVLW   ' '
00070E EC?? F???      01707                 CALL    LCDsendData
                      01708 endif
                      01709         ; Display the transmitter voltage
000712 EC?? F???      01710                 CALL    TransVoltage
                      01711         ; If the Auto Trim button is pressed then display the total on time of
                      01712         ; the transmitter
000716 01??           01713                 MOVLR   HIGH SWATRIM
000718 5000           01714                 MOVFP   SWATRIM,WREG
00071A EC?? F???      01715                 CALL    SwitchTest
00071E A0D8           01716                 BTFSS   ALUSTA,C
000720 EF?? F???      01717                 GOTO    DispNoBT
                      01718                 ; Here if the Auto Trim button is pressed
                      01719                 ; Test if the transmitter is in the Master mode, if so then
                      01720                 ; display Stdnt on the display instead of the on time
000724 C??? FFE8      01721                 MOVFF   Master,WREG
000728 1EE8           01722                 COMF    WREG
00072A 66E8           01723                 TSTFSZ  WREG
00072C EF?? F???      01724                 GOTO    DispBT
                      01725                 ; Here is display the Stdnt message
000730 0E80           01726                 MOVLW   LINE1
000732 EC?? F???      01727                 CALL    LCDsendCMD
                      01728                 PrintMess MES12
000736 0E??               M                 MOVLW   UPPER (MES12)
000738 6EF8               M                 MOVWF   TBLPTRU,A
00073A 0E??               M                 MOVLW   HIGH (MES12)
00073C 6EF7               M                 MOVWF   TBLPTRH,A
00073E 0E??               M                 MOVLW   LOW (MES12)
000740 6EF6               M                 MOVWF   TBLPTRL,A
000742 EC?? F???          M                 CALL    LCDsendMess
000746 EF?? F???      01729                 GOTO    DispNoBT
00074A                01730 DispBT          
00074A 0E80           01731                 MOVLW   LINE1
00074C EC?? F???      01732                 CALL    LCDsendCMD
                      01733                 MOVE    BatteryTimer,CEXreg
000750 C??? F???          M                 MOVFF   BatteryTimer,CEXreg
000754 C??? F???          M                 MOVFF   (BatteryTimer+1),(CEXreg+1)
000758 EC?? F???      01734                 CALL    LCDintZS                
00075C                01735 DispNoBT        
                      01736                 ; Test the BTflag and update the time if necessary
00075C 01??           01737                 MOVLR   HIGH BTflag
00075E AE??           01738                 BTFSS   BTflag,7
000760 EF?? F???      01739                 GOTO    DispNoSaveBT   
000764 6A??           01740                 CLRF    BTflag
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 67


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      01741                 ; Here to update the time in EEPROM
000766 0E??           01742                 MOVLW   LOW BatteryTimer
000768 CFE8 F???      01743                 MOVFF   WREG,AXreg      ; RAM address of data to write
00076C 6AE8           01744                 CLRF    WREG,A
00076E CFE8 F???      01745                 MOVFF   WREG,AXreg+1
000772 C??? FFE8      01746                 MOVFF   BatteryTimer,WREG
000776 EC?? F???      01747                 CALL    EEPROMwriteByte
                      01748 
00077A 0E??           01749                 MOVLW   LOW (BatteryTimer+1)
00077C CFE8 F???      01750                 MOVFF   WREG,AXreg      ; RAM address of data to write
000780 6AE8           01751                 CLRF    WREG,A
000782 CFE8 F???      01752                 MOVFF   WREG,AXreg+1
000786 C??? FFE8      01753                 MOVFF   BatteryTimer+1,WREG
00078A EC?? F???      01754                 CALL    EEPROMwriteByte
00078E                01755 DispNoSaveBT
                      01756         ; Display the Throttle Adjust message if the TTflag is set
00078E EC?? F???      01757                 CALL    ThrottleAdjustMessage
000792 B0D8           01758                 BTFSC   ALUSTA,C
000794 EF?? F???      01759                 GOTO    DispAircraftDone                
                      01760         ; Display the receiver bat voltage if its non zero..
                      01761 ifndef          MicroProStar                    ; These functions do not exist on the MicroProStar
000798 EC?? F???      01762                 CALL    RecVoltage
00079C B0D8           01763                 BTFSC   ALUSTA,C
00079E EF?? F???      01764                 GOTO    DispAircraftDone
                      01765         ; Display The Tach RPM if enabled
0007A2 EC?? F???      01766                 CALL    TackDisplay
0007A6 B0D8           01767                 BTFSC   ALUSTA,C
0007A8 EF?? F???      01768                 GOTO    DispAircraftDone
                      01769 endif
                      01770         ; Call the Button ID function
0007AC EC?? F???      01771                 CALL    ButtonID
                      01772                 ; If timeout5 is not zero then exit...
0007B0 01??           01773                 MOVLR   HIGH TimeOut5
0007B2 5000           01774                 MOVFP   TimeOut5,WREG
0007B4 12E8           01775                 IORWF   WREG
0007B6 A4D8           01776                 BTFSS   ALUSTA,Z
0007B8 EF?? F???      01777                 GOTO    DispAircraftDone
                      01778         ; Display the aircraft name on the second line
                      01779                 ; If student mode then display student
0007BC 01??           01780                 MOVLR   HIGH Student
0007BE A0??           01781                 BTFSS   Student,0
0007C0 EF?? F???      01782                 GOTO    DispNotStudent
0007C4 0EC0           01783                 MOVLW   LINE2
0007C6 EC?? F???      01784                 CALL    LCDsendCMD
                      01785                 PrintMess MES10
0007CA 0E??               M                 MOVLW   UPPER (MES10)
0007CC 6EF8               M                 MOVWF   TBLPTRU,A
0007CE 0E??               M                 MOVLW   HIGH (MES10)
0007D0 6EF7               M                 MOVWF   TBLPTRH,A
0007D2 0E??               M                 MOVLW   LOW (MES10)
0007D4 6EF6               M                 MOVWF   TBLPTRL,A
0007D6 EC?? F???          M                 CALL    LCDsendMess
0007DA EF?? F???      01786                 GOTO    DispAircraftDone
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 68


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

0007DE                01787 DispNotStudent
0007DE EC?? F???      01788                 CALL    DisplayAircraftName
0007E2 EC?? F???      01789                 CALL    HelicopterModeDisplay
0007E6                01790 DispAircraftDone
                      01791         ; Process the Option button
0007E6 EC?? F???      01792                 CALL    Option
0007EA A0D8           01793                 BTFSS   ALUSTA,C
0007EC EF?? F???      01794                 GOTO    Dsp1
                      01795         ; Test if the Helicopter Gyro tune mode is active and process
0007F0 EC?? F???      01796                 CALL    GyroTuneProcess
0007F4 B0D8           01797                 BTFSC   ALUSTA,C
0007F6 EF?? F???      01798                 GOTO    Dsp1
                      01799         ; If the mode is 1 set it to 0, if its 0 set it to 1
0007FA 01??           01800                 MOVLR   HIGH Cmode
0007FC 66??           01801                 TSTFSZ  Cmode
0007FE EF?? F???      01802                 GOTO    Dsp2
                      01803                 ; Here if counter mode is 0, set to 1 and start the down counter
000802 2A??           01804                 INCF    Cmode,F
                      01805                 MOVE    DWNSecs,Dsecs
000804 C??? F???          M                 MOVFF   DWNSecs,Dsecs
000808 C??? F???          M                 MOVFF   (DWNSecs+1),(Dsecs+1)
00080C 6A??           01806                 CLRF    Usecs
00080E 6A??           01807                 CLRF    Umins
000810 EF?? F???      01808                 GOTO    Dsp1
000814                01809 Dsp2            
                      01810                 ; Here if counter mode is 1
000814 06??           01811                 DECF    Cmode,F
000816                01812 Dsp1
                      01813         ; Test the timer mode...
                      01814         ; Display the down counter, do the following
                      01815         ; at 1 min, beep 3 times
                      01816         ; at 30 sec, beep 2 times
                      01817         ; at 10 sec, beep 1 time
                      01818         ; and one time at 5,4,3,2,1 sec
000816 01??           01819                 MOVLR   HIGH Cmode
000818 A0??           01820                 BTFSS   Cmode,0
00081A EF?? F???      01821                 GOTO    Dsp3 
                      01822                 ; Here if we are in the count down mode
00081E 66??           01823                 TSTFSZ  Dmins
000820 EF?? F???      01824                 GOTO    Dsp3
                      01825                 ; Here if this is the last minute of the 
                      01826                 ; timer, test for and generate the warning beeps
000824 0E3B           01827                 MOVLW   D'59'   
000826 62??           01828                 CPFSEQ  DsecsLatch
000828 EF?? F???      01829                 GOTO    Dsp3a
00082C 0E05           01830                 MOVLW   5
00082E 6E??           01831                 MOVWF   BeepCyl
000830 0E0A           01832                 MOVLW   D'10'
000832 EC?? F???      01833                 CALL    Beep
000836 EF?? F???      01834                 GOTO    Dsp3
00083A                01835 Dsp3a
00083A 0E1E           01836                 MOVLW   D'30'   
00083C 62??           01837                 CPFSEQ  DsecsLatch
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 69


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

00083E EF?? F???      01838                 GOTO    Dsp3b
000842 0E03           01839                 MOVLW   3
000844 6E??           01840                 MOVWF   BeepCyl
000846 0E0A           01841                 MOVLW   D'10'
000848 EC?? F???      01842                 CALL    Beep
00084C EF?? F???      01843                 GOTO    Dsp3
000850                01844 Dsp3b
000850 0E0A           01845                 MOVLW   D'10'   
000852 62??           01846                 CPFSEQ  DsecsLatch
000854 EF?? F???      01847                 GOTO    Dsp3c
000858 0E01           01848                 MOVLW   1
00085A 6E??           01849                 MOVWF   BeepCyl
00085C 0E0A           01850                 MOVLW   D'10'
00085E EC?? F???      01851                 CALL    Beep
000862 EF?? F???      01852                 GOTO    Dsp3
000866                01853 Dsp3c
000866 0E06           01854                 MOVLW   6       
000868 60??           01855                 CPFSLT  DsecsLatch
00086A EF?? F???      01856                 GOTO    Dsp3
00086E 0E01           01857                 MOVLW   1
000870 6E??           01858                 MOVWF   BeepCyl
000872 0E0A           01859                 MOVLW   D'10'
000874 EC?? F???      01860                 CALL    Beep
000878 EF?? F???      01861                 GOTO    Dsp3
                      01862 
00087C                01863 Dsp3
00087C 0E7F           01864                 MOVLW   07F
00087E 6E??           01865                 MOVWF   DsecsLatch
                      01866         ; Display the current ON time or count down time... 
                      01867                 ; If Cmode = 0 then display the on time
                      01868                 ; If Cmode = 1 and CNTmode = 1 then display the down timer
                      01869                 ; If Cmode = 1 and CNTmode = 0 then display the up timer
                      01870                 ; If Cmode = 1 and CNTmode = 2 then display the down timer and stop at 0
000880 5000           01871                 MOVFP   Secs,WREG       ; Move counter to DXreg
000882 6E??           01872                 MOVWF   DXreg
000884 5000           01873                 MOVFP   Mins,WREG
000886 6E??           01874                 MOVWF   DXreg+1
000888 0E01           01875                 MOVLW   1
00088A 62??           01876                 CPFSEQ  Cmode
00088C EF?? F???      01877                 GOTO    Dsp3d           ; Jump if Cmode is zero
                      01878            ; Here if Cmode == 1
000890 5000           01879                 MOVFP   Dsecs,WREG      ; Test down counter to see if its 0
000892 10??           01880                 IORWF   Dmins,W
000894 B4D8           01881                 BTFSC   ALUSTA,Z
000896 EF?? F???      01882                 GOTO    DSP3d1          ; Jump if zero
                      01883            ; Here if down counter has not reached 0       
00089A 5000           01884                 MOVFP   Dsecs,WREG      ; Move down counter to DXreg
00089C 6E??           01885                 MOVWF   DXreg
00089E 5000           01886                 MOVFP   Dmins,WREG
0008A0 6E??           01887                 MOVWF   DXreg+1
0008A2 0E00           01888                 MOVLW   0 
0008A4 01??           01889                 MOVLR   HIGH CNTmode
0008A6 62??           01890                 CPFSEQ  CNTmode
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 70


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

0008A8 EF?? F???      01891                 GOTO    Dsp3d           ; If CNTmode != 0 then jump
0008AC                01892 DSP3d1     ; Here if CNTmode == 0   
0008AC 0E02           01893                 MOVLW   2 
0008AE 01??           01894                 MOVLR   HIGH CNTmode
0008B0 5C??           01895                 SUBWF   CNTmode,W
0008B2 B4D8           01896                 BTFSC   ALUSTA,Z
0008B4 EF?? F???      01897                 GOTO    Dsp3d1a         ; If CNTmode == 2 then jump
                      01898            ; Here if CNTmode != 2       
0008B8 01??           01899                 MOVLR   HIGH Usecs      ; Move up time to DXreg
0008BA 5000           01900                 MOVFP   Usecs,WREG
0008BC 6E??           01901                 MOVWF   DXreg
0008BE 5000           01902                 MOVFP   Umins,WREG
0008C0 6E??           01903                 MOVWF   DXreg+1
0008C2 EF?? F???      01904                 GOTO    Dsp3d
0008C6                01905 Dsp3d1a    ; Here if CNTmode == 2
0008C6 6AE8           01906                 CLRF    WREG
0008C8 01??           01907                 MOVLR   HIGH DXreg
0008CA 6E??           01908                 MOVWF   DXreg
0008CC 6E??           01909                 MOVWF   DXreg+1
0008CE                01910 Dsp3d      ; Display the time in DXreg                    
0008CE 01??           01911                 MOVLR   HIGH DXreg
0008D0 0E8B           01912                 MOVLW   LINE1+ONTIMEPOS
0008D2 EC?? F???      01913                 CALL    LCDsendCMD
0008D6 5000           01914                 MOVFP   DXreg+1,WREG
0008D8 CFE8 F???      01915                 MOVPF   WREG,CEXreg
0008DC 6A??           01916                 CLRF    CEXreg+1
0008DE 6A??           01917                 CLRF    CEXreg+2
0008E0 6A??           01918                 CLRF    CEXreg+3
0008E2 EC?? F???      01919                 CALL    LCDint2
0008E6 0E3A           01920                 MOVLW   ':'
0008E8 EC?? F???      01921                 CALL    LCDsendData
0008EC C??? FFE8      01922                 MOVFF   DXreg,WREG
0008F0 CFE8 F???      01923                 MOVFF   WREG,CEXreg
0008F4 EC?? F???      01924                 CALL    LCDint2
0008F8 0012           01925                 RETURN
                      01926                 
                      01927 ; This function looks at the Timer enabling options:
                      01928 ;  1.) The enable switch
                      01929 ;  2.) The throttle stick position enable
                      01930 ; If both of these are true, then the TimerCount flag is
                      01931 ; set, FF. This function is called in the run main loop.                
0008FA                01932 TimerEnable    
                      01933         ; Read the enabled switch status 
0008FA 01??           01934                 MOVLR   HIGH TEnaSW
0008FC 5000           01935                 MOVFP   TEnaSW,WREG
0008FE EC?? F???      01936                 CALL    SwitchTest
000902 A0D8           01937                 BTFSS   ALUSTA,C
000904 EF?? F???      01938                 GOTO    TE1       
                      01939         ; Test the throttle position
000908 01??           01940                 MOVLR   HIGH Tthres
00090A 0E00           01941                 MOVLW   0
00090C 64??           01942                 CPFSGT  Tthres
00090E EF?? F???      01943                 GOTO    TE2   
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 71


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

000912 01??           01944                 MOVLR   HIGH Tpos
000914 BE??           01945                 BTFSC   Tpos+1,7
000916 EF?? F???      01946                 GOTO    TE1
00091A 01??           01947                 MOVLR   HIGH Tthres
00091C 5000           01948                 MOVFP   Tthres,WREG
00091E 01??           01949                 MOVLR   HIGH AXreg
000920 6E??           01950                 MOVWF   AXreg
000922 6A??           01951                 CLRF    AXreg+1
                      01952                 MOVEC   D'10',BXreg
000924 01??               M                 MOVLR   HIGH (BXreg)
000926 0E0A               M                 MOVLW   LOW (D'10')
000928 6E??               M                 MOVWF   (BXreg)
00092A 0E00               M                 MOVLW   HIGH (D'10')
00092C 6E??               M                 MOVWF   (BXreg+1)
00092E EC?? F???      01953                 CALL    Mult1616
000932 5000           01954                 MOVFP   Tpos,WREG
000934 5E??           01955                 SUBWF   CEXreg
000936 5000           01956                 MOVFP   Tpos+1,WREG
000938 58??           01957                 SUBWFB  CEXreg+1,W
00093A B0D8           01958                 BTFSC   ALUSTA,C
00093C EF?? F???      01959                 GOTO    TE1  
                      01960         ; Enable the counter 
000940                01961 TE2             
000940 01??           01962                 MOVLR   HIGH TimerCount
000942 68??           01963                 SETF    TimerCount
000944 0012           01964                 RETURN
000946                01965 TE1                               
000946 01??           01966                 MOVLR   HIGH TimerCount
000948 6A??           01967                 CLRF    TimerCount
00094A 0012           01968                 RETURN
                      01969 
                      01970 ; This function tests the TTflag, if its set then the Throttle
                      01971 ; adjust message is printed on the second line of the display
                      01972 ; and the carry flag is set on exit.
00094C                01973 ThrottleAdjustMessage
                      01974         ; Test the TTflag
00094C 90D8           01975                 BCF     ALUSTA,C
00094E 01??           01976                 MOVLR   HIGH TTflag
000950 AE??           01977                 BTFSS   TTflag,7
000952 0012           01978                 RETURN
                      01979         ; Here to display message
000954 0EC0           01980                 MOVLW   LINE2
000956 EC?? F???      01981                 CALL    LCDsendCMD
                      01982                 PrintMess MES24
00095A 0E??               M                 MOVLW   UPPER (MES24)
00095C 6EF8               M                 MOVWF   TBLPTRU,A
00095E 0E??               M                 MOVLW   HIGH (MES24)
000960 6EF7               M                 MOVWF   TBLPTRH,A
000962 0E??               M                 MOVLW   LOW (MES24)
000964 6EF6               M                 MOVWF   TBLPTRL,A
000966 EC?? F???          M                 CALL    LCDsendMess
                      01983         ; Set carry flag and exit
00096A 80D8           01984                 BSF     ALUSTA,C        
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 72


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

00096C 0012           01985                 RETURN
                      01986                              
                      01987         Include <TestIO.asm>
                      00001 ;
                      00002 ; This is a IO test routine entered when the Option and Preset buttons are
                      00003 ; held down during power up. The display will show binary data for ports
                      00004 ; D and E on the top line, and G and B on the second line.
                      00005 ;
                      00006 ifdef   MicroProStar
                      00007 ; Entry point for the MicroProStar mode.
                      00008 TestIO
                      00009         ; Enable the MOD output pin
                      00010                 BCF     DDRF,MOD,A
                      00011         ;
                      00012                 SingleLine
                      00013                 CALL    LCDshowLine1
                      00014                 CLRF    WREG            ; Make sure we point to line one of the display
                      00015                 MOVFF   WREG,DisplayLine
                      00016         ; Make sure test select buttons are released
                      00017                 Release OPTION_BUTTON
                      00018                 Release PORTD,PRESET
                      00019 TestIOa
                      00020         ; Display the digitial port data
                      00021                 MOVLW   LINE1
                      00022                 CALL    LCDsendCMD
                      00023                 CALL    MP8KreadD
                      00024                 CALL    LCDbinary
                      00025                 MOVLW   LINE1+LCDRIGHT
                      00026                 CALL    LCDsendCMD
                      00027                 CALL    MP8KreadE
                      00028                 CALL    LCDbinary
                      00029         ; Use aileron dual rate to drive mod pin, this is useful for
                      00030         ; setting the RF deck modulation depth
                      00031                 CALL    MP8KreadD
                      00032                 BTFSC   WREG,AilDR
                      00033                 BSF     PORTF,MOD
                      00034                 BTFSS   WREG,AilDR
                      00035                 BCF     PORTF,MOD
                      00036         ; Use rudder dual rate to turn on and off buzzer
                      00037                 BCF     PORTA,BUZZER,A 
                      00038                 BTFSS   WREG,RudDR
                      00039                 BSF     PORTA,BUZZER,A 
                      00040                 CALL    MP8Kbuzzer      
                      00041                 ; Delay a bit
                      00042                 MOVLW   D'50'
                      00043                 CALL    Delay1mS
                      00044                 Pressed OPTION_BUTTON
                      00045                 BTFSC   ALUSTA,C
                      00046                 GOTO    TestIOa
                      00047                 Release OPTION_BUTTON
                      00048         ; Read and display the ADC channels... 
                      00049                 MOVLR   HIGH CXreg
                      00050                 CLRF    CXreg
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 73


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00051 else
                      00052 ;
                      00053 ; This is the entry point for the MicroStar mode.
                      00054 ;
00096E                00055 TestIO
                      00056                 Release OPTION_BUTTON
                          M                 State   PORTE,OPTION
00096E 010F               M                 MOVLB   HIGH PORTE
000970 90D8               M                 BCF     ALUSTA,C
000972 B484               M                 BTFSC   PORTE,OPTION
000974 80D8               M                 BSF     ALUSTA,C
000976 A0D8               M                 BTFSS   ALUSTA,C
000978 EF?? F???          M                 GOTO    $ - D'10'
00097C 0E0A               M                 MOVLW   D'10'
00097E EC?? F???          M                 CALL    Delay1mS
                          M                 State   PORTE,OPTION
000982 010F               M                 MOVLB   HIGH PORTE
000984 90D8               M                 BCF     ALUSTA,C
000986 B484               M                 BTFSC   PORTE,OPTION
000988 80D8               M                 BSF     ALUSTA,C
00098A A0D8               M                 BTFSS   ALUSTA,C
00098C EF?? F???          M                 GOTO    $ - D'30'
                      00057                 Release PORTD,PRESET
                          M                 State   PORTD,PRESET
000990 010F               M                 MOVLB   HIGH PORTD
000992 90D8               M                 BCF     ALUSTA,C
000994 B683               M                 BTFSC   PORTD,PRESET
000996 80D8               M                 BSF     ALUSTA,C
000998 A0D8               M                 BTFSS   ALUSTA,C
00099A EF?? F???          M                 GOTO    $ - D'10'
00099E 0E0A               M                 MOVLW   D'10'
0009A0 EC?? F???          M                 CALL    Delay1mS
                          M                 State   PORTD,PRESET
0009A4 010F               M                 MOVLB   HIGH PORTD
0009A6 90D8               M                 BCF     ALUSTA,C
0009A8 B683               M                 BTFSC   PORTD,PRESET
0009AA 80D8               M                 BSF     ALUSTA,C
0009AC A0D8               M                 BTFSS   ALUSTA,C
0009AE EF?? F???          M                 GOTO    $ - D'30'
0009B2                00058 TestIOa
                      00059 ifdef ECMA1010display
                      00060                 MOVLW   LINE1
                      00061                 CALL    LCDsendCMD
                      00062                 PrintMess MES0
                      00063                 MOVLW   LINE2
                      00064                 CALL    LCDsendCMD
                      00065                 PrintMess MES0
                      00066                 MOVLW   LINE3
                      00067                 CALL    LCDsendCMD
                      00068                 PrintMess MES0
                      00069                 MOVLW   LINE4
                      00070                 CALL    LCDsendCMD
                      00071                 PrintMess MES0
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 74


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00072 endif
                      00073         ; Read and display parallel IO ports
0009B2 0E80           00074                 MOVLW   LINE1
0009B4 EC?? F???      00075                 CALL    LCDsendCMD      ; First line of display
0009B8 010F           00076                 MOVLB   HIGH PORTD      ; Port D
0009BA 5083           00077                 MOVFP   PORTD,WREG
0009BC EC?? F???      00078                 CALL    LCDbinary
                      00079 ifdef ECMA1010display
                      00080                 MOVLW   LINE2
                      00081                 CALL    LCDsendCMD
                      00082 endif
0009C0 010F           00083                 MOVLB   HIGH PORTE      ; Port E
0009C2 5084           00084                 MOVFP   PORTE,WREG
0009C4 EC?? F???      00085                 CALL    LCDbinary
0009C8 0EC0           00086                 MOVLW   LINE3           ; Second line of display
0009CA EC?? F???      00087                 CALL    LCDsendCMD
0009CE 010F           00088                 MOVLB   HIGH PORTG      ; Port G
0009D0 5086           00089                 MOVFP   PORTG,WREG
0009D2 EC?? F???      00090                 CALL    LCDbinary
                      00091 ifdef ECMA1010display
                      00092                 MOVLW   LINE4
                      00093                 CALL    LCDsendCMD
                      00094 endif
0009D6 010F           00095                 MOVLB   HIGH PORTB      ; Port B
0009D8 5081           00096                 MOVFP   PORTB,WREG
0009DA EC?? F???      00097                 CALL    LCDbinary
                      00098         ; Test LEDs
                      00099         ; PortD bit 0 (Ail DR) = LED1
                      00100         ; PortD bit 1 (Eve DR) = LED2
0009DE 010F           00101                 MOVLB   HIGH PORTD
0009E0 5083           00102                 MOVFP   PORTD,WREG
0009E2 8682           00103                 BSF     PORTC,LED1
0009E4 8481           00104                 BSF     PORTB,LED2
0009E6 B0E8           00105                 BTFSC   WREG,0
0009E8 9682           00106                 BCF     PORTC,LED1
0009EA B2E8           00107                 BTFSC   WREG,1
0009EC 9481           00108                 BCF     PORTB,LED2
                      00109         ; Test the buzzer = PORTD bit 2 (Rud DR)
0009EE 9880           00110                 BCF     PORTA,BUZZER
0009F0 B4E8           00111                 BTFSC   WREG,2
0009F2 8880           00112                 BSF     PORTA,BUZZER
                      00113         ; Loop untill the option button is pressed...
0009F4 0E32           00114                 MOVLW   D'50'
0009F6 EC?? F???      00115                 CALL    Delay1mS
                      00116                 Pressed OPTION_BUTTON
                          M                 State   PORTE,OPTION
0009FA 010F               M                 MOVLB   HIGH PORTE
0009FC 90D8               M                 BCF     ALUSTA,C
0009FE B484               M                 BTFSC   PORTE,OPTION
000A00 80D8               M                 BSF     ALUSTA,C
000A02 B0D8               M                 BTFSC   ALUSTA,C
000A04 EF?? F???          M                 GOTO    $ + D'14'
000A08 0E0A               M                 MOVLW   D'10'
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 75


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

000A0A EC?? F???          M                 CALL    Delay1mS
                          M                 State   PORTE,OPTION
000A0E 010F               M                 MOVLB   HIGH PORTE
000A10 90D8               M                 BCF     ALUSTA,C
000A12 B484               M                 BTFSC   PORTE,OPTION
000A14 80D8               M                 BSF     ALUSTA,C
000A16 B0D8           00117                 BTFSC   ALUSTA,C
000A18 EF?? F???      00118                 GOTO    TestIOa
                      00119                 Release OPTION_BUTTON
                          M                 State   PORTE,OPTION
000A1C 010F               M                 MOVLB   HIGH PORTE
000A1E 90D8               M                 BCF     ALUSTA,C
000A20 B484               M                 BTFSC   PORTE,OPTION
000A22 80D8               M                 BSF     ALUSTA,C
000A24 A0D8               M                 BTFSS   ALUSTA,C
000A26 EF?? F???          M                 GOTO    $ - D'10'
000A2A 0E0A               M                 MOVLW   D'10'
000A2C EC?? F???          M                 CALL    Delay1mS
                          M                 State   PORTE,OPTION
000A30 010F               M                 MOVLB   HIGH PORTE
000A32 90D8               M                 BCF     ALUSTA,C
000A34 B484               M                 BTFSC   PORTE,OPTION
000A36 80D8               M                 BSF     ALUSTA,C
000A38 A0D8               M                 BTFSS   ALUSTA,C
000A3A EF?? F???          M                 GOTO    $ - D'30'
                      00120         ; Read the ADC channels...
                      00121 ifdef ECMA1010display
                      00122                 MOVLW   LINE3
                      00123                 CALL    LCDsendCMD
                      00124                 PrintMess MES0
                      00125                 MOVLW   LINE4
                      00126                 CALL    LCDsendCMD
                      00127                 PrintMess MES0
                      00128 endif
000A3E 0EC0           00129                 MOVLW   LINE2
000A40 EC?? F???      00130                 CALL    LCDsendCMD
                      00131                 PrintMess MES0
000A44 0E??               M                 MOVLW   UPPER (MES0)
000A46 6EF8               M                 MOVWF   TBLPTRU,A
000A48 0E??               M                 MOVLW   HIGH (MES0)
000A4A 6EF7               M                 MOVWF   TBLPTRH,A
000A4C 0E??               M                 MOVLW   LOW (MES0)
000A4E 6EF6               M                 MOVWF   TBLPTRL,A
000A50 EC?? F???          M                 CALL    LCDsendMess
000A54 01??           00132                 MOVLR   HIGH CXreg
000A56 6A??           00133                 CLRF    CXreg
                      00134 endif
                      00135 ;
                      00136 ; The following is common code for both the MicroStar and MicroProStar
                      00137 ;
000A58                00138 TestIO1
000A58 0E80           00139                 MOVLW   LINE1
000A5A EC?? F???      00140                 CALL    LCDsendCMD
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 76


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00141                 PrintMess MES3
000A5E 0E??               M                 MOVLW   UPPER (MES3)
000A60 6EF8               M                 MOVWF   TBLPTRU,A
000A62 0E??               M                 MOVLW   HIGH (MES3)
000A64 6EF7               M                 MOVWF   TBLPTRH,A
000A66 0E??               M                 MOVLW   LOW (MES3)
000A68 6EF6               M                 MOVWF   TBLPTRL,A
000A6A EC?? F???          M                 CALL    LCDsendMess
000A6E 0E87           00142                 MOVLW   LINE1+TESTCHPOS
000A70 EC?? F???      00143                 CALL    LCDsendCMD
000A74 01??           00144                 MOVLR   HIGH AXreg
000A76 5000           00145                 MOVFP   CXreg,WREG
000A78 EC?? F???      00146                 CALL    LCDhex
000A7C EC?? F???      00147                 CALL    ADCread
                      00148                 ; divide by 4 if its the PIC 18F8722
000A80 C??? FFE8      00149                 MOVFF   PIC18F8723,WREG
000A84 66E8           00150                 TSTFSZ  WREG,A
000A86 EF?? F???      00151                 GOTO    TestIO2
000A8A 90D8           00152                 BCF     ALUSTA,C,A
000A8C 32C4           00153                 RRCF    ADRESH,F,A
000A8E 32C3           00154                 RRCF    ADRESL,F,A
000A90 90D8           00155                 BCF     ALUSTA,C,A
000A92 32C4           00156                 RRCF    ADRESH,F,A
000A94 32C3           00157                 RRCF    ADRESL,F,A
000A96                00158 TestIO2         ;
000A96 0E8C           00159                 MOVLW   LINE1+TESTVALPOS
000A98 EC?? F???      00160                 CALL    LCDsendCMD
                      00161 ifdef TestADChex
                      00162                 MOVLB   HIGH ADRESH
                      00163                 MOVPF   ADRESH,WREG
                      00164                 CALL    LCDhex  
                      00165                 MOVLB   HIGH ADRESL
                      00166                 MOVPF   ADRESL,WREG
                      00167                 CALL    LCDhex  
                      00168 else
000A9C CFC3 F???      00169                 MOVFF   ADRESL,CEXreg
000AA0 CFC4 F???      00170                 MOVFF   ADRESH,CEXreg+1
000AA4 01??           00171                 MOVLB   HIGH CEXreg
000AA6 6A??           00172                 CLRF    CEXreg+2
000AA8 6A??           00173                 CLRF    CEXreg+3
000AAA EC?? F???      00174                 CALL    LCDint4
                      00175 endif
                      00176         ; Delay
000AAE 0E32           00177                 MOVLW   D'50'
000AB0 EC?? F???      00178                 CALL    Delay1mS
                      00179         ; If option button is pressed then advance to next channel
                      00180         ; after channel 12, exit
                      00181                 Pressed OPTION_BUTTON
                          M                 State   PORTE,OPTION
000AB4 010F               M                 MOVLB   HIGH PORTE
000AB6 90D8               M                 BCF     ALUSTA,C
000AB8 B484               M                 BTFSC   PORTE,OPTION
000ABA 80D8               M                 BSF     ALUSTA,C
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 77


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

000ABC B0D8               M                 BTFSC   ALUSTA,C
000ABE EF?? F???          M                 GOTO    $ + D'14'
000AC2 0E0A               M                 MOVLW   D'10'
000AC4 EC?? F???          M                 CALL    Delay1mS
                          M                 State   PORTE,OPTION
000AC8 010F               M                 MOVLB   HIGH PORTE
000ACA 90D8               M                 BCF     ALUSTA,C
000ACC B484               M                 BTFSC   PORTE,OPTION
000ACE 80D8               M                 BSF     ALUSTA,C
000AD0 B0D8           00182                 BTFSC   ALUSTA,C
000AD2 EF?? F???      00183                 GOTO    TestIO1
                      00184                 Release OPTION_BUTTON
                          M                 State   PORTE,OPTION
000AD6 010F               M                 MOVLB   HIGH PORTE
000AD8 90D8               M                 BCF     ALUSTA,C
000ADA B484               M                 BTFSC   PORTE,OPTION
000ADC 80D8               M                 BSF     ALUSTA,C
000ADE A0D8               M                 BTFSS   ALUSTA,C
000AE0 EF?? F???          M                 GOTO    $ - D'10'
000AE4 0E0A               M                 MOVLW   D'10'
000AE6 EC?? F???          M                 CALL    Delay1mS
                          M                 State   PORTE,OPTION
000AEA 010F               M                 MOVLB   HIGH PORTE
000AEC 90D8               M                 BCF     ALUSTA,C
000AEE B484               M                 BTFSC   PORTE,OPTION
000AF0 80D8               M                 BSF     ALUSTA,C
000AF2 A0D8               M                 BTFSS   ALUSTA,C
000AF4 EF?? F???          M                 GOTO    $ - D'30'
                      00185         ; Advance ADC channel
000AF8 01??           00186                 MOVLR   HIGH CXreg
000AFA 2A??           00187                 INCF    CXreg
000AFC 0E0C           00188                 MOVLW   D'12'
000AFE 64??           00189                 CPFSGT  CXreg
000B00 EF?? F???      00190                 GOTO    TestIO1
000B04 EF?? F???      00191                 GOTO    TestIOa
                      01988         Include <ADC.asm>
                      00001 ;
                      00002 ; ADC.asm
                      00003 ;
                      00004 ; This file contains routines used for ADC data processing for the MicroStar and
                      00005 ; MicroProStar applications. This file also contains a number of related routines 
                      00006 ; including the processor type detection function.
                      00007 ;
                      00008 ; Gordon Anderson
                      00009 ;
                      00010 
                      00011 ; This function displays the transmitter voltage on the first line of the LCD
                      00012 ; display. The ADC value for the display is expected to be in Vbat. This function
                      00013 ; also tests the voltage against an alarm limit, if the value is below the limit 
                      00014 ; the buzzer is used to signal an alarm.
000B08                00015 TransVoltage
                      00016         ; Display the Battery voltage
                      00017                 ; Set the print position
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 78


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

000B08 0E80           00018                 MOVLW   LINE1
000B0A EC?? F???      00019                 CALL    LCDsendCMD
                      00020                 ; Multiply the BattAlarm by 100 and place in CXreg
                      00021                 MOVE    BattAlarm,AXreg 
000B0E C??? F???          M                 MOVFF   BattAlarm,AXreg
000B12 C??? F???          M                 MOVFF   (BattAlarm+1),(AXreg+1)
000B16 6A??           00022                 CLRF    AXreg+1
                      00023                 MOVEC   D'100',BXreg
000B18 01??               M                 MOVLR   HIGH (BXreg)
000B1A 0E64               M                 MOVLW   LOW (D'100')
000B1C 6E??               M                 MOVWF   (BXreg)
000B1E 0E00               M                 MOVLW   HIGH (D'100')
000B20 6E??               M                 MOVWF   (BXreg+1)
000B22 EC?? F???      00024                 CALL    Mult1616
                      00025                 MOVE    CEXreg,CXreg            
000B26 C??? F???          M                 MOVFF   CEXreg,CXreg
000B2A C??? F???          M                 MOVFF   (CEXreg+1),(CXreg+1)
                      00026                 ; Filter the battery voltage before display
000B2E EC?? F???      00027                 CALL    TransFilter
                      00028                 MOVE    VmonG,BXreg
000B32 C??? F???          M                 MOVFF   VmonG,BXreg
000B36 C??? F???          M                 MOVFF   (VmonG+1),(BXreg+1)
000B3A EC?? F???      00029                 CALL    Mult1616
000B3E 5000           00030                 MOVFP   CEXreg+1,WREG
000B40 CFE8 F???      00031                 MOVPF   WREG,CEXreg
000B44 5000           00032                 MOVFP   CEXreg+2,WREG
000B46 CFE8 F???      00033                 MOVPF   WREG,CEXreg+1
000B4A 6A??           00034                 CLRF    CEXreg+2
                      00035         ; If this is a MicroProStar we need to add the diode voltage drop to the
                      00036         ; ADC value to improve the linearity in this conversion. The voltage is 
                      00037         ; multiplied by 100 so add 80 to represent a .8 volts diode drop.
                      00038 ifdef           MicroProStar
                      00039                 MOVLW   LOW D'80'
                      00040                 ADDWF   CEXreg,F
                      00041                 MOVLW   HIGH D'80'
                      00042                 ADDWFC  CEXreg+1,F
                      00043 endif
                      00044                 ; Test the battery voltage, if its below the limit
                      00045                 ; then beep a bunch of times
000B4C 01??           00046                 MOVLR   HIGH LValarm
000B4E B0??           00047                 BTFSC   LValarm,0
000B50 EF?? F???      00048                 GOTO    NoAlarm
000B54 01??           00049                 MOVLR   HIGH CEXreg
000B56 5000           00050                 MOVFP   CXreg,WREG
000B58 5C??           00051                 SUBWF   CEXreg,W
000B5A 5000           00052                 MOVFP   CXreg+1,WREG
000B5C 58??           00053                 SUBWFB  CEXreg+1,W
                      00054                 ; If result is negative then beep! 
000B5E AEE8           00055                 BTFSS   WREG,7
000B60 EF?? F???      00056                 GOTO    NoAlarm
                      00057                 ; Make noise!
000B64 0EC9           00058                 MOVLW   D'201'
000B66 01??           00059                 MOVLR   HIGH BeepCyl
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 79


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

000B68 6E??           00060                 MOVWF   BeepCyl
000B6A 0E05           00061                 MOVLW   D'5'
000B6C EC?? F???      00062                 CALL    Beep 
                      00063                 ; Set the alarm flag so wo do not do this again!
000B70 01??           00064                 MOVLR   HIGH LValarm
000B72 68??           00065                 SETF    LValarm
                      00066         ; Display the voltage
000B74                00067 NoAlarm         
000B74 01??           00068                 MOVLR   HIGH CEXreg
000B76 EC?? F???      00069                 CALL    Int2Str
000B7A 0E20           00070                 MOVLW   ' '
000B7C CFE8 F???      00071                 MOVPF   WREG,Areg
000B80 0E30           00072                 MOVLW   '0'
000B82 64??           00073                 CPFSGT  Buffer
000B84 C??? F???      00074                 MOVPF   Areg,Buffer
000B88 5000           00075                 MOVFP   Buffer,WREG
000B8A EC?? F???      00076                 CALL    LCDsendData
000B8E 5000           00077                 MOVFP   Buffer+1,WREG
000B90 EC?? F???      00078                 CALL    LCDsendData
000B94 0E2E           00079                 MOVLW   '.'
000B96 EC?? F???      00080                 CALL    LCDsendData
000B9A 5000           00081                 MOVFP   Buffer+2,WREG
000B9C EC?? F???      00082                 CALL    LCDsendData  
000BA0 0012           00083                 RETURN
                      00084                 
                      00085 ; This function applies a difference filter to the transmitter ADC value used
                      00086 ; to monitor the battery voltage. The filter function (time constant) is fixed
                      00087 ; and define by the constant below.
                      00088 ; The filter calculation:
                      00089 ;       Vbat * 256 = Vbat(t-1) * (256 - FilterTC) + Vbat(t) * FilterTC
                      00090 ; Vbat(t) = Vbat when called
                      00091 ; Filtered Vbat is returned in AXreg as well
  00000030            00092 FilterTC        EQU     30
000BA2                00093 TransFilter
                      00094         ; Calculate Vbat(t-1) * FilterTC
000BA2 C??? F???      00095                 MOVFF   Vbat256+1,AXreg
000BA6 C??? F???      00096                 MOVFF   Vbat256+2,AXreg+1
                      00097                 MOVEC   FilterTC,BXreg
000BAA 01??               M                 MOVLR   HIGH (BXreg)
000BAC 0E30               M                 MOVLW   LOW (FilterTC)
000BAE 6E??               M                 MOVWF   (BXreg)
000BB0 0E00               M                 MOVLW   HIGH (FilterTC)
000BB2 6E??               M                 MOVWF   (BXreg+1)
000BB4 EC?? F???      00098                 CALL    Mult1616                ; Result in CEXreg
                      00099         ; Calculate Vbat(t-1) * (256 - FilterTC), subtract CEXreg from Vbat256
000BB8 01??           00100                 MOVLB   HIGH Vbat256
000BBA C??? FFE8      00101                 MOVFF   CEXreg,WREG
000BBE 5E??           00102                 SUBWF   Vbat256,F
000BC0 C??? FFE8      00103                 MOVFF   CEXreg+1,WREG
000BC4 5A??           00104                 SUBWFB  Vbat256+1,F
000BC6 C??? FFE8      00105                 MOVFF   CEXreg+2,WREG
000BCA 5A??           00106                 SUBWFB  Vbat256+2,F
                      00107         ; Calculate Vbat(t) * FilterTC
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 80


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00108                 MOVE    Vbat,AXreg
000BCC C??? F???          M                 MOVFF   Vbat,AXreg
000BD0 C??? F???          M                 MOVFF   (Vbat+1),(AXreg+1)
                      00109                 MOVEC   FilterTC,BXreg
000BD4 01??               M                 MOVLR   HIGH (BXreg)
000BD6 0E30               M                 MOVLW   LOW (FilterTC)
000BD8 6E??               M                 MOVWF   (BXreg)
000BDA 0E00               M                 MOVLW   HIGH (FilterTC)
000BDC 6E??               M                 MOVWF   (BXreg+1)
000BDE EC?? F???      00110                 CALL    Mult1616
                      00111         ; Sum into Vbat256
000BE2 01??           00112                 MOVLB   HIGH Vbat256
000BE4 C??? FFE8      00113                 MOVFF   CEXreg,WREG
000BE8 26??           00114                 ADDWF   Vbat256,F
000BEA C??? FFE8      00115                 MOVFF   CEXreg+1,WREG
000BEE 22??           00116                 ADDWFC  Vbat256+1,F
000BF0 C??? FFE8      00117                 MOVFF   CEXreg+2,WREG
000BF4 22??           00118                 ADDWFC  Vbat256+2,F
                      00119         ; Load filtered value into AXreg and return
000BF6 C??? F???      00120                 MOVFF   Vbat256+1,AXreg
000BFA C??? F???      00121                 MOVFF   Vbat256+2,AXreg+1
000BFE 0012           00122                 RETURN
                      00123                 
                      00124 ; This function will read ADC channel 13, this is the receiver
                      00125 ; voltage monitor channel. If the value is greater than a few 
                      00126 ; counts then the data is displayed on the second line of the 
                      00127 ; display. If the receiver value is displayed then this function
                      00128 ; returns with the carry flag set.
000C00                00129 RecVoltage    
                      00130         ; Read ADC positive reference channel 
000C00 0E0D           00131                 MOVLW   ADCrec
000C02 EC?? F???      00132                 CALL    ADCread         ; Results are in Pos
000C06 0E0D           00133                 MOVLW   ADCrec
000C08 EC?? F???      00134                 CALL    ADCread         ; Results are in Pos
                      00135         ; Convert the ACD counts into the voltage
                      00136                 MOVE    Pos,AXreg
000C0C C??? F???          M                 MOVFF   Pos,AXreg
000C10 C??? F???          M                 MOVFF   (Pos+1),(AXreg+1)
                      00137                 MOVE    VRmonG,BXreg
000C14 C??? F???          M                 MOVFF   VRmonG,BXreg
000C18 C??? F???          M                 MOVFF   (VRmonG+1),(BXreg+1)
000C1C EC?? F???      00138                 CALL    Mult1616
                      00139         ; Divide the value in CEXreg by 256
000C20 01??           00140                 MOVLR   HIGH CEXreg
000C22 5000           00141                 MOVFP   CEXreg+1,WREG
000C24 6E??           00142                 MOVWF   CEXreg
000C26 5000           00143                 MOVFP   CEXreg+2,WREG
000C28 6E??           00144                 MOVWF   CEXreg+1
000C2A 5000           00145                 MOVFP   CEXreg+3,WREG
000C2C 6E??           00146                 MOVWF   CEXreg+2
000C2E 6A??           00147                 CLRF    CEXreg+3
                      00148         ; Now convert to a string...
000C30 EC?? F???      00149                 CALL    Int2Str                                  
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 81


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00150                 ; The string is in Buffer, in millivolts
                      00151         ; If the voltage is greater that 1 volt, then display it!
000C34 01??           00152                 MOVLR   HIGH Buffer
000C36 5000           00153                 MOVFP   Buffer,WREG
000C38 10??           00154                 IORWF   Buffer+1,W
000C3A 0B0F           00155                 ANDLW   0F
000C3C 90D8           00156                 BCF     ALUSTA,C
000C3E B4D8           00157                 BTFSC   ALUSTA,Z
000C40 0012           00158                 RETURN
                      00159         ; Here to display the value!
000C42 0EC0           00160                 MOVLW   LINE2
000C44 EC?? F???      00161                 CALL    LCDsendCMD
                      00162                 PrintMess MES23
000C48 0E??               M                 MOVLW   UPPER (MES23)
000C4A 6EF8               M                 MOVWF   TBLPTRU,A
000C4C 0E??               M                 MOVLW   HIGH (MES23)
000C4E 6EF7               M                 MOVWF   TBLPTRH,A
000C50 0E??               M                 MOVLW   LOW (MES23)
000C52 6EF6               M                 MOVWF   TBLPTRL,A
000C54 EC?? F???          M                 CALL    LCDsendMess
000C58 0ECB           00163                 MOVLW   LINE2 + RECVPOS
000C5A EC?? F???      00164                 CALL    LCDsendCMD
000C5E 01??           00165                 MOVLR   HIGH Buffer
000C60 5000           00166                 MOVFP   Buffer,WREG
000C62 EC?? F???      00167                 CALL    LCDsendData
000C66 5000           00168                 MOVFP   Buffer+1,WREG
000C68 EC?? F???      00169                 CALL    LCDsendData    
000C6C 0E2E           00170                 MOVLW   '.'
000C6E EC?? F???      00171                 CALL    LCDsendData
000C72 5000           00172                 MOVFP   Buffer+2,WREG
000C74 EC?? F???      00173                 CALL    LCDsendData    
000C78 5000           00174                 MOVFP   Buffer+3,WREG
000C7A EC?? F???      00175                 CALL    LCDsendData
                      00176         ; Set carry flag and exit
000C7E 80D8           00177                 BSF     ALUSTA,C
000C80 0012           00178                 RETURN
                      00179 
                      00180 ; This function reads the PIC type and set the PIC18F8723 flag if the processor is detected.
                      00181 ; This is used to determine if a 12 or 10 bit ADC is present. The 8723 has a 12 bit ADC.
000C82                00182 ProcessorType
000C82 6AE8           00183                 CLRF    WREG
000C84 CFE8 F???      00184                 MOVFF   WREG,PIC18F8723         ; Clear the flag
000C88 0E3F           00185                 MOVLW   UPPER 3FFFFF            ; Load the dievide ID address
000C8A 6EF8           00186                 MOVWF   TBLPTRU,A
000C8C 0EFF           00187                 MOVLW   HIGH 3FFFFF
000C8E 6EF7           00188                 MOVWF   TBLPTRH,A
000C90 0EFF           00189                 MOVLW   LOW 3FFFFF
000C92 6EF6           00190                 MOVWF   TBLPTRL,A
                      00191                 ; Read the device type and set the memory flag
000C94 0008           00192                 TBLRD*
000C96 50F5           00193                 MOVF    TABLAT,W,A
000C98 0A4A           00194                 XORLW   4A                      ; If 4A then its an 8723
000C9A 0EFF           00195                 MOVLW   0FF
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 82


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

000C9C B4D8           00196                 BTFSC   ALUSTA,Z
000C9E CFE8 F???      00197                 MOVFF   WREG,PIC18F8723
000CA2 0012           00198                 RETURN
                      00199 
                      00200 ; This function will read the ADC channel defined in WREG 256 times and
                      00201 ; sum the results in ADCsum.
000CA4                00202 ReadADC256
                      00203         ; First clear ADCsum
000CA4 01??           00204                 MOVLR   HIGH ADCsum
000CA6 6A??           00205                 CLRF    ADCsum
000CA8 6A??           00206                 CLRF    ADCsum+1
000CAA 6A??           00207                 CLRF    ADCsum+2
                      00208         ; Save Channel to Areg
000CAC 6E00           00209                 MOVWF   Areg,A
                      00210         ; Setup Breg as a loop counter
000CAE 6A00           00211                 CLRF    Breg,A
                      00212         ; Read the ADC
000CB0                00213 RD256a
000CB0 5000           00214                 MOVF    Areg,W,A
000CB2 EC?? F???      00215                 CALL    ADCread
                      00216         ; Sum the result
000CB6 01??           00217                 MOVLR   HIGH ADCsum
000CB8 50C3           00218                 MOVFP   ADRESL,W,A
000CBA 26??           00219                 ADDWF   ADCsum
000CBC 50C4           00220                 MOVFP   ADRESH,W,A
000CBE 22??           00221                 ADDWFC  ADCsum+1
000CC0 B0D8           00222                 BTFSC   ALUSTA,C,A
000CC2 2A??           00223                 INCF    ADCsum+2
                      00224         ; Do the loop counter test
000CC4 2E??           00225                 DECFSZ  Breg
000CC6 EF?? F???      00226                 GOTO    RD256a
000CCA 0012           00227                 RETURN
                      00228 ;
                      00229 ; This function reads data from the ADC channel defined in WREG.
                      00230 ; The results are in the ADC registers when this function returns.
                      00231 ; The results are also written to Pos.
                      00232 ; Areg will contain the channel number when this function returns
                      00233 ; as will WREG.
                      00234 ; The function ADClookup is called to translate the ADC channel number 
                      00235 ; into the value that will be used to select the ADC channel and the
                      00236 ; ADC reference. The bit use is defined below:
                      00237 ;
000CCC                00238 ADCread
                      00239         ; Save the ADC requested channel
000CCC 6E00           00240                 MOVWF   Areg,A
                      00241         ; Lookup the ADC parameters, mux channel and reference data
000CCE EC?? F???      00242                 CALL    ADClookup
                      00243         ; Test bit 4, if set this is the MPS fixed mode
000CD2 A8E8           00244                 BTFSS   WREG,4
000CD4 EF?? F???      00245                 GOTO    ADCread00
                      00246         ; Here for MPS fixed mode
000CD8 EC?? F???      00247                 CALL    ADCfixed
000CDC B0D8           00248                 BTFSC   ALUSTA,C
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 83


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

000CDE EC?? F???      00249                 CALL    ADCfixed
000CE2 C??? FFE8      00250                 MOVFF   Areg,WREG
000CE6 0012           00251                 RETURN          
                      00252         ; Here for normal mode, Perform the conversion
000CE8                00253 ADCread00
000CE8 EC?? F???      00254                 CALL    ADCreadChan
                      00255         ; Restore the requested channel
000CEC C??? FFE8      00256                 MOVFF   Areg,WREG
000CF0 0012           00257                 RETURN
                      00258 ;
                      00259 ; This function reads the ADC channel defined in the WREG reg and applies
                      00260 ; the reference voltages as defined via the flag bits.
                      00261 ; The results are in the ADC registers when this function returns.
                      00262 ; The results are also written to Pos.
                      00263 ;       WREG bit definition
                      00264 ;               0       \
                      00265 ;               1        | ADC mux channel
                      00266 ;               2        |
                      00267 ;               3       /
                      00268 ;               4       Set for the MSP glitch detection mode, this also requires the 5 Volt ref flag to
                             be set
                      00269 ;               5       for MicroProStar this is mux select
                      00270 ;               6       - ref 0=gnd, 1=ext, MicroProStar only
                      00271 ;               7       + ref 0=ext, 1=5 volts
                      00272 ;
000CF2                00273 ADCreadChan
                      00274         ; Set default reference values
000CF2 6AC1           00275                 CLRF    ADCON1,A        ; Use VDD and VSS as reference
                      00276         ; If MSB is clear then use ext ref      
000CF4 AEE8           00277                 BTFSS   WREG,7,A
000CF6 88C1           00278                 BSF     ADCON1,VCFG0,A  ; Use external reference for positive supply
000CF8 9EE8           00279                 BCF     WREG,7,A
                      00280 #ifdef MicroProStar
                      00281         ; Select the ADC MUX
                      00282                 BTFSC   WREG,6,A
                      00283                 BSF     ADCON1,VCFG1,A  ; Use external reference for negative supply
                      00284                 BTFSS   WREG,6,A
                      00285                 BCF     ADCON1,VCFG1,A  ; Use ground reference for negative supply
                      00286         ; Select the negative reference
                      00287                 BTFSC   WREG,5,A
                      00288                 BSF     MP8K_LCD,MP8K_LCD_RS,A
                      00289                 BTFSS   WREG,5,A        
                      00290                 BCF     MP8K_LCD,MP8K_LCD_RS,A
                      00291         ; Clear upper bits to maintain compatability
                      00292                 ANDLW   0x0F
                      00293 #endif
                      00294         ; Select the channel
000CFA 44E8           00295                 RLNCF   WREG,W,A
000CFC 44E8           00296                 RLNCF   WREG,W,A
000CFE 6EC2           00297                 MOVWF   ADCON0,A
                      00298         ; Setup ADC
000D00 0EA1           00299                 MOVLW   0A1             ; Right justify and 1MHz conversion clock
000D02 6EC0           00300                 MOVWF   ADCON2,A
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 84


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00301         ; Setup the loop counter
000D04 0E04           00302                 MOVLW   4
000D06 CFE8 F???      00303                 MOVFF   WREG,Creg
                      00304                 MOVEC   0,Pos
000D0A 01??               M                 MOVLR   HIGH (Pos)
000D0C 0E00               M                 MOVLW   LOW (0)
000D0E 6E??               M                 MOVWF   (Pos)
000D10 0E00               M                 MOVLW   HIGH (0)
000D12 6E??               M                 MOVWF   (Pos+1)
                      00305         ; Start the conversion
000D14                00306 ADCread1
000D14 80C2           00307                 BSF     ADCON0,ADON,A
000D16 0000           00308                 NOP                     ; delay to let the Mux settle
000D18 0000           00309                 NOP
000D1A 0000           00310                 NOP
000D1C 82C2           00311                 BSF     ADCON0,GO,A
                      00312         ; Wait for the ADC to finish
000D1E                00313 ADCread0
000D1E B2C2           00314                 BTFSC   ADCON0,DONE,A
000D20 EF?? F???      00315                 GOTO    ADCread0
                      00316         ; Sum results in Pos
000D24 01??           00317                 MOVLR   HIGH Pos
000D26 50C3           00318                 MOVF    ADRESL,W,A
000D28 26??           00319                 ADDWF   Pos,F
000D2A 50C4           00320                 MOVF    ADRESH,W,A
000D2C 22??           00321                 ADDWFC  Pos+1,F
                      00322         ; Loop till done
000D2E 01??           00323                 MOVLR   HIGH Creg
000D30 06??           00324                 DECF    Creg,F
000D32 E1??           00325                 BNZ     ADCread1
                      00326         ; Here when done, test for 8723
000D34 C??? FFE8      00327                 MOVFF   PIC18F8723,WREG
000D38 1EE8           00328                 COMF    WREG
000D3A 66E8           00329                 TSTFSZ  WREG,A
000D3C EF?? F???      00330                 GOTO    ADCread2
                      00331                 ; divide by 4   
000D40 90D8           00332                 BCF     ALUSTA,C
000D42 32??           00333                 RRCF    Pos+1
000D44 32??           00334                 RRCF    Pos
000D46 90D8           00335                 BCF     ALUSTA,C
000D48 32??           00336                 RRCF    Pos+1
000D4A 32??           00337                 RRCF    Pos
000D4C                00338 ADCread2        
                      00339         ; Make the ADC regs match Pos
000D4C C??? FFC3      00340                 MOVFF   Pos,ADRESL
000D50 C??? FFC4      00341                 MOVFF   Pos+1,ADRESH
000D54 0012           00342                 RETURN
                      00343 ;
                      00344 ; This ADC read function supports the MPS where the 5 volt reference is used to read
                      00345 ; the joystick pots. The pots are powered from the battery so the battery voltage is
                      00346 ; used to normalize the value read. The battery voltage is read before and after the
                      00347 ; channel is read and if the values are not close then carry flag is set on return.
                      00348 ;
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 85


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00349 ; Procedure:
                      00350 ;       1.) Read the battery voltage and save
                      00351 ;       2.) Read the requested channel
                      00352 ;       3.) Read the battery voltage and save
                      00353 ;       4.) If values from 1 and 3 are not close in value then there is a read error
                      00354 ;           and we need to exit with an error flag set, carry flag set on error
                      00355 ;       5.) If no error then the value = requested channel * nominal bat voltage / battery voltage
                      00356 ;
                      00357 ; Areg contains the ADC channel request
                      00358 ;
000D56                00359 ADCfixed
                      00360         ; Save AXreg and BXreg, in use in some places
                      00361                 MOVE    AXreg,AXregSave
000D56 C??? F???          M                 MOVFF   AXreg,AXregSave
000D5A C??? F???          M                 MOVFF   (AXreg+1),(AXregSave+1)
                      00362                 MOVE    BXreg,BXregSave
000D5E C??? F???          M                 MOVFF   BXreg,BXregSave
000D62 C??? F???          M                 MOVFF   (BXreg+1),(BXregSave+1)
                      00363                 MOVE32  CEXreg,CEXregSave
000D66 C??? F???          M                 MOVFF   CEXreg,CEXregSave
000D6A C??? F???          M                 MOVFF   (CEXreg+1),(CEXregSave+1)
000D6E C??? F???          M                 MOVFF   (CEXreg+2),(CEXregSave+2)
000D72 C??? F???          M                 MOVFF   (CEXreg+3),(CEXregSave+3)
                      00364         ; Read the reference
000D76 0E03           00365                 MOVLW   ADCref
000D78 EC?? F???      00366                 CALL    ADClookup
000D7C EC?? F???      00367                 CALL    ADCreadChan
                      00368                 MOVE    Pos,DEXreg
000D80 C??? F???          M                 MOVFF   Pos,DEXreg
000D84 C??? F???          M                 MOVFF   (Pos+1),(DEXreg+1)
                      00369         ; Read the requested channnel
000D88 C??? FFE8      00370                 MOVFF   Areg,WREG
000D8C EC?? F???      00371                 CALL    ADClookup
000D90 98E8           00372                 BCF     WREG,4          ; Clear the MPS fixed flag bit
000D92 EC?? F???      00373                 CALL    ADCreadChan
                      00374                 MOVE    Pos,AXreg
000D96 C??? F???          M                 MOVFF   Pos,AXreg
000D9A C??? F???          M                 MOVFF   (Pos+1),(AXreg+1)
                      00375         ; Read the reference again
000D9E 0E03           00376                 MOVLW   ADCref
000DA0 EC?? F???      00377                 CALL    ADClookup
000DA4 EC?? F???      00378                 CALL    ADCreadChan
                      00379         ; Now calculate the difference between the two ref values
                      00380         ; pos = pos - DEXref
000DA8 01??           00381                 MOVLB   HIGH Pos
000DAA C??? FFE8      00382                 MOVFF   DEXreg,WREG
000DAE 5E??           00383                 SUBWF   Pos,F
000DB0 C??? FFE8      00384                 MOVFF   DEXreg+1,WREG
000DB4 5A??           00385                 SUBWFB  Pos+1,F
                      00386         ; Get the absolute value of the difference
000DB6 AE??           00387                 BTFSS   Pos+1,7
000DB8 EF?? F???      00388                 GOTO    ADCfixed1
                      00389                 ; Here if negative so take 2s complement
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 86


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

000DBC 1E??           00390                 COMF    Pos
000DBE 1E??           00391                 COMF    Pos+1
000DC0 2A??           00392                 INCF    Pos
000DC2 B4D8           00393                 BTFSC   ALUSTA,Z
000DC4 2A??           00394                 INCF    Pos+1
                      00395         ; Now check the difference
000DC6                00396 ADCfixed1
000DC6 50??           00397                 MOVF    Pos+1,W
000DC8 A4D8           00398                 BTFSS   ALUSTA,Z
000DCA EF?? F???      00399                 GOTO    ADCfixed2       ; If the MS byte is non zero then the change is too big
000DCE 50??           00400                 MOVF    Pos,W
000DD0 01??           00401                 MOVLB   HIGH ADCfixThres
000DD2 5C??           00402                 SUBWF   ADCfixThres,W
000DD4 A0D8           00403                 BTFSS   ALUSTA,C
000DD6 EF?? F???      00404                 GOTO    ADCfixed2
                      00405         ; Here if the bat values are close and we have valid data
                      00406                 MOVEC   NOMINALBAT,BXreg
000DDA 01??               M                 MOVLR   HIGH (BXreg)
000DDC 0E00               M                 MOVLW   LOW (NOMINALBAT)
000DDE 6E??               M                 MOVWF   (BXreg)
000DE0 0E08               M                 MOVLW   HIGH (NOMINALBAT)
000DE2 6E??               M                 MOVWF   (BXreg+1)
000DE4 EC?? F???      00407                 CALL    Mult1616
000DE8 EC?? F???      00408                 CALL    Divide2416
                      00409                 MOVE    CEXreg,Pos
000DEC C??? F???          M                 MOVFF   CEXreg,Pos
000DF0 C??? F???          M                 MOVFF   (CEXreg+1),(Pos+1)
                      00410         ; Make the ADC regs match Pos
000DF4 C??? FFC3      00411                 MOVFF   Pos,ADRESL
000DF8 C??? FFC4      00412                 MOVFF   Pos+1,ADRESH
                      00413         ; Restore AXreg and BXreg
                      00414                 MOVE    AXregSave,AXreg
000DFC C??? F???          M                 MOVFF   AXregSave,AXreg
000E00 C??? F???          M                 MOVFF   (AXregSave+1),(AXreg+1)
                      00415                 MOVE    BXregSave,BXreg
000E04 C??? F???          M                 MOVFF   BXregSave,BXreg
000E08 C??? F???          M                 MOVFF   (BXregSave+1),(BXreg+1)
                      00416                 MOVE32  CEXregSave,CEXreg
000E0C C??? F???          M                 MOVFF   CEXregSave,CEXreg
000E10 C??? F???          M                 MOVFF   (CEXregSave+1),(CEXreg+1)
000E14 C??? F???          M                 MOVFF   (CEXregSave+2),(CEXreg+2)
000E18 C??? F???          M                 MOVFF   (CEXregSave+3),(CEXreg+3)
000E1C 90D8           00417                 BCF     ALUSTA,C
000E1E 0012           00418                 RETURN
                      00419         ; Here with a big bat value error and we have invalid data, calculate the result anyway
000E20                00420 ADCfixed2
                      00421                 MOVEC   NOMINALBAT,BXreg
000E20 01??               M                 MOVLR   HIGH (BXreg)
000E22 0E00               M                 MOVLW   LOW (NOMINALBAT)
000E24 6E??               M                 MOVWF   (BXreg)
000E26 0E08               M                 MOVLW   HIGH (NOMINALBAT)
000E28 6E??               M                 MOVWF   (BXreg+1)
000E2A EC?? F???      00422                 CALL    Mult1616
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 87


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

000E2E EC?? F???      00423                 CALL    Divide2416
                      00424                 MOVE    CEXreg,Pos
000E32 C??? F???          M                 MOVFF   CEXreg,Pos
000E36 C??? F???          M                 MOVFF   (CEXreg+1),(Pos+1)
                      00425         ; Make the ADC regs match Pos
000E3A C??? FFC3      00426                 MOVFF   Pos,ADRESL
000E3E C??? FFC4      00427                 MOVFF   Pos+1,ADRESH
                      00428         ; Restore AXreg and BXreg
                      00429                 MOVE    AXregSave,AXreg
000E42 C??? F???          M                 MOVFF   AXregSave,AXreg
000E46 C??? F???          M                 MOVFF   (AXregSave+1),(AXreg+1)
                      00430                 MOVE    BXregSave,BXreg 
000E4A C??? F???          M                 MOVFF   BXregSave,BXreg
000E4E C??? F???          M                 MOVFF   (BXregSave+1),(BXreg+1)
                      00431                 MOVE32  CEXregSave,CEXreg
000E52 C??? F???          M                 MOVFF   CEXregSave,CEXreg
000E56 C??? F???          M                 MOVFF   (CEXregSave+1),(CEXreg+1)
000E5A C??? F???          M                 MOVFF   (CEXregSave+2),(CEXreg+2)
000E5E C??? F???          M                 MOVFF   (CEXregSave+3),(CEXreg+3)
000E62 80D8           00432                 BSF     ALUSTA,C
000E64 0012           00433                 RETURN
                      00434         
                      01989 
                      01990 ; Timer3 init routine.
000E66                01991 Timer3Init
                      01992         ; Write initial values into data arrays
000E66 01??           01993                 MOVLR   HIGH Pstate
000E68 6A??           01994                 CLRF    Pstate
000E6A 6A??           01995                 CLRF    Secs
000E6C 6A??           01996                 CLRF    Mins
000E6E C??? FFE8      01997                 MOVFF   TicksPer,WREG
000E72 CFE8 F???      01998                 MOVPF   WREG,Tick
                      01999         ; Fill the channel times array with nominal values
                      02000                 MOVEC   D'400',Sync
000E76 01??               M                 MOVLR   HIGH (Sync)
000E78 0E90               M                 MOVLW   LOW (D'400')
000E7A 6E??               M                 MOVWF   (Sync)
000E7C 0E01               M                 MOVLW   HIGH (D'400')
000E7E 6E??               M                 MOVWF   (Sync+1)
                      02001                 MOVEC   D'400',NextTime
000E80 01??               M                 MOVLR   HIGH (NextTime)
000E82 0E90               M                 MOVLW   LOW (D'400')
000E84 6E??               M                 MOVWF   (NextTime)
000E86 0E01               M                 MOVLW   HIGH (D'400')
000E88 6E??               M                 MOVWF   (NextTime+1)
000E8A 6A??           02002                 CLRF    Psum
000E8C 6A??           02003                 CLRF    Psum+1
000E8E 0E10           02004                 MOVLW   D'16'
000E90 01??           02005                 MOVLR   HIGH Pstate
000E92 CFE8 F???      02006                 MOVPF   WREG,NumChan
000E96 6A??           02007                 CLRF    CHtimes
000E98 6A??           02008                 CLRF    CHtimes+2
000E9A 6A??           02009                 CLRF    CHtimes+4
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 88


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

000E9C 6A??           02010                 CLRF    CHtimes+6
000E9E 6A??           02011                 CLRF    CHtimes+8
000EA0 6A??           02012                 CLRF    CHtimes+D'10'
000EA2 6A??           02013                 CLRF    CHtimes+D'12'
000EA4 6A??           02014                 CLRF    CHtimes+D'14'
000EA6 6A??           02015                 CLRF    CHtimes+D'16'
000EA8 6A??           02016                 CLRF    CHtimes+D'18'
000EAA 0E08           02017                 MOVLW   8
000EAC CFE8 F???      02018                 MOVPF   WREG,CHtimes+1
000EB0 CFE8 F???      02019                 MOVPF   WREG,CHtimes+3
000EB4 CFE8 F???      02020                 MOVPF   WREG,CHtimes+5
000EB8 CFE8 F???      02021                 MOVPF   WREG,CHtimes+7
000EBC CFE8 F???      02022                 MOVPF   WREG,CHtimes+9
000EC0 CFE8 F???      02023                 MOVPF   WREG,CHtimes+D'11'
000EC4 CFE8 F???      02024                 MOVPF   WREG,CHtimes+D'13'
000EC8 CFE8 F???      02025                 MOVPF   WREG,CHtimes+D'15'
000ECC CFE8 F???      02026                 MOVPF   WREG,CHtimes+D'17'
000ED0 CFE8 F???      02027                 MOVPF   WREG,CHtimes+D'19'
                      02028         ; Output initial Mod pin state and define as ouput
                      02029 ;               BCF     DDRF,MOD,A      ; Define as output, do this after all setup is done
000ED4 8E85           02030                 BSF     PORTF,MOD,A     ; Set initial state
                      02031         ; Setup timer3 and turn on interrupts
                      02032                 ; Setup the compare register, using compare reg 2
000ED6 01??           02033                 MOVLR   HIGH Sync
000ED8 5000           02034                 MOVFP   Sync,WREG
000EDA 010F           02035                 MOVLB   HIGH CCPR2L
000EDC CFE8 FFBB      02036                 MOVPF   WREG,CCPR2L
000EE0 01??           02037                 MOVLR   HIGH (Sync + 1)
000EE2 5000           02038                 MOVFP   (Sync + 1),WREG
000EE4 010F           02039                 MOVLB   HIGH CCPR2H
000EE6 CFE8 FFBC      02040                 MOVPF   WREG,CCPR2H
000EEA 0E0A           02041                 MOVLW   0A                      ; Interrupt on conpare equal counter
                      02042                                                 ; (0B = reset timer 3)
000EEC 010F           02043                 MOVLB   HIGH CCP2CON
000EEE CFE8 FFBA      02044                 MOVPF   WREG,CCP2CON            ; Setup the condition reg
                      02045                 ; Enable the interrupt, compare reg 2. timer 3 does not
                      02046                 ; generate an interrupt
000EF2 010F           02047                 MOVLB   HIGH PIE2
000EF4 80A0           02048                 BSF     PIE2,CCP2IE
000EF6 010F           02049                 MOVLB   HIGH PIR2
000EF8 909E           02050                 BCF     PIR1,CCP2IF
                      02051                 ; Configure timer 3, sync count
000EFA 010F           02052                 MOVLB   HIGH T3CON
000EFC 0E08           02053                 MOVLW   08
000EFE CFE8 FFB1      02054                 MOVPF   WREG,T3CON
000F02 80B1           02055                 BSF     T3CON,TMR3ON
000F04 0012           02056                 RETURN
                      02057 
                      02058 ; Timer3 interrupt service routine
                      02059 ;
                      02060 ;   This function generates the PPM output signal. A state
                      02061 ;   variable Pstate controls the function. When a state ends
                      02062 ;   in an odd number then we are outputting the sync pulse.
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 89


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      02063 ;   Sync pulses have a constant width.
                      02064 ;
                      02065 ;   Timer 3 uses compare reg 2. When the compare reg matches the
                      02066 ;   counter then the counter is reset and an interrupt is generated.
                      02067 ;
000F06                02068 TIMER3ISR
                      02069         ; Output the MOD pin state if this is not futaba master mode and
                      02070         ; enabled for the student
000F06 01??           02071                 MOVLB   HIGH FutabaStudent
000F08 A0??           02072                 BTFSS   FutabaStudent,0
000F0A 7E85           02073                 BTG     PORTF,MOD,A
                      02074         ; Output the AUXOUT signal
000F0C 01??           02075                 MOVLB   HIGH AUXMODE
000F0E AE??           02076                 BTFSS   AUXMODE,7
000F10 EF?? F???      02077                 GOTO    AuxServoChanMode
000F14 7087           02078                 BTG     PORTH,AUXOUT,A
000F16 EF?? F???      02079                 GOTO    EndAuxState
000F1A                02080 AuxServoChanMode
000F1A 01??           02081                 MOVLB   HIGH AUXSTATE
000F1C B0??           02082                 BTFSC   AUXSTATE,0
000F1E EF?? F???      02083                 GOTO    AuxStateClr
000F22 8087           02084                 BSF     PORTH,AUXOUT,A
000F24 EF?? F???      02085                 GOTO    EndAuxState
000F28                02086 AuxStateClr
000F28 9087           02087                 BCF     PORTH,AUXOUT,A
000F2A                02088 EndAuxState
                      02089         ; Set the timers next compare value, sum current value with NextTime
000F2A 01??           02090                 MOVLB   HIGH NextTime
000F2C CFBB FFE8      02091                 MOVFF   CCPR2L,WREG
000F30 26??           02092                 ADDWF   NextTime
000F32 CFBC FFE8      02093                 MOVFF   CCPR2H,WREG
000F36 22??           02094                 ADDWFC  NextTime+1
                      02095 
000F38 C??? FFE8      02096                 MOVFF   NextTime,WREG
000F3C CFE8 FFBB      02097                 MOVFF   WREG,CCPR2L
                      02098 
000F40 C??? FFE8      02099                 MOVFF   (NextTime + 1),WREG
000F44 CFE8 FFBC      02100                 MOVFF   WREG,CCPR2H
                      02101         ; Advance to next state
000F48 01??           02102                 MOVLB   HIGH Pstate
000F4A 6AE8           02103                 CLRF    WREG,A
000F4C 64??           02104                 CPFSGT  Pstate
000F4E EC?? F???      02105                 CALL    RTC             ; Do the real time clock stuff.
                      02106                                         ; This happens at 40 Hz
000F52 01??           02107                 MOVLB   HIGH Pstate
000F54 2A??           02108                 INCF    Pstate
000F56 C??? FFE8      02109                 MOVFF   Pstate,WREG
000F5A 0BFE           02110                 ANDLW   0FE
000F5C 60??           02111                 CPFSLT  NumChan
000F5E EF?? F???      02112                 GOTO    TIMER3ISR0
                      02113         ; IF here reset the state to 0
000F62 6A??           02114                 CLRF    Pstate
                      02115                 ; Calculate the time to the next output sequence,
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 90


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      02116                 ; 40Hz rate
000F64 C??? FFE8      02117                 MOVFF   CycleCounts,WREG
000F68 CFE8 F???      02118                 MOVFF   WREG,NextTime
000F6C C??? FFE8      02119                 MOVFF   Psum,WREG
000F70 5E??           02120                 SUBWF   NextTime,F
000F72 C??? FFE8      02121                 MOVFF   CycleCounts+1,WREG
000F76 CFE8 F???      02122                 MOVFF   WREG,NextTime+1
000F7A C??? FFE8      02123                 MOVFF   Psum+1,WREG
000F7E 5A??           02124                 SUBWFB  NextTime+1,F
000F80 6A??           02125                 CLRF    Psum
000F82 6A??           02126                 CLRF    Psum+1
000F84 EF?? F???      02127                 GOTO    TIMER3ISR3
000F88                02128 TIMER3ISR0
                      02129         ; Test for an odd state number. If its odd then we
                      02130         ; output the sync pulse time
000F88 A0??           02131                 BTFSS   Pstate,0
000F8A EF?? F???      02132                 GOTO    TIMER3ISR1
000F8E C??? FFE8      02133                 MOVFF   Sync,WREG
000F92 CFE8 F???      02134                 MOVFF   WREG,NextTime
000F96 C??? FFE8      02135                 MOVFF   Sync+1,WREG
000F9A CFE8 F???      02136                 MOVFF   WREG,NextTime+1
                      02137         ; Test if this channel position is being output to the
                      02138         ; AUXOUT pin
000F9E C??? FFE8      02139                 MOVFF   AUXMODE,WREG
000FA2 01??           02140                 MOVLB   HIGH AUXSTATE
000FA4 80??           02141                 BSF     AUXSTATE,0
000FA6 62??           02142                 CPFSEQ  Pstate
000FA8 EF?? F???      02143                 GOTO    TIMER3ISR2
000FAC 90??           02144                 BCF     AUXSTATE,0
000FAE EF?? F???      02145                 GOTO    TIMER3ISR2
                      02146         ; Test if this is the 9th chanel, if so then send
                      02147         ; the sum divided by 16
000FB2                02148 TIMER3ISR1
                      02149 ;               MOVFP   Pstate,WREG
000FB2 0E12           02150                 MOVLW   D'18'
                      02151 ;               CPFSEQ  NumChan
000FB4 62??           02152                 CPFSEQ  Pstate                  ; This should fix the channel 9 bug
000FB6 EF?? F???      02153                 GOTO    TIMER3ISR1a
000FBA C??? FFE8      02154                 MOVFF   Psum,WREG
000FBE CFE8 F???      02155                 MOVFF   WREG,NextTime
000FC2 C??? FFE8      02156                 MOVFF   Psum+1,WREG
000FC6 CFE8 F???      02157                 MOVFF   WREG,NextTime+1
000FCA 32??           02158                 RRCF    NextTime+1,F
000FCC 32??           02159                 RRCF    NextTime,F
000FCE 32??           02160                 RRCF    NextTime+1,F
000FD0 32??           02161                 RRCF    NextTime,F
000FD2 32??           02162                 RRCF    NextTime+1,F
000FD4 32??           02163                 RRCF    NextTime,F
000FD6 32??           02164                 RRCF    NextTime+1,F
000FD8 32??           02165                 RRCF    NextTime,F
000FDA 0E0F           02166                 MOVLW   0F
000FDC 16??           02167                 ANDWF   NextTime+1,F
000FDE EF?? F???      02168                 GOTO    TIMER3ISR2
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 91


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      02169         ; Get the next state time using indirect addressing
000FE2                02170 TIMER3ISR1a
000FE2 0E??           02171                 MOVLW   HIGH ChannelOrder
000FE4 CFE8 FFEA      02172                 MOVFF   WREG,FSR0H
000FE8 0E??           02173                 MOVLW   ChannelOrder
000FEA CFE8 FFE9      02174                 MOVFF   WREG,FSR0L
000FEE C??? FFE8      02175                 MOVFF   Pstate,WREG
000FF2 30E8           02176                 RRCF    WREG,W,A
000FF4 9EE8           02177                 BCF     WREG,7,A
000FF6 04E8           02178                 DECF    WREG,W,A
000FF8 26E9           02179                 ADDWF   FSR0L,F,A
000FFA EC?? F???      02180                 CALL    SelectOutputChannel
                      02181                 ; Subtract the Sync pulse width from this time
000FFE C??? FFE8      02182                 MOVFF   Sync,WREG
001002 5E??           02183                 SUBWF   NextTime
001004 C??? FFE8      02184                 MOVFF   Sync+1,WREG
001008 5A??           02185                 SUBWFB  NextTime+1
                      02186         ; Now sum the channel times
00100A                02187 TIMER3ISR2
00100A C??? FFE8      02188                 MOVFF   NextTime,WREG
00100E 26??           02189                 ADDWF   Psum,F
001010 C??? FFE8      02190                 MOVFF   NextTime+1,WREG
001014 22??           02191                 ADDWFC  Psum+1,F
                      02192         ; Clear the interrupt bit and exit
001016                02193 TIMER3ISR3
001016 010F           02194                 MOVLB   HIGH PIR2
001018 90A1           02195                 BCF     PIR2,CCP2IF
00101A 0012           02196                 RETURN
                      02197 
                      02198 ; This function is called at 40Hz and is responsible for all
                      02199 ; time generation. Up to 10mS can be spent in this routine.
00101C                02200 RTC
                      02201         ; Call the MPS real time interrupt process code
                      02202                 ifdef   MicroProStar
                      02203                 CALL    MPSrtc
                      02204                 endif
                      02205         ; Test the USARTS
00101C EC?? F???      02206                 CALL    USART1reset
001020 EC?? F???      02207                 CALL    USART2reset
                      02208         ; Bypass the overrun test if not in the run mode
001024 01??           02209                 MOVLR   HIGH Mode
001026 0E01           02210                 MOVLW   modeRUN
001028 62??           02211                 CPFSEQ  Mode
00102A EF?? F???      02212                 GOTO    NotOverrunTest
                      02213         ; Test the OVERRUN flag if set then turn on the LED
00102E 01??           02214                 MOVLB   HIGH OVERRUN
                      02215 ifndef          MicroProStar
001030 8682           02216                 BSF     PORTC,LED1,A
001032 B0??           02217                 BTFSC   OVERRUN,0
001034 9682           02218                 BCF     PORTC,LED1,A
                      02219 endif
                      02220         ; Always set the OVERRUN flag
001036 0EFF           02221                 MOVLW   0FF
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 92


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

001038 6E??           02222                 MOVWF   OVERRUN
00103A                02223 NotOverrunTest
                      02224         ; Insure that the Mod pin is in the correct state and do not output the
                      02225         ; Mod pulse if in the Futaba mode and control is sent to student
00103A 01??           02226                 MOVLR   HIGH SHIFT
00103C BE??           02227                 BTFSC   SHIFT,7
00103E EF?? F???      02228                 GOTO    RTCx
001042 01??           02229                 MOVLB   HIGH FutabaStudent      ; added for 2.0l
001044 A0??           02230                 BTFSS   FutabaStudent,0         ; added for 2.0l
001046 9E85           02231                 BCF     PORTF,MOD,A
001048 EF?? F???      02232                 GOTO    RTCy
00104C                02233 RTCx
00104C 01??           02234                 MOVLB   HIGH FutabaStudent      ; added for 2.0l
00104E A0??           02235                 BTFSS   FutabaStudent,0         ; added for 2.0l
001050 8E85           02236                 BSF     PORTF,MOD,A
001052                02237 RTCy
                      02238         ; Test the AUXOUT mode and if we are in PPM 
                      02239         ; Version 2.0n allowed the shift level to invert.
                      02240         ; Version 2.0p has an inverted PPM output, LSB set incicates invert.
001052 01??           02241                 MOVLB   HIGH AUXMODE
001054 AE??           02242                 BTFSS   AUXMODE,7
001056 EF?? F???      02243                 GOTO    NotPPM                  ; Jump if not in PPM mode
                      02244                 ; Test LSB to see if its inverted
00105A B0??           02245                 BTFSC   AUXMODE,0
00105C EF?? F???      02246                 GOTO    AUXhi
001060 9087           02247                 BCF     PORTH,AUXOUT,A
001062 EF?? F???      02248                 GOTO    NotPPM          
001066                02249 AUXhi
001066 8087           02250                 BSF     PORTH,AUXOUT,A
001068                02251 NotPPM  
                      02252         ; End of AUXOUT processing
001068 01??           02253                 MOVLR   HIGH Tick
00106A 2E??           02254                 DECFSZ  Tick
00106C EF?? F???      02255                 GOTO    RTC1
                      02256         ; If here its time to inc the secs, here one time per second
                      02257         ; First test the down counter and dec if its not zero
001070 EC?? F???      02258                 CALL    TachRead
001074 01??           02259                 MOVLB   HIGH Cmode
001076 A0??           02260                 BTFSS   Cmode,0
001078 EF?? F???      02261                 GOTO    RTC1a
00107C 01??           02262                 MOVLB   HIGH TimerCount
00107E 0EFF           02263                 MOVLW   0FF
001080 62??           02264                 CPFSEQ  TimerCount
001082 EF?? F???      02265                 GOTO    RTC1a           ; Jump is not enabled
001086 C??? FFE8      02266                 MOVFF   Dsecs,WREG
00108A 10??           02267                 IORWF   Dmins,W
00108C B4D8           02268                 BTFSC   ALUSTA,Z,A
00108E EF?? F???      02269                 GOTO    RTC1d
                      02270         ; Dec the down counter...
001092 66??           02271                 TSTFSZ  Dsecs
001094 EF?? F???      02272                 GOTO    RTC1b
                      02273                 ; Here if Sec is zero
001098 0E3C           02274                 MOVLW   D'60'
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 93


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

00109A 6E??           02275                 MOVWF   Dsecs
00109C 06??           02276                 DECF    Dmins,F
00109E                02277 RTC1b
00109E 06??           02278                 DECF    Dsecs,F
0010A0                02279 RTC1c
0010A0 50??           02280                 MOVF    Dsecs,W
0010A2 6E??           02281                 MOVWF   DsecsLatch 
                      02282         ; If CNTmode != 0 (down) and the down count times are zero,
                      02283         ; then reset the up counters to zero
0010A4 01??           02284                 MOVLB   HIGH CNTmode
0010A6 6AE8           02285                 CLRF    WREG,A
0010A8 10??           02286                 IORWF   CNTmode,W
0010AA B4D8           02287                 BTFSC   ALUSTA,Z,A
0010AC EF?? F???      02288                 GOTO    RTC1d
0010B0 01??           02289                 MOVLB   HIGH Dsecs
0010B2 50??           02290                 MOVF    Dsecs,W
0010B4 10??           02291                 IORWF   Dmins,W
0010B6 B4D8           02292                 BTFSC   ALUSTA,Z,A
0010B8 EF?? F???      02293                 GOTO    RTC1d
0010BC 6A??           02294                 CLRF    Usecs
0010BE 6A??           02295                 CLRF    Umins   
0010C0 EF?? F???      02296                 GOTO    RTC1a           
                      02297         ; Here to inc the up counter
0010C4                02298 RTC1d
0010C4 01??           02299                 MOVLB   HIGH Usecs
0010C6 2A??           02300                 INCF    Usecs
0010C8 0E3C           02301                 MOVLW   D'60'
0010CA 62??           02302                 CPFSEQ  Usecs
0010CC EF?? F???      02303                 GOTO    RTC1a
0010D0 6A??           02304                 CLRF    Usecs
0010D2 2A??           02305                 INCF    Umins
0010D4                02306 RTC1a
0010D4 C??? FFE8      02307                 MOVFF   TicksPer,WREG
0010D8 CFE8 F???      02308                 MOVFF   WREG,Tick
0010DC 2A??           02309                 INCF    Secs
0010DE 0E3C           02310                 MOVLW   D'60'
0010E0 62??           02311                 CPFSEQ  Secs
0010E2 EF?? F???      02312                 GOTO    RTC1
                      02313         ; If here its time to inc the minutes, here one time per minute
0010E6 6A??           02314                 CLRF    Secs
0010E8 2A??           02315                 INCF    Mins
                      02316                 ; Increment the battery timer and set the flag            
0010EA 01??           02317                 MOVLB   HIGH BatteryTimer
0010EC 2A??           02318                 INCF    BatteryTimer
0010EE B4D8           02319                 BTFSC   ALUSTA,Z,A
0010F0 2A??           02320                 INCF    BatteryTimer+1
0010F2 01??           02321                 MOVLB   HIGH BTflag
0010F4 68??           02322                 SETF    BTflag                          
0010F6                02323 RTC1              
                      02324         ; Send an S to tell the Slave its ok to send!
0010F6 01??           02325                 MOVLB   HIGH Master
0010F8 A0??           02326                 BTFSS   Master,0
0010FA EF?? F???      02327                 GOTO    RTC1NotMaster
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 94


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

0010FE 0E53           02328                 MOVLW   'S'
001100 EC?? F???      02329                 CALL    USART2sendChar
                      02330                 ; Clear the MasterState variable
001104 01??           02331                 MOVLB   HIGH MasterState
001106 6A??           02332                 CLRF    MasterState
001108                02333 RTC1NotMaster
                      02334 ifdef           MicroProStar
                      02335                 MP8K_IsBusy             ; If the IO system is in use do not read the IO
                      02336                 BTFSC   ALUSTA,C
                      02337                 GOTO    RTCioBusy
                      02338                 ; Process the buzzer
                      02339                 CALL    MP8Kbuzzer
                      02340 endif
                      02341         ; Debounce port D
                      02342 ifdef           MicroProStar
                      02343                 CALL    MP8KreadD
                      02344 else
001108 CF83 FFE8      02345                 MOVFF   PORTD,WREG
                      02346 endif
00110C 01??           02347                 MOVLB   HIGH PORTDimage
00110E 1A??           02348                 XORWF   PORTDlast,F
001110 A4D8           02349                 BTFSS   ALUSTA,Z,A
001112 6E??           02350                 MOVWF   PORTDimage
001114 6E??           02351                 MOVWF   PORTDlast
001116 C??? FFE8      02352                 MOVFF   PORTDimage,WREG
00111A 12??           02353                 IORWF   PORTDlatch,F
00111C 1EE8           02354                 COMF    WREG
00111E 12??           02355                 IORWF   PORTDlatchLow,F
001120 C??? FFE8      02356                 MOVFF   PORTDlatch,WREG
001124 16??           02357                 ANDWF   PORTDlatchLow,F
                      02358         ; Debounce port E
                      02359 ifdef           MicroProStar
                      02360                 CALL    MP8KreadE
                      02361 else
001126 CF84 FFE8      02362                 MOVFF   PORTE,WREG
                      02363                 
00112A 94E8           02364                 BCF     WREG,OPTION
00112C B484           02365                 BTFSC   OPTION_BUTTON
00112E 84E8           02366                 BSF     WREG,OPTION
                      02367 endif
001130 01??           02368                 MOVLB   HIGH PORTEimage
001132 1A??           02369                 XORWF   PORTElast,F
001134 A4D8           02370                 BTFSS   ALUSTA,Z,A
001136 6E??           02371                 MOVWF   PORTEimage
001138 6E??           02372                 MOVWF   PORTElast
00113A C??? FFE8      02373                 MOVFF   PORTEimage,WREG
00113E 12??           02374                 IORWF   PORTElatch,F
001140 1EE8           02375                 COMF    WREG
001142 12??           02376                 IORWF   PORTElatchLow,F
001144 C??? FFE8      02377                 MOVFF   PORTElatch,WREG
001148 16??           02378                 ANDWF   PORTElatchLow,F
00114A                02379 RTCioBusy
                      02380         ; Test the TimeOut counters
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 95


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

00114A 01??           02381                 MOVLB   HIGH TimeOut
00114C 66??           02382                 TSTFSZ  TimeOut
00114E 06??           02383                 DECF    TimeOut
001150 66??           02384                 TSTFSZ  TimeOut1
001152 06??           02385                 DECF    TimeOut1
001154 66??           02386                 TSTFSZ  TimeOut2
001156 06??           02387                 DECF    TimeOut2
001158 66??           02388                 TSTFSZ  TimeOut3
00115A 06??           02389                 DECF    TimeOut3
00115C 66??           02390                 TSTFSZ  TimeOut4
00115E 06??           02391                 DECF    TimeOut4
001160 66??           02392                 TSTFSZ  TimeOut5
001162 06??           02393                 DECF    TimeOut5
                      02394         ; Do the buzzer stuff...
001164 66??           02395                 TSTFSZ  BeepCtr
001166 EF?? F???      02396                 GOTO    RTC2
00116A 0012           02397                 RETURN
00116C                02398 RTC2    ; Here if the buzzer is active
00116C 2E??           02399                 DECFSZ  BeepCtr
00116E 0012           02400                 RETURN
001170 7880           02401                 BTG     PORTA,BUZZER,A
001172 4E??           02402                 DCFSNZ  BeepCyl
001174 0012           02403                 RETURN
001176 C??? FFE8      02404                 MOVFF   BeepTicks,WREG
00117A CFE8 F???      02405                 MOVFF   WREG,BeepCtr
00117E 0012           02406                 RETURN
                      02407 
                      02408 ; Call this function with the number of ticks to beep in WREG
                      02409 ; BeepCly is assumed set...
001180                02410 Beep
001180 CFE8 F???      02411                 MOVFF   WREG,BeepTicks
001184 CFE8 F???      02412                 MOVFF   WREG,BeepCtr
                      02413         ; Turn it on!
001188 C??? FFE8      02414                 MOVFF   BuzPol,WREG
00118C 66E8           02415                 TSTFSZ  WREG,A
00118E EF?? F???      02416                 GOTO    BuzInvert
                      02417         ;
001192 9880           02418                 BCF     PORTA,BUZZER,A 
001194 C??? FFE8      02419                 MOVFF   Adapter,WREG
001198 66E8           02420                 TSTFSZ  WREG
00119A 7880           02421                 BTG     PORTA,BUZZER,A
                      02422 ifdef           MicroProStar
                      02423                 CALL    MP8Kbuzzer
                      02424 endif
00119C 0012           02425                 RETURN
00119E                02426 BuzInvert:
00119E 8880           02427                 BSF     PORTA,BUZZER,A 
0011A0 C??? FFE8      02428                 MOVFF   Adapter,WREG
0011A4 66E8           02429                 TSTFSZ  WREG
0011A6 7880           02430                 BTG     PORTA,BUZZER,A
                      02431 ifdef           MicroProStar
                      02432                 CALL    MP8Kbuzzer
                      02433 endif
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 96


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

0011A8 0012           02434                 RETURN
                      02435 
                      02436 
                      02437 ; This routine sends the value in Areg MSB first. The number of bits to send
                      02438 ; are defined in Breg. Both Areg and Breg are destroyed.
0011AA                02439 PLLsend
                      02440         ; Select the bank
0011AA 01??           02441                 MOVLB   HIGH Areg
                      02442         ; Set the data line
0011AC BE??           02443                 BTFSC   Areg,7
0011AE EF?? F???      02444                 GOTO    PLLsend1
0011B2 9E81           02445                 BCF     PORTB,SDObit
0011B4 EF?? F???      02446                 GOTO    PLLsend2
0011B8                02447 PLLsend1
0011B8 8E81           02448                 BSF     PORTB,SDObit
0011BA                02449 PLLsend2
                      02450         ; Pulse the clock line
0011BA 8A82           02451                 BSF     PORTC,CLK
0011BC 9A82           02452                 BCF     PORTC,CLK
                      02453         ; Loop untill finished
0011BE 46??           02454                 RLNCF   Areg
0011C0 2E??           02455                 DECFSZ  Breg
0011C2 EF?? F???      02456                 GOTO    PLLsend
0011C6 0012           02457                 RETURN
                      02458 
                      02459 ; This function powers the PLL down and shuts off the RF output stage.
0011C8                02460 PLLpowerDown               
0011C8 01??           02461                 MOVLB   HIGH PLLinitWORD
0011CA 50??           02462                 MOVF    PLLinitWORD+2,W
0011CC 6E??           02463                 MOVWF   Areg
0011CE 0E08           02464                 MOVLW   8
0011D0 6E00           02465                 MOVWF   Breg,A
0011D2 EC?? F???      02466                 CALL    PLLsend  
0011D6 01??           02467                 MOVLB   HIGH PLLinitWORD
0011D8 50??           02468                 MOVF    PLLinitWORD+1,W
0011DA 6E00           02469                 MOVWF   Areg,A
0011DC 0E08           02470                 MOVLW   8
0011DE 6E00           02471                 MOVWF   Breg,A
0011E0 EC?? F???      02472                 CALL    PLLsend 
0011E4 01??           02473                 MOVLB   HIGH PLLinitWORD
0011E6 50??           02474                 MOVF    PLLinitWORD,W
0011E8 6E00           02475                 MOVWF   Areg,A
0011EA 0E08           02476                 MOVLW   8
0011EC 6E00           02477                 MOVWF   Breg,A
0011EE EC?? F???      02478                 CALL    PLLsend
                      02479                 ; Pulse the load line
0011F2 8686           02480                 BSF     PORTG,PLLCS,A
0011F4 9686           02481                 BCF     PORTG,PLLCS,A
0011F6 0012           02482                 RETURN
                      02483 
                      02484 ; This function is used to calculate the PLL register N.
0011F8                02485 PLLCalNreg
                      02486         ; Calculate N, N=FCF/PDF
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 97


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      02487                 MOVE24  FCF,CEXreg
0011F8 C??? F???          M                 MOVFF   FCF,CEXreg
0011FC C??? F???          M                 MOVFF   (FCF+1),(CEXreg+1)
001200 C??? F???          M                 MOVFF   (FCF+2),(CEXreg+2)
                      02488                 MOVE    PDF,DEXreg
001204 C??? F???          M                 MOVFF   PDF,DEXreg
001208 C??? F???          M                 MOVFF   (PDF+1),(DEXreg+1)
00120C EC?? F???      02489                 CALL    Divide2416
                      02490         ; Add the selected channel to the result. To allow the phase lock freq
                      02491         ; to be different that the channel spacing, the variable PMUL is provided.
001210 01??           02492                 MOVLB   HIGH SelFreq
001212 50??           02493                 MOVF    SelFreq,W
001214 01??           02494                 MOVLB   HIGH PMUL
001216 02??           02495                 MULWF   PMUL
001218 50F3           02496                 MOVF    PRODL,W
00121A 01??           02497                 MOVLB   HIGH CEXreg
00121C 26??           02498                 ADDWF   CEXreg,F
00121E CFF4 FFE8      02499                 MOVFF   PRODH,WREG
001222 22??           02500                 ADDWFC  CEXreg+1,F
                      02501 ;                BTFSC   ALUSTA,C
                      02502 ;                INCF    CEXreg+1
001224 B0D8           02503                 BTFSC   ALUSTA,C
001226 2A??           02504                 INCF    CEXreg+2
                      02505          ; Now move the result to Nreg and add the control bits...
001228 01??           02506                 MOVLB   HIGH Nreg
00122A 6A??           02507                 CLRF    Nreg
00122C 6A??           02508                 CLRF    Nreg+1
00122E 6A??           02509                 CLRF    Nreg+2
001230 01??           02510                 MOVLB   HIGH CEXreg
001232 50??           02511                 MOVF    CEXreg,W
001234 46E8           02512                 RLNCF   WREG
001236 46E8           02513                 RLNCF   WREG
001238 80E8           02514                 BSF     WREG,0
00123A 92E8           02515                 BCF     WREG,1
00123C 0B1F           02516                 ANDLW   01F
00123E B6??           02517                 BTFSC   CEXreg,3
001240 8EE8           02518                 BSF     WREG,7
001242 01??           02519                 MOVLB   HIGH Nreg
001244 6E??           02520                 MOVWF   Nreg
                      02521                 ; Now the MS two bytes...
001246 01??           02522                 MOVLB   HIGH CEXreg   
001248 36??           02523                 RLCF    CEXreg+0
00124A 36??           02524                 RLCF    CEXreg+1
00124C 36??           02525                 RLCF    CEXreg+2
00124E 36??           02526                 RLCF    CEXreg+0
001250 36??           02527                 RLCF    CEXreg+1
001252 36??           02528                 RLCF    CEXreg+2
001254 36??           02529                 RLCF    CEXreg+0
001256 36??           02530                 RLCF    CEXreg+1
001258 36??           02531                 RLCF    CEXreg+2
00125A 36??           02532                 RLCF    CEXreg+0
00125C 36??           02533                 RLCF    CEXreg+1
00125E 36??           02534                 RLCF    CEXreg+2
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 98


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

001260 50??           02535                 MOVF    CEXreg+1,W
001262 01??           02536                 MOVLB   HIGH Nreg
001264 6E??           02537                 MOVWF   Nreg+1
001266 01??           02538                 MOVLB   HIGH CEXreg
001268 50??           02539                 MOVF    CEXreg+2,W
00126A 0B1F           02540                 ANDLW   01F
00126C 01??           02541                 MOVLB   HIGH Nreg
00126E 0910           02542                 IORLW   HICUR
001270 6E??           02543                 MOVWF   Nreg+2
001272 0012           02544                 RETURN
                      02545 
                      02546 ; This routine initializes the PLL. The three regs F, R, and N are downloaded to
                      02547 ; the PLL.
001274                02548 PLLsetup         
                      02549         ; Calculate the Nreg
001274 EC?? F???      02550                 CALL    PLLCalNreg
                      02551         ; F register
001278 01??           02552                 MOVLB   HIGH Freg
00127A 50??           02553                 MOVF    Freg+2,W
00127C 6E00           02554                 MOVWF   Areg,A
00127E 0E08           02555                 MOVLW   8
001280 6E00           02556                 MOVWF   Breg,A
001282 EC?? F???      02557                 CALL    PLLsend
001286 01??           02558                 MOVLB   HIGH Freg
001288 50??           02559                 MOVF    Freg+1,W
00128A 6E00           02560                 MOVWF   Areg,A
00128C 0E08           02561                 MOVLW   8
00128E 6E00           02562                 MOVWF   Breg,A
001290 EC?? F???      02563                 CALL    PLLsend
001294 01??           02564                 MOVLB   HIGH Freg
001296 50??           02565                 MOVF    Freg,W
001298 6E00           02566                 MOVWF   Areg,A
00129A 0E08           02567                 MOVLW   8
00129C 6E00           02568                 MOVWF   Breg,A
00129E EC?? F???      02569                 CALL    PLLsend
                      02570                 ; Pulse the load line
0012A2 8686           02571                 BSF     PORTG,PLLCS,A
0012A4 9686           02572                 BCF     PORTG,PLLCS,A
                      02573         ; R register
0012A6 01??           02574                 MOVLB   HIGH Rreg
0012A8 50??           02575                 MOVF    Rreg+2,W
0012AA 6E00           02576                 MOVWF   Areg,A
0012AC 0E08           02577                 MOVLW   8
0012AE 6E00           02578                 MOVWF   Breg,A
0012B0 EC?? F???      02579                 CALL    PLLsend
0012B4 01??           02580                 MOVLB   HIGH Rreg
0012B6 50??           02581                 MOVF    Rreg+1,W
0012B8 6E00           02582                 MOVWF   Areg,A
0012BA 0E08           02583                 MOVLW   8
0012BC 6E00           02584                 MOVWF   Breg,A
0012BE EC?? F???      02585                 CALL    PLLsend
0012C2 01??           02586                 MOVLB   HIGH Rreg
0012C4 50??           02587                 MOVF    Rreg,W
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 99


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

0012C6 6E00           02588                 MOVWF   Areg,A
0012C8 0E08           02589                 MOVLW   8
0012CA 6E00           02590                 MOVWF   Breg,A
0012CC EC?? F???      02591                 CALL    PLLsend
                      02592                 ; Pulse the load line
0012D0 8686           02593                 BSF     PORTG,PLLCS,A
0012D2 9686           02594                 BCF     PORTG,PLLCS,A
                      02595         ; N register
0012D4 01??           02596                 MOVLB   HIGH Nreg
0012D6 50??           02597                 MOVF    Nreg+2,W
0012D8 6E00           02598                 MOVWF   Areg,A
0012DA 0E08           02599                 MOVLW   8
0012DC 6E00           02600                 MOVWF   Breg,A
0012DE EC?? F???      02601                 CALL    PLLsend
0012E2 01??           02602                 MOVLB   HIGH Nreg
0012E4 50??           02603                 MOVF    Nreg+1,W
0012E6 6E00           02604                 MOVWF   Areg,A
0012E8 0E08           02605                 MOVLW   8
0012EA 6E00           02606                 MOVWF   Breg,A
0012EC EC?? F???      02607                 CALL    PLLsend
0012F0 01??           02608                 MOVLB   HIGH Nreg
0012F2 50??           02609                 MOVF    Nreg,W
0012F4 6E00           02610                 MOVWF   Areg,A
0012F6 0E08           02611                 MOVLW   8
0012F8 6E00           02612                 MOVWF   Breg,A
0012FA EC?? F???      02613                 CALL    PLLsend
                      02614                 ; Pulse the load line
0012FE 8686           02615                 BSF     PORTG,PLLCS,A
001300 9686           02616                 BCF     PORTG,PLLCS,A
001302 0012           02617                 RETURN
                      02618 ;
                      02619 ; This function sets up the port directions and initalizes the data variables
                      02620 ; for the PLL.     
                      02621 ; The PLL PIC reset bit is set to 0
                      02622 ;
                      02623 ; Fband:
                      02624 ;     1 = 50 MHz
                      02625 ;     2 = 53 MHz
                      02626 ;     3 = 72 MHz
                      02627 ;
001304                02628 PLLinit
                      02629         ; Set port directions and initial states
001304 010F           02630                 MOVLB   HIGH PORTB
001306 9E93           02631                 BCF     DDRB,SDObit
001308 9A94           02632                 BCF     DDRC,CLK
00130A 9C93           02633                 BCF     DDRB,PLLRST
00130C 9C81           02634                 BCF     PORTB,PLLRST
00130E 9E81           02635                 BCF     PORTB,SDObit
001310 9A82           02636                 BCF     PORTC,CLK
001312 9698           02637                 BCF     DDRG,PLLCS,A
001314 9686           02638                 BCF     PORTG,PLLCS,A
                      02639         ; Setup the PLL variables depending on the Fband value
001316 01??           02640                 MOVLB   HIGH Fband
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 100


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

001318 0E01           02641                 MOVLW   1
00131A 62??           02642                 CPFSEQ  Fband
00131C EF?? F???      02643                 GOTO    PLLinit0
                      02644         ; Here if its the 50MHz band
                      02645                 MOVE24  Freg50,Freg
001320 C??? F???          M                 MOVFF   Freg50,Freg
001324 C??? F???          M                 MOVFF   (Freg50+1),(Freg+1)
001328 C??? F???          M                 MOVFF   (Freg50+2),(Freg+2)
                      02646                 MOVE24  Rreg50,Rreg
00132C C??? F???          M                 MOVFF   Rreg50,Rreg
001330 C??? F???          M                 MOVFF   (Rreg50+1),(Rreg+1)
001334 C??? F???          M                 MOVFF   (Rreg50+2),(Rreg+2)
                      02647                 MOVEC24 D'50800',FCF
001338 01??               M                 MOVLR   HIGH (FCF)
00133A 0E70               M                 MOVLW   LOW (D'50800')
00133C 6E??               M                 MOVWF   (FCF)
00133E 0EC6               M                 MOVLW   HIGH (D'50800')
001340 6E??               M                 MOVWF   (FCF+1)
001342 0E00               M                 MOVLW   UPPER (D'50800')
001344 6E??               M                 MOVWF   (FCF+2)
                      02648                 MOVEC   D'20',PDF
001346 01??               M                 MOVLR   HIGH (PDF)
001348 0E14               M                 MOVLW   LOW (D'20')
00134A 6E??               M                 MOVWF   (PDF)
00134C 0E00               M                 MOVLW   HIGH (D'20')
00134E 6E??               M                 MOVWF   (PDF+1)
001350 01??           02649                 MOVLB   HIGH FCN   
001352 6A??           02650                 CLRF    FCN
001354 0E0A           02651                 MOVLW   D'10'
001356 6E??           02652                 MOVWF   NUMFREQ
001358 0E01           02653                 MOVLW   1
00135A 6E??           02654                 MOVWF   PMUL
00135C 0012           02655                 RETURN
00135E                02656 PLLinit0
00135E 0E02           02657                 MOVLW   2
001360 62??           02658                 CPFSEQ  Fband
001362 EF?? F???      02659                 GOTO    PLLinit1
                      02660          ; Here if its the 53MHz band
                      02661                 MOVE24  Freg53,Freg
001366 C??? F???          M                 MOVFF   Freg53,Freg
00136A C??? F???          M                 MOVFF   (Freg53+1),(Freg+1)
00136E C??? F???          M                 MOVFF   (Freg53+2),(Freg+2)
                      02662                 MOVE24  Rreg53,Rreg
001372 C??? F???          M                 MOVFF   Rreg53,Rreg
001376 C??? F???          M                 MOVFF   (Rreg53+1),(Rreg+1)
00137A C??? F???          M                 MOVFF   (Rreg53+2),(Rreg+2)
                      02663                 MOVEC24 D'53100',FCF
00137E 01??               M                 MOVLR   HIGH (FCF)
001380 0E6C               M                 MOVLW   LOW (D'53100')
001382 6E??               M                 MOVWF   (FCF)
001384 0ECF               M                 MOVLW   HIGH (D'53100')
001386 6E??               M                 MOVWF   (FCF+1)
001388 0E00               M                 MOVLW   UPPER (D'53100')
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 101


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

00138A 6E??               M                 MOVWF   (FCF+2)
                      02664                 MOVEC   D'20',PDF
00138C 01??               M                 MOVLR   HIGH (PDF)
00138E 0E14               M                 MOVLW   LOW (D'20')
001390 6E??               M                 MOVWF   (PDF)
001392 0E00               M                 MOVLW   HIGH (D'20')
001394 6E??               M                 MOVWF   (PDF+1)
001396 01??           02665                 MOVLB   HIGH FCN   
001398 6A??           02666                 CLRF    FCN
00139A 0E08           02667                 MOVLW   D'8'
00139C 6E??           02668                 MOVWF   NUMFREQ 
00139E 0E05           02669                 MOVLW   D'5'
0013A0 6E??           02670                 MOVWF   PMUL
0013A2 0012           02671                 RETURN
0013A4                02672 PLLinit1       
0013A4 0E03           02673                 MOVLW   3
0013A6 62??           02674                 CPFSEQ  Fband
0013A8 EF?? F???      02675                 GOTO    PLLinit2
                      02676          ; Here if its the 72MHz band
                      02677                 MOVE24  Freg72,Freg
0013AC C??? F???          M                 MOVFF   Freg72,Freg
0013B0 C??? F???          M                 MOVFF   (Freg72+1),(Freg+1)
0013B4 C??? F???          M                 MOVFF   (Freg72+2),(Freg+2)
                      02678                 MOVE24  Rreg72,Rreg
0013B8 C??? F???          M                 MOVFF   Rreg72,Rreg
0013BC C??? F???          M                 MOVFF   (Rreg72+1),(Rreg+1)
0013C0 C??? F???          M                 MOVFF   (Rreg72+2),(Rreg+2)
                      02679                 MOVEC24 D'72010',FCF
0013C4 01??               M                 MOVLR   HIGH (FCF)
0013C6 0E4A               M                 MOVLW   LOW (D'72010')
0013C8 6E??               M                 MOVWF   (FCF)
0013CA 0E19               M                 MOVLW   HIGH (D'72010')
0013CC 6E??               M                 MOVWF   (FCF+1)
0013CE 0E01               M                 MOVLW   UPPER (D'72010')
0013D0 6E??               M                 MOVWF   (FCF+2)
                      02680                 MOVEC   D'10',PDF
0013D2 01??               M                 MOVLR   HIGH (PDF)
0013D4 0E0A               M                 MOVLW   LOW (D'10')
0013D6 6E??               M                 MOVWF   (PDF)
0013D8 0E00               M                 MOVLW   HIGH (D'10')
0013DA 6E??               M                 MOVWF   (PDF+1)
0013DC 01??           02681                 MOVLB   HIGH FCN
0013DE 0E0B           02682                 MOVLW   D'11'   
0013E0 6E??           02683                 MOVWF   FCN
0013E2 0E32           02684                 MOVLW   D'50'
0013E4 6E??           02685                 MOVWF   NUMFREQ
0013E6 0E02           02686                 MOVLW   D'2'
0013E8 6E??           02687                 MOVWF   PMUL
0013EA 0012           02688                 RETURN         
0013EC                02689 PLLinit2
0013EC 0012           02690                 RETURN
                      02691 
                      02692 
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 102


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      02693 
                      02694 ;****** Hardware INTERRUPT 1 SERVICE HANDLER
                      02695 ;
                      02696 ; This interrupt is used to support the Futaba buddy box operation.
                      02697 ; The ppm signal from a futaba encoder is assumed to be connected to
                      02698 ; the INT1 pin of the CPU.
                      02699 ; This pin is also used for the Tach. The blade detector in the tach
                      02700 ; module is connected to this pin. If the tach is enabled then this
                      02701 ; routine will count prop revolutions.
                      02702 ;
0013EE                02703 INT1ISR
                      02704    ; Test for for the tach module
                      02705 ifdef   NOTACHENA
                      02706                 GOTO    NoTach
                      02707 endif
0013EE B287           02708                 BTFSC   PORTH,TACHENA,A
0013F0 EF?? F???      02709                 GOTO    NoTach
                      02710    ; Here if tach module is present
                      02711         ; If timer 0 is enabled then save its value and advance blade counter
0013F4 AED5           02712                 BTFSS   T0CON,TMR0ON,A
0013F6 EF?? F???      02713                 GOTO    TimerOff
0013FA CFD6 F???      02714                 MOVFF   TMR0L,BladeTime
0013FE CFD7 F???      02715                 MOVFF   TMR0H,BladeTime+1       ; Save blade time count
001402 01??           02716                 MOVLB   HIGH  BladeDet
001404 2A??           02717                 INCF    BladeDet                ; Advance blade detector count
001406 B4D8           02718                 BTFSC   ALUSTA,Z
001408 2A??           02719                 INCF    BladeDet+1
00140A 90F0           02720                 BCF     INTCON3,INT1IF,A
00140C 0012           02721                 RETURN
                      02722         ; If timer 0 is disabled and blade counter is 0 then enable counter
00140E                02723 TimerOff        
00140E 01??           02724                 MOVLB   HIGH  BladeDet
001410 50??           02725                 MOVF    BladeDet,W
001412 10??           02726                 IORWF   BladeDet+1,W
001414 90F0           02727                 BCF     INTCON3,INT1IF,A
001416 A4D8           02728                 BTFSS   ALUSTA,Z
001418 0012           02729                 RETURN                          ; If blade count is non zero, exit
                      02730                 ; Enable counter
00141A 6AE8           02731                 CLRF    WREG
00141C CFE8 FFD7      02732                 MOVFF   WREG,TMR0H
001420 CFE8 FFD6      02733                 MOVFF   WREG,TMR0L
001424 8ED5           02734                 BSF     T0CON,TMR0ON,A
001426 90F0           02735                 BCF     INTCON3,INT1IF,A
001428 0012           02736                 RETURN  
                      02737    ; Here if no tach module has been detected
00142A                02738 NoTach
                      02739         ; Toggle the edge trigger and read status
00142A 7AF1           02740                 BTG     INTCON2,INTEDG1,A
                      02741         ; If the Auto Trim button is not pressed then exit. This state is indicated
                      02742         ; by INT1 being low prority
00142C ACF0           02743                 BTFSS   INTCON3,INT1IP,A        ; If INT1 is set to low priority then exit
00142E EF?? F???      02744                 GOTO    INT1ISR_EXIT            
                      02745         ; Test the SHIFT value 
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 103


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

001432 01??           02746                 MOVLB   HIGH SHIFT
001434 A0??           02747                 BTFSS   SHIFT,0
001436 EF?? F???      02748                 GOTO    ACESHIFT
                      02749         ; Here for normal shift 
00143A AAF1           02750                 BTFSS   INTCON2,INTEDG1,A
00143C 8E85           02751                 BSF     PORTF,MOD,A             ; Reversed for 2.0l
00143E BAF1           02752                 BTFSC   INTCON2,INTEDG1,A
001440 9E85           02753                 BCF     PORTF,MOD,A
001442 EF?? F???      02754                 GOTO    INT1ISR_EXIT
001446                02755 ACESHIFT                       
                      02756         ; Here for ACE shift
001446 AAF1           02757                 BTFSS   INTCON2,INTEDG1,A
001448 9E85           02758                 BCF     PORTF,MOD,A
00144A BAF1           02759                 BTFSC   INTCON2,INTEDG1,A
00144C 8E85           02760                 BSF     PORTF,MOD,A
                      02761         ; Exit
00144E                02762 INT1ISR_EXIT    
00144E 90F0           02763                 BCF     INTCON3,INT1IF,A
001450 0012           02764                 RETURN
                      02765 
                      02766 
                      02767 
                      02768 ;
                      02769 ; Delay subroutine. Delay = 2uS * WREG value
                      02770 ;
001452                02771 Delay2uS
001452 0000           02772                 NOP
001454 2EE8           02773                 DECFSZ  WREG
001456 EF?? F???      02774                 GOTO    Delay2uS
00145A 0012           02775                 RETURN
                      02776 
                      02777 ;
                      02778 ; Delay subroutine. Delay = 1mS * Areg value
                      02779 ;
00145C                02780 Delay1mS
00145C 6E??           02781                 MOVWF   Areg
00145E                02782 Delay1mS0
00145E 0EFA           02783                 MOVLW   D'250'
001460 EC?? F???      02784                 CALL    Delay2uS
001464 0EFA           02785                 MOVLW   D'250'
001466 EC?? F???      02786                 CALL    Delay2uS
00146A 2E??           02787                 DECFSZ  Areg
00146C EF?? F???      02788                 GOTO    Delay1mS0
001470 0012           02789                 RETURN
                      02790 
                      02791                 Include <EEPROM.asm>
                      00001 ;=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
                      00002 ;
                      00003 ; EEPROM read/write functions
                      00004 ;
                      00005 ;=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
                      00006 
                      00007 ; This function reads 256 bytes from the EEPROM and fills RAM page
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 104


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00008 ; 5 with its contents. The EEPROM holds configureation data as well
                      00009 ; as the Transmitter on time parameter
001472                00010 EEPROMread
                      00011         ; Setup pointer to RAM
001472 0E05           00012                 MOVLW   5
001474 6EE2           00013                 MOVWF   FSR1H,A
001476 6AE8           00014                 CLRF    WREG
001478 6EE1           00015                 MOVWF   FSR1L,A
                      00016         ; EEPROM address setup
00147A 6AE8           00017                 CLRF    WREG            ; EEPROM high address high address
00147C 6EAA           00018                 MOVWF   EEADRH,A        ; Upper bits of Data Memory Address to read
00147E 6AE8           00019                 CLRF    WREG    ;
001480 6EA9           00020                 MOVWF   EEADR,A         ; Lower bits of Data Memory Address to read
001482                00021 EEPROMnext
001482 9EA6           00022                 BCF     EECON1, EEPGD,A ; Point to DATA memory
001484 9CA6           00023                 BCF     EECON1, CFGS,A  ; Access EEPROM
001486 80A6           00024                 BSF     EECON1, RD,A    ; EEPROM Read
001488 50A8           00025                 MOVF    EEDATA, W,A     ; W = EEDATA
                      00026                 ; Save results in RAM
00148A 6EE6           00027                 MOVWF   POSTINC1,A              
                      00028                 ; Advanced through full page
00148C 2AA9           00029                 INCF    EEADR,F,A
00148E E1??           00030                 BNZ     EEPROMnext
001490 0012           00031                 RETURN
                      00032 
                      00033 ; This function reads a block of data from the EEPROM to memory. The low
                      00034 ; address of EEPROM and RAM are assumed the same so this only works for
                      00035 ; the first 256 byts of the EEPROM.
                      00036 ; 
                      00037 ; On call
                      00038 ;       AXreg = pointer to RAM memory
                      00039 ;       Areg  = block size in bytes
001492                00040 EEPROMreadBlock
                      00041         ; Setup pointer to RAM
001492 C??? FFE8      00042                 MOVFF   AXreg+1,WREG
001496 6EE2           00043                 MOVWF   FSR1H,A
001498 C??? FFE8      00044                 MOVFF   AXreg,WREG
00149C 6EE1           00045                 MOVWF   FSR1L,A
                      00046         ; EEPROM address setup
00149E 6AE8           00047                 CLRF    WREG            ; EEPROM high address high address
0014A0 6EAA           00048                 MOVWF   EEADRH,A        ; Upper bits of Data Memory Address to read
0014A2 C??? FFE8      00049                 MOVFF   AXreg,WREG
0014A6 6EA9           00050                 MOVWF   EEADR,A         ; Lower bits of Data Memory Address to read
0014A8                00051 EEPROMnextRB
0014A8 9EA6           00052                 BCF     EECON1, EEPGD,A ; Point to DATA memory
0014AA 9CA6           00053                 BCF     EECON1, CFGS,A  ; Access EEPROM
0014AC 80A6           00054                 BSF     EECON1, RD,A    ; EEPROM Read
0014AE 50A8           00055                 MOVF    EEDATA, W,A     ; W = EEDATA
                      00056                 ; Save results in RAM
0014B0 6EE6           00057                 MOVWF   POSTINC1,A              
                      00058                 ; Advanced through full page
0014B2 2AA9           00059                 INCF    EEADR,F,A
0014B4 0600           00060                 DECF    Areg,F,A
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 105


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

0014B6 E1??           00061                 BNZ     EEPROMnextRB
0014B8 0012           00062                 RETURN
                      00063 
                      00064 
                      00065 ; This function reads a byte from EEPROM.
                      00066 ;
                      00067 ;       AXreg = EEPROM address
                      00068 ;       WREG = data byte read from EEPROM
0014BA                00069 EEPROMreadByte
0014BA C??? FFE8      00070                 MOVFF   AXreg+1,WREG    ;
0014BE 6EAA           00071                 MOVWF   EEADRH,A        ; Upper bits of Data Memory Address to read
0014C0 C??? FFE8      00072                 MOVFF   AXreg,WREG      ;
0014C4 6EA9           00073                 MOVWF   EEADR,A         ; Lower bits of Data Memory Address to read
0014C6 9EA6           00074                 BCF     EECON1, EEPGD,A ; Point to DATA memory
0014C8 9CA6           00075                 BCF     EECON1, CFGS,A  ; Access EEPROM
0014CA 80A6           00076                 BSF     EECON1, RD,A    ; EEPROM Read
0014CC 50A8           00077                 MOVF    EEDATA, W,A     ; W = EEDATA
0014CE 0012           00078                 RETURN
                      00079                 
                      00080 ; This function writes a byte to EEPROM.
                      00081 ;
                      00082 ;       AXreg = EEPROM address
                      00083 ;       WREG = data byte to write to EEPROM
0014D0                00084 EEPROMwriteByte
                      00085         ; Write the byte
0014D0 98A1           00086                 BCF     PIR2,EEIF,A
0014D2 6EA8           00087                 MOVWF   EEDATA,A        ; Data Memory Value to write
0014D4 C??? FFE8      00088                 MOVFF   AXreg+1,WREG    ;
0014D8 6EAA           00089                 MOVWF   EEADRH,A        ; Upper bits of Data Memory Address to write
0014DA C??? FFE8      00090                 MOVFF   AXreg,WREG      ;
0014DE 6EA9           00091                 MOVWF   EEADR,A         ; Lower bits of Data Memory Address to write
0014E0 9EA6           00092                 BCF     EECON1, EEPGD,A ; Point to DATA memory
0014E2 9CA6           00093                 BCF     EECON1, CFGS,A  ; Access EEPROM
0014E4 84A6           00094                 BSF     EECON1, WREN,A  ; Enable writes
0014E6 9EF2           00095                 BCF     INTCON, GIE,A   ; Disable Interrupts
0014E8 0E55           00096                 MOVLW   55h             ;
0014EA 6EA7           00097                 MOVWF   EECON2,A        ; Write 55h
0014EC 0EAA           00098                 MOVLW   0AAh            ;
0014EE 6EA7           00099                 MOVWF   EECON2,A        ; Write 0AAh
0014F0 82A6           00100                 BSF     EECON1, WR,A    ; Set WR bit to begin write
0014F2 8EF2           00101                 BSF     INTCON, GIE,A   ; Enable Interrupts
                      00102         ; Wait for EEIF bit to set
0014F4                00103 EEPROMwriteByteWait
0014F4 A8A1           00104                 BTFSS   PIR2,EEIF,A
0014F6 EF?? F???      00105                 GOTO    EEPROMwriteByteWait
0014FA 98A1           00106                 BCF     PIR2,EEIF,A
0014FC 0012           00107                 RETURN
                      00108 
                      00109 ; This function writes a word to EEPROM.
                      00110 ;
                      00111 ;       AXreg = EEPROM address
                      00112 ;       BXreg = data word to write to EEPROM
0014FE                00113 EEPROMwriteWord
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 106


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00114         ; Write first byte
0014FE C??? FFE8      00115                 MOVFF   BXreg,WREG
001502 EC?? F???      00116                 CALL    EEPROMwriteByte
                      00117         ; Advance the address and write second byte
001506 01??           00118                 MOVLR   HIGH AXreg
001508 2A??           00119                 INCF    AXreg
00150A B4D8           00120                 BTFSC   ALUSTA,Z
00150C 2A??           00121                 INCF    AXreg+1
00150E C??? FFE8      00122                 MOVFF   BXreg+1,WREG
001512 EC?? F???      00123                 CALL    EEPROMwriteByte
001516 0012           00124                 RETURN
                      00125 
                      00126 ; This function writes a block of data from memory to EEPROM. The low
                      00127 ; address of EEPROM and RAM are assumed the same so this only works for
                      00128 ; the first 256 byts of the EEPROM.
                      00129 ; 
                      00130 ; On call
                      00131 ;       AXreg = pointer to RAM memory
                      00132 ;       Areg  = block size in bytes
001518                00133 EEPROMwriteBlock
                      00134         ; Setup pointer to RAM
001518 C??? FFE8      00135                 MOVFF   AXreg+1,WREG
00151C 6EE2           00136                 MOVWF   FSR1H,A
00151E C??? FFE8      00137                 MOVFF   AXreg,WREG
001522 6EE1           00138                 MOVWF   FSR1L,A
                      00139         ; EEPROM address setup
001524 6AE8           00140                 CLRF    WREG            ; EEPROM high address high address
001526 6EAA           00141                 MOVWF   EEADRH,A        ; Upper bits of Data Memory Address to read
001528 C??? FFE8      00142                 MOVFF   AXreg,WREG
00152C 6EA9           00143                 MOVWF   EEADR,A         ; Lower bits of Data Memory Address to read
00152E 98A1           00144                 BCF     PIR2,EEIF,A
001530                00145 EEPROMnextWB
                      00146         ; Write the byte
001530 50E6           00147                 MOVF    POSTINC1,W,A
001532 6EA8           00148                 MOVWF   EEDATA,A        ; Byte to write
001534 9EA6           00149                 BCF     EECON1, EEPGD,A ; Point to DATA memory
001536 9CA6           00150                 BCF     EECON1, CFGS,A  ; Access EEPROM
001538 84A6           00151                 BSF     EECON1, WREN,A  ; Enable writes
00153A 9EF2           00152                 BCF     INTCON, GIE,A   ; Disable Interrupts
00153C 0E55           00153                 MOVLW   55h             ;
00153E 6EA7           00154                 MOVWF   EECON2,A        ; Write 55h
001540 0EAA           00155                 MOVLW   0AAh            ;
001542 6EA7           00156                 MOVWF   EECON2,A        ; Write 0AAh
001544 82A6           00157                 BSF     EECON1, WR,A    ; Set WR bit to begin write
001546 8EF2           00158                 BSF     INTCON, GIE,A   ; Enable Interrupts
                      00159         ; Wait for EEIF bit to set
001548                00160 EEPROMwriteBWait
001548 A8A1           00161                 BTFSS   PIR2,EEIF,A
00154A EF?? F???      00162                 GOTO    EEPROMwriteBWait
00154E 98A1           00163                 BCF     PIR2,EEIF,A
                      00164         ; Advanced through the block
001550 2AA9           00165                 INCF    EEADR,F,A
001552 0600           00166                 DECF    Areg,F,A
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 107


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

001554 E1??           00167                 BNZ     EEPROMnextWB
001556 0012           00168                 RETURN
                      00169 
                      02792                 Include <Flash.asm>
                      00001 ;=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
                      00002 ;
                      00003 ; Flash configuration storage routines
                      00004 ;
                      00005 ;=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
                      00006 ; This function will format the Flash configuration memory.
                      00007 ; The default data is used for this format opertion.
001558                00008 FormatFlash
                      00009                 SingleLine
                      00010                 ShowLine1
001558 0E80           00011                 MOVLW   LINE1
00155A EC?? F???      00012                 CALL    LCDsendCMD
                      00013         ; display the accept message
                      00014                 ; Display format message
                      00015                 PrintMess MES17
00155E 0E??               M                 MOVLW   UPPER (MES17)
001560 6EF8               M                 MOVWF   TBLPTRU,A
001562 0E??               M                 MOVLW   HIGH (MES17)
001564 6EF7               M                 MOVWF   TBLPTRH,A
001566 0E??               M                 MOVLW   LOW (MES17)
001568 6EF6               M                 MOVWF   TBLPTRL,A
00156A EC?? F???          M                 CALL    LCDsendMess
                      00016         ; Make sure the pilot is ok with this!
00156E 0EFA           00017                 MOVLW   D'250'
001570 EC?? F???      00018                 CALL    Delay1mS
                      00019                 ShowLine2
001574 0EC0           00020                 MOVLW   LINE2
001576 EC?? F???      00021                 CALL    LCDsendCMD
                      00022                 PrintMess MES7
00157A 0E??               M                 MOVLW   UPPER (MES7)
00157C 6EF8               M                 MOVWF   TBLPTRU,A
00157E 0E??               M                 MOVLW   HIGH (MES7)
001580 6EF7               M                 MOVWF   TBLPTRH,A
001582 0E??               M                 MOVLW   LOW (MES7)
001584 6EF6               M                 MOVWF   TBLPTRL,A
001586 EC?? F???          M                 CALL    LCDsendMess
00158A EC?? F???      00023                 CALL    YesNo
00158E A0D8           00024                 BTFSS   ALUSTA,C
001590 0012           00025                 RETURN                  ; GOTO  FSexit
                      00026         ; Display the formating message
001592 0EC0           00027                 MOVLW   LINE2
001594 EC?? F???      00028                 CALL    LCDsendCMD
                      00029                 PrintMess MES19
001598 0E??               M                 MOVLW   UPPER (MES19)
00159A 6EF8               M                 MOVWF   TBLPTRU,A
00159C 0E??               M                 MOVLW   HIGH (MES19)
00159E 6EF7               M                 MOVWF   TBLPTRH,A
0015A0 0E??               M                 MOVLW   LOW (MES19)
0015A2 6EF6               M                 MOVWF   TBLPTRL,A
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 108


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

0015A4 EC?? F???          M                 CALL    LCDsendMess
                      00030 ifdef           MicroProStar
                      00031         ; If this is the MicroProStar then display on both lines to make sure it shows!
                      00032                 MOVLW   LINE1
                      00033                 CALL    LCDsendCMD
                      00034                 PrintMess MES19
                      00035 endif
                      00036         ; Here if its OK to format, Load the default parameters
0015A8 EC?? F???      00037                 CALL    LoadDefaults
0015AC EC?? F???      00038                 CALL    SaveGeneral
                      00039         ; Setup loop counter to format all aircraft setups
0015B0 01??           00040                 MOVLB   HIGH Dtemp
0015B2 0E60           00041                 MOVLW   NumAircraft
0015B4 6E??           00042                 MOVWF   Dtemp
0015B6                00043 FS03
0015B6 C??? FFE8      00044                 MOVFF   Aircraft,WREG   ; Load aircraft number
0015BA EC?? F???      00045                 CALL    SaveAircraft
0015BE 01??           00046                 MOVLB   HIGH Aircraft
0015C0 2A??           00047                 INCF    Aircraft        ; Next Aircraft
                      00048                 ; Now advance the generic aircraft name's, "MODEL XX"
0015C2 01??           00049                 MOVLB   HIGH Name
0015C4 2A??           00050                 INCF    Name+7
                      00051                 ; Look to see if it's greater that '9', 3A
0015C6 0E3A           00052                 MOVLW   3A
0015C8 62??           00053                 CPFSEQ  Name+7
0015CA EF?? F???      00054                 GOTO    FS04
                      00055                 ; Now advance Name+6 and set Name+7 to '0'
0015CE 2A??           00056                 INCF    Name+6
0015D0 0E30           00057                 MOVLW   30
0015D2 6E??           00058                 MOVWF   Name+7
                      00059         ; Loop till finished....
0015D4                00060 FS04
0015D4 01??           00061                 MOVLB   HIGH Dtemp
0015D6 2E??           00062                 DECFSZ  Dtemp
0015D8 EF?? F???      00063                 GOTO    FS03
                      00064         ; Here when we are finished, Reload the setup information
0015DC                00065 FSexit
0015DC EC?? F???      00066                 CALL    LoadGeneral
0015E0 C??? FFE8      00067                 MOVFF   Aircraft,WREG
0015E4 EC?? F???      00068                 CALL    LoadAircraft
                      00069                 ShowLine1
0015E8 0012           00070                 RETURN
                      00071 
                      00072 ;
                      00073 ; This function will write variables to all aircraft settings memory.
                      00074 ; This is used to allow a pilot to apply an edited parameter to all
                      00075 ; aircraft. This function assumes that the bytes to be changed are all
                      00076 ; contained with in one 64 byte block. This is not error checked and
                      00077 ; assumed that the caller has checked this constraint.
                      00078 ;
                      00079 ; The following registeres are used:
                      00080 ;
                      00081 ;       Src     = Address of source data
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 109


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00082 ;       Cnt     = Number of bytes to update
                      00083 ;       BlkBuf  = 64 byte buffer used to hole each flash block
                      00084 ;
0015EA                00085 FlashAllAircraft
                      00086         ; Exit if the source address is not on RAM page 3 or 4
0015EA 01??           00087                 MOVLR   HIGH Src
0015EC 0E03           00088                 MOVLW   3
0015EE 18??           00089                 XORWF   Src+1,W
0015F0 B4D8           00090                 BTFSC   ALUSTA,Z
0015F2 EF?? F???      00091                 GOTO    AddressOK
0015F6 0E04           00092                 MOVLW   4
0015F8 18??           00093                 XORWF   Src+1,W
0015FA A4D8           00094                 BTFSS   ALUSTA,Z
0015FC 0012           00095                 RETURN
                      00096         ; Setup loop counter
0015FE                00097 AddressOK
0015FE 0E60           00098                 MOVLW   NumAircraft
001600 CFE8 F???      00099                 MOVFF   WREG,Creg
                      00100         ; Define the destination address
001604 01??           00101                 MOVLR   HIGH Dst
001606 6A??           00102                 CLRF    Dst+1
001608 50??           00103                 MOVF    Src,W
00160A 0B3F           00104                 ANDLW   0x3F            ; The 64 lower bits of the address
00160C 0F??           00105                 ADDLW   LOW BlkBuf
00160E 6E??           00106                 MOVWF   Dst
001610 0E??           00107                 MOVLW   HIGH BlkBuf
001612 22??           00108                 ADDWFC  Dst+1,F
                      00109         ; Define the Flash memory address, place in CEXreg
                      00110                 MOVE    Src,CEXreg
001614 C??? F???          M                 MOVFF   Src,CEXreg
001618 C??? F???          M                 MOVFF   (Src+1),(CEXreg+1)
00161C 6A??           00111                 CLRF    CEXreg+2
00161E 0EC0           00112                 MOVLW   0xC0
001620 16??           00113                 ANDWF   CEXreg,F
001622 0E03           00114                 MOVLW   3
001624 5E??           00115                 SUBWF   CEXreg+1,F
001626 0E00           00116                 MOVLW   LOW CFGaircraft
001628 26??           00117                 ADDWF   CEXreg,F
00162A 0E01           00118                 MOVLW   HIGH CFGaircraft
00162C 22??           00119                 ADDWFC  CEXreg+1,F
00162E 0E01           00120                 MOVLW   UPPER CFGaircraft
001630 22??           00121                 ADDWFC  CEXreg+2,F
                      00122         ; Read the 64 byte block from Flash to the ram buffer
001632                00123 FlashAllAircraftNext
                      00124                 MOVEC   BlkBuf,AXreg
001632 01??               M                 MOVLR   HIGH (AXreg)
001634 0E??               M                 MOVLW   LOW (BlkBuf)
001636 6E??               M                 MOVWF   (AXreg)
001638 0E??               M                 MOVLW   HIGH (BlkBuf)
00163A 6E??               M                 MOVWF   (AXreg+1)
00163C 0E40           00125                 MOVLW   D'64'
00163E CFE8 F???      00126                 MOVFF   WREG,Areg
001642 EC?? F???      00127                 CALL    FlashRead
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 110


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00128         ; Erase the 64 byte Flash block
001646 0E01           00129                 MOVLW   1
001648 CFE8 F???      00130                 MOVFF   WREG,Areg
00164C EC?? F???      00131                 CALL    FlashErase
                      00132         ; Write the new data to the ram buffer
001650 C??? F???      00133                 MOVFF   Cnt,Areg
001654 EC?? F???      00134                 CALL    BlkMove
001658 C??? F???      00135                 MOVFF   Areg,Cnt
                      00136         ; Write the data back to flash
                      00137                 MOVEC   BlkBuf,AXreg
00165C 01??               M                 MOVLR   HIGH (AXreg)
00165E 0E??               M                 MOVLW   LOW (BlkBuf)
001660 6E??               M                 MOVWF   (AXreg)
001662 0E??               M                 MOVLW   HIGH (BlkBuf)
001664 6E??               M                 MOVWF   (AXreg+1)
001666 0E01           00138                 MOVLW   1
001668 CFE8 F???      00139                 MOVFF   WREG,Areg
00166C EC?? F???      00140                 CALL    FlashWrite
                      00141         ; Advance the aircraft config memory pointer, advance by 512 
001670 01??           00142                 MOVLR   HIGH CEXreg
001672 0E02           00143                 MOVLW   2
001674 26??           00144                 ADDWF   CEXreg+1,F
001676 B4D8           00145                 BTFSC   ALUSTA,Z
001678 2A??           00146                 INCF    CEXreg+2,F
                      00147         ; Loop through all aircraft
00167A 2E00           00148                 DECFSZ  Creg,F,A
00167C EF?? F???      00149                 GOTO    FlashAllAircraftNext
001680 0012           00150                 RETURN
                      00151 
                      00152 ; This function will read data from flash memory and save it
                      00153 ; at the address in reg AXreg.  The following registers are 
                      00154 ; assumed defined when this call is made:
                      00155 ;
                      00156 ;       AXreg  = Destination address in ram
                      00157 ;       CEXreg = Flash memory address 
                      00158 ;       Areg   = Number of bytes to read
                      00159 ;
001682                00160 FlashRead
                      00161         ; Set table pointer with Flash program memory address
001682 01??           00162                 MOVLR   HIGH CEXreg
001684 50??           00163                 MOVFP   CEXreg+2,W
001686 6EF8           00164                 MOVWF   TBLPTRU,A
001688 50??           00165                 MOVFP   CEXreg+1,W
00168A 6EF7           00166                 MOVWF   TBLPTRH,A
00168C 50??           00167                 MOVFP   CEXreg,W
00168E 6EF6           00168                 MOVWF   TBLPTRL,A
                      00169         ; Setup indirection regs
001690 01??           00170                 MOVLR   HIGH AXreg
001692 50??           00171                 MOVFP   AXreg+1,W
001694 6EE2           00172                 MOVWF   FSR1H,A
001696 50??           00173                 MOVFP   AXreg,W
001698 6EE1           00174                 MOVWF   FSR1L,A
00169A                00175 FlashRead1
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 111


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

00169A 0009           00176                 TBLRD*+
00169C 50F5           00177                 MOVF    TABLAT,W
00169E 6EE6           00178                 MOVWF   POSTINC1
0016A0 06??           00179                 DECF    Areg
0016A2 0009           00180                 TBLRD*+
0016A4 50F5           00181                 MOVF    TABLAT,W
0016A6 6EE6           00182                 MOVWF   POSTINC1
0016A8 2E??           00183                 DECFSZ  Areg
0016AA EF?? F???      00184                 GOTO    FlashRead1
0016AE 0012           00185                 RETURN
                      00186 
                      00187 
                      00188 ; This function will erase 64 byte blocks of Flash program memory. 
                      00189 ; The following registers are defined when this function
                      00190 ; is called:
                      00191 ;
                      00192 ;       CEXreg = Flash memory address, pointer to first block 
                      00193 ;       Areg   = Number of 64 byte blocks to erase
0016B0                00194 FlashErase
                      00195         ; Load the pointer to flash block to erase
0016B0 01??           00196                 MOVLR   HIGH CEXreg
0016B2 50??           00197                 MOVFP   CEXreg+2,W
0016B4 6EF8           00198                 MOVWF   TBLPTRU,A
0016B6 50??           00199                 MOVFP   CEXreg+1,W
0016B8 6EF7           00200                 MOVWF   TBLPTRH,A
0016BA 50??           00201                 MOVFP   CEXreg,W
0016BC 6EF6           00202                 MOVWF   TBLPTRL,A
                      00203         ; Erase this block
0016BE 8EA6           00204                 BSF     EECON1, EEPGD,A ; point to Flash program memory
0016C0 9CA6           00205                 BCF     EECON1, CFGS,A  ; access Flash program memory
0016C2 84A6           00206                 BSF     EECON1, WREN,A  ; enable write to memory
0016C4 88A6           00207                 BSF     EECON1, FREE,A  ; enable Row Erase operation
0016C6 9EF2           00208                 BCF     INTCON, GIE,A   ; disable interrupts
0016C8 0E55           00209                 MOVLW   55h
0016CA 6EA7           00210                 MOVWF   EECON2,A        ; write 55h
0016CC 0EAA           00211                 MOVLW   0AAh
0016CE 6EA7           00212                 MOVWF   EECON2,A        ; write 0AAh
0016D0 82A6           00213                 BSF     EECON1, WR,A    ; start erase (CPU stall)
0016D2 0000           00214                 NOP
0016D4 8EF2           00215                 BSF     INTCON, GIE,A   ; re-enable interrupts
                      00216         ; Exit on last block
0016D6 4E00           00217                 DCFSNZ  Areg,F,A
0016D8 0012           00218                 RETURN
                      00219         ; Advance to the next block by adding 64 to CEXreg
0016DA 01??           00220                 MOVLR   HIGH CEXreg
0016DC 0E40           00221                 MOVLW   D'64'
0016DE 26??           00222                 ADDWF   CEXreg
0016E0 0E00           00223                 MOVLW   0
0016E2 22??           00224                 ADDWFC  CEXreg+1
0016E4 22??           00225                 ADDWFC  CEXreg+2
                      00226         ; Loop till all blocks are erased
0016E6 EF?? F???      00227                 GOTO    FlashErase
                      00228 
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 112


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00229 ; This function will write data to flash memory. The source
                      00230 ; data address is in reg AXreg.  The following registers are 
                      00231 ; assumed defined when this call is made:
                      00232 ;
                      00233 ;       AXreg  = Ram source memory address 
                      00234 ;       CEXreg = Destination address in Flash, must be on 64 byte page
                      00235 ;       Areg   = Number of 64 byte blocks to program
                      00236 ;
0016EA                00237 FlashWrite
0016EA EC?? F???      00238                 CALL    SyncUp
                      00239         ; Load the pointer to flash block
0016EE 01??           00240                 MOVLR   HIGH CEXreg
0016F0 50??           00241                 MOVFP   CEXreg+2,W
0016F2 6EF8           00242                 MOVWF   TBLPTRU,A
0016F4 50??           00243                 MOVFP   CEXreg+1,W
0016F6 6EF7           00244                 MOVWF   TBLPTRH,A
0016F8 50??           00245                 MOVFP   CEXreg,W
0016FA 6EF6           00246                 MOVWF   TBLPTRL,A
                      00247         ; Erase this block
0016FC 8EA6           00248                 BSF     EECON1, EEPGD,A ; point to Flash program memory
0016FE 9CA6           00249                 BCF     EECON1, CFGS,A  ; access Flash program memory
001700 84A6           00250                 BSF     EECON1, WREN,A  ; enable write to memory
001702 88A6           00251                 BSF     EECON1, FREE,A  ; enable Row Erase operation
001704 9EF2           00252                 BCF     INTCON, GIE,A   ; disable interrupts
001706 0E55           00253                 MOVLW   55h
001708 6EA7           00254                 MOVWF   EECON2,A        ; write 55h
00170A 0EAA           00255                 MOVLW   0AAh
00170C 6EA7           00256                 MOVWF   EECON2,A        ; write 0AAh
00170E 82A6           00257                 BSF     EECON1, WR,A    ; start erase (CPU stall)
001710 8EF2           00258                 BSF     INTCON, GIE,A   ; re-enable interrupts
                      00259         ; Write the buffer to holding reg
001712 000A           00260                 TBLRD*-                 ; dummy read decrement
001714 01??           00261                 MOVLR   HIGH AXreg
001716 50??           00262                 MOVFP   AXreg+1,W       ; point to buffer
001718 6EE2           00263                 MOVWF   FSR1H,A
00171A 50??           00264                 MOVFP   AXreg,W
00171C 6EE1           00265                 MOVWF   FSR1L,A
00171E 0E40           00266                 MOVLW   D'64'           ; number of bytes in holding register
001720 6E00           00267                 MOVWF   Breg,A
001722                00268 WRITE_BYTE_TO_HREGS
001722 CFE6 FFE8      00269                 MOVFF   POSTINC1, WREG  ; get low byte of buffer data
001726 6EF5           00270                 MOVWF   TABLAT,A        ; present data to table latch
001728 000F           00271                 TBLWT+*                 ; write data, perform a short write
                      00272                                         ; to internal TBLWT holding register.
00172A 2E00           00273                 DECFSZ  Breg,F,A                ; loop until buffers are full
00172C D???           00274                 BRA     WRITE_BYTE_TO_HREGS
                      00275         ; Program the block
00172E 8EA6           00276                 BSF     EECON1, EEPGD,A ; point to Flash program memory
001730 9CA6           00277                 BCF     EECON1, CFGS,A  ; access Flash program memory
001732 84A6           00278                 BSF     EECON1, WREN,A  ; enable write to memory
001734 9EF2           00279                 BCF     INTCON, GIE,A   ; disable interrupts
001736 0E55           00280                 MOVLW   55h
001738 6EA7           00281                 MOVWF   EECON2,A        ; write 55h
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 113


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

00173A 0EAA           00282                 MOVLW   0AAh
00173C 6EA7           00283                 MOVWF   EECON2,A        ; write 0AAh
00173E 82A6           00284                 BSF     EECON1, WR,A    ; start program (CPU stall)
001740 8EF2           00285                 BSF     INTCON, GIE,A   ; re-enable interrupts
001742 94A6           00286                 BCF     EECON1, WREN,A  ; disable write to memory
                      00287         ; Exit after last block
001744 4E00           00288                 DCFSNZ  Areg,F,A
001746 0012           00289                 RETURN
                      00290         ; Advance pointers to next block
001748 01??           00291                 MOVLR   HIGH CEXreg
00174A 0E40           00292                 MOVLW   D'64'
00174C 26??           00293                 ADDWF   CEXreg
00174E 0E00           00294                 MOVLW   0
001750 22??           00295                 ADDWFC  CEXreg+1
001752 22??           00296                 ADDWFC  CEXreg+2
001754 01??           00297                 MOVLR   HIGH AXreg
001756 0E40           00298                 MOVLW   D'64'
001758 26??           00299                 ADDWF   AXreg
00175A 0E00           00300                 MOVLW   0
00175C 22??           00301                 ADDWFC  AXreg+1
                      00302         ; Loop till all blocks are processed
00175E EF?? F???      00303                 GOTO    FlashWrite
                      00304 
                      00305 ; This function will write data to flash memory. The source
                      00306 ; data address is in reg AXreg.  The following registers are 
                      00307 ; assumed defined when this call is made:
                      00308 ;
                      00309 ;       AXreg  = Ram source memory address 
                      00310 ;       CEXreg = Destination address in Flash, must be on 64 byte page
                      00311 ;       Areg   = Number of 64 byte blocks to program
                      00312 ;
001762                00313 FlashWrite_8720
                      00314         ; Load the pointer to flash block
001762 01??           00315                 MOVLR   HIGH CEXreg
001764 50??           00316                 MOVFP   CEXreg+2,W
001766 6EF8           00317                 MOVWF   TBLPTRU,A
001768 50??           00318                 MOVFP   CEXreg+1,W
00176A 6EF7           00319                 MOVWF   TBLPTRH,A
00176C 50??           00320                 MOVFP   CEXreg,W
00176E 6EF6           00321                 MOVWF   TBLPTRL,A
                      00322         ; Erase this block
001770 8EA6           00323                 BSF     EECON1, EEPGD,A ; point to Flash program memory
001772 9CA6           00324                 BCF     EECON1, CFGS,A  ; access Flash program memory
001774 84A6           00325                 BSF     EECON1, WREN,A  ; enable write to memory
001776 88A6           00326                 BSF     EECON1, FREE,A  ; enable Row Erase operation
001778 9EF2           00327                 BCF     INTCON, GIE,A   ; disable interrupts
00177A 0E55           00328                 MOVLW   55h
00177C 6EA7           00329                 MOVWF   EECON2,A        ; write 55h
00177E 0EAA           00330                 MOVLW   0AAh
001780 6EA7           00331                 MOVWF   EECON2,A        ; write 0AAh
001782 82A6           00332                 BSF     EECON1, WR,A    ; start erase (CPU stall)
001784 0000           00333                 NOP
001786 8EF2           00334                 BSF     INTCON, GIE,A   ; re-enable interrupts
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 114


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00335         ; Write the buffer to holding reg
001788 000A           00336                 TBLRD*-                                 ; dummy read decrement
00178A                00337 WRITE_BUFFER_BACK
00178A 0E08           00338                 MOVLW   8                               ; number of write buffer groups of 8 bytes
00178C 6E00           00339                 MOVWF   Breg,A
00178E 01??           00340                 MOVLR   HIGH AXreg
001790 50??           00341                 MOVFP   AXreg+1,W       ; point to buffer
001792 6EE2           00342                 MOVWF   FSR1H,A
001794 50??           00343                 MOVFP   AXreg,W
001796 6EE1           00344                 MOVWF   FSR1L,A
001798                00345 PROGRAM_LOOP
001798 0E08           00346                 MOVLW   8                               ; number of bytes in holding register
00179A 6E00           00347                 MOVWF   Creg,A
00179C                00348 WRITE_WORD_TO_HREGS
00179C CFE6 FFE8      00349                 MOVFF   POSTINC1, WREG  ; get low byte of buffer data
0017A0 6EF5           00350                 MOVWF   TABLAT,A                ; present data to table latch
0017A2 000F           00351                 TBLWT+*                                 ; write data, perform a short write
                      00352                                                                 ; to internal TBLWT holding register.
0017A4 2E00           00353                 DECFSZ  Creg,F,A                ; loop until buffers are full
0017A6 D???           00354                 BRA     WRITE_WORD_TO_HREGS
0017A8                00355 PROGRAM_MEMORY
0017A8 8EA6           00356                 BSF     EECON1, EEPGD,A ; point to Flash program memory
0017AA 9CA6           00357                 BCF     EECON1, CFGS,A  ; access Flash program memory
0017AC 84A6           00358                 BSF     EECON1, WREN,A  ; enable write to memory
0017AE 9EF2           00359                 BCF     INTCON, GIE,A   ; disable interrupts
0017B0 0E55           00360                 MOVLW   055h
0017B2 6EA7           00361                 MOVWF   EECON2,A                ; write 55H
0017B4 0EAA           00362                 MOVLW   0AAh
0017B6 6EA7           00363                 MOVWF   EECON2,A                ; write AAH
0017B8 82A6           00364                 BSF     EECON1, WR,A    ; start program (CPU stall)
0017BA 0000           00365                 NOP
0017BC 8EF2           00366                 BSF     INTCON, GIE,A   ; re-enable interrupts
0017BE 2E00           00367                 DECFSZ  Breg,F,A                ; loop until done
0017C0 D???           00368                 BRA     PROGRAM_LOOP
0017C2 94A6           00369                 BCF     EECON1, WREN,A  ; disable write to memory
                      00370         ; Advance pointers to next block
0017C4 01??           00371                 MOVLR   HIGH CEXreg
0017C6 0E40           00372                 MOVLW   D'64'
0017C8 26??           00373                 ADDWF   CEXreg
0017CA 0E00           00374                 MOVLW   0
0017CC 22??           00375                 ADDWFC  CEXreg+1
0017CE 22??           00376                 ADDWFC  CEXreg+2
0017D0 01??           00377                 MOVLR   HIGH AXreg
0017D2 0E40           00378                 MOVLW   D'64'
0017D4 26??           00379                 ADDWF   AXreg
0017D6 0E00           00380                 MOVLW   0
0017D8 22??           00381                 ADDWFC  AXreg+1
                      00382         ; Loop till all blocks are processed
0017DA 2E00           00383                 DECFSZ  Areg,F,A
0017DC EF?? F???      00384                 GOTO    FlashWrite_8720
0017E0 0012           00385                 RETURN  
                      02793                 
                      02794 ifdef           LCD52display
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 115


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      02795                 Include <lcd52.asm>
                      00001 ;
                      00002 ; LCD Drivers for displays using HD44780 controller
                      00003 ; or the ST7036 controller used in the DOG162 display
                      00004 ;
                      00005 ; This file contains the drivers for the common LCD Display controller. 
                      00006 ; These displays use a HD44780 controller, this is the most common
                      00007 ; LCD controller in use today.
                      00008 ;
                      00009 ; This driver also supports the ST7036 controller, The differences are
                      00010 ; very minor.
                      00011 ;
                      00012 ; The MicroStar will send position command to for the first and second lines of
                      00013 ; the display. It expect the first line address to start a B0 and the second
                      00014 ; at C0. This is not the same as the HD44780 and will see code in the LCDsendCMD
                      00015 ; function to map these position command into valid values.
                      00016 ;
  00000005            00017 RS      EQU     5               ; LCD
  00000003            00018 ENA     EQU     3               ; LCD
  00000004            00019 RW      EQU     4               ; LCD
                      00020 
                      00021 
0017E2                00022 LCDinit
                      00023         ; Set the direction of all bits and define initial state
0017E2 010F           00024                 MOVLB   HIGH LCDDATA
0017E4 6A9A           00025                 CLRF    LCDDATADIR      ; Data output port
0017E6 6A88           00026                 CLRF    LCDDATA
                      00027         ; Control lines...
0017E8 9693           00028                 BCF     LCDCTRLDIR,ENA,A
0017EA 9A93           00029                 BCF     LCDCTRLDIR,RS,A
0017EC 9893           00030                 BCF     LCDCTRLDIR,RW,A ; Control lines are all outputs
0017EE 8681           00031                 BSF     LCDCTRL,ENA,A
0017F0 8A81           00032                 BSF     LCDCTRL,RS,A
0017F2 8881           00033                 BSF     LCDCTRL,RW,A
0017F4 0E14           00034                 MOVLW   D'20'
0017F6 EC?? F???      00035                 CALL    Delay1mS
                      00036         ; Now send the initalization data to the display
0017FA C??? FFE8      00037                 MOVFF   Dog162,WREG
0017FE 1EE8           00038                 COMF    WREG
001800 66E8           00039                 TSTFSZ  WREG
001802 EF?? F???      00040                 GOTO    NoDog
                      00041         ; Here to init for the DOG162 display, Controller is ST7036     
001806 0E39           00042                 MOVLW   39
001808 EC?? F???      00043                 CALL    LCDsendCMD
00180C 0E05           00044                 MOVLW   D'5'
00180E EC?? F???      00045                 CALL    Delay1mS        
001812 0E39           00046                 MOVLW   39
001814 EC?? F???      00047                 CALL    LCDsendCMD
001818 0E01           00048                 MOVLW   D'1'
00181A EC?? F???      00049                 CALL    Delay1mS        
00181E 0E39           00050                 MOVLW   39
001820 EC?? F???      00051                 CALL    LCDsendCMD
001824 0E01           00052                 MOVLW   D'1'
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 116


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

001826 EC?? F???      00053                 CALL    Delay1mS        
00182A 0E39           00054                 MOVLW   39
00182C EC?? F???      00055                 CALL    LCDsendCMD
                      00056 
001830 0E1C           00057                 MOVLW   1C
001832 EC?? F???      00058                 CALL    LCDsendCMD
001836 0E52           00059                 MOVLW   52
001838 EC?? F???      00060                 CALL    LCDsendCMD
00183C 0E69           00061                 MOVLW   69
00183E EC?? F???      00062                 CALL    LCDsendCMD
001842 0E74           00063                 MOVLW   74                      ; Contrast
001844 EC?? F???      00064                 CALL    LCDsendCMD
001848 0E0C           00065                 MOVLW   0C
00184A EC?? F???      00066                 CALL    LCDsendCMD
00184E 0E01           00067                 MOVLW   01
001850 EC?? F???      00068                 CALL    LCDsendCMD
001854 0E06           00069                 MOVLW   06
001856 EC?? F???      00070                 CALL    LCDsendCMD
                      00071                 
00185A 0E38           00072                 MOVLW   38
00185C EC?? F???      00073                 CALL    LCDsendCMD
                      00074         ; Init the charater generator for digital trims
001860 0E40           00075                 MOVLW           40
001862 EC?? F???      00076                 CALL            LCDsendCMD
001866 0E40           00077                 MOVLW           D'64'
                      00078                 PrintMessN      HCGtbl
001868 CFE8 F???          M                 MOVFF   WREG,Areg
00186C 0E??               M                 MOVLW   UPPER (HCGtbl)
00186E 6EF8               M                 MOVWF   TBLPTRU,A
001870 0E??               M                 MOVLW   HIGH (HCGtbl)
001872 6EF7               M                 MOVWF   TBLPTRH,A
001874 0E??               M                 MOVLW   LOW (HCGtbl)
001876 6EF6               M                 MOVWF   TBLPTRL,A
001878 C??? FFE8          M                 MOVFF   Areg,WREG
00187C EC?? F???          M                 CALL    LCDsendMessN
001880 EF?? F???      00079                 GOTO    LCDinitDone
                      00080         ; Here for the standard HD44780 controller init
001884                00081 NoDog   
001884 0E38           00082                 MOVLW   38
001886 EC?? F???      00083                 CALL    LCDsendCMD
00188A 0E05           00084                 MOVLW   D'5'
00188C EC?? F???      00085                 CALL    Delay1mS        
001890 0E38           00086                 MOVLW   38
001892 EC?? F???      00087                 CALL    LCDsendCMD
001896 0E01           00088                 MOVLW   D'1'
001898 EC?? F???      00089                 CALL    Delay1mS        
00189C 0E38           00090                 MOVLW   38
00189E EC?? F???      00091                 CALL    LCDsendCMD
0018A2 0E01           00092                 MOVLW   D'1'
0018A4 EC?? F???      00093                 CALL    Delay1mS        
0018A8 0E38           00094                 MOVLW   38
0018AA EC?? F???      00095                 CALL    LCDsendCMD
                      00096 
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 117


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

0018AE 0E06           00097                 MOVLW   06
0018B0 EC?? F???      00098                 CALL    LCDsendCMD
0018B4 0E0C           00099                 MOVLW   0C
0018B6 EC?? F???      00100                 CALL    LCDsendCMD
0018BA 0E01           00101                 MOVLW   01
0018BC EC?? F???      00102                 CALL    LCDsendCMD
0018C0 0E80           00103                 MOVLW   80
0018C2 EC?? F???      00104                 CALL    LCDsendCMD
                      00105         ; Init the charater generator for digital trims
0018C6 0E40           00106                 MOVLW           40
0018C8 EC?? F???      00107                 CALL            LCDsendCMD
0018CC 0E40           00108                 MOVLW           D'64'
                      00109                 PrintMessN      HCGtbl
0018CE CFE8 F???          M                 MOVFF   WREG,Areg
0018D2 0E??               M                 MOVLW   UPPER (HCGtbl)
0018D4 6EF8               M                 MOVWF   TBLPTRU,A
0018D6 0E??               M                 MOVLW   HIGH (HCGtbl)
0018D8 6EF7               M                 MOVWF   TBLPTRH,A
0018DA 0E??               M                 MOVLW   LOW (HCGtbl)
0018DC 6EF6               M                 MOVWF   TBLPTRL,A
0018DE C??? FFE8          M                 MOVFF   Areg,WREG
0018E2 EC?? F???          M                 CALL    LCDsendMessN
0018E6                00110 LCDinitDone
                      00111         ; Send the signon message and software version
0018E6 0E80           00112                 MOVLW   LINE1
0018E8 EC?? F???      00113                 CALL    LCDsendCMD
0018EC 0E??           00114                 MOVLW   HIGH (MES1)
0018EE 6EF7           00115                 MOVWF   TBLPTRH
0018F0 0E??           00116                 MOVLW   LOW (MES1)
0018F2 6EF6           00117                 MOVWF   TBLPTRL
0018F4 EC?? F???      00118                 CALL    LCDsendMess
0018F8 0EC0           00119                 MOVLW   LINE2
0018FA EC?? F???      00120                 CALL    LCDsendCMD
0018FE 0E??           00121                 MOVLW   HIGH (MES2)
001900 6EF7           00122                 MOVWF   TBLPTRH
001902 0E??           00123                 MOVLW   LOW (MES2)
001904 6EF6           00124                 MOVWF   TBLPTRL
001906 EC?? F???      00125                 CALL    LCDsendMess
00190A 0012           00126                 Return
                      00127 
                      00128 ;
                      00129 ; This function is called to remap special characters to printable codes.
                      00130 ; This is used for non english options.
                      00131 ; The LCD print char is assumed to be in LCDwreg, the remaped result is
                      00132 ; put in the same location.
                      00133 ;
00190C                00134 LCDspecialRemap
00190C 01??           00135                 MOVLB   HIGH LCDwreg
00190E 0EF3           00136                 MOVLW   ''
001910 62??           00137                 CPFSEQ  LCDwreg
001912 EF?? F???      00138                 GOTO    LCDsR01
001916                00139 LCDsR00
001916 0E6F           00140                 MOVLW   'o'
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 118


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

001918 6E??           00141                 MOVWF   LCDwreg
00191A 0012           00142                 Return
00191C                00143 LCDsR01 
00191C 0EF2           00144                 MOVLW   ''
00191E 62??           00145                 CPFSEQ  LCDwreg
001920 EF?? F???      00146                 GOTO    LCDsR02
001924 EF?? F???      00147                 GOTO    LCDsR00
001928                00148 LCDsR02
001928 0EE0           00149                 MOVLW   ''
00192A 62??           00150                 CPFSEQ  LCDwreg
00192C EF?? F???      00151                 GOTO    LCDsR03
001930 0E61           00152                 MOVLW   'a'
001932 6E??           00153                 MOVWF   LCDwreg
001934 0012           00154                 Return
001936                00155 LCDsR03
001936 0EE9           00156                 MOVLW   ''
001938 62??           00157                 CPFSEQ  LCDwreg
00193A EF?? F???      00158                 GOTO    LCDsR04
00193E 0E65           00159                 MOVLW   'e'
001940 6E??           00160                 MOVWF   LCDwreg
001942 0012           00161                 Return
001944                00162 LCDsR04
001944 0EE7           00163                 MOVLW   ''
001946 62??           00164                 CPFSEQ  LCDwreg
001948 EF?? F???      00165                 GOTO    LCDsR05
00194C 0E63           00166                 MOVLW   'c'
00194E 6E??           00167                 MOVWF   LCDwreg
001950 0012           00168                 Return
001952                00169 LCDsR05
001952 0EED           00170                 MOVLW   ''
001954 62??           00171                 CPFSEQ  LCDwreg
001956 EF?? F???      00172                 GOTO    LCDsR06
00195A 0E69           00173                 MOVLW   'i'
00195C 6E??           00174                 MOVWF   LCDwreg
00195E 0012           00175                 Return
001960                00176 LCDsR06
001960 0EE8           00177                 MOVLW   ''
001962 62??           00178                 CPFSEQ  LCDwreg
001964 EF?? F???      00179                 GOTO    LCDsR07
001968 0E65           00180                 MOVLW   'e'
00196A 6E??           00181                 MOVWF   LCDwreg
00196C 0012           00182                 Return
00196E                00183 LCDsR07
00196E 0EFA           00184                 MOVLW   ''
001970 62??           00185                 CPFSEQ  LCDwreg
001972 0012           00186                 Return
001974 0E75           00187                 MOVLW   'u'
001976 6E??           00188                 MOVWF   LCDwreg
001978 0012           00189                 Return
                      00190                 
                      00191                 
                      00192                 
                      00193                 
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 119


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

00197A                00194 LCDsendData
00197A EC?? F???      00195                 CALL    LCDwait
                      00196 ifdef           Catalan
                      00197                 CALL    LCDspecialRemap
                      00198                 MOVFF   LCDwreg,WREG
                      00199 endif
00197E EC?? F???      00200                 CALL    LCDportOut
001982 8A81           00201                 BSF     LCDCTRL,RS,A
001984 9881           00202                 BCF     LCDCTRL,RW,A
001986 0000           00203                 NOP
001988 0000           00204                 NOP
00198A 8681           00205                 BSF     LCDCTRL,ENA,A
00198C 0000           00206                 NOP
00198E 0000           00207                 NOP
001990 9681           00208                 BCF     LCDCTRL,ENA,A
001992 0000           00209                 NOP
001994 0000           00210                 NOP
001996 0012           00211                 Return
                      00212 
001998                00213 LCDsendCMD
001998 EC?? F???      00214                 CALL    LCDwait
00199C EC?? F???      00215                 CALL    LCDportOut
0019A0 9A81           00216                 BCF     LCDCTRL,RS,A
0019A2 9881           00217                 BCF     LCDCTRL,RW,A
0019A4 0000           00218                 NOP
0019A6 0000           00219                 NOP
0019A8 8681           00220                 BSF     LCDCTRL,ENA,A
0019AA 0000           00221                 NOP
0019AC 0000           00222                 NOP
0019AE 9681           00223                 BCF     LCDCTRL,ENA,A
0019B0 0000           00224                 NOP
0019B2 0000           00225                 NOP
0019B4 0012           00226                 Return
                      00227 
                      00228 ; This function reads the busy bit and waits till the display is not busy
0019B6                00229 LCDwait
                      00230         ; Wait till its not busy
0019B6 EC?? F???      00231                 CALL    LCDbusy
0019BA B0D8           00232                 BTFSC   ALUSTA,0,A
0019BC EF?? F???      00233                 GOTO    LCDwait
                      00234         ; Make the data port, outputs
0019C0 6A9A           00235                 CLRF    LOW LCDDATADIR,A
0019C2 0012           00236                 Return
                      00237 
                      00238 ; This function reads the busy bit and sets the carry flag if the display
                      00239 ; is busy.
0019C4                00240 LCDbusy
                      00241         ; Make the data port, inputs
0019C4 689A           00242                 SETF    LCDDATADIR,A
                      00243         ; Read the busy bit
0019C6 8881           00244                 BSF     LCDCTRL,RW,A
0019C8 9A81           00245                 BCF     LCDCTRL,RS,A
0019CA 0000           00246                 NOP
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 120


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

0019CC 0000           00247                 NOP
0019CE 8681           00248                 BSF     LCDCTRL,ENA,A
0019D0 0000           00249                 NOP
0019D2 0000           00250                 NOP
                      00251         ; Now read bit and set Carry flag in CPU
0019D4 90D8           00252                 BCF     ALUSTA,0,A
0019D6 CFE8 F???      00253                 MOVFF   WREG,LCDwreg
0019DA C??? FFE8      00254                 MOVFF   Adapter,WREG
0019DE 66E8           00255                 TSTFSZ  WREG
0019E0 EF?? F???      00256                 GOTO    LCDbusyA
                      00257                 ; Here if not adapter
0019E4 BE88           00258                 BTFSC   LCDDATA,7,A
0019E6 80D8           00259                 BSF     ALUSTA,0,A
0019E8 9681           00260                 BCF     LCDCTRL,ENA,A
0019EA C??? FFE8      00261                 MOVFF   LCDwreg,WREG
0019EE 0012           00262                 Return
0019F0                00263 LCDbusyA
0019F0 B088           00264                 BTFSC   LCDDATA,0,A
0019F2 80D8           00265                 BSF     ALUSTA,0,A
0019F4 9681           00266                 BCF     LCDCTRL,ENA,A
0019F6 C??? FFE8      00267                 MOVFF   LCDwreg,WREG
0019FA 0012           00268                 Return
                      00269 
                      00270 
                      00271 ; This function output the data port value. The value to be sent is
                      00272 ; in Reg WREG on call. This fundtion sends the data to the data port.
0019FC                00273 LCDportOut
0019FC 6E88           00274                 MOVWF   LCDDATA,A
                      00275         ; If this is the Adapter option we have more to do
0019FE C??? FFE8      00276                 MOVFF   Adapter,WREG
001A02 1EE8           00277                 COMF    WREG
001A04 66E8           00278                 TSTFSZ  WREG
001A06 0012           00279                 RETURN
                      00280         ; Here if adapter mode
001A08 CF88 FFE8      00281                 MOVFF   LCDDATA,WREG
001A0C 6A88           00282                 CLRF    LCDDATA,A
001A0E B0E8           00283                 BTFSC   WREG,0,A
001A10 8888           00284                 BSF     LCDDATA,4,A
001A12 B2E8           00285                 BTFSC   WREG,1,A
001A14 8A88           00286                 BSF     LCDDATA,5,A
001A16 B4E8           00287                 BTFSC   WREG,2,A
001A18 8C88           00288                 BSF     LCDDATA,6,A
001A1A B6E8           00289                 BTFSC   WREG,3,A
001A1C 8E88           00290                 BSF     LCDDATA,7,A
001A1E B8E8           00291                 BTFSC   WREG,4,A
001A20 8688           00292                 BSF     LCDDATA,3,A
001A22 BAE8           00293                 BTFSC   WREG,5,A
001A24 8488           00294                 BSF     LCDDATA,2,A
001A26 BCE8           00295                 BTFSC   WREG,6,A
001A28 8288           00296                 BSF     LCDDATA,1,A
001A2A BEE8           00297                 BTFSC   WREG,7,A
001A2C 8088           00298                 BSF     LCDDATA,0,A
001A2E 0012           00299                 RETURN
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 121


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00300 
                      00301 ; Custom character genertion table, used to create horizontal bars
                      00302 ; This table is used to setup the display for digital trim display.
                      00303 ; The second line of the display is used to indicate the trim
                      00304 ; position. The second line is divided in half and used for positive
                      00305 ; and negative trim positions. The custom characters need to be changed
                      00306 ; for right or left bar painting because 9 characters are needed and
                      00307 ; only 8 are posible. . 
                      00308 ;
                      00309 ; For a right going bar:
                      00310 ;       0,1,2,3,7
                      00311 ; For a left going bar:
                      00312 ;       4,5,6,7,3
001A30                00313 HCGtbl
                      00314         ; The first 4 symbols for the right side of the display
001A30 1010 1010 1010 00315         DB      10,10,10,10,10,10,10,10
       1010 
001A38 1818 1818 1818 00316         DB      18,18,18,18,18,18,18,18
       1818 
001A40 1C1C 1C1C 1C1C 00317         DB      1C,1C,1C,1C,1C,1C,1C,1C
       1C1C 
001A48 1E1E 1E1E 1E1E 00318         DB      1E,1E,1E,1E,1E,1E,1E,1E
       1E1E 
                      00319         ; The second 4 symbols for the left side of the display
001A50 0101 0101 0101 00320         DB      01,01,01,01,01,01,01,01
       0101 
001A58 0303 0303 0303 00321         DB      03,03,03,03,03,03,03,03
       0303 
001A60 0707 0707 0707 00322         DB      07,07,07,07,07,07,07,07
       0707 
001A68 0F0F 0F0F 0F0F 00323         DB      0F,0F,0F,0F,0F,0F,0F,0F
       0F0F 
                      00324         ; This is the pattern for all pixels on
001A70 1F1F 1F1F 1F1F 00325         DB      1F,1F,1F,1F,1F,1F,1F,1F
       1F1F 
                      00326 
                      00327 
                      02796 endif
                      02797 ifdef           SED1230display
                      02798                 Include <sed1230.asm>
                      02799 endif
                      02800 ifdef           ECMA1010display
                      02801                 Include <ECMA1010.asm>
                      02802 endif
                      02803 ifdef           MicroProStar
                      02804                 Include <MP8000.asm>
                      02805 endif
                      02806                 Include <Display.asm>
                      00001 ; This function sends the message pointed to by AXreg to the display.
                      00002 ; The full line is displayed, 12 or 16 characters depending on the 
                      00003 ; display type. The display line must be selected before this call 
                      00004 ; is made.
001A78                00005 LCDsendAX
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 122


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

001A78 0E80           00006                 MOVLW   LINE1
001A7A EC?? F???      00007                 CALL    LCDsendCMD
001A7E C??? FFF6      00008                 MOVFF   AXreg,TBLPTRL
001A82 C??? FFF7      00009                 MOVFF   AXreg+1,TBLPTRH
001A86 6AF8           00010                 CLRF    TBLPTRU,A
001A88 EC?? F???      00011                 CALL    LCDsendMess
001A8C 0012           00012                 RETURN
                      00013 
                      00014 ; This function sends the message pointed to by AXreg line 2 of the display.
                      00015 ; The full line is displayed, 12 or 16 characters depending on the 
                      00016 ; display type.
001A8E                00017 LCDsendAXLine2
001A8E 0EC0           00018                 MOVLW   LINE2
001A90 EC?? F???      00019                 CALL    LCDsendCMD
001A94 C??? FFF6      00020                 MOVFF   AXreg,TBLPTRL
001A98 C??? FFF7      00021                 MOVFF   AXreg+1,TBLPTRH
001A9C 6AF8           00022                 CLRF    TBLPTRU,A
001A9E EC?? F???      00023                 CALL    LCDsendMess
001AA2 0012           00024                 RETURN
                      00025 
                      00026 ; This function sends the message pointed to by DXreg line 2 of the display.
                      00027 ; The full line is displayed, 12 or 16 characters depending on the 
                      00028 ; display type.
001AA4                00029 LCDsendDXLine2
001AA4 0EC0           00030                 MOVLW   LINE2
001AA6 EC?? F???      00031                 CALL    LCDsendCMD
001AAA C??? FFF6      00032                 MOVFF   DXreg,TBLPTRL
001AAE C??? FFF7      00033                 MOVFF   DXreg+1,TBLPTRH
001AB2 6AF8           00034                 CLRF    TBLPTRU,A
001AB4 EC?? F???      00035                 CALL    LCDsendMess
001AB8 0012           00036                 RETURN
                      00037 
                      00038 ifdef   MicroProStar
                      00039 ; This function displays the second line of the LCD display. Both lines
                      00040 ; are saved in the display memory.
                      00041 LCDshowLine2
                      00042         ; If its already active, exit
                      00043                 MOVFF   ActiveDisplayLine,WREG
                      00044                 XORLW   2
                      00045                 BTFSC   ALUSTA,Z
                      00046                 RETURN
                      00047         ; Set to line 2
                      00048                 MOVLW   0x02
                      00049                 CALL    LCDsendCMD
                      00050                 MOVLW   0x18
                      00051                 CALL    LCDsendCMD
                      00052                 MOVLW   0x18
                      00053                 CALL    LCDsendCMD
                      00054                 MOVLW   0x18
                      00055                 CALL    LCDsendCMD
                      00056                 MOVLW   0x18
                      00057                 CALL    LCDsendCMD
                      00058                 MOVLW   0x18
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 123


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00059                 CALL    LCDsendCMD
                      00060                 MOVLW   0x18
                      00061                 CALL    LCDsendCMD
                      00062                 MOVLW   0x18
                      00063                 CALL    LCDsendCMD
                      00064                 MOVLW   0x18
                      00065                 CALL    LCDsendCMD
                      00066         ; Set active display line flag to 2
                      00067                 MOVLW   2
                      00068                 MOVFF   WREG,ActiveDisplayLine
                      00069                 RETURN
                      00070                 
                      00071 ; This function resets the display pointer to the first line of the display.
                      00072 LCDshowLine1
                      00073         ; If its already active, exit
                      00074                 MOVFF   ActiveDisplayLine,WREG
                      00075                 XORLW   1
                      00076                 BTFSC   ALUSTA,Z
                      00077                 RETURN
                      00078         ; Set to line 1
                      00079                 MOVLW   0x02
                      00080                 CALL    LCDsendCMD
                      00081         ; Set active display line flag to 1
                      00082                 MOVLW   1
                      00083                 MOVFF   WREG,ActiveDisplayLine
                      00084                 RETURN
                      00085 
                      00086 ; This function will send a message to the LCD display. This function sends
                      00087 ; the number of characters defined in WREG.
                      00088 ; The table pointers must point to the message in FLASH when this function
                      00089 ; is called.
                      00090 ; This function uses
                      00091 ;               WREG
                      00092 ;               Areg
                      00093 ;               Table pointers
                      00094 LCDsendMess
                      00095                 MOVLW   10
                      00096                 GOTO    LCDsendMessN            
                      00097 LCDsendMessN
                      00098                 MOVWF   Areg,A
                      00099 NEXT
                      00100                 TBLRD*+
                      00101                 MOVFF   TABLAT,WREG
                      00102                 IORWF   WREG
                      00103                 BTFSC   ALUSTA,Z
                      00104                 RETURN
                      00105                 CALL    LCDsendData
                      00106         ; Send until end of count
                      00107 NextChar
                      00108                 DCFSNZ  Areg,F,A
                      00109                 RETURN
                      00110                 GOTO    NEXT
                      00111 else
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 124


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00112 ; This function will send a message to the LCD display. This function sends
                      00113 ; the entire line, 16 characters or 12 characters depending on the display 
                      00114 ; type.
                      00115 ; The table pointers must point to the message in FLASH when this function
                      00116 ; is called.
                      00117 ; This function uses
                      00118 ;               WREG
                      00119 ;               Areg
                      00120 ;               Table pointers
001ABA                00121 LCDsendMess
                      00122 ifdef   ECMA1010display
                      00123                 MOVLW   0C
                      00124 else
001ABA 0E10           00125                 MOVLW   10
                      00126 endif
001ABC EF?? F???      00127                 GOTO    LCDsendMessN
                      00128                 
                      00129 ; This function will send a message to the LCD display. This function sends
                      00130 ; the number of characters defined in WREG.
                      00131 ; The table pointers must point to the message in FLASH when this function
                      00132 ; is called.
                      00133 ; This function uses
                      00134 ;               WREG
                      00135 ;               Areg
                      00136 ;               Table pointers
001AC0                00137 LCDsendMessN
001AC0 6E00           00138                 MOVWF   Areg,A
001AC2                00139 NEXT
001AC2 0009           00140                 TBLRD*+
001AC4 CFF5 FFE8      00141                 MOVFF   TABLAT,WREG
001AC8 12E8           00142                 IORWF   WREG
001ACA B4D8           00143                 BTFSC   ALUSTA,Z
001ACC 0012           00144                 RETURN
001ACE EC?? F???      00145                 CALL    LCDsendData
001AD2 4E00           00146                 DCFSNZ  Areg,F,A
001AD4 0012           00147                 RETURN
001AD6 EF?? F???      00148                 GOTO    NEXT
                      00149 endif
                      00150 
                      00151 ; The function displays the value in the WREG on the display in
                      00152 ; binary format (1s and 0s). This value is displayed at the 
                      00153 ; current cursor location.
                      00154 ; Areg and Breg are used by this routine.
001ADA                00155 LCDbinary
001ADA 6E??           00156                 MOVWF   Areg
001ADC 0E08           00157                 MOVLW   D'8'
001ADE 6E??           00158                 MOVWF   Breg
001AE0                00159 LCDbinary0
001AE0 0E30           00160                 MOVLW   30
001AE2 BE??           00161                 BTFSC   Areg,7
001AE4 0E31           00162                 MOVLW   31
001AE6 EC?? F???      00163                 CALL    LCDsendData
001AEA 36??           00164                 RLCF    Areg
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 125


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

001AEC 2E??           00165                 DECFSZ  Breg
001AEE EF?? F???      00166                 GOTO    LCDbinary0
001AF2 0012           00167                 RETURN
                      00168 
                      00169 ; The function displays the value in the WREG on the display in
                      00170 ; hex format. This value is displayed at the 
                      00171 ; current cursor location.
                      00172 ; Areg and Breg are used by this routine.
001AF4                00173 LCDhex
001AF4 6E??           00174                 MOVWF   Areg
001AF6 0E3A           00175                 MOVLW   3A
001AF8 6E??           00176                 MOVWF   Breg
                      00177         ; MS dibble
001AFA C??? FFE8      00178                 MOVPF   Areg,WREG
001AFE 0BF0           00179                 ANDLW   0F0
001B00 42E8           00180                 RRNCF   WREG
001B02 42E8           00181                 RRNCF   WREG
001B04 42E8           00182                 RRNCF   WREG
001B06 42E8           00183                 RRNCF   WREG
001B08 0930           00184                 IORLW   030
001B0A 64??           00185                 CPFSGT  Breg
001B0C 0F07           00186                 ADDLW   7
001B0E EC?? F???      00187                 CALL    LCDsendData
                      00188         ; LS dibble
001B12 C??? FFE8      00189                 MOVPF   Areg,WREG
001B16 0B0F           00190                 ANDLW   0F
001B18 0930           00191                 IORLW   030
001B1A 64??           00192                 CPFSGT  Breg
001B1C 0F07           00193                 ADDLW   7
001B1E EC?? F???      00194                 CALL    LCDsendData
001B22 C??? FFE8      00195                 MOVPF   Areg,WREG
001B26 0012           00196                 RETURN
                      00197 
                      00198 ; This function prints the sign of the value in CEXreg 
                      00199 ; and then returns with the absolute value in CEXreg. Only
                      00200 ; the 16 LSBs of CEXreg are used.
001B28                00201 LCDsign
                      00202         ; Set the 2 MS bytes to 0
001B28 0E00           00203                 MOVLW   0
001B2A CFE8 F???      00204                 MOVFF   WREG,CEXreg+2
001B2E CFE8 F???      00205                 MOVFF   WREG,CEXreg+3
                      00206         ; Test the sign of CEXreg, assume its a 16 bit reg
001B32 01??           00207                 MOVLB   HIGH CEXreg
001B34 0E20           00208                 MOVLW   ' '
001B36 BE??           00209                 BTFSC   CEXreg+1,7
001B38 0E2D           00210                 MOVLW   '-'
001B3A EC?? F???      00211                 CALL    LCDsendData
                      00212         ; If negative then perform 2s complement
001B3E 01??           00213                 MOVLB   HIGH CEXreg
001B40 AE??           00214                 BTFSS   CEXreg+1,7
001B42 0012           00215                 RETURN
                      00216         ; Here if negative
001B44 1E??           00217                 COMF    CEXreg
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 126


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

001B46 1E??           00218                 COMF    CEXreg+1
001B48 2A??           00219                 INCF    CEXreg
001B4A B4D8           00220                 BTFSC   ALUSTA,Z
001B4C 2A??           00221                 INCF    CEXreg+1
001B4E 0012           00222                 RETURN
                      00223                 
                      00224 
                      00225 ;
                      00226 ; This function prints the unsigned integer that is in 
                      00227 ; CEXreg to the LCD at its current position. There are 
                      00228 ; a number of entry points into this function:
                      00229 ;
                      00230 ; LCDint        prints 5 characters
                      00231 ; LCDint4       prints 4 characters
                      00232 ; LCDint3       prints 3 characters
                      00233 ; LCDint2       prints 2 characters
                      00234 ; LCDint1       prints 1 characters
                      00235 ;
001B50                00236 LCDint
001B50 EC?? F???      00237                 CALL    Int2Str
001B54 5000           00238                 MOVFP   Buffer,WREG
001B56 EC?? F???      00239                 CALL    LCDsendData
001B5A                00240 LCDintA
001B5A 5000           00241                 MOVFP   Buffer+1,WREG
001B5C EC?? F???      00242                 CALL    LCDsendData
001B60                00243 LCDintB
001B60 5000           00244                 MOVFP   Buffer+2,WREG
001B62 EC?? F???      00245                 CALL    LCDsendData
001B66                00246 LCDintC
001B66 5000           00247                 MOVFP   Buffer+3,WREG
001B68 EC?? F???      00248                 CALL    LCDsendData
001B6C                00249 LCDintD
001B6C 5000           00250                 MOVFP   Buffer+4,WREG
001B6E EC?? F???      00251                 CALL    LCDsendData
001B72 0012           00252                 RETURN
001B74                00253 LCDint4
001B74 EC?? F???      00254                 CALL    Int2Str
001B78 EF?? F???      00255                 GOTO    LCDintA
001B7C                00256 LCDint3
001B7C EC?? F???      00257                 CALL    Int2Str
001B80 EF?? F???      00258                 GOTO    LCDintB
001B84                00259 LCDint2
001B84 EC?? F???      00260                 CALL    Int2Str
001B88 EF?? F???      00261                 GOTO    LCDintC
001B8C                00262 LCDint1
001B8C EC?? F???      00263                 CALL    Int2Str
001B90 EF?? F???      00264                 GOTO    LCDintD
                      00265 
                      00266 ; This function prints an unsigned int to the LCD at its current loacation
                      00267 ; and performs leading zero suppresion.
001B94                00268 LCDintZS
001B94 EC?? F???      00269                 CALL    Int2Str
001B98 EC?? F???      00270                 CALL    RemoveLeadingZeros
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 127


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

001B9C 5000           00271                 MOVFP   Buffer,WREG
001B9E EC?? F???      00272                 CALL    LCDsendData
001BA2 5000           00273                 MOVFP   Buffer+1,WREG
001BA4 EC?? F???      00274                 CALL    LCDsendData
001BA8 5000           00275                 MOVFP   Buffer+2,WREG
001BAA EC?? F???      00276                 CALL    LCDsendData
001BAE 5000           00277                 MOVFP   Buffer+3,WREG
001BB0 EC?? F???      00278                 CALL    LCDsendData
001BB4 5000           00279                 MOVFP   Buffer+4,WREG
001BB6 EC?? F???      00280                 CALL    LCDsendData
001BBA 0012           00281                 RETURN
                      00282 
                      00283 ; This function removes leading zeros from the ascii string in Buffer.
001BBC                00284 RemoveLeadingZeros
001BBC 01??           00285                 MOVLR   HIGH Buffer
001BBE 0E30           00286                 MOVLW   '0'
001BC0 62??           00287                 CPFSEQ  Buffer
001BC2 0012           00288                 RETURN
001BC4 0E20           00289                 MOVLW   ' '
001BC6 6E??           00290                 MOVWF   Buffer
                      00291 
001BC8 0E30           00292                 MOVLW   '0'
001BCA 62??           00293                 CPFSEQ  Buffer+1
001BCC 0012           00294                 RETURN
001BCE 0E20           00295                 MOVLW   ' '
001BD0 6E??           00296                 MOVWF   Buffer+1
                      00297 
001BD2 0E30           00298                 MOVLW   '0'
001BD4 62??           00299                 CPFSEQ  Buffer+2
001BD6 0012           00300                 RETURN
001BD8 0E20           00301                 MOVLW   ' '
001BDA 6E??           00302                 MOVWF   Buffer+2
                      00303 
001BDC 0E30           00304                 MOVLW   '0'
001BDE 62??           00305                 CPFSEQ  Buffer+3
001BE0 0012           00306                 RETURN
001BE2 0E20           00307                 MOVLW   ' '
001BE4 6E??           00308                 MOVWF   Buffer+3
001BE6 0012           00309                 RETURN
                      00310 
                      00311 ; This function converts an integer into an ascii string.
                      00312 ; CEXreg contains the integer and the 5 byte
                      00313 ; string is placed in buffer
001BE8                00314 Int2Str
                      00315         ; 10000 digit
001BE8 01??           00316                 MOVLB   HIGH DEXreg
001BEA 6A??           00317                 CLRF    DEXreg+2
001BEC 6A??           00318                 CLRF    DEXreg+3
001BEE 0E10           00319                 MOVLW   LOW D'10000'
001BF0 6E??           00320                 MOVWF   DEXreg
001BF2 0E27           00321                 MOVLW   HIGH D'10000'
001BF4 6E??           00322                 MOVWF   DEXreg+1
001BF6 EC?? F???      00323                 CALL    Divide2416
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 128


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

001BFA 0E30           00324                 MOVLW   30
001BFC 1000           00325                 IORWF   CEXreg,0
001BFE 6E??           00326                 MOVWF   Buffer
                      00327                 MOVE32  EEXreg,CEXreg
001C00 C??? F???          M                 MOVFF   EEXreg,CEXreg
001C04 C??? F???          M                 MOVFF   (EEXreg+1),(CEXreg+1)
001C08 C??? F???          M                 MOVFF   (EEXreg+2),(CEXreg+2)
001C0C C??? F???          M                 MOVFF   (EEXreg+3),(CEXreg+3)
                      00328         ; 1000 digit
001C10 6A??           00329                 CLRF    DEXreg+2
001C12 6A??           00330                 CLRF    DEXreg+3
001C14 0EE8           00331                 MOVLW   LOW D'1000'
001C16 6E??           00332                 MOVWF   DEXreg
001C18 0E03           00333                 MOVLW   HIGH D'1000'
001C1A 6E??           00334                 MOVWF   DEXreg+1
001C1C EC?? F???      00335                 CALL    Divide2416
001C20 0E30           00336                 MOVLW   30
001C22 1000           00337                 IORWF   CEXreg,0
001C24 6E??           00338                 MOVWF   Buffer+1
                      00339                 MOVE32  EEXreg,CEXreg
001C26 C??? F???          M                 MOVFF   EEXreg,CEXreg
001C2A C??? F???          M                 MOVFF   (EEXreg+1),(CEXreg+1)
001C2E C??? F???          M                 MOVFF   (EEXreg+2),(CEXreg+2)
001C32 C??? F???          M                 MOVFF   (EEXreg+3),(CEXreg+3)
                      00340         ; 100 digit
001C36 6A??           00341                 CLRF    DEXreg+2
001C38 6A??           00342                 CLRF    DEXreg+3
001C3A 0E64           00343                 MOVLW   LOW D'100'
001C3C 6E??           00344                 MOVWF   DEXreg
001C3E 0E00           00345                 MOVLW   HIGH D'100'
001C40 6E??           00346                 MOVWF   DEXreg+1
001C42 EC?? F???      00347                 CALL    Divide2416
001C46 0E30           00348                 MOVLW   30
001C48 1000           00349                 IORWF   CEXreg,0
001C4A 6E??           00350                 MOVWF   Buffer+2
                      00351                 MOVE32  EEXreg,CEXreg
001C4C C??? F???          M                 MOVFF   EEXreg,CEXreg
001C50 C??? F???          M                 MOVFF   (EEXreg+1),(CEXreg+1)
001C54 C??? F???          M                 MOVFF   (EEXreg+2),(CEXreg+2)
001C58 C??? F???          M                 MOVFF   (EEXreg+3),(CEXreg+3)
                      00352         ; 10 digit
001C5C 6A??           00353                 CLRF    DEXreg+2
001C5E 6A??           00354                 CLRF    DEXreg+3
001C60 0E0A           00355                 MOVLW   LOW D'10'
001C62 6E??           00356                 MOVWF   DEXreg
001C64 0E00           00357                 MOVLW   HIGH D'10'
001C66 6E??           00358                 MOVWF   DEXreg+1
001C68 EC?? F???      00359                 CALL    Divide2416
001C6C 0E30           00360                 MOVLW   30
001C6E 1000           00361                 IORWF   CEXreg,0
001C70 6E??           00362                 MOVWF   Buffer+3
                      00363         ; The 1's digit is in the remainder's lsb
001C72 0E30           00364                 MOVLW   30
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 129


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

001C74 1000           00365                 IORWF   EEXreg,0
001C76 6E??           00366                 MOVWF   Buffer+4
001C78 0012           00367                 RETURN
                      00368 
                      00369 ; This function sets the DOG display contrast to the value defined in
                      00370 ; DOGcontrast variable. There are 64 valid values, 0 to 63
001C7A                00371 SetDOGcontrast
                      00372    ; Exit if this is not a DOG display
001C7A C??? FFE8      00373                 MOVFF   Dog162,WREG
001C7E 1EE8           00374                 COMF    WREG
001C80 66E8           00375                 TSTFSZ  WREG
001C82 0012           00376                 RETURN
                      00377    ; Here if DOG display
001C84 0E39           00378                 MOVLW   39
001C86 EC?? F???      00379                 CALL    LCDsendCMD
                      00380                 ; Set the 2 MSBs
001C8A C??? FFE8      00381                 MOVFF   DOGcontrast,WREG
001C8E 3AE8           00382                 SWAPF   WREG
001C90 0B03           00383                 ANDLW   03
001C92 0950           00384                 IORLW   50
001C94 EC?? F???      00385                 CALL    LCDsendCMD
                      00386                 ; Set the 4 LSBs
001C98 C??? FFE8      00387                 MOVFF   DOGcontrast,WREG
001C9C 0B0F           00388                 ANDLW   0F
001C9E 0970           00389                 IORLW   70
001CA0 EC?? F???      00390                 CALL    LCDsendCMD
                      00391                 ; Return the normal mode
001CA4 0E38           00392                 MOVLW   38
001CA6 EC?? F???      00393                 CALL    LCDsendCMD
001CAA 0012           00394                 RETURN
                      00395 
                      02807                 Include <comms.asm>
                      00001 ;
                      00002 ; RS232 function. 
                      00003 ;       USART1 is used by a host computer to configure the transmitter
                      00004 ;       USART2 support three different modes of operation
                      00005 ;               1.) The buddy box system that allows two microstar
                      00006 ;                   systems to be used in a student and master mode.
                      00007 ;               2.) The FMS mode to support the free FMS flight simulator.
                      00008 ;                   This code is found in the FMS.asm file.
                      00009 ;               3.) The serial position data sending function. This mode
                      00010 ;                   sends the position data at full resolution. 
                      00011 ;
                      00012 ;
                      00013 ; This function is called in the main polling loop. This function
                      00014 ; reads and processes messages that are found in the command buffer.
                      00015 ; The command buffer is filled by the receiver interrupt service
                      00016 ; routine.
                      00017 ;
                      00018 ; Valid commands are:
                      00019 ;       31 = Read general data from flash
                      00020 ;       32 = Read selected aircraft data from flash
                      00021 ;       33 = Write general data to flash
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 130


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00022 ;       34 = Write selected aircraft data to flash
                      00023 ;       35 = Reset the flash programmed flag
                      00024 ;
001CAC                00025 ProcessCommand
                      00026         ; Test the command flag and process any requests
001CAC 01??           00027                 MOVLB   HIGH Cmd
001CAE 0E31           00028                 MOVLW   31              ; Read general reg
001CB0 62??           00029                 CPFSEQ  Cmd
001CB2 EF?? F???      00030                 GOTO    Not31
                      00031                 ; Here if its a read general command
001CB6 EC?? F???      00032                 CALL    LoadGeneral
001CBA EF?? F???      00033                 GOTO    CmdEnd
001CBE                00034 Not31
001CBE 0E32           00035                 MOVLW   32
001CC0 62??           00036                 CPFSEQ  Cmd
001CC2 EF?? F???      00037                 GOTO    Not32
                      00038                 ; Here if its a read aircraft data command
001CC6 C??? FFE8      00039                 MOVFF   Aircraft,WREG
001CCA EC?? F???      00040                 CALL    LoadAircraft
001CCE EF?? F???      00041                 GOTO    CmdEnd
001CD2                00042 Not32
001CD2 0E33           00043                 MOVLW   33              ; Write general reg
001CD4 62??           00044                 CPFSEQ  Cmd
001CD6 EF?? F???      00045                 GOTO    Not33
                      00046                 ; Here if its a write general command
001CDA EC?? F???      00047                 CALL    SaveGeneral     
001CDE EF?? F???      00048                 GOTO    CmdEnd
001CE2                00049 Not33   
001CE2 0E34           00050                 MOVLW   34              ; Write aircraft data
001CE4 62??           00051                 CPFSEQ  Cmd
001CE6 EF?? F???      00052                 GOTO    Not34
                      00053                 ; Here if its a write aircraft data command
001CEA C??? FFE8      00054                 MOVFF   Aircraft,WREG
001CEE EC?? F???      00055                 CALL    SaveAircraft
001CF2                00056 Not34
001CF2 0E35           00057                 MOVLW   35              ; Reset the boot flag in EEPROM, this
                      00058                                         ; will enable the boot loader on reset
001CF4 62??           00059                 CPFSEQ  Cmd
001CF6 EF?? F???      00060                 GOTO    CmdEnd
                      00061                 ; Here if its reset the boot flag command, set location 1023 in
                      00062                 ; EEprom to FF hex.
                      00063                 MOVEC   D'1023',AXreg
001CFA 01??               M                 MOVLR   HIGH (AXreg)
001CFC 0EFF               M                 MOVLW   LOW (D'1023')
001CFE 6E??               M                 MOVWF   (AXreg)
001D00 0E03               M                 MOVLW   HIGH (D'1023')
001D02 6E??               M                 MOVWF   (AXreg+1)
001D04 CFE8 F???      00064                 MOVFF   WREG,AXreg+1
001D08 0EFF           00065                 MOVLW   0xFF
001D0A EC?? F???      00066                 CALL    EEPROMwriteByte
001D0E EF?? F???      00067                 GOTO    CmdEnd
001D12                00068 CmdEnd
001D12 6A??           00069                 CLRF    Cmd
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 131


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

001D14 0012           00070                 RETURN
                      00071 
                      00072 ; The following USART reset functions test the status bits and if
                      00073 ; an overrun error is detected the USART is reset
001D16                00074 USART1reset
001D16 010F           00075                 MOVLB   HIGH RCSTA1
001D18 A2AB           00076                 BTFSS   RCSTA1,OERR
001D1A 0012           00077                 RETURN
                      00078                 ; Here with an overrun
001D1C 98AB           00079                 BCF     RCSTA1,CREN
001D1E 88AB           00080                 BSF     RCSTA1,CREN
                      00081                 ; Empty the receive buffer
001D20 010F           00082                 MOVLB   HIGH RCREG1
001D22 50AE           00083                 MOVF    RCREG1,W
                      00084                 ; Clear the message state
001D24 01??           00085                 MOVLB   HIGH MessState
001D26 6A??           00086                 CLRF    MessState
001D28 0012           00087                 RETURN
                      00088 
001D2A                00089 USART2reset
001D2A 010F           00090                 MOVLB   HIGH RCSTA2
001D2C A26B           00091                 BTFSS   RCSTA2,OERR
001D2E 0012           00092                 RETURN
                      00093                 ; Here with an overrun
001D30 986B           00094                 BCF     RCSTA2,CREN
001D32 886B           00095                 BSF     RCSTA2,CREN
                      00096                 ; Empty the receive buffer
001D34 010F           00097                 MOVLB   HIGH RCREG2
001D36 506E           00098                 MOVF    RCREG2,W
001D38 0012           00099                 RETURN
                      00100 
                      00101 ; This function configures USATRT1. The baud rate is set to 9600 and
                      00102 ; the receiver interrupts are enabled. UART 1 is used to communicate with
                      00103 ; The PC application.
001D3A                00104 USART1init
                      00105         ; Baudrate generator
001D3A 0E0C           00106                 MOVLW   D'12'           ; 9600 baud
001D3C CFE8 FFAF      00107                 MOVFF   WREG,SPBRG1
                      00108         ; Enable transmitter
001D40 0E22           00109                 MOVLW   22
001D42 CFE8 FFAC      00110                 MOVFF   WREG,TXSTA1
                      00111         ; Receiver
001D46 0E90           00112                 MOVLW   90
001D48 CFE8 FFAB      00113                 MOVFF   WREG,RCSTA1
                      00114         ; Message receive variables
001D4C 01??           00115                 MOVLB   HIGH MessState
001D4E 6A??           00116                 CLRF    MessState
                      00117         ; Set interrupt priority to low and enable
001D50 9A9F           00118                 BCF     IPR1,RC1IP,A            ; Low priority
001D52 8A9D           00119                 BSF     PIE1,RC1IE,A            ; Enable the interrupt
001D54 0012           00120                 RETURN
                      00121 
001D56                00122 USART1sendChar
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 132


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00123         ; Wait for xmit ready...
001D56                00124 USC1
001D56 A2AC           00125                 BTFSS   TXSTA1,TRMT,A
001D58 EF?? F???      00126                 GOTO    USC1
                      00127         ; Send it
001D5C CFE8 FFAD      00128                 MOVFF   WREG,TXREG1
001D60 0012           00129                 RETURN
                      00130 
                      00131 ; This function configures USATRT2. The baud rate is set to 115200 and
                      00132 ; the receiver interrupts are enabled. UART 2 is used for the buddy box operation.
                      00133 ; USART2 is also used in the serial send mode, if this mode is selected
                      00134 ; the baud rate is set at 38400.
001D62                00135 USART2init
                      00136         ; Set baudrate to 38400 for the SendSerial mode
001D62 0E0C           00137                 MOVLW   D'12'                   ; 12 will give a 38400 baud rate, 3 is 115200
001D64 CFE8 FF6F      00138                 MOVFF   WREG,SPBRG2
                      00139         ; Test if SerialSend mode is enabled
001D68 C??? FFE8      00140                 MOVFF   SerialSend,WREG
001D6C 66E8           00141                 TSTFSZ  WREG,A
001D6E EF?? F???      00142                 GOTO    U2set
                      00143         ; Set baudrate at 115200 baud for the buddy box mode
001D72 0E03           00144                 MOVLW   D'3'                    ; 12 will give a 38400 baud rate, 3 is 115200
001D74 CFE8 FF6F      00145                 MOVFF   WREG,SPBRG2
                      00146         ; Disable 16 bit baudrate mode
001D78                00147 U2set
001D78 967C           00148                 BCF     BAUDCON2,BRG16,A
                      00149         ; Enable transmitter
001D7A 0E26           00150                 MOVLW   26
001D7C CFE8 FF6C      00151                 MOVFF   WREG,TXSTA2
                      00152         ; Receiver
001D80 0E90           00153                 MOVLW   90
001D82 CFE8 FF6B      00154                 MOVFF   WREG,RCSTA2
                      00155         ; Set interrupt priority to low and enable
001D86 9AA5           00156                 BCF     IPR3,RC2IP,A            ; Low priority
001D88 8AA3           00157                 BSF     PIE3,RC2IE,A            ; Enable the interrupt
001D8A 0012           00158                 RETURN
                      00159 
001D8C                00160 USART2sendEmpty
                      00161         ; Wait for xmit ready...
001D8C                00162 USE2
001D8C A26C           00163                 BTFSS   TXSTA2,TRMT,A
001D8E EF?? F???      00164                 GOTO    USE2
001D92 0012           00165                 RETURN
                      00166 
001D94                00167 USART2sendChar
                      00168         ; Wait for xmit ready...
001D94                00169 USC2
001D94 A26C           00170                 BTFSS   TXSTA2,TRMT,A
001D96 EF?? F???      00171                 GOTO    USC2
                      00172         ; Send it
001D9A CFE8 FF6D      00173                 MOVFF   WREG,TXREG2
001D9E 0012           00174                 RETURN
                      00175 
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 133


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00176 ;
                      00177 ; This function will send data out UART channel 1. The data will be
                      00178 ; read at the address in indirect register FSR1. FSR1 will be setup 
                      00179 ; by this call. The following registers are assumed defined
                      00180 ; when this call is made:
                      00181 ;
                      00182 ;       MessBank  = Bank for source
                      00183 ;       MessLoc   = Address of source data
                      00184 ;       MessLen   = Number of bytes to send
                      00185 ;
001DA0                00186 USART1send
                      00187     ; Save the FSR1 register data
001DA0 CFE1 F???      00188                 MOVFF   FSR1L, FSR1Lsave
001DA4 CFE2 F???      00189                 MOVFF   FSR1H, FSR1Hsave
                      00190         ; Setup FSR1
001DA8 01??           00191                 MOVLB   HIGH MessLoc
001DAA C??? FFE1      00192                 MOVFF   MessLoc,FSR1L
001DAE 01??           00193                 MOVLB   HIGH MessBank
001DB0 C??? FFE2      00194                 MOVFF   MessBank,FSR1H
001DB4 6A??           00195                 CLRF    CheckSum
                      00196         ; Wait for Xmitter buffer to empty
001DB6                00197 US1
001DB6 A2AC           00198                 BTFSS   TXSTA1,TRMT
001DB8 EF?? F???      00199                 GOTO    US1
                      00200         ; Now read the char from the buffer and send it
001DBC CFE6 FFE8      00201                 MOVFF   POSTINC1,WREG
001DC0 01??           00202                 MOVLB   HIGH CheckSum
001DC2 26??           00203                 ADDWF   CheckSum
001DC4 CFE8 FFAD      00204                 MOVFF   WREG,TXREG1
                      00205         ; Check the loop counter...
001DC8 01??           00206                 MOVLB   HIGH MessLen
001DCA 2E??           00207                 DECFSZ  MessLen
001DCC EF?? F???      00208                 GOTO    US1
                      00209         ; Restore regs...
001DD0 C??? FFE1      00210                 MOVFF   FSR1Lsave, FSR1L
001DD4 C??? FFE2      00211                 MOVFF   FSR1Hsave, FSR1H
001DD8 0012           00212                 RETURN
                      00213 
                      00214 ;
                      00215 ; This function will receive data from UART channel 1. The data will be
                      00216 ; saved at the address in indirect register FSR1. FSR1 will be setup 
                      00217 ; by this call. The following registers are assumed defined
                      00218 ; when this call is made:
                      00219 ;
                      00220 ;       MessBank  = Bank for destination
                      00221 ;       MessLoc   = Address of destanation data
                      00222 ;       MessLen   = Number of bytes to receive
                      00223 ;
001DDA                00224 USART1in
                      00225     ; Save the FSR1 register data
001DDA CFE1 F???      00226                 MOVFF   FSR1L, FSR1Lsave
001DDE CFE2 F???      00227                 MOVFF   FSR1H, FSR1Hsave
                      00228         ; Setup FSR1
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 134


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

001DE2 01??           00229                 MOVLB   HIGH MessLoc
001DE4 C??? FFE1      00230                 MOVFF   MessLoc,FSR1L
001DE8 01??           00231                 MOVLB   HIGH MessBank
001DEA C??? FFE2      00232                 MOVFF   MessBank,FSR1H
001DEE 6A??           00233                 CLRF    CheckSum
                      00234 ;               MOVLW   0
                      00235 ;               CPFSGT  MessLen
                      00236 ;               RETURN
                      00237         ; Wait for Receiver buffer to fill, or a timeout
001DF0                00238 UI1
001DF0 01??           00239                 MOVLB   HIGH TimeOut
001DF2 0E05           00240                 MOVLW   d'5'
001DF4 6E??           00241                 MOVWF   TimeOut
001DF6 6AE8           00242                 CLRF    WREG
001DF8                00243 UI1a
001DF8 64??           00244                 CPFSGT  TimeOut
001DFA EF?? F???      00245                 GOTO    UI2
001DFE AA9E           00246                 BTFSS   PIR1,RC1IF
001E00 EF?? F???      00247                 GOTO    UI1a
                      00248         ; Now read the char from the UART and save it
001E04 CFAE FFE8      00249                 MOVFF   RCREG1,WREG
001E08 CFE8 FFE6      00250                 MOVFF   WREG,POSTINC1
001E0C 01??           00251                 MOVLB   HIGH CheckSum
001E0E 26??           00252                 ADDWF   CheckSum
                      00253         ; Check the loop counter...
001E10 01??           00254                 MOVLB   HIGH MessLen
001E12 2E??           00255                 DECFSZ  MessLen
001E14 EF?? F???      00256                 GOTO    UI1
                      00257         ; Restore regs...
001E18                00258 UI2
001E18 C??? FFE1      00259                 MOVFF   FSR1Lsave, FSR1L
001E1C C??? FFE2      00260                 MOVFF   FSR1Hsave, FSR1H
001E20 0012           00261                 RETURN
                      00262 
                      00263 ;Cmd            RES     1       ; This flag is set by a host PC to
                      00264 ;                               ; request an action.
                      00265 ;
                      00266 ; The following variables are used by USART1 serial receiver. Receive messages
                      00267 ; are in the following format:
                      00268 ;               1 byte, start of message = 0x55
                      00269 ;               1 byte, message type
                      00270 ;               1 byte, Bank address
                      00271 ;               1 byte, location
                      00272 ;               1 byte, data length
                      00273 ;               (optional data block if its a receive message)
                      00274 ;               1 byte, mod 256 checksum
                      00275 ; Valid message types are:
                      00276 ;       1 = Reveive message, from host
                      00277 ;       2 = Send message, to host
                      00278 ; Valid commands are:
                      00279 ;       31 = Read general data from flash
                      00280 ;       32 = Read selected aircraft data from flash
                      00281 ;       33 = Write general data to flash
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 135


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00282 ;       34 = Write selected aircraft data to flash
                      00283 ;       35 = Reset the flash programmed flag
                      00284 ;
                      00285 ;RECMESS        EQU     1
                      00286 ;SENDMESS       EQU     2
                      00287 ;ACK            EQU     D'12'
                      00288 ;NAK            EQU     D'13'
                      00289 ;
001E22                00290 USART1rec
                      00291         ; Look for a character in the input buffer
001E22 AA9E           00292                 BTFSS   PIR1,RC1IF
001E24 0012           00293                 RETURN
                      00294         ; Here with a character, test state and jump to correct 
                      00295         ; entry point
001E26 01??           00296                 MOVLB   HIGH MessState
001E28 0E00           00297                 MOVLW   0
001E2A 62??           00298                 CPFSEQ  MessState
001E2C EF?? F???      00299                 GOTO    UR1
                      00300         ; Here if state is 0, looking for a start of message byte
001E30 CFAE FFE8      00301                 MOVFF   RCREG1,WREG
001E34 CFE8 F???      00302                 MOVFF   WREG,MessStart
001E38 0E55           00303                 MOVLW   55
001E3A 62??           00304                 CPFSEQ  MessStart
001E3C 0012           00305                 RETURN
                      00306                 ; Advance the state... and set the message timeout value
001E3E 0E28           00307                 MOVLW   D'40'
001E40 CFE8 F???      00308                 MOVFF   WREG,TimeOut1
001E44 2A??           00309                 INCF    MessState
001E46 0012           00310                 RETURN
001E48                00311 UR1
001E48 0E01           00312                 MOVLW   1
001E4A 62??           00313                 CPFSEQ  MessState
001E4C EF?? F???      00314                 GOTO    UR2
                      00315         ; Here if state is 1, looking for a message command
001E50 CFAE FFE8      00316                 MOVFF   RCREG1,WREG
001E54 CFE8 F???      00317                 MOVFF   WREG,MessType
001E58 2A??           00318                 INCF    MessState
001E5A 0012           00319                 RETURN
001E5C                00320 UR2
001E5C 0E02           00321                 MOVLW   2
001E5E 62??           00322                 CPFSEQ  MessState
001E60 EF?? F???      00323                 GOTO    UR3
                      00324         ; Here if state is 2, looking for a bank address
001E64 CFAE FFE8      00325                 MOVFF   RCREG1,WREG
001E68 CFE8 F???      00326                 MOVFF   WREG,MessBank
001E6C 2A??           00327                 INCF    MessState
001E6E 0012           00328                 RETURN
001E70                00329 UR3
001E70 0E03           00330                 MOVLW   3
001E72 62??           00331                 CPFSEQ  MessState
001E74 EF?? F???      00332                 GOTO    UR4
                      00333         ; Here if state is 3, looking for a location byte
001E78 CFAE FFE8      00334                 MOVFF   RCREG1,WREG
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 136


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

001E7C CFE8 F???      00335                 MOVFF   WREG,MessLoc
001E80 2A??           00336                 INCF    MessState
001E82 0012           00337                 RETURN
                      00338 
001E84                00339 UR4
001E84 0E04           00340                 MOVLW   4
001E86 62??           00341                 CPFSEQ  MessState
001E88 EF?? F???      00342                 GOTO    UR5
                      00343         ; Here if state is 4, looking for number of bytes in message
001E8C CFAE FFE8      00344                 MOVFF   RCREG1,WREG
001E90 CFE8 F???      00345                 MOVFF   WREG,MessLen
001E94 2A??           00346                 INCF    MessState
                      00347         ; Fall into state 5, no character input is needed for this state transistion
001E96                00348 UR5
001E96 0E05           00349                 MOVLW   5
001E98 62??           00350                 CPFSEQ  MessState
001E9A EF?? F???      00351                 GOTO    UR6
                      00352         ; Here if state is 5, Now we send or receive the message
                      00353                 ; If message type is receive then call the message block
                      00354                 ; receive function here... else advance to the next state
                      00355                 ; and get the checksum...
001E9E 0E01           00356                 MOVLW   RECMESS
001EA0 62??           00357                 CPFSEQ  MessType
001EA2 EF?? F???      00358                 GOTO    UR5a
                      00359                 ; Here if its a rec message type so call the rec mess function
001EA6 EC?? F???      00360                 CALL    USART1in
001EAA                00361 UR5a
001EAA 2A??           00362                 INCF    MessState
001EAC 0012           00363                 RETURN
001EAE                00364 UR6
001EAE 0E06           00365                 MOVLW   6
001EB0 62??           00366                 CPFSEQ  MessState
001EB2 EF?? F???      00367                 GOTO    UR7
                      00368         ; Here if state is 6, Read the checksum
001EB6 CFAE FFE8      00369                 MOVFF   RCREG1,WREG
001EBA CFE8 F???      00370                 MOVFF   WREG,MessCHK
                      00371         ; Validate message and send the response:
                      00372         ;   If we just received a message compare the checksums and send
                      00373         ;   ACK or NAK.
                      00374         ;   If this is a send message then igore the checksum and send the data
                      00375         ;   followed by a checksum.
001EBE 0E02           00376                 MOVLW   SENDMESS
001EC0 62??           00377                 CPFSEQ  MessType
001EC2 EF?? F???      00378                 GOTO    UR6a
001EC6 EC?? F???      00379                 CALL    USART1send
001ECA C??? FFE8      00380                 MOVFF   CheckSum,WREG
001ECE EC?? F???      00381                 CALL    USART1sendChar
001ED2 6A??           00382                 CLRF    MessState
001ED4 0012           00383                 RETURN
                      00384         ; Compare the checksums on receive messages
001ED6                00385 UR6a
001ED6 C??? FFE8      00386                 MOVFF   CheckSum,WREG
001EDA 62??           00387                 CPFSEQ  MessCHK
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 137


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

001EDC EF?? F???      00388                 GOTO    UR6b
001EE0 0E0C           00389                 MOVLW   ACK
001EE2 EC?? F???      00390                 CALL    USART1sendChar
001EE6 6A??           00391                 CLRF    MessState
001EE8 0012           00392                 RETURN
001EEA                00393 UR6b
001EEA 0E0D           00394                 MOVLW   NAK
001EEC EC?? F???      00395                 CALL    USART1sendChar
001EF0 6A??           00396                 CLRF    MessState
001EF2 0012           00397                 RETURN
                      00398         ; Exit and clear the state variable
001EF4                00399 UR7
001EF4 6A??           00400                 CLRF    MessState
001EF6 0012           00401                 RETURN
                      00402 
                      00403 ; This function is used in the buddy box system. If this transmitter
                      00404 ; is in the student mode then channels 1 through 4 are sent out serial
                      00405 ; port 2. The normalized servo positions are sent, without the trims.
                      00406 ; This is only done in the RUN mode.
                      00407 ; This function is also called in master mode with a received char.
001EF8                00408 SendStudent
                      00409         ; Look for a character in the input buffer
001EF8 AAA4           00410                 BTFSS   PIR3,RC2IF
001EFA 0012           00411                 RETURN
001EFC CF6E FFE8      00412                 MOVFF   RCREG2,WREG
                      00413         ; If We are in the master mode then jump to its routine
001F00 01??           00414                 MOVLB   HIGH Master
001F02 B0??           00415                 BTFSC   Master,0
001F04 EF?? F???      00416                 GOTO    MasterISR
                      00417         ; Test for send position command
001F08 0A53           00418                 XORLW   'S'
001F0A A4D8           00419                 BTFSS   ALUSTA,Z
001F0C 0012           00420                 RETURN
                      00421         ; Test if we are in student mode
001F0E 01??           00422                 MOVLB   HIGH Student
001F10 A0??           00423                 BTFSS   Student,0
001F12 0012           00424                 RETURN
                      00425         ; Here if in student mode.....
                      00426                 ; Aileron
001F14 01??           00427                 MOVLB   HIGH Apos
001F16 0E0F           00428                 MOVLW   0F
001F18 14??           00429                 ANDWF   Apos+1,W
001F1A 0910           00430                 IORLW   10
001F1C EC?? F???      00431                 CALL    USART2sendChar
001F20 C??? FFE8      00432                 MOVFF   Apos,WREG
001F24 EC?? F???      00433                 CALL    USART2sendChar
                      00434                 ; Introduce a small delay to let the UART resync if needed. This will
                      00435                 ; allow for slight differences in CPU clocks 
001F28 EC?? F???      00436                 CALL    USART2sendEmpty
001F2C 0E05           00437                 MOVLW   D'5'
001F2E EC?? F???      00438                 CALL    Delay2uS
                      00439                 ; Elevator
001F32 01??           00440                 MOVLB   HIGH Epos
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 138


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

001F34 0E0F           00441                 MOVLW   0F
001F36 14??           00442                 ANDWF   Epos+1,W
001F38 0920           00443                 IORLW   20
001F3A EC?? F???      00444                 CALL    USART2sendChar
001F3E 50??           00445                 MOVF    Epos,W
001F40 EC?? F???      00446                 CALL    USART2sendChar
                      00447                 ; Introduce a small delay to let the UART resync if needed. This will
                      00448                 ; allow for slight differences in CPU clocks 
001F44 EC?? F???      00449                 CALL    USART2sendEmpty
001F48 0E05           00450                 MOVLW   D'5'
001F4A EC?? F???      00451                 CALL    Delay2uS
                      00452                 ; Rudder
001F4E 01??           00453                 MOVLB   HIGH Rpos
001F50 0E0F           00454                 MOVLW   0F
001F52 14??           00455                 ANDWF   Rpos+1,W
001F54 0930           00456                 IORLW   30
001F56 EC?? F???      00457                 CALL    USART2sendChar
001F5A 50??           00458                 MOVF    Rpos,W
001F5C EC?? F???      00459                 CALL    USART2sendChar
                      00460                 ; Introduce a small delay to let the UART resync if needed. This will
                      00461                 ; allow for slight differences in CPU clocks 
001F60 EC?? F???      00462                 CALL    USART2sendEmpty
001F64 0E05           00463                 MOVLW   D'5'
001F66 EC?? F???      00464                 CALL    Delay2uS
                      00465                 ; Throttle
001F6A 01??           00466                 MOVLB   HIGH Tpos
001F6C 0E0F           00467                 MOVLW   0F
001F6E 14??           00468                 ANDWF   Tpos+1,W
001F70 0940           00469                 IORLW   40
001F72 EC?? F???      00470                 CALL    USART2sendChar
001F76 50??           00471                 MOVF    Tpos,W
001F78 EC?? F???      00472                 CALL    USART2sendChar
001F7C 0012           00473                 RETURN
                      00474 
001F7E                00475 MasterISR
                      00476         ; Test State variable, if LSB is zero then save this value
                      00477         ; and exit
001F7E 01??           00478                 MOVLB   HIGH MasterState
001F80 B0??           00479                 BTFSC   MasterState,0
001F82 EF?? F???      00480                 GOTO    MasterState1
                      00481                 ; Here with high byte of message
001F86 6E??           00482                 MOVWF   MasterPos+1
001F88 2A??           00483                 INCF    MasterState
001F8A 0012           00484                 RETURN
001F8C                00485 MasterState1
001F8C 6E??           00486                 MOVWF   MasterPos
001F8E 2A??           00487                 INCF    MasterState
                      00488         ; Test the state a process message
001F90 0E02           00489                 MOVLW   2
001F92 62??           00490                 CPFSEQ  MasterState
001F94 EF?? F???      00491                 GOTO    MS2
                      00492         ; Here if Aileron
001F98 50??           00493                 MOVF    MasterPos+1,W
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 139


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

001F9A 0BF0           00494                 ANDLW   0F0
001F9C 0A10           00495                 XORLW   010
001F9E A4D8           00496                 BTFSS   ALUSTA,Z
001FA0 EF?? F???      00497                 GOTO    MS5
001FA4 0E0F           00498                 MOVLW   0F
001FA6 16??           00499                 ANDWF   MasterPos+1,F
001FA8 A6??           00500                 BTFSS   MasterPos+1,3
001FAA EF?? F???      00501                 GOTO    MS1a
001FAE 0EF0           00502                 MOVLW   0F0
001FB0 12??           00503                 IORWF   MasterPos+1
001FB2                00504 MS1a
                      00505                 MOVE    MasterPos,MApos
001FB2 C??? F???          M                 MOVFF   MasterPos,MApos
001FB6 C??? F???          M                 MOVFF   (MasterPos+1),(MApos+1)
001FBA EF?? F???      00506                 GOTO    MS5
001FBE                00507 MS2
001FBE 0E04           00508                 MOVLW   4
001FC0 62??           00509                 CPFSEQ  MasterState
001FC2 EF?? F???      00510                 GOTO    MS3
                      00511         ; Here if Elevator
001FC6 50??           00512                 MOVF    MasterPos+1,W
001FC8 0BF0           00513                 ANDLW   0F0
001FCA 0A20           00514                 XORLW   020
001FCC A4D8           00515                 BTFSS   ALUSTA,Z
001FCE EF?? F???      00516                 GOTO    MS5
001FD2 0E0F           00517                 MOVLW   0F
001FD4 16??           00518                 ANDWF   MasterPos+1,F
001FD6 A6??           00519                 BTFSS   MasterPos+1,3
001FD8 EF?? F???      00520                 GOTO    MS2a
001FDC 0EF0           00521                 MOVLW   0F0
001FDE 12??           00522                 IORWF   MasterPos+1
001FE0                00523 MS2a
                      00524                 MOVE    MasterPos,MEpos
001FE0 C??? F???          M                 MOVFF   MasterPos,MEpos
001FE4 C??? F???          M                 MOVFF   (MasterPos+1),(MEpos+1)
001FE8 EF?? F???      00525                 GOTO    MS5
001FEC                00526 MS3
001FEC 0E06           00527                 MOVLW   6
001FEE 62??           00528                 CPFSEQ  MasterState
001FF0 EF?? F???      00529                 GOTO    MS4
                      00530         ; Here if Rudder
001FF4 50??           00531                 MOVF    MasterPos+1,W
001FF6 0BF0           00532                 ANDLW   0F0
001FF8 0A30           00533                 XORLW   030
001FFA A4D8           00534                 BTFSS   ALUSTA,Z
001FFC EF?? F???      00535                 GOTO    MS5
002000 0E0F           00536                 MOVLW   0F
002002 16??           00537                 ANDWF   MasterPos+1,F
002004 A6??           00538                 BTFSS   MasterPos+1,3
002006 EF?? F???      00539                 GOTO    MS3a
00200A 0EF0           00540                 MOVLW   0F0
00200C 12??           00541                 IORWF   MasterPos+1
00200E                00542 MS3a
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 140


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00543                 MOVE    MasterPos,MRpos
00200E C??? F???          M                 MOVFF   MasterPos,MRpos
002012 C??? F???          M                 MOVFF   (MasterPos+1),(MRpos+1)
002016 EF?? F???      00544                 GOTO    MS5
00201A                00545 MS4
00201A 0E08           00546                 MOVLW   8
00201C 62??           00547                 CPFSEQ  MasterState
00201E EF?? F???      00548                 GOTO    MS5
                      00549         ; Here if Throttle
002022 50??           00550                 MOVF    MasterPos+1,W
002024 0BF0           00551                 ANDLW   0F0
002026 0A40           00552                 XORLW   040
002028 A4D8           00553                 BTFSS   ALUSTA,Z
00202A EF?? F???      00554                 GOTO    MS5
00202E 0E0F           00555                 MOVLW   0F
002030 16??           00556                 ANDWF   MasterPos+1,F
002032 A6??           00557                 BTFSS   MasterPos+1,3
002034 EF?? F???      00558                 GOTO    MS4a
002038 0EF0           00559                 MOVLW   0F0
00203A 12??           00560                 IORWF   MasterPos+1
00203C                00561 MS4a
                      00562                 MOVE    MasterPos,MTpos
00203C C??? F???          M                 MOVFF   MasterPos,MTpos
002040 C??? F???          M                 MOVFF   (MasterPos+1),(MTpos+1)
002044 EF?? F???      00563                 GOTO    MS5
002048                00564 MS5
002048 0012           00565                 RETURN
                      00566 
                      00567 
                      00568 ;
                      00569 ; This function uses USART2 to send the position data using USART channel 2.
                      00570 ; This function supports connecting the encoder to a receiving device that
                      00571 ; can convert the serial data stream into servo position pulses. The number
                      00572 ; of channels sent are defined by the microstar number of channels 
                      00573 ; parameter.
                      00574 ; The position information is set at the framing rate of the encoder and each
                      00575 ; channel's data in send in two bytes, LS first.
                      00576 ;
                      00577 ; Data block format:
                      00578 ;       <SOT><SOT><channel 1 position, 2 bytes, LS first>...<channel n><Checksum><EOT><EOT>
                      00579 ;
                      00580 ;       <SOT> = Start of text character, 0xAA
                      00581 ;       <EOT> = End of text character, 0xED
                      00582 ;       Checksum is a mod 256 sum of all channel position data
                      00583 ;       Channel position data is sent in 2 bytes and the 4 MSB of the MS byte
                      00584 ;       contain the channel number
                      00585 ;
  000000AA            00586 SOT     EQU     0xAA
  000000ED            00587 EOT     EQU     0xED
                      00588 
00204A                00589 SerialSendPositionData
                      00590         ; Exit if the send flag is not set
00204A C??? FFE8      00591                 MOVFF   SerialSend,WREG
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 141


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

00204E 1EE8           00592                 COMF    WREG
002050 66E8           00593                 TSTFSZ  WREG
002052 0012           00594                 RETURN
                      00595         ; Send SOT characters
002054 0EAA           00596                 MOVLW   SOT
002056 EC?? F???      00597                 CALL    USART2sendChar
00205A 0EAA           00598                 MOVLW   SOT
00205C EC?? F???      00599                 CALL    USART2sendChar
                      00600         ; Send the channel data
                      00601                 ; Areg is the loop counter
002060 6A00           00602                 CLRF    Areg,A
                      00603                 ; Breg is the checksum
002062 6A00           00604                 CLRF    Breg,A
                      00605                 ; Areg contains current channel number. First use channel order
                      00606                 ; to determine the channel number to send.
002064                00607 SSPDnext
002064 0E??           00608                 MOVLW   HIGH ChannelOrder
002066 6EE2           00609                 MOVWF   FSR1H
002068 0E??           00610                 MOVLW   LOW ChannelOrder
00206A 6EE1           00611                 MOVWF   FSR1L
00206C C??? FFE8      00612                 MOVFF   Areg,WREG
002070 CFE3 F???      00613                 MOVFF   PLUSW1,AXreg            ; AXreg has channel number
                      00614                 ; Now get channel number
002074 0E??           00615                 MOVLW   HIGH (CHtimes+2)        
002076 6EE2           00616                 MOVWF   FSR1H
002078 0E??           00617                 MOVLW   LOW (CHtimes+2) 
00207A 6EE1           00618                 MOVWF   FSR1L
                      00619                 ; Build prointer into CHtimes
00207C C??? FFE8      00620                 MOVFF   AXreg,WREG
002080 06E8           00621                 DECF    WREG
002082 90D8           00622                 BCF     ALUSTA,C
002084 36E8           00623                 RLCF    WREG    
                      00624                 ; Load value from CHtimes
002086 CFE3 F???      00625                 MOVFF   PLUSW1,AXreg
00208A 2AE8           00626                 INCF    WREG
00208C CFE3 F???      00627                 MOVFF   PLUSW1,AXreg+1          ; Channel data is now in AXreg
                      00628                 ; Add channel sequence number to MS nibble in channel data word
002090 01??           00629                 MOVLR   HIGH AXreg
002092 3A??           00630                 SWAPF   AXreg+1
002094 0EF0           00631                 MOVLW   0xF0
002096 16??           00632                 ANDWF   AXreg+1,F
002098 C??? FFE8      00633                 MOVFF   Areg,WREG
00209C 2AE8           00634                 INCF    WREG
00209E 12??           00635                 IORWF   AXreg+1,F
0020A0 3A??           00636                 SWAPF   AXreg+1
                      00637                 ; Add these bytes to the checksum
0020A2 C??? FFE8      00638                 MOVFF   Breg,WREG
0020A6 24??           00639                 ADDWF   AXreg,W
0020A8 24??           00640                 ADDWF   AXreg+1,W
0020AA CFE8 F???      00641                 MOVFF   WREG,Breg
                      00642                 ; Send the channel position data
0020AE C??? FFE8      00643                 MOVFF   AXreg,WREG
0020B2 EC?? F???      00644                 CALL    USART2sendChar
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 142


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

0020B6 C??? FFE8      00645                 MOVFF   AXreg+1,WREG
0020BA EC?? F???      00646                 CALL    USART2sendChar
                      00647                 ; Advance the loop counter and continue till all channels are done, 8 channels max
0020BE 2A00           00648                 INCF    Areg,F,A
0020C0 0E08           00649                 MOVLW   8
0020C2 6000           00650                 CPFSLT  Areg,A
0020C4 EF?? F???      00651                 GOTO    SSPDdone
0020C8 C??? FFE8      00652                 MOVFF   MaxChannels,WREG
0020CC 90D8           00653                 BCF     ALUSTA,C
0020CE 32E8           00654                 RRCF    WREG
0020D0 6400           00655                 CPFSGT  Areg,A
0020D2 EF?? F???      00656                 GOTO    SSPDnext                
                      00657         ; Send the checksum
0020D6                00658 SSPDdone
0020D6 C??? FFE8      00659                 MOVFF   Breg,WREG
0020DA EC?? F???      00660                 CALL    USART2sendChar
                      00661         ; Send the EOT characters
0020DE 0EED           00662                 MOVLW   EOT
0020E0 EC?? F???      00663                 CALL    USART2sendChar
0020E4 0EED           00664                 MOVLW   EOT
0020E6 EC?? F???      00665                 CALL    USART2sendChar
                      00666         ; Exit
0020EA 0012           00667                 RETURN
                      00668                 
                      02808                 Include <FMS.asm>
                      00001 ; 
                      00002 ; FMS.asm
                      00003 ;
                      00004 ;  This file contains the routines needed to support the Flight Model simulator.
                      00005 ;  FMS is a free simulator that will accept RS232 position input data. FMS
                      00006 ;  expects the following:
                      00007 ;    0xF0 start of data block
                      00008 ;    One byte per data channel, 0=1mS, 239=2mS do not send a 0xF0 in the data block.
                      00009 ;  The number of channels sent is defined by the number of position bytes sent.
                      00010 ;  The baud rate is set at 9600, FMS supports 19200 but the PIC clock does not allow
                      00011 ;  this rate to be generated with enough accuracy.
                      00012 ;  
                      00013 
                      00014 ; This function initalizes the UART for FMS operation. The UART selected for initalization
                      00015 ; is defined via the FMSflag and FMSflagU1 values. FMSflag is set for UART2 and FMSflagU1 is 
                      00016 ; set for UART 1.
0020EC                00017 FMSinit
                      00018         ; Test the flag to determine the UART to use.
0020EC 01??           00019                 MOVLB   HIGH FMSflag            ; This flag is set for UART 2
0020EE 66??           00020                 TSTFSZ  FMSflag 
0020F0 EF?? F???      00021                 GOTO    FMSinit1        
                      00022         ;
                      00023         ; Here for UART 1
                      00024         ;
                      00025         ; Disable 16 bit baudrate mode
0020F4 967E           00026                 BCF     BAUDCON1,BRG16,A
                      00027         ; Baudrate generator
0020F6 0E0C           00028                 MOVLW   D'12'           ; 9600 baud
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 143


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

0020F8 010F           00029                 MOVLB   HIGH SPBRG1
0020FA 6EAF           00030                 MOVWF   SPBRG1
                      00031         ; Enable transmitter
0020FC 0E22           00032                 MOVLW   22
0020FE 6EAC           00033                 MOVWF   TXSTA1
                      00034         ; Receiver
002100 0E90           00035                 MOVLW   90
002102 CFE8 FFAB      00036                 MOVFF   WREG,RCSTA1
002106 0012           00037                 RETURN
                      00038         ;
                      00039         ; Here for UART 2
                      00040         ;
002108                00041 FMSinit1
                      00042         ; Disable 16 bit baudrate mode
002108 967C           00043                 BCF     BAUDCON2,BRG16,A
                      00044         ; Baudrate generator
00210A 0E0C           00045                 MOVLW   D'12'           ; 9600 baud
00210C 010F           00046                 MOVLB   HIGH SPBRG2
00210E 6E6F           00047                 MOVWF   SPBRG2
                      00048         ; Enable transmitter
002110 0E22           00049                 MOVLW   22
002112 6E6C           00050                 MOVWF   TXSTA2
                      00051         ; Receiver
002114 0E90           00052                 MOVLW   90
002116 CFE8 FF6B      00053                 MOVFF   WREG,RCSTA2
00211A 0012           00054                 RETURN
                      00055 
                      00056 ; This function sends a centered channel using UART 2.
                      00057 ; The normalized position data is in AXreg. The range of
                      00058 ; this value is -1000 to 1000
00211C                00059 FMScenter
                      00060         ; Add 1000 to AXreg
00211C 01??           00061                 MOVLB   HIGH AXreg
00211E 0EE8           00062                 MOVLW   LOW D'1000'
002120 26??           00063                 ADDWF   AXreg
002122 0E03           00064                 MOVLW   HIGH D'1000'
002124 22??           00065                 ADDWFC  AXreg+1
                      00066                 ; If AXreg is negative then set it to zero
002126 AE??           00067                 BTFSS   AXreg+1,7
002128 EF?? F???      00068                 GOTO    FMScNotZ
00212C 6AE8           00069                 CLRF    WREG
00212E CFE8 F???      00070                 MOVFF   WREG,AXreg
002132 CFE8 F???      00071                 MOVFF   WREG,AXreg+1
                      00072         ; Limit test, if AX is greater than 1912 then send 239.
002136                00073 FMScNotZ
002136 0E78           00074                 MOVLW   LOW D'1912'
002138 5C??           00075                 SUBWF   AXreg,W
00213A 0E07           00076                 MOVLW   HIGH D'1912'
00213C 58??           00077                 SUBWFB  AXreg+1,W
00213E A0D8           00078                 BTFSS   ALUSTA,C
002140 EF?? F???      00079                 GOTO    FMSdiv8
002144 0EEF           00080                 MOVLW   D'239'
002146 EF?? F???      00081                 GOTO    FMSsend
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 144


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00082         ; Divide by 8
00214A                00083 FMSdiv8
00214A 32??           00084                 RRCF    AXreg+1
00214C 32??           00085                 RRCF    AXreg           ; Devide by 2
00214E                00086 FMSdiv4
00214E 32??           00087                 RRCF    AXreg+1
002150 32??           00088                 RRCF    AXreg           ; Devide by 4
002152 32??           00089                 RRCF    AXreg+1
002154 32??           00090                 RRCF    AXreg           ; Devide by 8
002156 50??           00091                 MOVF    AXreg,W
                      00092         ; Send
002158                00093 FMSsend
                      00094         ; Use the flag to select the proper uart to use
002158 01??           00095                 MOVLB   HIGH FMSflag    ; This flag is set for UART 2
00215A 66??           00096                 TSTFSZ  FMSflag 
00215C EF?? F???      00097                 GOTO    USART2sendChar
002160 EF?? F???      00098                 GOTO    USART1sendChar
                      00099 
                      00100 ; This function sends a non centered channel using UART 2.              
                      00101 ; The normalized position data is in AXreg. The range of
                      00102 ; this value is 0 to 1000
002164                00103 FMSnonCenter
                      00104         ; If AXreg is negative then set it to zero
002164 01??           00105                 MOVLR   HIGH AXreg
002166 AE??           00106                 BTFSS   AXreg+1,7
002168 EF?? F???      00107                 GOTO    FMSNotZ
00216C 6AE8           00108                 CLRF    WREG
00216E CFE8 F???      00109                 MOVFF   WREG,AXreg
002172 CFE8 F???      00110                 MOVFF   WREG,AXreg+1
                      00111         ; Limit test, if AX is greater than 956 then send 239.
002176                00112 FMSNotZ
002176 0EBC           00113                 MOVLW   LOW D'956'
002178 5C??           00114                 SUBWF   AXreg,W
00217A 0E03           00115                 MOVLW   HIGH D'956'
00217C 58??           00116                 SUBWFB  AXreg+1,W
00217E A0D8           00117                 BTFSS   ALUSTA,C
002180 EF?? F???      00118                 GOTO    FMSdiv4
002184 0EEF           00119                 MOVLW   D'239'
002186 EF?? F???      00120                 GOTO    FMSsend
                      00121         
                      00122                 
                      00123 ; This function sends the data blocks using UART 2. The following 
                      00124 ; channels are send in the following order:
                      00125 ;       Aileron
                      00126 ;       Elevator
                      00127 ;       Rudder
                      00128 ;       Throttle
                      00129 ;       CH5 (Retracts)
                      00130 ;       CH6
00218A                00131 FMS
                      00132         ; Send the sync character
00218A 0EF0           00133                 MOVLW   0F0
00218C EC?? F???      00134                 CALL    FMSsend
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 145


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

002190 0E80           00135                 MOVLW   080
002192 EC?? F???      00136                 CALL    FMSsend                 ; Don't know why I hade to send this byte?
                      00137         ; Process Ail, Ele, and Rud
                      00138                 MOVE16  Apos,AXreg
002196 C??? F???          M                 MOVFF   Apos,AXreg
00219A C??? F???          M                 MOVFF   (Apos+1),(AXreg+1)
00219E EC?? F???      00139                 CALL    FMScenter
                      00140                 MOVE16  Epos,AXreg
0021A2 C??? F???          M                 MOVFF   Epos,AXreg
0021A6 C??? F???          M                 MOVFF   (Epos+1),(AXreg+1)
0021AA EC?? F???      00141                 CALL    FMScenter
                      00142                 MOVE16  Rpos,AXreg
0021AE C??? F???          M                 MOVFF   Rpos,AXreg
0021B2 C??? F???          M                 MOVFF   (Rpos+1),(AXreg+1)
0021B6 EC?? F???      00143                 CALL    FMScenter
                      00144         ; Process Throttle, and CH5, CH6
                      00145                 MOVE16  Tpos,AXreg
0021BA C??? F???          M                 MOVFF   Tpos,AXreg
0021BE C??? F???          M                 MOVFF   (Tpos+1),(AXreg+1)
0021C2 EC?? F???      00146                 CALL    FMSnonCenter
                      00147                 MOVE16  CH5pos,AXreg
0021C6 C??? F???          M                 MOVFF   CH5pos,AXreg
0021CA C??? F???          M                 MOVFF   (CH5pos+1),(AXreg+1)
0021CE EC?? F???      00148                 CALL    FMScenter
                      00149                 MOVE16  CH6pos,AXreg
0021D2 C??? F???          M                 MOVFF   CH6pos,AXreg
0021D6 C??? F???          M                 MOVFF   (CH6pos+1),(AXreg+1)
0021DA EC?? F???      00150                 CALL    FMScenter
                      00151         ; Done!
0021DE 0012           00152                 RETURN
                      00153 
                      00154 
                      00155 
                      02809                 Include <Math.asm>
                      00001 #define _C              ALUSTA,0
                      00002 #define _DC             ALUSTA,1
                      00003 #define _Z              ALUSTA,2
                      00004 #define _OV             ALUSTA,3
                      00005 
  00000007            00006 MSB             equ     7
  00000000            00007 LSB             equ     0
  00000004            00008 NAN             equ     4       ; bit4 = not-a-number exception flag
                      00009 
                      00010 
                      00011 ;
                      00012 ; Math functions...
                      00013 ;
                      00014 ; This routine does a 16x16 multiply with a 32 bit result.
                      00015 ;  CEXreg = AXreg * BXreg
                      00016 ;
                      00017 ; Numbers are saved in intel order LS first
                      00018 ;
0021E0                00019 Mult1616
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 146


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00020         ; First do the unsigned multiply
0021E0 EC?? F???      00021                 CALL    Mult1616u
                      00022         ; Test sign of BXreg correct if neg
0021E4 AE??           00023                 BTFSS   BXreg+1,7
0021E6 EF?? F???      00024                 GOTO    Mult1
0021EA 50??           00025                 MOVFP   AXreg,W
0021EC 5E??           00026                 SUBWF   CEXreg+2
0021EE 50??           00027                 MOVFP   AXreg+1,W
0021F0 5A??           00028                 SUBWFB  CEXreg+3
0021F2                00029 Mult1
                      00030         ; Test sign of AXreg correct if neg
0021F2 AE??           00031                 BTFSS   AXreg+1,7
0021F4 EF?? F???      00032                 GOTO    Mult2
0021F8 50??           00033                 MOVFP   BXreg,W
0021FA 5E??           00034                 SUBWF   CEXreg+2
0021FC 50??           00035                 MOVFP   BXreg+1,W
0021FE 5A??           00036                 SUBWFB  CEXreg+3
002200                00037 Mult2
                      00038         ; Done! 
002200 0012           00039                 RETURN
                      00040 ;
                      00041 ; Unsigned 16x16 multiply
                      00042 ;
                      00043 ; This routine does a 16x16 multiply with a 32 bit result.
                      00044 ;  CEXreg = AXreg * BXreg
                      00045 ;
                      00046 ; Numbers are saved in intel order LS first
                      00047 ;
002202                00048 Mult1616u
002202 01??           00049                 MOVLR   HIGH AXreg
002204 6A??           00050                 CLRF    CEXreg
002206 6A??           00051                 CLRF    CEXreg+1
002208 6A??           00052                 CLRF    CEXreg+2
00220A 6A??           00053                 CLRF    CEXreg+3
                      00054         ; LSB of BX times LSB of AX
00220C 50??           00055                 MOVFP   BXreg,W
00220E 02??           00056                 MULWF   AXreg
002210 CFF3 F???      00057                 MOVPF   PRODL,CEXreg
002214 CFF4 F???      00058                 MOVPF   PRODH,CEXreg+1
                      00059         ; LSB of BX times MSB of AX
002218 50??           00060                 MOVFP   BXreg,W
00221A 02??           00061                 MULWF   AXreg+1
00221C 50F3           00062                 MOVFP   PRODL,W
00221E 26??           00063                 ADDWF   CEXreg+1
002220 50F4           00064                 MOVFP   PRODH,W
002222 22??           00065                 ADDWFC  CEXreg+2
002224 B0D8           00066                 BTFSC   ALUSTA,C,A
002226 2A??           00067                 INCF    CEXreg+3
                      00068         ; MSB of BX times LSB of AX
002228 50??           00069                 MOVFP   BXreg+1,W
00222A 02??           00070                 MULWF   AXreg
00222C 50F3           00071                 MOVFP   PRODL,W
00222E 26??           00072                 ADDWF   CEXreg+1
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 147


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

002230 50F4           00073                 MOVFP   PRODH,W
002232 22??           00074                 ADDWFC  CEXreg+2
002234 B0D8           00075                 BTFSC   ALUSTA,C,A
002236 2A??           00076                 INCF    CEXreg+3
                      00077         ; MSB of BX times MSB of AX
002238 50??           00078                 MOVFP   BXreg+1,W
00223A 02??           00079                 MULWF   AXreg+1
00223C 50F3           00080                 MOVFP   PRODL,W
00223E 26??           00081                 ADDWF   CEXreg+2
002240 50F4           00082                 MOVFP   PRODH,W
002242 22??           00083                 ADDWFC  CEXreg+3
                      00084         ; Done! 
002244 0012           00085                 RETURN
                      00086 
                      00087 ;**********************************************************************************************
                      00088 ;**********************************************************************************************
                      00089 ;
                      00090 ;       16/08 BIT Division Macros
                      00091 ;
                      00092 SDIV1608        macro
                      00093 ;
                      00094 ;       Max Timing:     3+5+14*8+2 = 122 clks
                      00095 ;
                      00096 ;       Min Timing:     3+5+14*8+2 = 122 clks
                      00097 ;
                      00098 ;       PM: 3+5+14*8+2 = 122            DM: 4
                      00099 ;
                      00100                 variable i
                      00101 
                      00102                 MOVFP           DEXreg,WREG
                      00103                 SUBWF           EEXreg, F
                      00104                 RLCF            CEXreg+1, F
                      00105 
                      00106                 RLCF            CEXreg+1,W
                      00107                 RLCF            EEXreg, F
                      00108                 MOVFP           DEXreg,WREG
                      00109                 ADDWF           EEXreg, F
                      00110                 RLCF            CEXreg+1, F
                      00111 
                      00112                 variable i = D'2'
                      00113 
                      00114                 while i < D'8'
                      00115 
                      00116                 RLCF            CEXreg+1,W
                      00117                 RLCF            EEXreg, F
                      00118                 MOVFP           DEXreg,WREG
                      00119 
                      00120                 BTFSC           CEXreg+1,LSB
                      00121                 SUBWF           EEXreg, F
                      00122                 BTFSS           CEXreg+1,LSB
                      00123                 ADDWF           EEXreg, F
                      00124                 RLCF            CEXreg+1, F
                      00125 
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 148


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00126                 variable i=i+1
                      00127 
                      00128                 endw
                      00129 
                      00130                 RLCF            CEXreg,W
                      00131                 RLCF            EEXreg, F
                      00132                 MOVFP           DEXreg,WREG
                      00133 
                      00134                 BTFSC           CEXreg+1,LSB
                      00135                 SUBWF           EEXreg, F
                      00136                 BTFSS           CEXreg+1,LSB
                      00137                 ADDWF           EEXreg, F
                      00138                 RLCF            CEXreg, F
                      00139 
                      00140                 variable i = D'9'
                      00141 
                      00142                 while i < D'16'
                      00143 
                      00144                 RLCF            CEXreg,W
                      00145                 RLCF            EEXreg, F
                      00146                 MOVFP           DEXreg,WREG
                      00147 
                      00148                 BTFSC           CEXreg,LSB
                      00149                 SUBWF           EEXreg, F
                      00150                 BTFSS           CEXreg,LSB
                      00151                 ADDWF           EEXreg, F
                      00152                 RLCF            CEXreg, F
                      00153 
                      00154                 variable i=i+1
                      00155 
                      00156                 endw
                      00157 
                      00158                 BTFSS           CEXreg,LSB
                      00159                 ADDWF           EEXreg, F
                      00160 
                      00161                 endm
                      00162 
                      00163 ;**********************************************************************************************
                      00164 ;**********************************************************************************************
                      00165 ;
                      00166 ;       16/8 Bit Signed Fixed Point Divide 16/08 -> 16.08
                      00167 ;
                      00168 ;       Input:  16 bit fixed point dividend in CEXreg+1, CEXreg
                      00169 ;               8 bit fixed point divisor in DEXreg
                      00170 ;
                      00171 ;       Use:    CALL    FXD1608S
                      00172 ;
                      00173 ;       Output: 16 bit fixed point quotient in CEXreg+1, CEXreg
                      00174 ;               8 bit fixed point remainder in EEXreg
                      00175 ;
                      00176 ;       Result: AARG, REM  <--  AARG / BARG
                      00177 ;
                      00178 ;       Max Timing:     21+122+5 = 148 clks             A > 0, B > 0
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 149


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00179 ;                       22+122+13 = 157 clks            A > 0, B < 0
                      00180 ;                       24+122+13 = 159 clks            A < 0, B > 0
                      00181 ;                       25+122+5 = 152 clks             A < 0, B < 0
                      00182 ;                       7 clks                          A = 0
                      00183 ;
                      00184 ;       Min Timing:     21+122+5 = 148 clks             A > 0, B > 0
                      00185 ;                       22+122+13 = 157 clks            A > 0, B < 0
                      00186 ;                       24+122+13 = 159 clks            A < 0, B > 0
                      00187 ;                       25+122+5 = 152 clks             A < 0, B < 0
                      00188 ;
                      00189 ;       PM: 25+122+12+30 = 189             DM: 6
                      00190 ;
002246                00191 Divide168
002246                00192 FXD1608S
002246 01??           00193                 MOVLR           HIGH CEXreg
002248 6A??           00194                 CLRF            SIGN
00224A 6A??           00195                 CLRF            EEXreg                  ; clear partial remainder
00224C 5000           00196                 MOVFP           CEXreg+1,WREG
00224E 10??           00197                 IORWF           CEXreg,W
002250 B4D8           00198                 BTFSC           _Z
002252 0C00           00199                 RETLW           0x00
                      00200 
002254 5000           00201                 MOVFP           CEXreg+1,WREG
002256 18??           00202                 XORWF           DEXreg,W
002258 BEE8           00203                 BTFSC           WREG,MSB
00225A 1E??           00204                 COMF            SIGN,F
                      00205 
00225C 6A??           00206                 CLRF            TEMPB3                  ; clear exception flag
00225E 0E00           00207                 MOVLW           0
                      00208 
002260 AE??           00209                 BTFSS           DEXreg,MSB             ; if MSB set go & negate BARG
002262 EF?? F???      00210                 GOTO            CA1608S
                      00211 
002266 1E??           00212                 COMF            DEXreg, F
002268 2A??           00213                 INCF            DEXreg, F
                      00214 
00226A AE??           00215 CA1608S         BTFSS           CEXreg+1,MSB             ; if MSB set go & negate AARGa
00226C EF?? F???      00216                 GOTO            C1608SX
                      00217 
002270 1E??           00218                 COMF            CEXreg, F
002272 1E??           00219                 COMF            CEXreg+1, F
002274 2A??           00220                 INCF            CEXreg, F
002276 22??           00221                 ADDWFC          CEXreg+1, F
                      00222 
002278 5000           00223 C1608SX         MOVFP           CEXreg+1,WREG
00227A 10??           00224                 IORWF           DEXreg,W
00227C BEE8           00225                 BTFSC           WREG,MSB
00227E EF?? F???      00226                 GOTO            C1608SX1
                      00227 
                      00228 C1608S          SDIV1608
                          M ;
                          M ;       Max Timing:     3+5+14*8+2 = 122 clks
                          M ;
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 150


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M ;       Min Timing:     3+5+14*8+2 = 122 clks
                          M ;
                          M ;       PM: 3+5+14*8+2 = 122            DM: 4
                          M ;
  0000                    M                 variable i
                          M 
002282 5000               M                 MOVFP           DEXreg,WREG
002284 5E??               M                 SUBWF           EEXreg, F
002286 36??               M                 RLCF            CEXreg+1, F
                          M 
002288 34??               M                 RLCF            CEXreg+1,W
00228A 36??               M                 RLCF            EEXreg, F
00228C 5000               M                 MOVFP           DEXreg,WREG
00228E 26??               M                 ADDWF           EEXreg, F
002290 36??               M                 RLCF            CEXreg+1, F
                          M 
  0002                    M                 variable i = D'2'
                          M 
                          M                 while i < D'8'
                          M 
002292 34??               M                 RLCF            CEXreg+1,W
002294 36??               M                 RLCF            EEXreg, F
002296 5000               M                 MOVFP           DEXreg,WREG
                          M 
002298 B0??               M                 BTFSC           CEXreg+1,LSB
00229A 5E??               M                 SUBWF           EEXreg, F
00229C A0??               M                 BTFSS           CEXreg+1,LSB
00229E 26??               M                 ADDWF           EEXreg, F
0022A0 36??               M                 RLCF            CEXreg+1, F
                          M 
  0003                    M                 variable i=i+1
                          M 
                          M 
0022A2 34??               M                 RLCF            CEXreg+1,W
0022A4 36??               M                 RLCF            EEXreg, F
0022A6 5000               M                 MOVFP           DEXreg,WREG
                          M 
0022A8 B0??               M                 BTFSC           CEXreg+1,LSB
0022AA 5E??               M                 SUBWF           EEXreg, F
0022AC A0??               M                 BTFSS           CEXreg+1,LSB
0022AE 26??               M                 ADDWF           EEXreg, F
0022B0 36??               M                 RLCF            CEXreg+1, F
                          M 
  0004                    M                 variable i=i+1
                          M 
                          M 
0022B2 34??               M                 RLCF            CEXreg+1,W
0022B4 36??               M                 RLCF            EEXreg, F
0022B6 5000               M                 MOVFP           DEXreg,WREG
                          M 
0022B8 B0??               M                 BTFSC           CEXreg+1,LSB
0022BA 5E??               M                 SUBWF           EEXreg, F
0022BC A0??               M                 BTFSS           CEXreg+1,LSB
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 151


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

0022BE 26??               M                 ADDWF           EEXreg, F
0022C0 36??               M                 RLCF            CEXreg+1, F
                          M 
  0005                    M                 variable i=i+1
                          M 
                          M 
0022C2 34??               M                 RLCF            CEXreg+1,W
0022C4 36??               M                 RLCF            EEXreg, F
0022C6 5000               M                 MOVFP           DEXreg,WREG
                          M 
0022C8 B0??               M                 BTFSC           CEXreg+1,LSB
0022CA 5E??               M                 SUBWF           EEXreg, F
0022CC A0??               M                 BTFSS           CEXreg+1,LSB
0022CE 26??               M                 ADDWF           EEXreg, F
0022D0 36??               M                 RLCF            CEXreg+1, F
                          M 
  0006                    M                 variable i=i+1
                          M 
                          M 
0022D2 34??               M                 RLCF            CEXreg+1,W
0022D4 36??               M                 RLCF            EEXreg, F
0022D6 5000               M                 MOVFP           DEXreg,WREG
                          M 
0022D8 B0??               M                 BTFSC           CEXreg+1,LSB
0022DA 5E??               M                 SUBWF           EEXreg, F
0022DC A0??               M                 BTFSS           CEXreg+1,LSB
0022DE 26??               M                 ADDWF           EEXreg, F
0022E0 36??               M                 RLCF            CEXreg+1, F
                          M 
  0007                    M                 variable i=i+1
                          M 
                          M 
0022E2 34??               M                 RLCF            CEXreg+1,W
0022E4 36??               M                 RLCF            EEXreg, F
0022E6 5000               M                 MOVFP           DEXreg,WREG
                          M 
0022E8 B0??               M                 BTFSC           CEXreg+1,LSB
0022EA 5E??               M                 SUBWF           EEXreg, F
0022EC A0??               M                 BTFSS           CEXreg+1,LSB
0022EE 26??               M                 ADDWF           EEXreg, F
0022F0 36??               M                 RLCF            CEXreg+1, F
                          M 
  0008                    M                 variable i=i+1
                          M 
                          M                 endw
                          M 
0022F2 34??               M                 RLCF            CEXreg,W
0022F4 36??               M                 RLCF            EEXreg, F
0022F6 5000               M                 MOVFP           DEXreg,WREG
                          M 
0022F8 B0??               M                 BTFSC           CEXreg+1,LSB
0022FA 5E??               M                 SUBWF           EEXreg, F
0022FC A0??               M                 BTFSS           CEXreg+1,LSB
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 152


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

0022FE 26??               M                 ADDWF           EEXreg, F
002300 36??               M                 RLCF            CEXreg, F
                          M 
  0009                    M                 variable i = D'9'
                          M 
                          M                 while i < D'16'
                          M 
002302 34??               M                 RLCF            CEXreg,W
002304 36??               M                 RLCF            EEXreg, F
002306 5000               M                 MOVFP           DEXreg,WREG
                          M 
002308 B0??               M                 BTFSC           CEXreg,LSB
00230A 5E??               M                 SUBWF           EEXreg, F
00230C A0??               M                 BTFSS           CEXreg,LSB
00230E 26??               M                 ADDWF           EEXreg, F
002310 36??               M                 RLCF            CEXreg, F
                          M 
  000A                    M                 variable i=i+1
                          M 
                          M 
002312 34??               M                 RLCF            CEXreg,W
002314 36??               M                 RLCF            EEXreg, F
002316 5000               M                 MOVFP           DEXreg,WREG
                          M 
002318 B0??               M                 BTFSC           CEXreg,LSB
00231A 5E??               M                 SUBWF           EEXreg, F
00231C A0??               M                 BTFSS           CEXreg,LSB
00231E 26??               M                 ADDWF           EEXreg, F
002320 36??               M                 RLCF            CEXreg, F
                          M 
  000B                    M                 variable i=i+1
                          M 
                          M 
002322 34??               M                 RLCF            CEXreg,W
002324 36??               M                 RLCF            EEXreg, F
002326 5000               M                 MOVFP           DEXreg,WREG
                          M 
002328 B0??               M                 BTFSC           CEXreg,LSB
00232A 5E??               M                 SUBWF           EEXreg, F
00232C A0??               M                 BTFSS           CEXreg,LSB
00232E 26??               M                 ADDWF           EEXreg, F
002330 36??               M                 RLCF            CEXreg, F
                          M 
  000C                    M                 variable i=i+1
                          M 
                          M 
002332 34??               M                 RLCF            CEXreg,W
002334 36??               M                 RLCF            EEXreg, F
002336 5000               M                 MOVFP           DEXreg,WREG
                          M 
002338 B0??               M                 BTFSC           CEXreg,LSB
00233A 5E??               M                 SUBWF           EEXreg, F
00233C A0??               M                 BTFSS           CEXreg,LSB
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 153


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

00233E 26??               M                 ADDWF           EEXreg, F
002340 36??               M                 RLCF            CEXreg, F
                          M 
  000D                    M                 variable i=i+1
                          M 
                          M 
002342 34??               M                 RLCF            CEXreg,W
002344 36??               M                 RLCF            EEXreg, F
002346 5000               M                 MOVFP           DEXreg,WREG
                          M 
002348 B0??               M                 BTFSC           CEXreg,LSB
00234A 5E??               M                 SUBWF           EEXreg, F
00234C A0??               M                 BTFSS           CEXreg,LSB
00234E 26??               M                 ADDWF           EEXreg, F
002350 36??               M                 RLCF            CEXreg, F
                          M 
  000E                    M                 variable i=i+1
                          M 
                          M 
002352 34??               M                 RLCF            CEXreg,W
002354 36??               M                 RLCF            EEXreg, F
002356 5000               M                 MOVFP           DEXreg,WREG
                          M 
002358 B0??               M                 BTFSC           CEXreg,LSB
00235A 5E??               M                 SUBWF           EEXreg, F
00235C A0??               M                 BTFSS           CEXreg,LSB
00235E 26??               M                 ADDWF           EEXreg, F
002360 36??               M                 RLCF            CEXreg, F
                          M 
  000F                    M                 variable i=i+1
                          M 
                          M 
002362 34??               M                 RLCF            CEXreg,W
002364 36??               M                 RLCF            EEXreg, F
002366 5000               M                 MOVFP           DEXreg,WREG
                          M 
002368 B0??               M                 BTFSC           CEXreg,LSB
00236A 5E??               M                 SUBWF           EEXreg, F
00236C A0??               M                 BTFSS           CEXreg,LSB
00236E 26??               M                 ADDWF           EEXreg, F
002370 36??               M                 RLCF            CEXreg, F
                          M 
  0010                    M                 variable i=i+1
                          M 
                          M                 endw
                          M 
002372 A0??               M                 BTFSS           CEXreg,LSB
002374 26??               M                 ADDWF           EEXreg, F
                          M 
                      00229 
002376 B0??           00230                 BTFSC           TEMPB3,LSB              ; test exception flag
002378 EF?? F???      00231                 GOTO            C1608SX4
                      00232 
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 154


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

00237C AE??           00233 C1608SOK        BTFSS           SIGN,MSB                ; negate 
00237E 0C00           00234                 RETLW           0x00
                      00235 
002380 1E??           00236                 COMF            CEXreg, F
002382 1E??           00237                 COMF            CEXreg+1, F
002384 6AE8           00238                 CLRF            WREG
002386 2A??           00239                 INCF            CEXreg, F
002388 22??           00240                 ADDWFC          CEXreg+1, F
                      00241 
00238A 1E??           00242                 COMF            EEXreg, F
00238C 2A??           00243                 INCF            EEXreg, F
                      00244 
00238E 0C00           00245                 RETLW           0x00
                      00246 
002390 AE??           00247 C1608SX1        BTFSS           DEXreg,MSB              ; test BARG exception
002392 EF?? F???      00248                 GOTO            C1608SX3
002396 BE??           00249                 BTFSC           CEXreg+1,MSB            ; test AARG exception
002398 EF?? F???      00250                 GOTO            C1608SX2
00239C CFE8 F???      00251                 MOVPF           WREG,Ctemp
0023A0 5000           00252                 MOVFP           CEXreg,WREG
0023A2 CFE8 F???      00253                 MOVPF           WREG,EEXreg
0023A6 9E??           00254                 BCF             EEXreg,MSB
0023A8 36??           00255                 RLCF            CEXreg,F
0023AA 36??           00256                 RLCF            CEXreg+1,F
0023AC 5000           00257                 MOVFP           CEXreg+1,WREG
0023AE CFE8 F???      00258                 MOVPF           WREG,CEXreg
0023B2 5000           00259                 MOVFP           Ctemp,WREG
0023B4 6A??           00260                 CLRF            CEXreg+1
0023B6 EF?? F???      00261                 GOTO            C1608SOK
0023BA 6A??           00262 C1608SX2        CLRF            CEXreg          ; quotient = 1, remainder = 0
0023BC 2A??           00263                 INCF            CEXreg,F
0023BE 6A??           00264                 CLRF            CEXreg+1
0023C0 0C00           00265                 RETLW           0x00
                      00266 
0023C2 1E??           00267 C1608SX3        COMF            CEXreg+1,F              ; numerator = 0x7FFF + 1
0023C4 1E??           00268                 COMF            CEXreg,F
0023C6 2A??           00269                 INCF            TEMPB3,F
0023C8 EF?? F???      00270                 GOTO            C1608S
                      00271 
0023CC 2A??           00272 C1608SX4        INCF            EEXreg,F                ; increment remainder and test for
0023CE 5000           00273                 MOVFP           DEXreg,WREG             ; overflow
0023D0 62??           00274                 CPFSEQ          EEXreg
0023D2 EF?? F???      00275                 GOTO            C1608SOK
0023D6 6A??           00276                 CLRF            EEXreg                  ; if remainder overflow, clear
0023D8 0E00           00277                 MOVLW           0
0023DA 2A??           00278                 INCF            CEXreg,F                ; remainder, increment quotient and
0023DC 22??           00279                 ADDWFC          CEXreg+1,F              ; test for overflow exception
0023DE AE??           00280                 BTFSS           CEXreg+1,MSB
0023E0 EF?? F???      00281                 GOTO            C1608SOK
0023E4 88??           00282                 BSF             FPFLAGS,NAN
0023E6 0CFF           00283                 RETLW           0xFF
                      00284                 
                      00285 
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 155


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00286 
                      00287 INCLUDE         <DIV2416.ASM>
                      00001 
                      00002 #define AARGB2          CEXreg
                      00003 #define AARGB1          CEXreg+1
                      00004 #define AARGB0          CEXreg+2
                      00005 
                      00006 #define BARGB1          DEXreg
                      00007 #define BARGB0          DEXreg+1
                      00008 
                      00009 #define REMB1           EEXreg
                      00010 #define REMB0           EEXreg+1
                      00011 
                      00012 ;**********************************************************************************************
                      00013 ;
                      00014 ;       24/16 Bit Division Macros
                      00015 ;
                      00016 SDIV2416        macro
                      00017 ;
                      00018 ;       Max Timing:     5+8+22*12+6 = 283 clks
                      00019 ;
                      00020 ;       Min Timing:     5+8+22*11+3 = 258 clks
                      00021 ;
                      00022 ;       PM: 5+8+22*14+6 = 327           DM: 8
                      00023 ;
                      00024                 variable i
                      00025 
                      00026                 MOVFP           BARGB1,WREG
                      00027                 SUBWF           REMB1, F
                      00028                 MOVFP           BARGB0,WREG
                      00029                 SUBWFB          REMB0, F
                      00030                 RLCF            AARGB0, F
                      00031 
                      00032                 RLCF            AARGB0,W
                      00033                 RLCF            REMB1, F
                      00034                 RLCF            REMB0, F
                      00035                 MOVFP           BARGB1,WREG
                      00036                 ADDWF           REMB1, F
                      00037                 MOVFP           BARGB0,WREG
                      00038                 ADDWFC          REMB0, F
                      00039                 RLCF            AARGB0, F
                      00040 
                      00041                 variable i = D'2'
                      00042 
                      00043                 while i < D'8'
                      00044 
                      00045                 RLCF            AARGB0,W
                      00046                 RLCF            REMB1, F
                      00047                 RLCF            REMB0, F
                      00048                 MOVFP           BARGB1,WREG
                      00049                 BTFSS           AARGB0,LSB
                      00050                 GOTO            SADD46#v(i)
                      00051                 SUBWF           REMB1, F
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 156


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00052                 MOVFP           BARGB0,WREG
                      00053                 SUBWFB          REMB0, F
                      00054                 GOTO            SOK46#v(i)
                      00055 
                      00056 SADD46#v(i)     ADDWF           REMB1, F
                      00057                 MOVFP           BARGB0,WREG
                      00058                 ADDWFC          REMB0, F
                      00059 
                      00060 SOK46#v(i)      RLCF            AARGB0, F
                      00061 
                      00062                 variable i=i+1
                      00063 
                      00064                 endw
                      00065 
                      00066                 RLCF            AARGB1,W
                      00067                 RLCF            REMB1, F
                      00068                 RLCF            REMB0, F
                      00069                 MOVFP           BARGB1,WREG
                      00070                 BTFSS           AARGB0,LSB
                      00071                 GOTO            SADD468
                      00072                 SUBWF           REMB1, F
                      00073                 MOVFP           BARGB0,WREG
                      00074                 SUBWFB          REMB0, F
                      00075                 GOTO            SOK468
                      00076 
                      00077 SADD468         ADDWF           REMB1, F
                      00078                 MOVFP           BARGB0,WREG
                      00079                 ADDWFC          REMB0, F
                      00080 
                      00081 SOK468          RLCF            AARGB1, F
                      00082 
                      00083                 variable i = D'9'
                      00084 
                      00085                 while i < D'16'
                      00086 
                      00087                 RLCF            AARGB1,W
                      00088                 RLCF            REMB1, F
                      00089                 RLCF            REMB0, F
                      00090                 MOVFP           BARGB1,WREG
                      00091                 BTFSS           AARGB1,LSB
                      00092                 GOTO            SADD46#v(i)
                      00093                 SUBWF           REMB1, F
                      00094                 MOVFP           BARGB0,WREG
                      00095                 SUBWFB          REMB0, F
                      00096                 GOTO            SOK46#v(i)
                      00097 
                      00098 SADD46#v(i)     ADDWF           REMB1, F
                      00099                 MOVFP           BARGB0,WREG
                      00100                 ADDWFC          REMB0, F
                      00101 
                      00102 SOK46#v(i)      RLCF            AARGB1, F
                      00103 
                      00104                 variable i=i+1
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 157


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00105 
                      00106                 endw
                      00107 
                      00108                 RLCF            AARGB2,W
                      00109                 RLCF            REMB1, F
                      00110                 RLCF            REMB0, F
                      00111                 MOVFP           BARGB1,WREG
                      00112                 BTFSS           AARGB1,LSB
                      00113                 GOTO            SADD4616
                      00114                 SUBWF           REMB1, F
                      00115                 MOVFP           BARGB0,WREG
                      00116                 SUBWFB          REMB0, F
                      00117                 GOTO            SOK4616
                      00118 
                      00119 SADD4616        ADDWF           REMB1, F
                      00120                 MOVFP           BARGB0,WREG
                      00121                 ADDWFC          REMB0, F
                      00122 
                      00123 SOK4616         RLCF            AARGB2, F
                      00124 
                      00125 
                      00126                 variable i = D'17'
                      00127 
                      00128                 while i < D'24'
                      00129 
                      00130                 RLCF            AARGB2,W
                      00131                 RLCF            REMB1, F
                      00132                 RLCF            REMB0, F
                      00133                 MOVFP           BARGB1,WREG
                      00134                 BTFSS           AARGB2,LSB
                      00135                 GOTO            SADD46#v(i)
                      00136                 SUBWF           REMB1, F
                      00137                 MOVFP           BARGB0,WREG
                      00138                 SUBWFB          REMB0, F
                      00139                 GOTO            SOK46#v(i)
                      00140 
                      00141 SADD46#v(i)     ADDWF           REMB1, F
                      00142                 MOVFP           BARGB0,WREG
                      00143                 ADDWFC          REMB0, F
                      00144 
                      00145 SOK46#v(i)      RLCF            AARGB2, F
                      00146 
                      00147                 variable i=i+1
                      00148 
                      00149                 endw
                      00150 
                      00151                 BTFSC           AARGB2,LSB
                      00152                 GOTO            SOK46
                      00153                 MOVFP           BARGB1,WREG
                      00154                 ADDWF           REMB1, F
                      00155                 MOVFP           BARGB0,WREG
                      00156                 ADDWFC          REMB0, F
                      00157 SOK46
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 158


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00158 
                      00159                 endm
                      00160 
                      00161 
                      00162 ;**********************************************************************************************
                      00163 ;**********************************************************************************************
                      00164 ;
                      00165 ;       24/16 Bit Signed Fixed Point Divide 24/16 -> 24.16
                      00166 ;
                      00167 ;       Input:  24 bit fixed point dividend in AARGB0, AARGB1, AARGB2
                      00168 ;               16 bit fixed point divisor in BARGB0, BARGB1
                      00169 ;
                      00170 ;       Use:    CALL    FXD2416S
                      00171 ;
                      00172 ;       Output: 24 bit fixed point quotient in AARGB0, AARGB1, AARGB2
                      00173 ;               16 bit fixed point remainder in REMB0, REMB1
                      00174 ;
                      00175 ;       Result: AARG, REM  <--  AARG / BARG
                      00176 ;
                      00177 ;       Max Timing:     23+283+5 = 311 clks             A > 0, B > 0
                      00178 ;                       26+283+17 = 326 clks            A > 0, B < 0
                      00179 ;                       28+283+17 = 328 clks            A < 0, B > 0
                      00180 ;                       31+283+5 = 319 clks             A < 0, B < 0
                      00181 ;                       9 clks                          A = 0
                      00182 ;
                      00183 ;       Min Timing:     23+258+5 = 286 clks             A > 0, B > 0
                      00184 ;                       26+258+17 = 301 clks            A > 0, B < 0
                      00185 ;                       28+258+17 = 303 clks            A < 0, B > 0
                      00186 ;                       31+258+5 = 294 clks             A < 0, B < 0
                      00187 ;
                      00188 ;       PM: 30+327+16+41 = 414             DM: 9
                      00189 ;
                      00190 
0023E8                00191 Divide2416
0023E8                00192 FXD2416S
0023E8 01??           00193                 MOVLR           HIGH AXreg
0023EA 6A??           00194                 CLRF            SIGN
0023EC 6A??           00195                 CLRF            REMB0                   ; clear partial remainder
0023EE 6A??           00196                 CLRF            REMB1
0023F0 50??           00197                 MOVFP           AARGB0,W
0023F2 10??           00198                 IORWF           AARGB1,W
0023F4 10??           00199                 IORWF           AARGB2,W
0023F6 B4D8           00200                 BTFSC           _Z
0023F8 0C00           00201                 RETLW           0x00
                      00202 
0023FA 50??           00203                 MOVFP           AARGB0,W
0023FC 18??           00204                 XORWF           BARGB0,W
0023FE BEE8           00205                 BTFSC           WREG,MSB,A
002400 1E??           00206                 COMF            SIGN,F
                      00207 
002402 6A??           00208                 CLRF            TEMPB3                  ; clear exception flag
002404 0E00           00209                 MOVLW           0
                      00210 
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 159


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

002406 AE??           00211                 BTFSS           BARGB0,MSB              ; if MSB set go & negate BARG
002408 EF?? F???      00212                 GOTO            CA2416S
                      00213 
00240C 1E??           00214                 COMF            BARGB1, F
00240E 1E??           00215                 COMF            BARGB0, F
002410 2A??           00216                 INCF            BARGB1, F
002412 22??           00217                 ADDWFC          BARGB0, F
                      00218 
002414 AE??           00219 CA2416S         BTFSS           AARGB0,MSB              ; if MSB set go & negate AARGa
002416 EF?? F???      00220                 GOTO            C2416SX
                      00221 
00241A 1E??           00222                 COMF            AARGB2, F
00241C 1E??           00223                 COMF            AARGB1, F
00241E 1E??           00224                 COMF            AARGB0, F
002420 2A??           00225                 INCF            AARGB2, F
002422 22??           00226                 ADDWFC          AARGB1, F
002424 22??           00227                 ADDWFC          AARGB0, F
                      00228 
002426 50??           00229 C2416SX         MOVFP           AARGB0,W
002428 10??           00230                 IORWF           BARGB0,W
00242A BEE8           00231                 BTFSC           WREG,MSB,A
00242C EF?? F???      00232                 GOTO            C2416SX1
                      00233 
                      00234 C2416S          SDIV2416
                          M ;
                          M ;       Max Timing:     5+8+22*12+6 = 283 clks
                          M ;
                          M ;       Min Timing:     5+8+22*11+3 = 258 clks
                          M ;
                          M ;       PM: 5+8+22*14+6 = 327           DM: 8
                          M ;
  0000                    M                 variable i
                          M 
002430 5000               M                 MOVFP           BARGB1,WREG
002432 5E??               M                 SUBWF           REMB1, F
002434 5000               M                 MOVFP           BARGB0,WREG
002436 5A??               M                 SUBWFB          REMB0, F
002438 36??               M                 RLCF            AARGB0, F
                          M 
00243A 34??               M                 RLCF            AARGB0,W
00243C 36??               M                 RLCF            REMB1, F
00243E 36??               M                 RLCF            REMB0, F
002440 5000               M                 MOVFP           BARGB1,WREG
002442 26??               M                 ADDWF           REMB1, F
002444 5000               M                 MOVFP           BARGB0,WREG
002446 22??               M                 ADDWFC          REMB0, F
002448 36??               M                 RLCF            AARGB0, F
                          M 
  0002                    M                 variable i = D'2'
                          M 
                          M                 while i < D'8'
                          M 
00244A 34??               M                 RLCF            AARGB0,W
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 160


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

00244C 36??               M                 RLCF            REMB1, F
00244E 36??               M                 RLCF            REMB0, F
002450 5000               M                 MOVFP           BARGB1,WREG
002452 A0??               M                 BTFSS           AARGB0,LSB
002454 EF?? F???          M                 GOTO            SADD462
002458 5E??               M                 SUBWF           REMB1, F
00245A 5000               M                 MOVFP           BARGB0,WREG
00245C 5A??               M                 SUBWFB          REMB0, F
00245E EF?? F???          M                 GOTO            SOK462
                          M 
002462 26??               M SADD462         ADDWF           REMB1, F
002464 5000               M                 MOVFP           BARGB0,WREG
002466 22??               M                 ADDWFC          REMB0, F
                          M 
002468 36??               M SOK462          RLCF            AARGB0, F
                          M 
  0003                    M                 variable i=i+1
                          M 
                          M 
00246A 34??               M                 RLCF            AARGB0,W
00246C 36??               M                 RLCF            REMB1, F
00246E 36??               M                 RLCF            REMB0, F
002470 5000               M                 MOVFP           BARGB1,WREG
002472 A0??               M                 BTFSS           AARGB0,LSB
002474 EF?? F???          M                 GOTO            SADD463
002478 5E??               M                 SUBWF           REMB1, F
00247A 5000               M                 MOVFP           BARGB0,WREG
00247C 5A??               M                 SUBWFB          REMB0, F
00247E EF?? F???          M                 GOTO            SOK463
                          M 
002482 26??               M SADD463         ADDWF           REMB1, F
002484 5000               M                 MOVFP           BARGB0,WREG
002486 22??               M                 ADDWFC          REMB0, F
                          M 
002488 36??               M SOK463          RLCF            AARGB0, F
                          M 
  0004                    M                 variable i=i+1
                          M 
                          M 
00248A 34??               M                 RLCF            AARGB0,W
00248C 36??               M                 RLCF            REMB1, F
00248E 36??               M                 RLCF            REMB0, F
002490 5000               M                 MOVFP           BARGB1,WREG
002492 A0??               M                 BTFSS           AARGB0,LSB
002494 EF?? F???          M                 GOTO            SADD464
002498 5E??               M                 SUBWF           REMB1, F
00249A 5000               M                 MOVFP           BARGB0,WREG
00249C 5A??               M                 SUBWFB          REMB0, F
00249E EF?? F???          M                 GOTO            SOK464
                          M 
0024A2 26??               M SADD464         ADDWF           REMB1, F
0024A4 5000               M                 MOVFP           BARGB0,WREG
0024A6 22??               M                 ADDWFC          REMB0, F
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 161


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M 
0024A8 36??               M SOK464          RLCF            AARGB0, F
                          M 
  0005                    M                 variable i=i+1
                          M 
                          M 
0024AA 34??               M                 RLCF            AARGB0,W
0024AC 36??               M                 RLCF            REMB1, F
0024AE 36??               M                 RLCF            REMB0, F
0024B0 5000               M                 MOVFP           BARGB1,WREG
0024B2 A0??               M                 BTFSS           AARGB0,LSB
0024B4 EF?? F???          M                 GOTO            SADD465
0024B8 5E??               M                 SUBWF           REMB1, F
0024BA 5000               M                 MOVFP           BARGB0,WREG
0024BC 5A??               M                 SUBWFB          REMB0, F
0024BE EF?? F???          M                 GOTO            SOK465
                          M 
0024C2 26??               M SADD465         ADDWF           REMB1, F
0024C4 5000               M                 MOVFP           BARGB0,WREG
0024C6 22??               M                 ADDWFC          REMB0, F
                          M 
0024C8 36??               M SOK465          RLCF            AARGB0, F
                          M 
  0006                    M                 variable i=i+1
                          M 
                          M 
0024CA 34??               M                 RLCF            AARGB0,W
0024CC 36??               M                 RLCF            REMB1, F
0024CE 36??               M                 RLCF            REMB0, F
0024D0 5000               M                 MOVFP           BARGB1,WREG
0024D2 A0??               M                 BTFSS           AARGB0,LSB
0024D4 EF?? F???          M                 GOTO            SADD466
0024D8 5E??               M                 SUBWF           REMB1, F
0024DA 5000               M                 MOVFP           BARGB0,WREG
0024DC 5A??               M                 SUBWFB          REMB0, F
0024DE EF?? F???          M                 GOTO            SOK466
                          M 
0024E2 26??               M SADD466         ADDWF           REMB1, F
0024E4 5000               M                 MOVFP           BARGB0,WREG
0024E6 22??               M                 ADDWFC          REMB0, F
                          M 
0024E8 36??               M SOK466          RLCF            AARGB0, F
                          M 
  0007                    M                 variable i=i+1
                          M 
                          M 
0024EA 34??               M                 RLCF            AARGB0,W
0024EC 36??               M                 RLCF            REMB1, F
0024EE 36??               M                 RLCF            REMB0, F
0024F0 5000               M                 MOVFP           BARGB1,WREG
0024F2 A0??               M                 BTFSS           AARGB0,LSB
0024F4 EF?? F???          M                 GOTO            SADD467
0024F8 5E??               M                 SUBWF           REMB1, F
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 162


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

0024FA 5000               M                 MOVFP           BARGB0,WREG
0024FC 5A??               M                 SUBWFB          REMB0, F
0024FE EF?? F???          M                 GOTO            SOK467
                          M 
002502 26??               M SADD467         ADDWF           REMB1, F
002504 5000               M                 MOVFP           BARGB0,WREG
002506 22??               M                 ADDWFC          REMB0, F
                          M 
002508 36??               M SOK467          RLCF            AARGB0, F
                          M 
  0008                    M                 variable i=i+1
                          M 
                          M                 endw
                          M 
00250A 34??               M                 RLCF            AARGB1,W
00250C 36??               M                 RLCF            REMB1, F
00250E 36??               M                 RLCF            REMB0, F
002510 5000               M                 MOVFP           BARGB1,WREG
002512 A0??               M                 BTFSS           AARGB0,LSB
002514 EF?? F???          M                 GOTO            SADD468
002518 5E??               M                 SUBWF           REMB1, F
00251A 5000               M                 MOVFP           BARGB0,WREG
00251C 5A??               M                 SUBWFB          REMB0, F
00251E EF?? F???          M                 GOTO            SOK468
                          M 
002522 26??               M SADD468         ADDWF           REMB1, F
002524 5000               M                 MOVFP           BARGB0,WREG
002526 22??               M                 ADDWFC          REMB0, F
                          M 
002528 36??               M SOK468          RLCF            AARGB1, F
                          M 
  0009                    M                 variable i = D'9'
                          M 
                          M                 while i < D'16'
                          M 
00252A 34??               M                 RLCF            AARGB1,W
00252C 36??               M                 RLCF            REMB1, F
00252E 36??               M                 RLCF            REMB0, F
002530 5000               M                 MOVFP           BARGB1,WREG
002532 A0??               M                 BTFSS           AARGB1,LSB
002534 EF?? F???          M                 GOTO            SADD469
002538 5E??               M                 SUBWF           REMB1, F
00253A 5000               M                 MOVFP           BARGB0,WREG
00253C 5A??               M                 SUBWFB          REMB0, F
00253E EF?? F???          M                 GOTO            SOK469
                          M 
002542 26??               M SADD469         ADDWF           REMB1, F
002544 5000               M                 MOVFP           BARGB0,WREG
002546 22??               M                 ADDWFC          REMB0, F
                          M 
002548 36??               M SOK469          RLCF            AARGB1, F
                          M 
  000A                    M                 variable i=i+1
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 163


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M 
                          M 
00254A 34??               M                 RLCF            AARGB1,W
00254C 36??               M                 RLCF            REMB1, F
00254E 36??               M                 RLCF            REMB0, F
002550 5000               M                 MOVFP           BARGB1,WREG
002552 A0??               M                 BTFSS           AARGB1,LSB
002554 EF?? F???          M                 GOTO            SADD4610
002558 5E??               M                 SUBWF           REMB1, F
00255A 5000               M                 MOVFP           BARGB0,WREG
00255C 5A??               M                 SUBWFB          REMB0, F
00255E EF?? F???          M                 GOTO            SOK4610
                          M 
002562 26??               M SADD4610        ADDWF           REMB1, F
002564 5000               M                 MOVFP           BARGB0,WREG
002566 22??               M                 ADDWFC          REMB0, F
                          M 
002568 36??               M SOK4610         RLCF            AARGB1, F
                          M 
  000B                    M                 variable i=i+1
                          M 
                          M 
00256A 34??               M                 RLCF            AARGB1,W
00256C 36??               M                 RLCF            REMB1, F
00256E 36??               M                 RLCF            REMB0, F
002570 5000               M                 MOVFP           BARGB1,WREG
002572 A0??               M                 BTFSS           AARGB1,LSB
002574 EF?? F???          M                 GOTO            SADD4611
002578 5E??               M                 SUBWF           REMB1, F
00257A 5000               M                 MOVFP           BARGB0,WREG
00257C 5A??               M                 SUBWFB          REMB0, F
00257E EF?? F???          M                 GOTO            SOK4611
                          M 
002582 26??               M SADD4611        ADDWF           REMB1, F
002584 5000               M                 MOVFP           BARGB0,WREG
002586 22??               M                 ADDWFC          REMB0, F
                          M 
002588 36??               M SOK4611         RLCF            AARGB1, F
                          M 
  000C                    M                 variable i=i+1
                          M 
                          M 
00258A 34??               M                 RLCF            AARGB1,W
00258C 36??               M                 RLCF            REMB1, F
00258E 36??               M                 RLCF            REMB0, F
002590 5000               M                 MOVFP           BARGB1,WREG
002592 A0??               M                 BTFSS           AARGB1,LSB
002594 EF?? F???          M                 GOTO            SADD4612
002598 5E??               M                 SUBWF           REMB1, F
00259A 5000               M                 MOVFP           BARGB0,WREG
00259C 5A??               M                 SUBWFB          REMB0, F
00259E EF?? F???          M                 GOTO            SOK4612
                          M 
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 164


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

0025A2 26??               M SADD4612        ADDWF           REMB1, F
0025A4 5000               M                 MOVFP           BARGB0,WREG
0025A6 22??               M                 ADDWFC          REMB0, F
                          M 
0025A8 36??               M SOK4612         RLCF            AARGB1, F
                          M 
  000D                    M                 variable i=i+1
                          M 
                          M 
0025AA 34??               M                 RLCF            AARGB1,W
0025AC 36??               M                 RLCF            REMB1, F
0025AE 36??               M                 RLCF            REMB0, F
0025B0 5000               M                 MOVFP           BARGB1,WREG
0025B2 A0??               M                 BTFSS           AARGB1,LSB
0025B4 EF?? F???          M                 GOTO            SADD4613
0025B8 5E??               M                 SUBWF           REMB1, F
0025BA 5000               M                 MOVFP           BARGB0,WREG
0025BC 5A??               M                 SUBWFB          REMB0, F
0025BE EF?? F???          M                 GOTO            SOK4613
                          M 
0025C2 26??               M SADD4613        ADDWF           REMB1, F
0025C4 5000               M                 MOVFP           BARGB0,WREG
0025C6 22??               M                 ADDWFC          REMB0, F
                          M 
0025C8 36??               M SOK4613         RLCF            AARGB1, F
                          M 
  000E                    M                 variable i=i+1
                          M 
                          M 
0025CA 34??               M                 RLCF            AARGB1,W
0025CC 36??               M                 RLCF            REMB1, F
0025CE 36??               M                 RLCF            REMB0, F
0025D0 5000               M                 MOVFP           BARGB1,WREG
0025D2 A0??               M                 BTFSS           AARGB1,LSB
0025D4 EF?? F???          M                 GOTO            SADD4614
0025D8 5E??               M                 SUBWF           REMB1, F
0025DA 5000               M                 MOVFP           BARGB0,WREG
0025DC 5A??               M                 SUBWFB          REMB0, F
0025DE EF?? F???          M                 GOTO            SOK4614
                          M 
0025E2 26??               M SADD4614        ADDWF           REMB1, F
0025E4 5000               M                 MOVFP           BARGB0,WREG
0025E6 22??               M                 ADDWFC          REMB0, F
                          M 
0025E8 36??               M SOK4614         RLCF            AARGB1, F
                          M 
  000F                    M                 variable i=i+1
                          M 
                          M 
0025EA 34??               M                 RLCF            AARGB1,W
0025EC 36??               M                 RLCF            REMB1, F
0025EE 36??               M                 RLCF            REMB0, F
0025F0 5000               M                 MOVFP           BARGB1,WREG
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 165


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

0025F2 A0??               M                 BTFSS           AARGB1,LSB
0025F4 EF?? F???          M                 GOTO            SADD4615
0025F8 5E??               M                 SUBWF           REMB1, F
0025FA 5000               M                 MOVFP           BARGB0,WREG
0025FC 5A??               M                 SUBWFB          REMB0, F
0025FE EF?? F???          M                 GOTO            SOK4615
                          M 
002602 26??               M SADD4615        ADDWF           REMB1, F
002604 5000               M                 MOVFP           BARGB0,WREG
002606 22??               M                 ADDWFC          REMB0, F
                          M 
002608 36??               M SOK4615         RLCF            AARGB1, F
                          M 
  0010                    M                 variable i=i+1
                          M 
                          M                 endw
                          M 
00260A 34??               M                 RLCF            AARGB2,W
00260C 36??               M                 RLCF            REMB1, F
00260E 36??               M                 RLCF            REMB0, F
002610 5000               M                 MOVFP           BARGB1,WREG
002612 A0??               M                 BTFSS           AARGB1,LSB
002614 EF?? F???          M                 GOTO            SADD4616
002618 5E??               M                 SUBWF           REMB1, F
00261A 5000               M                 MOVFP           BARGB0,WREG
00261C 5A??               M                 SUBWFB          REMB0, F
00261E EF?? F???          M                 GOTO            SOK4616
                          M 
002622 26??               M SADD4616        ADDWF           REMB1, F
002624 5000               M                 MOVFP           BARGB0,WREG
002626 22??               M                 ADDWFC          REMB0, F
                          M 
002628 36??               M SOK4616         RLCF            AARGB2, F
                          M 
                          M 
  0011                    M                 variable i = D'17'
                          M 
                          M                 while i < D'24'
                          M 
00262A 34??               M                 RLCF            AARGB2,W
00262C 36??               M                 RLCF            REMB1, F
00262E 36??               M                 RLCF            REMB0, F
002630 5000               M                 MOVFP           BARGB1,WREG
002632 A0??               M                 BTFSS           AARGB2,LSB
002634 EF?? F???          M                 GOTO            SADD4617
002638 5E??               M                 SUBWF           REMB1, F
00263A 5000               M                 MOVFP           BARGB0,WREG
00263C 5A??               M                 SUBWFB          REMB0, F
00263E EF?? F???          M                 GOTO            SOK4617
                          M 
002642 26??               M SADD4617        ADDWF           REMB1, F
002644 5000               M                 MOVFP           BARGB0,WREG
002646 22??               M                 ADDWFC          REMB0, F
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 166


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M 
002648 36??               M SOK4617         RLCF            AARGB2, F
                          M 
  0012                    M                 variable i=i+1
                          M 
                          M 
00264A 34??               M                 RLCF            AARGB2,W
00264C 36??               M                 RLCF            REMB1, F
00264E 36??               M                 RLCF            REMB0, F
002650 5000               M                 MOVFP           BARGB1,WREG
002652 A0??               M                 BTFSS           AARGB2,LSB
002654 EF?? F???          M                 GOTO            SADD4618
002658 5E??               M                 SUBWF           REMB1, F
00265A 5000               M                 MOVFP           BARGB0,WREG
00265C 5A??               M                 SUBWFB          REMB0, F
00265E EF?? F???          M                 GOTO            SOK4618
                          M 
002662 26??               M SADD4618        ADDWF           REMB1, F
002664 5000               M                 MOVFP           BARGB0,WREG
002666 22??               M                 ADDWFC          REMB0, F
                          M 
002668 36??               M SOK4618         RLCF            AARGB2, F
                          M 
  0013                    M                 variable i=i+1
                          M 
                          M 
00266A 34??               M                 RLCF            AARGB2,W
00266C 36??               M                 RLCF            REMB1, F
00266E 36??               M                 RLCF            REMB0, F
002670 5000               M                 MOVFP           BARGB1,WREG
002672 A0??               M                 BTFSS           AARGB2,LSB
002674 EF?? F???          M                 GOTO            SADD4619
002678 5E??               M                 SUBWF           REMB1, F
00267A 5000               M                 MOVFP           BARGB0,WREG
00267C 5A??               M                 SUBWFB          REMB0, F
00267E EF?? F???          M                 GOTO            SOK4619
                          M 
002682 26??               M SADD4619        ADDWF           REMB1, F
002684 5000               M                 MOVFP           BARGB0,WREG
002686 22??               M                 ADDWFC          REMB0, F
                          M 
002688 36??               M SOK4619         RLCF            AARGB2, F
                          M 
  0014                    M                 variable i=i+1
                          M 
                          M 
00268A 34??               M                 RLCF            AARGB2,W
00268C 36??               M                 RLCF            REMB1, F
00268E 36??               M                 RLCF            REMB0, F
002690 5000               M                 MOVFP           BARGB1,WREG
002692 A0??               M                 BTFSS           AARGB2,LSB
002694 EF?? F???          M                 GOTO            SADD4620
002698 5E??               M                 SUBWF           REMB1, F
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 167


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

00269A 5000               M                 MOVFP           BARGB0,WREG
00269C 5A??               M                 SUBWFB          REMB0, F
00269E EF?? F???          M                 GOTO            SOK4620
                          M 
0026A2 26??               M SADD4620        ADDWF           REMB1, F
0026A4 5000               M                 MOVFP           BARGB0,WREG
0026A6 22??               M                 ADDWFC          REMB0, F
                          M 
0026A8 36??               M SOK4620         RLCF            AARGB2, F
                          M 
  0015                    M                 variable i=i+1
                          M 
                          M 
0026AA 34??               M                 RLCF            AARGB2,W
0026AC 36??               M                 RLCF            REMB1, F
0026AE 36??               M                 RLCF            REMB0, F
0026B0 5000               M                 MOVFP           BARGB1,WREG
0026B2 A0??               M                 BTFSS           AARGB2,LSB
0026B4 EF?? F???          M                 GOTO            SADD4621
0026B8 5E??               M                 SUBWF           REMB1, F
0026BA 5000               M                 MOVFP           BARGB0,WREG
0026BC 5A??               M                 SUBWFB          REMB0, F
0026BE EF?? F???          M                 GOTO            SOK4621
                          M 
0026C2 26??               M SADD4621        ADDWF           REMB1, F
0026C4 5000               M                 MOVFP           BARGB0,WREG
0026C6 22??               M                 ADDWFC          REMB0, F
                          M 
0026C8 36??               M SOK4621         RLCF            AARGB2, F
                          M 
  0016                    M                 variable i=i+1
                          M 
                          M 
0026CA 34??               M                 RLCF            AARGB2,W
0026CC 36??               M                 RLCF            REMB1, F
0026CE 36??               M                 RLCF            REMB0, F
0026D0 5000               M                 MOVFP           BARGB1,WREG
0026D2 A0??               M                 BTFSS           AARGB2,LSB
0026D4 EF?? F???          M                 GOTO            SADD4622
0026D8 5E??               M                 SUBWF           REMB1, F
0026DA 5000               M                 MOVFP           BARGB0,WREG
0026DC 5A??               M                 SUBWFB          REMB0, F
0026DE EF?? F???          M                 GOTO            SOK4622
                          M 
0026E2 26??               M SADD4622        ADDWF           REMB1, F
0026E4 5000               M                 MOVFP           BARGB0,WREG
0026E6 22??               M                 ADDWFC          REMB0, F
                          M 
0026E8 36??               M SOK4622         RLCF            AARGB2, F
                          M 
  0017                    M                 variable i=i+1
                          M 
                          M 
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 168


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

0026EA 34??               M                 RLCF            AARGB2,W
0026EC 36??               M                 RLCF            REMB1, F
0026EE 36??               M                 RLCF            REMB0, F
0026F0 5000               M                 MOVFP           BARGB1,WREG
0026F2 A0??               M                 BTFSS           AARGB2,LSB
0026F4 EF?? F???          M                 GOTO            SADD4623
0026F8 5E??               M                 SUBWF           REMB1, F
0026FA 5000               M                 MOVFP           BARGB0,WREG
0026FC 5A??               M                 SUBWFB          REMB0, F
0026FE EF?? F???          M                 GOTO            SOK4623
                          M 
002702 26??               M SADD4623        ADDWF           REMB1, F
002704 5000               M                 MOVFP           BARGB0,WREG
002706 22??               M                 ADDWFC          REMB0, F
                          M 
002708 36??               M SOK4623         RLCF            AARGB2, F
                          M 
  0018                    M                 variable i=i+1
                          M 
                          M                 endw
                          M 
00270A B0??               M                 BTFSC           AARGB2,LSB
00270C EF?? F???          M                 GOTO            SOK46
002710 5000               M                 MOVFP           BARGB1,WREG
002712 26??               M                 ADDWF           REMB1, F
002714 5000               M                 MOVFP           BARGB0,WREG
002716 22??               M                 ADDWFC          REMB0, F
002718                    M SOK46
                          M 
                      00235 
002718 B0??           00236                 BTFSC           TEMPB3,LSB              ; test exception flag
00271A EF?? F???      00237                 GOTO            C2416SX4
                      00238 
00271E AE??           00239 C2416SOK        BTFSS           SIGN,MSB                ; negate
002720 0C00           00240                 RETLW           0x00
                      00241 
002722 1E??           00242                 COMF            AARGB2, F
002724 1E??           00243                 COMF            AARGB1, F
002726 1E??           00244                 COMF            AARGB0, F
002728 0E00           00245                 MOVLW           0
00272A 2A??           00246                 INCF            AARGB2, F
00272C 22??           00247                 ADDWFC          AARGB1, F
00272E 22??           00248                 ADDWFC          AARGB0, F
                      00249 
002730 1E??           00250                 COMF            REMB1, F
002732 1E??           00251                 COMF            REMB0, F
002734 2A??           00252                 INCF            REMB1, F
002736 22??           00253                 ADDWFC          REMB0, F
                      00254 
002738 0C00           00255                 RETLW           0x00
                      00256 
00273A AE??           00257 C2416SX1        BTFSS           BARGB0,MSB              ; test BARG exception
00273C EF?? F???      00258                 GOTO            C2416SX3
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 169


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

002740 BE??           00259                 BTFSC           AARGB0,MSB              ; test AARG exception
002742 EF?? F???      00260                 GOTO            C2416SX2
002746 CFE8 F???      00261                 MOVPF           WREG,Ctemp
00274A 50??           00262                 MOVFP           AARGB1,W
00274C CFE8 F???      00263                 MOVPF           WREG,REMB0
002750 50??           00264                 MOVFP           AARGB2,W
002752 CFE8 F???      00265                 MOVPF           WREG,REMB1
002756 9E??           00266                 BCF             REMB0,MSB
002758 36??           00267                 RLCF            AARGB1,F
00275A 36??           00268                 RLCF            AARGB0,F
00275C 50??           00269                 MOVFP           AARGB0,W
00275E CFE8 F???      00270                 MOVPF           WREG,AARGB2
002762 50??           00271                 MOVFP           Ctemp,W
002764 6A??           00272                 CLRF            AARGB0
002766 6A??           00273                 CLRF            AARGB1
002768 EF?? F???      00274                 GOTO            C2416SOK
00276C 6A??           00275 C2416SX2        CLRF            AARGB2          ; quotient = 1, remainder = 0
00276E 2A??           00276                 INCF            AARGB2,F
002770 6A??           00277                 CLRF            AARGB1
002772 6A??           00278                 CLRF            AARGB0
002774 0C00           00279                 RETLW           0x00
                      00280 
002776 1E??           00281 C2416SX3        COMF            AARGB0,F                ; numerator = 0x7FFFFF + 1
002778 1E??           00282                 COMF            AARGB1,F
00277A 1E??           00283                 COMF            AARGB2,F
00277C 2A??           00284                 INCF            TEMPB3,F
00277E EF?? F???      00285                 GOTO            C2416S
                      00286 
002782 2A??           00287 C2416SX4        INCF            REMB1,F                 ; increment remainder and test for
002784 6AE8           00288                 CLRF            WREG
002786 22??           00289                 ADDWFC          REMB0,F
002788 50??           00290                 MOVFP           BARGB1,W                ; overflow
00278A 62??           00291                 CPFSEQ          REMB1
00278C EF?? F???      00292                 GOTO            C2416SOK
002790 50??           00293                 MOVFP           BARGB0,W                ; overflow
002792 62??           00294                 CPFSEQ          REMB0
002794 EF?? F???      00295                 GOTO            C2416SOK
002798 6A??           00296                 CLRF            REMB0                   ; if remainder overflow, clear
00279A 6A??           00297                 CLRF            REMB1
00279C 0E00           00298                 MOVLW           0
00279E 2A??           00299                 INCF            AARGB2,F                ; remainder, increment quotient and
0027A0 22??           00300                 ADDWFC          AARGB1,F                ; test for overflow exception
0027A2 22??           00301                 ADDWFC          AARGB0,F
0027A4 AE??           00302                 BTFSS           AARGB0,MSB
0027A6 EF?? F???      00303                 GOTO            C2416SOK
0027AA 88??           00304                 BSF             FPFLAGS,NAN
0027AC 0CFF           00305                 RETLW           0xFF
                      00306                 
                      00288 INCLUDE         <DIV3232U.ASM>
                      00001 
                      00002 #define TEMP    TEMPB3
                      00003 
                      00004 NDIV3232        macro
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 170


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00005 
                      00006 ;       Max Timing:     16+31*21+10 = 677 clks
                      00007 ;
                      00008 ;       Min Timing: 16+31*20+3 = 639 clks
                      00009 ;
                      00010 ;       PM: 16+31*29+10 = 925           DM: 13
                      00011 ;
                      00012                 variable i
                      00013 
                      00014                 RLCF            CEXreg+3,W
                      00015                 RLCF            EEXreg, F
                      00016                 RLCF            EEXreg+1, F
                      00017                 RLCF            EEXreg+2, F
                      00018                 RLCF            EEXreg+3, F
                      00019                 MOVFP           DEXreg,WREG
                      00020                 SUBWF           EEXreg, F
                      00021                 MOVFP           DEXreg+1,WREG
                      00022                 SUBWFB          EEXreg+1, F
                      00023                 MOVFP           DEXreg+2,WREG
                      00024                 SUBWFB          EEXreg+2, F
                      00025                 MOVFP           DEXreg+3,WREG
                      00026                 SUBWFB          EEXreg+3, F
                      00027                 CLRF            TEMP
                      00028                 SUBWFB          TEMP, F
                      00029                 RLCF            CEXreg+3, F
                      00030 
                      00031                 variable i = D'1'
                      00032 
                      00033                 while i < D'8'
                      00034 
                      00035                 RLCF            CEXreg+3,W
                      00036                 RLCF            EEXreg, F
                      00037                 RLCF            EEXreg+1, F
                      00038                 RLCF            EEXreg+2, F
                      00039                 RLCF            EEXreg+3, F
                      00040                 RLCF            TEMP, F
                      00041                 MOVFP           DEXreg,WREG
                      00042                 BTFSS           CEXreg+3,LSB
                      00043                 GOTO            NADD22#v(i)
                      00044                 SUBWF           EEXreg, F
                      00045                 MOVFP           DEXreg+1,WREG
                      00046                 SUBWFB          EEXreg+1, F
                      00047                 MOVFP           DEXreg+2,WREG
                      00048                 SUBWFB          EEXreg+2, F
                      00049                 MOVFP           DEXreg+3,WREG
                      00050                 SUBWFB          EEXreg+3, F
                      00051                 CLRF            WREG
                      00052                 SUBWFB          TEMP, F
                      00053                 GOTO            NOK22#v(i)
                      00054 
                      00055 NADD22#v(i)     ADDWF           EEXreg, F
                      00056                 MOVFP           DEXreg+1,WREG
                      00057                 ADDWFC          EEXreg+1, F
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 171


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00058                 MOVFP           DEXreg+2,WREG
                      00059                 ADDWFC          EEXreg+2, F
                      00060                 MOVFP           DEXreg+3,WREG
                      00061                 ADDWFC          EEXreg+3, F
                      00062                 CLRF            WREG
                      00063                 ADDWFC          TEMP, F
                      00064         
                      00065 NOK22#v(i)      RLCF            CEXreg+3, F
                      00066 
                      00067                 variable i=i+1
                      00068 
                      00069                 endw
                      00070 
                      00071                 RLCF            CEXreg+2,W
                      00072                 RLCF            EEXreg, F
                      00073                 RLCF            EEXreg+1, F
                      00074                 RLCF            EEXreg+2, F
                      00075                 RLCF            EEXreg+3, F
                      00076                 RLCF            TEMP, F
                      00077                 MOVFP           DEXreg,WREG
                      00078                 BTFSS           CEXreg+3,LSB
                      00079                 GOTO            NADD228
                      00080                 SUBWF           EEXreg, F
                      00081                 MOVFP           DEXreg+1,WREG
                      00082                 SUBWFB          EEXreg+1, F
                      00083                 MOVFP           DEXreg+2,WREG
                      00084                 SUBWFB          EEXreg+2, F
                      00085                 MOVFP           DEXreg+3,WREG
                      00086                 SUBWFB          EEXreg+3, F
                      00087                 CLRF            WREG
                      00088                 SUBWFB          TEMP, F
                      00089                 GOTO            NOK228
                      00090 
                      00091 NADD228         ADDWF           EEXreg, F
                      00092                 MOVFP           DEXreg+1,WREG
                      00093                 ADDWFC          EEXreg+1, F
                      00094                 MOVFP           DEXreg+2,WREG
                      00095                 ADDWFC          EEXreg+2, F
                      00096                 MOVFP           DEXreg+3,WREG
                      00097                 ADDWFC          EEXreg+3, F
                      00098                 CLRF            WREG
                      00099                 ADDWFC          TEMP, F
                      00100         
                      00101 NOK228          RLCF            CEXreg+2, F
                      00102 
                      00103                 variable i = D'9'
                      00104 
                      00105                 while i < D'16'
                      00106 
                      00107                 RLCF            CEXreg+2,W
                      00108                 RLCF            EEXreg, F
                      00109                 RLCF            EEXreg+1, F
                      00110                 RLCF            EEXreg+2, F
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 172


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00111                 RLCF            EEXreg+3, F
                      00112                 RLCF            TEMP, F
                      00113                 MOVFP           DEXreg,WREG
                      00114                 BTFSS           CEXreg+2,LSB
                      00115                 GOTO            NADD22#v(i)
                      00116                 SUBWF           EEXreg, F
                      00117                 MOVFP           DEXreg+1,WREG
                      00118                 SUBWFB          EEXreg+1, F
                      00119                 MOVFP           DEXreg+2,WREG
                      00120                 SUBWFB          EEXreg+2, F
                      00121                 MOVFP           DEXreg+3,WREG
                      00122                 SUBWFB          EEXreg+3, F
                      00123                 CLRF            WREG
                      00124                 SUBWFB          TEMP, F
                      00125                 GOTO            NOK22#v(i)
                      00126 
                      00127 NADD22#v(i)     ADDWF           EEXreg, F
                      00128                 MOVFP           DEXreg+1,WREG
                      00129                 ADDWFC          EEXreg+1, F
                      00130                 MOVFP           DEXreg+2,WREG
                      00131                 ADDWFC          EEXreg+2, F
                      00132                 MOVFP           DEXreg+3,WREG
                      00133                 ADDWFC          EEXreg+3, F
                      00134                 CLRF            WREG
                      00135                 ADDWFC          TEMP, F
                      00136         
                      00137 NOK22#v(i)      RLCF            CEXreg+2, F
                      00138 
                      00139                 variable i=i+1
                      00140 
                      00141                 endw
                      00142 
                      00143                 RLCF            CEXreg+1,W
                      00144                 RLCF            EEXreg, F
                      00145                 RLCF            EEXreg+1, F
                      00146                 RLCF            EEXreg+2, F
                      00147                 RLCF            EEXreg+3, F
                      00148                 RLCF            TEMP, F
                      00149                 MOVFP           DEXreg,WREG
                      00150                 BTFSS           CEXreg+2,LSB
                      00151                 GOTO            NADD2216
                      00152                 SUBWF           EEXreg, F
                      00153                 MOVFP           DEXreg+1,WREG
                      00154                 SUBWFB          EEXreg+1, F
                      00155                 MOVFP           DEXreg+2,WREG
                      00156                 SUBWFB          EEXreg+2, F
                      00157                 MOVFP           DEXreg+3,WREG
                      00158                 SUBWFB          EEXreg+3, F
                      00159                 CLRF            WREG
                      00160                 SUBWFB          TEMP, F
                      00161                 GOTO            NOK2216
                      00162 
                      00163 NADD2216        ADDWF           EEXreg, F
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 173


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00164                 MOVFP           DEXreg+1,WREG
                      00165                 ADDWFC          EEXreg+1, F
                      00166                 MOVFP           DEXreg+2,WREG
                      00167                 ADDWFC          EEXreg+2, F
                      00168                 MOVFP           DEXreg+3,WREG
                      00169                 ADDWFC          EEXreg+3, F
                      00170                 CLRF            WREG
                      00171                 ADDWFC          TEMP, F
                      00172         
                      00173 NOK2216         RLCF            CEXreg+1, F
                      00174 
                      00175                 variable i = D'17'
                      00176 
                      00177                 while i < D'24'
                      00178 
                      00179                 RLCF            CEXreg+1,W
                      00180                 RLCF            EEXreg, F
                      00181                 RLCF            EEXreg+1, F
                      00182                 RLCF            EEXreg+2, F
                      00183                 RLCF            EEXreg+3, F
                      00184                 RLCF            TEMP, F
                      00185                 MOVFP           DEXreg,WREG
                      00186                 BTFSS           CEXreg+1,LSB
                      00187                 GOTO            NADD22#v(i)
                      00188                 SUBWF           EEXreg, F
                      00189                 MOVFP           DEXreg+1,WREG
                      00190                 SUBWFB          EEXreg+1, F
                      00191                 MOVFP           DEXreg+2,WREG
                      00192                 SUBWFB          EEXreg+2, F
                      00193                 MOVFP           DEXreg+3,WREG
                      00194                 SUBWFB          EEXreg+3, F
                      00195                 CLRF            WREG
                      00196                 SUBWFB          TEMP, F
                      00197                 GOTO            NOK22#v(i)
                      00198 
                      00199 NADD22#v(i)     ADDWF           EEXreg, F
                      00200                 MOVFP           DEXreg+1,WREG
                      00201                 ADDWFC          EEXreg+1, F
                      00202                 MOVFP           DEXreg+2,WREG
                      00203                 ADDWFC          EEXreg+2, F
                      00204                 MOVFP           DEXreg+3,WREG
                      00205                 ADDWFC          EEXreg+3, F
                      00206                 CLRF            WREG
                      00207                 ADDWFC          TEMP, F
                      00208         
                      00209 NOK22#v(i)      RLCF            CEXreg+1, F
                      00210 
                      00211                 variable i=i+1
                      00212 
                      00213                 endw
                      00214 
                      00215                 RLCF            CEXreg,W
                      00216                 RLCF            EEXreg, F
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 174


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00217                 RLCF            EEXreg+1, F
                      00218                 RLCF            EEXreg+2, F
                      00219                 RLCF            EEXreg+3, F
                      00220                 RLCF            TEMP, F
                      00221                 MOVFP           DEXreg,WREG
                      00222                 BTFSS           CEXreg+1,LSB
                      00223                 GOTO            NADD2224
                      00224                 SUBWF           EEXreg, F
                      00225                 MOVFP           DEXreg+1,WREG
                      00226                 SUBWFB          EEXreg+1, F
                      00227                 MOVFP           DEXreg+2,WREG
                      00228                 SUBWFB          EEXreg+2, F
                      00229                 MOVFP           DEXreg+3,WREG
                      00230                 SUBWFB          EEXreg+3, F
                      00231                 CLRF            WREG
                      00232                 SUBWFB          TEMP, F
                      00233                 GOTO            NOK2224
                      00234 
                      00235 NADD2224        ADDWF           EEXreg, F
                      00236                 MOVFP           DEXreg+1,WREG
                      00237                 ADDWFC          EEXreg+1, F
                      00238                 MOVFP           DEXreg+2,WREG
                      00239                 ADDWFC          EEXreg+2, F
                      00240                 MOVFP           DEXreg+3,WREG
                      00241                 ADDWFC          EEXreg+3, F
                      00242                 CLRF            WREG
                      00243                 ADDWFC          TEMP, F
                      00244         
                      00245 NOK2224         RLCF            CEXreg, F
                      00246 
                      00247                 variable i = D'25'
                      00248 
                      00249                 while i < D'32'
                      00250 
                      00251                 RLCF            CEXreg,W
                      00252                 RLCF            EEXreg, F
                      00253                 RLCF            EEXreg+1, F
                      00254                 RLCF            EEXreg+2, F
                      00255                 RLCF            EEXreg+3, F
                      00256                 RLCF            TEMP, F
                      00257                 MOVFP           DEXreg,WREG
                      00258                 BTFSS           CEXreg,LSB
                      00259                 GOTO            NADD22#v(i)
                      00260                 SUBWF           EEXreg, F
                      00261                 MOVFP           DEXreg+1,WREG
                      00262                 SUBWFB          EEXreg+1, F
                      00263                 MOVFP           DEXreg+2,WREG
                      00264                 SUBWFB          EEXreg+2, F
                      00265                 MOVFP           DEXreg+3,WREG
                      00266                 SUBWFB          EEXreg+3, F
                      00267                 CLRF            WREG
                      00268                 SUBWFB          TEMP, F
                      00269                 GOTO            NOK22#v(i)
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 175


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00270 
                      00271 NADD22#v(i)     ADDWF           EEXreg, F
                      00272                 MOVFP           DEXreg+1,WREG
                      00273                 ADDWFC          EEXreg+1, F
                      00274                 MOVFP           DEXreg+2,WREG
                      00275                 ADDWFC          EEXreg+2, F
                      00276                 MOVFP           DEXreg+3,WREG
                      00277                 ADDWFC          EEXreg+3, F
                      00278                 CLRF            WREG
                      00279                 ADDWFC          TEMP, F
                      00280         
                      00281 NOK22#v(i)      RLCF            CEXreg, F
                      00282 
                      00283                 variable i=i+1
                      00284 
                      00285                 endw
                      00286 
                      00287                 BTFSC           CEXreg,LSB
                      00288                 GOTO            NOK22
                      00289                 MOVFP           DEXreg,WREG
                      00290                 ADDWF           EEXreg, F
                      00291                 MOVFP           DEXreg+1,WREG
                      00292                 ADDWFC          EEXreg+1, F
                      00293                 MOVFP           DEXreg+2,WREG
                      00294                 ADDWFC          EEXreg+2, F
                      00295                 MOVFP           DEXreg+3,WREG
                      00296                 ADDWFC          EEXreg+3, F
                      00297 
                      00298 NOK22
                      00299                 endm
                      00300 
                      00301 
                      00302 ;**********************************************************************************************
                      00303 ;**********************************************************************************************
                      00304 ;
                      00305 ;       32/32 Bit Unsigned Fixed Point Divide 32/32 -> 32.32
                      00306 ;
                      00307 ;       Input:  32 bit unsigned fixed point dividend in CEXreg+3, CEXreg+2,CEXreg+1,CEXreg
                      00308 ;               32 bit unsigned fixed point divisor in DEXreg+3, DEXreg+2, DEXreg+1, DEXreg
                      00309 ;
                      00310 ;       Use:    CALL    FXD3232U
                      00311 ;
                      00312 ;       Output: 32 bit unsigned fixed point quotient in CEXreg+3, CEXreg+2,CEXreg+1,CEXreg
                      00313 ;               32 bit unsigned fixed point remainder in EEXreg+3, EEXreg+2, EEXreg+1, EEXreg
                      00314 ;
                      00315 ;       Result: AARG, REM  <--  AARG / BARG
                      00316 ;
                      00317 ;       Max Timing:     4+677+2 = 683 clks
                      00318 ;
                      00319 ;       Min Timing:     4+639+2 = 645 clks
                      00320 ;
                      00321 ;       PM: 4+925+1 = 930               DM: 13
                      00322 ;
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 176


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

0027AE                00323 Divide3232u
0027AE                00324 FXD3232U
0027AE 01??           00325                 MOVLB           HIGH EEXreg
0027B0 6A??           00326                 CLRF            EEXreg+3
0027B2 6A??           00327                 CLRF            EEXreg+2
0027B4 6A??           00328                 CLRF            EEXreg+1
0027B6 6A??           00329                 CLRF            EEXreg
                      00330 
                      00331                 NDIV3232
                          M 
                          M ;       Max Timing:     16+31*21+10 = 677 clks
                          M ;
                          M ;       Min Timing: 16+31*20+3 = 639 clks
                          M ;
                          M ;       PM: 16+31*29+10 = 925           DM: 13
                          M ;
  0000                    M                 variable i
                          M 
0027B8 34??               M                 RLCF            CEXreg+3,W
0027BA 36??               M                 RLCF            EEXreg, F
0027BC 36??               M                 RLCF            EEXreg+1, F
0027BE 36??               M                 RLCF            EEXreg+2, F
0027C0 36??               M                 RLCF            EEXreg+3, F
0027C2 5000               M                 MOVFP           DEXreg,WREG
0027C4 5E??               M                 SUBWF           EEXreg, F
0027C6 5000               M                 MOVFP           DEXreg+1,WREG
0027C8 5A??               M                 SUBWFB          EEXreg+1, F
0027CA 5000               M                 MOVFP           DEXreg+2,WREG
0027CC 5A??               M                 SUBWFB          EEXreg+2, F
0027CE 5000               M                 MOVFP           DEXreg+3,WREG
0027D0 5A??               M                 SUBWFB          EEXreg+3, F
0027D2 6A??               M                 CLRF            TEMP
0027D4 5A??               M                 SUBWFB          TEMP, F
0027D6 36??               M                 RLCF            CEXreg+3, F
                          M 
  0001                    M                 variable i = D'1'
                          M 
                          M                 while i < D'8'
                          M 
0027D8 34??               M                 RLCF            CEXreg+3,W
0027DA 36??               M                 RLCF            EEXreg, F
0027DC 36??               M                 RLCF            EEXreg+1, F
0027DE 36??               M                 RLCF            EEXreg+2, F
0027E0 36??               M                 RLCF            EEXreg+3, F
0027E2 36??               M                 RLCF            TEMP, F
0027E4 5000               M                 MOVFP           DEXreg,WREG
0027E6 A0??               M                 BTFSS           CEXreg+3,LSB
0027E8 EF?? F???          M                 GOTO            NADD221
0027EC 5E??               M                 SUBWF           EEXreg, F
0027EE 5000               M                 MOVFP           DEXreg+1,WREG
0027F0 5A??               M                 SUBWFB          EEXreg+1, F
0027F2 5000               M                 MOVFP           DEXreg+2,WREG
0027F4 5A??               M                 SUBWFB          EEXreg+2, F
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 177


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

0027F6 5000               M                 MOVFP           DEXreg+3,WREG
0027F8 5A??               M                 SUBWFB          EEXreg+3, F
0027FA 6AE8               M                 CLRF            WREG
0027FC 5A??               M                 SUBWFB          TEMP, F
0027FE EF?? F???          M                 GOTO            NOK221
                          M 
002802 26??               M NADD221         ADDWF           EEXreg, F
002804 5000               M                 MOVFP           DEXreg+1,WREG
002806 22??               M                 ADDWFC          EEXreg+1, F
002808 5000               M                 MOVFP           DEXreg+2,WREG
00280A 22??               M                 ADDWFC          EEXreg+2, F
00280C 5000               M                 MOVFP           DEXreg+3,WREG
00280E 22??               M                 ADDWFC          EEXreg+3, F
002810 6AE8               M                 CLRF            WREG
002812 22??               M                 ADDWFC          TEMP, F
                          M         
002814 36??               M NOK221          RLCF            CEXreg+3, F
                          M 
  0002                    M                 variable i=i+1
                          M 
                          M 
002816 34??               M                 RLCF            CEXreg+3,W
002818 36??               M                 RLCF            EEXreg, F
00281A 36??               M                 RLCF            EEXreg+1, F
00281C 36??               M                 RLCF            EEXreg+2, F
00281E 36??               M                 RLCF            EEXreg+3, F
002820 36??               M                 RLCF            TEMP, F
002822 5000               M                 MOVFP           DEXreg,WREG
002824 A0??               M                 BTFSS           CEXreg+3,LSB
002826 EF?? F???          M                 GOTO            NADD222
00282A 5E??               M                 SUBWF           EEXreg, F
00282C 5000               M                 MOVFP           DEXreg+1,WREG
00282E 5A??               M                 SUBWFB          EEXreg+1, F
002830 5000               M                 MOVFP           DEXreg+2,WREG
002832 5A??               M                 SUBWFB          EEXreg+2, F
002834 5000               M                 MOVFP           DEXreg+3,WREG
002836 5A??               M                 SUBWFB          EEXreg+3, F
002838 6AE8               M                 CLRF            WREG
00283A 5A??               M                 SUBWFB          TEMP, F
00283C EF?? F???          M                 GOTO            NOK222
                          M 
002840 26??               M NADD222         ADDWF           EEXreg, F
002842 5000               M                 MOVFP           DEXreg+1,WREG
002844 22??               M                 ADDWFC          EEXreg+1, F
002846 5000               M                 MOVFP           DEXreg+2,WREG
002848 22??               M                 ADDWFC          EEXreg+2, F
00284A 5000               M                 MOVFP           DEXreg+3,WREG
00284C 22??               M                 ADDWFC          EEXreg+3, F
00284E 6AE8               M                 CLRF            WREG
002850 22??               M                 ADDWFC          TEMP, F
                          M         
002852 36??               M NOK222          RLCF            CEXreg+3, F
                          M 
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 178


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

  0003                    M                 variable i=i+1
                          M 
                          M 
002854 34??               M                 RLCF            CEXreg+3,W
002856 36??               M                 RLCF            EEXreg, F
002858 36??               M                 RLCF            EEXreg+1, F
00285A 36??               M                 RLCF            EEXreg+2, F
00285C 36??               M                 RLCF            EEXreg+3, F
00285E 36??               M                 RLCF            TEMP, F
002860 5000               M                 MOVFP           DEXreg,WREG
002862 A0??               M                 BTFSS           CEXreg+3,LSB
002864 EF?? F???          M                 GOTO            NADD223
002868 5E??               M                 SUBWF           EEXreg, F
00286A 5000               M                 MOVFP           DEXreg+1,WREG
00286C 5A??               M                 SUBWFB          EEXreg+1, F
00286E 5000               M                 MOVFP           DEXreg+2,WREG
002870 5A??               M                 SUBWFB          EEXreg+2, F
002872 5000               M                 MOVFP           DEXreg+3,WREG
002874 5A??               M                 SUBWFB          EEXreg+3, F
002876 6AE8               M                 CLRF            WREG
002878 5A??               M                 SUBWFB          TEMP, F
00287A EF?? F???          M                 GOTO            NOK223
                          M 
00287E 26??               M NADD223         ADDWF           EEXreg, F
002880 5000               M                 MOVFP           DEXreg+1,WREG
002882 22??               M                 ADDWFC          EEXreg+1, F
002884 5000               M                 MOVFP           DEXreg+2,WREG
002886 22??               M                 ADDWFC          EEXreg+2, F
002888 5000               M                 MOVFP           DEXreg+3,WREG
00288A 22??               M                 ADDWFC          EEXreg+3, F
00288C 6AE8               M                 CLRF            WREG
00288E 22??               M                 ADDWFC          TEMP, F
                          M         
002890 36??               M NOK223          RLCF            CEXreg+3, F
                          M 
  0004                    M                 variable i=i+1
                          M 
                          M 
002892 34??               M                 RLCF            CEXreg+3,W
002894 36??               M                 RLCF            EEXreg, F
002896 36??               M                 RLCF            EEXreg+1, F
002898 36??               M                 RLCF            EEXreg+2, F
00289A 36??               M                 RLCF            EEXreg+3, F
00289C 36??               M                 RLCF            TEMP, F
00289E 5000               M                 MOVFP           DEXreg,WREG
0028A0 A0??               M                 BTFSS           CEXreg+3,LSB
0028A2 EF?? F???          M                 GOTO            NADD224
0028A6 5E??               M                 SUBWF           EEXreg, F
0028A8 5000               M                 MOVFP           DEXreg+1,WREG
0028AA 5A??               M                 SUBWFB          EEXreg+1, F
0028AC 5000               M                 MOVFP           DEXreg+2,WREG
0028AE 5A??               M                 SUBWFB          EEXreg+2, F
0028B0 5000               M                 MOVFP           DEXreg+3,WREG
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 179


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

0028B2 5A??               M                 SUBWFB          EEXreg+3, F
0028B4 6AE8               M                 CLRF            WREG
0028B6 5A??               M                 SUBWFB          TEMP, F
0028B8 EF?? F???          M                 GOTO            NOK224
                          M 
0028BC 26??               M NADD224         ADDWF           EEXreg, F
0028BE 5000               M                 MOVFP           DEXreg+1,WREG
0028C0 22??               M                 ADDWFC          EEXreg+1, F
0028C2 5000               M                 MOVFP           DEXreg+2,WREG
0028C4 22??               M                 ADDWFC          EEXreg+2, F
0028C6 5000               M                 MOVFP           DEXreg+3,WREG
0028C8 22??               M                 ADDWFC          EEXreg+3, F
0028CA 6AE8               M                 CLRF            WREG
0028CC 22??               M                 ADDWFC          TEMP, F
                          M         
0028CE 36??               M NOK224          RLCF            CEXreg+3, F
                          M 
  0005                    M                 variable i=i+1
                          M 
                          M 
0028D0 34??               M                 RLCF            CEXreg+3,W
0028D2 36??               M                 RLCF            EEXreg, F
0028D4 36??               M                 RLCF            EEXreg+1, F
0028D6 36??               M                 RLCF            EEXreg+2, F
0028D8 36??               M                 RLCF            EEXreg+3, F
0028DA 36??               M                 RLCF            TEMP, F
0028DC 5000               M                 MOVFP           DEXreg,WREG
0028DE A0??               M                 BTFSS           CEXreg+3,LSB
0028E0 EF?? F???          M                 GOTO            NADD225
0028E4 5E??               M                 SUBWF           EEXreg, F
0028E6 5000               M                 MOVFP           DEXreg+1,WREG
0028E8 5A??               M                 SUBWFB          EEXreg+1, F
0028EA 5000               M                 MOVFP           DEXreg+2,WREG
0028EC 5A??               M                 SUBWFB          EEXreg+2, F
0028EE 5000               M                 MOVFP           DEXreg+3,WREG
0028F0 5A??               M                 SUBWFB          EEXreg+3, F
0028F2 6AE8               M                 CLRF            WREG
0028F4 5A??               M                 SUBWFB          TEMP, F
0028F6 EF?? F???          M                 GOTO            NOK225
                          M 
0028FA 26??               M NADD225         ADDWF           EEXreg, F
0028FC 5000               M                 MOVFP           DEXreg+1,WREG
0028FE 22??               M                 ADDWFC          EEXreg+1, F
002900 5000               M                 MOVFP           DEXreg+2,WREG
002902 22??               M                 ADDWFC          EEXreg+2, F
002904 5000               M                 MOVFP           DEXreg+3,WREG
002906 22??               M                 ADDWFC          EEXreg+3, F
002908 6AE8               M                 CLRF            WREG
00290A 22??               M                 ADDWFC          TEMP, F
                          M         
00290C 36??               M NOK225          RLCF            CEXreg+3, F
                          M 
  0006                    M                 variable i=i+1
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 180


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M 
                          M 
00290E 34??               M                 RLCF            CEXreg+3,W
002910 36??               M                 RLCF            EEXreg, F
002912 36??               M                 RLCF            EEXreg+1, F
002914 36??               M                 RLCF            EEXreg+2, F
002916 36??               M                 RLCF            EEXreg+3, F
002918 36??               M                 RLCF            TEMP, F
00291A 5000               M                 MOVFP           DEXreg,WREG
00291C A0??               M                 BTFSS           CEXreg+3,LSB
00291E EF?? F???          M                 GOTO            NADD226
002922 5E??               M                 SUBWF           EEXreg, F
002924 5000               M                 MOVFP           DEXreg+1,WREG
002926 5A??               M                 SUBWFB          EEXreg+1, F
002928 5000               M                 MOVFP           DEXreg+2,WREG
00292A 5A??               M                 SUBWFB          EEXreg+2, F
00292C 5000               M                 MOVFP           DEXreg+3,WREG
00292E 5A??               M                 SUBWFB          EEXreg+3, F
002930 6AE8               M                 CLRF            WREG
002932 5A??               M                 SUBWFB          TEMP, F
002934 EF?? F???          M                 GOTO            NOK226
                          M 
002938 26??               M NADD226         ADDWF           EEXreg, F
00293A 5000               M                 MOVFP           DEXreg+1,WREG
00293C 22??               M                 ADDWFC          EEXreg+1, F
00293E 5000               M                 MOVFP           DEXreg+2,WREG
002940 22??               M                 ADDWFC          EEXreg+2, F
002942 5000               M                 MOVFP           DEXreg+3,WREG
002944 22??               M                 ADDWFC          EEXreg+3, F
002946 6AE8               M                 CLRF            WREG
002948 22??               M                 ADDWFC          TEMP, F
                          M         
00294A 36??               M NOK226          RLCF            CEXreg+3, F
                          M 
  0007                    M                 variable i=i+1
                          M 
                          M 
00294C 34??               M                 RLCF            CEXreg+3,W
00294E 36??               M                 RLCF            EEXreg, F
002950 36??               M                 RLCF            EEXreg+1, F
002952 36??               M                 RLCF            EEXreg+2, F
002954 36??               M                 RLCF            EEXreg+3, F
002956 36??               M                 RLCF            TEMP, F
002958 5000               M                 MOVFP           DEXreg,WREG
00295A A0??               M                 BTFSS           CEXreg+3,LSB
00295C EF?? F???          M                 GOTO            NADD227
002960 5E??               M                 SUBWF           EEXreg, F
002962 5000               M                 MOVFP           DEXreg+1,WREG
002964 5A??               M                 SUBWFB          EEXreg+1, F
002966 5000               M                 MOVFP           DEXreg+2,WREG
002968 5A??               M                 SUBWFB          EEXreg+2, F
00296A 5000               M                 MOVFP           DEXreg+3,WREG
00296C 5A??               M                 SUBWFB          EEXreg+3, F
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 181


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

00296E 6AE8               M                 CLRF            WREG
002970 5A??               M                 SUBWFB          TEMP, F
002972 EF?? F???          M                 GOTO            NOK227
                          M 
002976 26??               M NADD227         ADDWF           EEXreg, F
002978 5000               M                 MOVFP           DEXreg+1,WREG
00297A 22??               M                 ADDWFC          EEXreg+1, F
00297C 5000               M                 MOVFP           DEXreg+2,WREG
00297E 22??               M                 ADDWFC          EEXreg+2, F
002980 5000               M                 MOVFP           DEXreg+3,WREG
002982 22??               M                 ADDWFC          EEXreg+3, F
002984 6AE8               M                 CLRF            WREG
002986 22??               M                 ADDWFC          TEMP, F
                          M         
002988 36??               M NOK227          RLCF            CEXreg+3, F
                          M 
  0008                    M                 variable i=i+1
                          M 
                          M                 endw
                          M 
00298A 34??               M                 RLCF            CEXreg+2,W
00298C 36??               M                 RLCF            EEXreg, F
00298E 36??               M                 RLCF            EEXreg+1, F
002990 36??               M                 RLCF            EEXreg+2, F
002992 36??               M                 RLCF            EEXreg+3, F
002994 36??               M                 RLCF            TEMP, F
002996 5000               M                 MOVFP           DEXreg,WREG
002998 A0??               M                 BTFSS           CEXreg+3,LSB
00299A EF?? F???          M                 GOTO            NADD228
00299E 5E??               M                 SUBWF           EEXreg, F
0029A0 5000               M                 MOVFP           DEXreg+1,WREG
0029A2 5A??               M                 SUBWFB          EEXreg+1, F
0029A4 5000               M                 MOVFP           DEXreg+2,WREG
0029A6 5A??               M                 SUBWFB          EEXreg+2, F
0029A8 5000               M                 MOVFP           DEXreg+3,WREG
0029AA 5A??               M                 SUBWFB          EEXreg+3, F
0029AC 6AE8               M                 CLRF            WREG
0029AE 5A??               M                 SUBWFB          TEMP, F
0029B0 EF?? F???          M                 GOTO            NOK228
                          M 
0029B4 26??               M NADD228         ADDWF           EEXreg, F
0029B6 5000               M                 MOVFP           DEXreg+1,WREG
0029B8 22??               M                 ADDWFC          EEXreg+1, F
0029BA 5000               M                 MOVFP           DEXreg+2,WREG
0029BC 22??               M                 ADDWFC          EEXreg+2, F
0029BE 5000               M                 MOVFP           DEXreg+3,WREG
0029C0 22??               M                 ADDWFC          EEXreg+3, F
0029C2 6AE8               M                 CLRF            WREG
0029C4 22??               M                 ADDWFC          TEMP, F
                          M         
0029C6 36??               M NOK228          RLCF            CEXreg+2, F
                          M 
  0009                    M                 variable i = D'9'
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 182


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M 
                          M                 while i < D'16'
                          M 
0029C8 34??               M                 RLCF            CEXreg+2,W
0029CA 36??               M                 RLCF            EEXreg, F
0029CC 36??               M                 RLCF            EEXreg+1, F
0029CE 36??               M                 RLCF            EEXreg+2, F
0029D0 36??               M                 RLCF            EEXreg+3, F
0029D2 36??               M                 RLCF            TEMP, F
0029D4 5000               M                 MOVFP           DEXreg,WREG
0029D6 A0??               M                 BTFSS           CEXreg+2,LSB
0029D8 EF?? F???          M                 GOTO            NADD229
0029DC 5E??               M                 SUBWF           EEXreg, F
0029DE 5000               M                 MOVFP           DEXreg+1,WREG
0029E0 5A??               M                 SUBWFB          EEXreg+1, F
0029E2 5000               M                 MOVFP           DEXreg+2,WREG
0029E4 5A??               M                 SUBWFB          EEXreg+2, F
0029E6 5000               M                 MOVFP           DEXreg+3,WREG
0029E8 5A??               M                 SUBWFB          EEXreg+3, F
0029EA 6AE8               M                 CLRF            WREG
0029EC 5A??               M                 SUBWFB          TEMP, F
0029EE EF?? F???          M                 GOTO            NOK229
                          M 
0029F2 26??               M NADD229         ADDWF           EEXreg, F
0029F4 5000               M                 MOVFP           DEXreg+1,WREG
0029F6 22??               M                 ADDWFC          EEXreg+1, F
0029F8 5000               M                 MOVFP           DEXreg+2,WREG
0029FA 22??               M                 ADDWFC          EEXreg+2, F
0029FC 5000               M                 MOVFP           DEXreg+3,WREG
0029FE 22??               M                 ADDWFC          EEXreg+3, F
002A00 6AE8               M                 CLRF            WREG
002A02 22??               M                 ADDWFC          TEMP, F
                          M         
002A04 36??               M NOK229          RLCF            CEXreg+2, F
                          M 
  000A                    M                 variable i=i+1
                          M 
                          M 
002A06 34??               M                 RLCF            CEXreg+2,W
002A08 36??               M                 RLCF            EEXreg, F
002A0A 36??               M                 RLCF            EEXreg+1, F
002A0C 36??               M                 RLCF            EEXreg+2, F
002A0E 36??               M                 RLCF            EEXreg+3, F
002A10 36??               M                 RLCF            TEMP, F
002A12 5000               M                 MOVFP           DEXreg,WREG
002A14 A0??               M                 BTFSS           CEXreg+2,LSB
002A16 EF?? F???          M                 GOTO            NADD2210
002A1A 5E??               M                 SUBWF           EEXreg, F
002A1C 5000               M                 MOVFP           DEXreg+1,WREG
002A1E 5A??               M                 SUBWFB          EEXreg+1, F
002A20 5000               M                 MOVFP           DEXreg+2,WREG
002A22 5A??               M                 SUBWFB          EEXreg+2, F
002A24 5000               M                 MOVFP           DEXreg+3,WREG
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 183


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

002A26 5A??               M                 SUBWFB          EEXreg+3, F
002A28 6AE8               M                 CLRF            WREG
002A2A 5A??               M                 SUBWFB          TEMP, F
002A2C EF?? F???          M                 GOTO            NOK2210
                          M 
002A30 26??               M NADD2210        ADDWF           EEXreg, F
002A32 5000               M                 MOVFP           DEXreg+1,WREG
002A34 22??               M                 ADDWFC          EEXreg+1, F
002A36 5000               M                 MOVFP           DEXreg+2,WREG
002A38 22??               M                 ADDWFC          EEXreg+2, F
002A3A 5000               M                 MOVFP           DEXreg+3,WREG
002A3C 22??               M                 ADDWFC          EEXreg+3, F
002A3E 6AE8               M                 CLRF            WREG
002A40 22??               M                 ADDWFC          TEMP, F
                          M         
002A42 36??               M NOK2210         RLCF            CEXreg+2, F
                          M 
  000B                    M                 variable i=i+1
                          M 
                          M 
002A44 34??               M                 RLCF            CEXreg+2,W
002A46 36??               M                 RLCF            EEXreg, F
002A48 36??               M                 RLCF            EEXreg+1, F
002A4A 36??               M                 RLCF            EEXreg+2, F
002A4C 36??               M                 RLCF            EEXreg+3, F
002A4E 36??               M                 RLCF            TEMP, F
002A50 5000               M                 MOVFP           DEXreg,WREG
002A52 A0??               M                 BTFSS           CEXreg+2,LSB
002A54 EF?? F???          M                 GOTO            NADD2211
002A58 5E??               M                 SUBWF           EEXreg, F
002A5A 5000               M                 MOVFP           DEXreg+1,WREG
002A5C 5A??               M                 SUBWFB          EEXreg+1, F
002A5E 5000               M                 MOVFP           DEXreg+2,WREG
002A60 5A??               M                 SUBWFB          EEXreg+2, F
002A62 5000               M                 MOVFP           DEXreg+3,WREG
002A64 5A??               M                 SUBWFB          EEXreg+3, F
002A66 6AE8               M                 CLRF            WREG
002A68 5A??               M                 SUBWFB          TEMP, F
002A6A EF?? F???          M                 GOTO            NOK2211
                          M 
002A6E 26??               M NADD2211        ADDWF           EEXreg, F
002A70 5000               M                 MOVFP           DEXreg+1,WREG
002A72 22??               M                 ADDWFC          EEXreg+1, F
002A74 5000               M                 MOVFP           DEXreg+2,WREG
002A76 22??               M                 ADDWFC          EEXreg+2, F
002A78 5000               M                 MOVFP           DEXreg+3,WREG
002A7A 22??               M                 ADDWFC          EEXreg+3, F
002A7C 6AE8               M                 CLRF            WREG
002A7E 22??               M                 ADDWFC          TEMP, F
                          M         
002A80 36??               M NOK2211         RLCF            CEXreg+2, F
                          M 
  000C                    M                 variable i=i+1
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 184


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M 
                          M 
002A82 34??               M                 RLCF            CEXreg+2,W
002A84 36??               M                 RLCF            EEXreg, F
002A86 36??               M                 RLCF            EEXreg+1, F
002A88 36??               M                 RLCF            EEXreg+2, F
002A8A 36??               M                 RLCF            EEXreg+3, F
002A8C 36??               M                 RLCF            TEMP, F
002A8E 5000               M                 MOVFP           DEXreg,WREG
002A90 A0??               M                 BTFSS           CEXreg+2,LSB
002A92 EF?? F???          M                 GOTO            NADD2212
002A96 5E??               M                 SUBWF           EEXreg, F
002A98 5000               M                 MOVFP           DEXreg+1,WREG
002A9A 5A??               M                 SUBWFB          EEXreg+1, F
002A9C 5000               M                 MOVFP           DEXreg+2,WREG
002A9E 5A??               M                 SUBWFB          EEXreg+2, F
002AA0 5000               M                 MOVFP           DEXreg+3,WREG
002AA2 5A??               M                 SUBWFB          EEXreg+3, F
002AA4 6AE8               M                 CLRF            WREG
002AA6 5A??               M                 SUBWFB          TEMP, F
002AA8 EF?? F???          M                 GOTO            NOK2212
                          M 
002AAC 26??               M NADD2212        ADDWF           EEXreg, F
002AAE 5000               M                 MOVFP           DEXreg+1,WREG
002AB0 22??               M                 ADDWFC          EEXreg+1, F
002AB2 5000               M                 MOVFP           DEXreg+2,WREG
002AB4 22??               M                 ADDWFC          EEXreg+2, F
002AB6 5000               M                 MOVFP           DEXreg+3,WREG
002AB8 22??               M                 ADDWFC          EEXreg+3, F
002ABA 6AE8               M                 CLRF            WREG
002ABC 22??               M                 ADDWFC          TEMP, F
                          M         
002ABE 36??               M NOK2212         RLCF            CEXreg+2, F
                          M 
  000D                    M                 variable i=i+1
                          M 
                          M 
002AC0 34??               M                 RLCF            CEXreg+2,W
002AC2 36??               M                 RLCF            EEXreg, F
002AC4 36??               M                 RLCF            EEXreg+1, F
002AC6 36??               M                 RLCF            EEXreg+2, F
002AC8 36??               M                 RLCF            EEXreg+3, F
002ACA 36??               M                 RLCF            TEMP, F
002ACC 5000               M                 MOVFP           DEXreg,WREG
002ACE A0??               M                 BTFSS           CEXreg+2,LSB
002AD0 EF?? F???          M                 GOTO            NADD2213
002AD4 5E??               M                 SUBWF           EEXreg, F
002AD6 5000               M                 MOVFP           DEXreg+1,WREG
002AD8 5A??               M                 SUBWFB          EEXreg+1, F
002ADA 5000               M                 MOVFP           DEXreg+2,WREG
002ADC 5A??               M                 SUBWFB          EEXreg+2, F
002ADE 5000               M                 MOVFP           DEXreg+3,WREG
002AE0 5A??               M                 SUBWFB          EEXreg+3, F
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 185


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

002AE2 6AE8               M                 CLRF            WREG
002AE4 5A??               M                 SUBWFB          TEMP, F
002AE6 EF?? F???          M                 GOTO            NOK2213
                          M 
002AEA 26??               M NADD2213        ADDWF           EEXreg, F
002AEC 5000               M                 MOVFP           DEXreg+1,WREG
002AEE 22??               M                 ADDWFC          EEXreg+1, F
002AF0 5000               M                 MOVFP           DEXreg+2,WREG
002AF2 22??               M                 ADDWFC          EEXreg+2, F
002AF4 5000               M                 MOVFP           DEXreg+3,WREG
002AF6 22??               M                 ADDWFC          EEXreg+3, F
002AF8 6AE8               M                 CLRF            WREG
002AFA 22??               M                 ADDWFC          TEMP, F
                          M         
002AFC 36??               M NOK2213         RLCF            CEXreg+2, F
                          M 
  000E                    M                 variable i=i+1
                          M 
                          M 
002AFE 34??               M                 RLCF            CEXreg+2,W
002B00 36??               M                 RLCF            EEXreg, F
002B02 36??               M                 RLCF            EEXreg+1, F
002B04 36??               M                 RLCF            EEXreg+2, F
002B06 36??               M                 RLCF            EEXreg+3, F
002B08 36??               M                 RLCF            TEMP, F
002B0A 5000               M                 MOVFP           DEXreg,WREG
002B0C A0??               M                 BTFSS           CEXreg+2,LSB
002B0E EF?? F???          M                 GOTO            NADD2214
002B12 5E??               M                 SUBWF           EEXreg, F
002B14 5000               M                 MOVFP           DEXreg+1,WREG
002B16 5A??               M                 SUBWFB          EEXreg+1, F
002B18 5000               M                 MOVFP           DEXreg+2,WREG
002B1A 5A??               M                 SUBWFB          EEXreg+2, F
002B1C 5000               M                 MOVFP           DEXreg+3,WREG
002B1E 5A??               M                 SUBWFB          EEXreg+3, F
002B20 6AE8               M                 CLRF            WREG
002B22 5A??               M                 SUBWFB          TEMP, F
002B24 EF?? F???          M                 GOTO            NOK2214
                          M 
002B28 26??               M NADD2214        ADDWF           EEXreg, F
002B2A 5000               M                 MOVFP           DEXreg+1,WREG
002B2C 22??               M                 ADDWFC          EEXreg+1, F
002B2E 5000               M                 MOVFP           DEXreg+2,WREG
002B30 22??               M                 ADDWFC          EEXreg+2, F
002B32 5000               M                 MOVFP           DEXreg+3,WREG
002B34 22??               M                 ADDWFC          EEXreg+3, F
002B36 6AE8               M                 CLRF            WREG
002B38 22??               M                 ADDWFC          TEMP, F
                          M         
002B3A 36??               M NOK2214         RLCF            CEXreg+2, F
                          M 
  000F                    M                 variable i=i+1
                          M 
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 186


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M 
002B3C 34??               M                 RLCF            CEXreg+2,W
002B3E 36??               M                 RLCF            EEXreg, F
002B40 36??               M                 RLCF            EEXreg+1, F
002B42 36??               M                 RLCF            EEXreg+2, F
002B44 36??               M                 RLCF            EEXreg+3, F
002B46 36??               M                 RLCF            TEMP, F
002B48 5000               M                 MOVFP           DEXreg,WREG
002B4A A0??               M                 BTFSS           CEXreg+2,LSB
002B4C EF?? F???          M                 GOTO            NADD2215
002B50 5E??               M                 SUBWF           EEXreg, F
002B52 5000               M                 MOVFP           DEXreg+1,WREG
002B54 5A??               M                 SUBWFB          EEXreg+1, F
002B56 5000               M                 MOVFP           DEXreg+2,WREG
002B58 5A??               M                 SUBWFB          EEXreg+2, F
002B5A 5000               M                 MOVFP           DEXreg+3,WREG
002B5C 5A??               M                 SUBWFB          EEXreg+3, F
002B5E 6AE8               M                 CLRF            WREG
002B60 5A??               M                 SUBWFB          TEMP, F
002B62 EF?? F???          M                 GOTO            NOK2215
                          M 
002B66 26??               M NADD2215        ADDWF           EEXreg, F
002B68 5000               M                 MOVFP           DEXreg+1,WREG
002B6A 22??               M                 ADDWFC          EEXreg+1, F
002B6C 5000               M                 MOVFP           DEXreg+2,WREG
002B6E 22??               M                 ADDWFC          EEXreg+2, F
002B70 5000               M                 MOVFP           DEXreg+3,WREG
002B72 22??               M                 ADDWFC          EEXreg+3, F
002B74 6AE8               M                 CLRF            WREG
002B76 22??               M                 ADDWFC          TEMP, F
                          M         
002B78 36??               M NOK2215         RLCF            CEXreg+2, F
                          M 
  0010                    M                 variable i=i+1
                          M 
                          M                 endw
                          M 
002B7A 34??               M                 RLCF            CEXreg+1,W
002B7C 36??               M                 RLCF            EEXreg, F
002B7E 36??               M                 RLCF            EEXreg+1, F
002B80 36??               M                 RLCF            EEXreg+2, F
002B82 36??               M                 RLCF            EEXreg+3, F
002B84 36??               M                 RLCF            TEMP, F
002B86 5000               M                 MOVFP           DEXreg,WREG
002B88 A0??               M                 BTFSS           CEXreg+2,LSB
002B8A EF?? F???          M                 GOTO            NADD2216
002B8E 5E??               M                 SUBWF           EEXreg, F
002B90 5000               M                 MOVFP           DEXreg+1,WREG
002B92 5A??               M                 SUBWFB          EEXreg+1, F
002B94 5000               M                 MOVFP           DEXreg+2,WREG
002B96 5A??               M                 SUBWFB          EEXreg+2, F
002B98 5000               M                 MOVFP           DEXreg+3,WREG
002B9A 5A??               M                 SUBWFB          EEXreg+3, F
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 187


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

002B9C 6AE8               M                 CLRF            WREG
002B9E 5A??               M                 SUBWFB          TEMP, F
002BA0 EF?? F???          M                 GOTO            NOK2216
                          M 
002BA4 26??               M NADD2216        ADDWF           EEXreg, F
002BA6 5000               M                 MOVFP           DEXreg+1,WREG
002BA8 22??               M                 ADDWFC          EEXreg+1, F
002BAA 5000               M                 MOVFP           DEXreg+2,WREG
002BAC 22??               M                 ADDWFC          EEXreg+2, F
002BAE 5000               M                 MOVFP           DEXreg+3,WREG
002BB0 22??               M                 ADDWFC          EEXreg+3, F
002BB2 6AE8               M                 CLRF            WREG
002BB4 22??               M                 ADDWFC          TEMP, F
                          M         
002BB6 36??               M NOK2216         RLCF            CEXreg+1, F
                          M 
  0011                    M                 variable i = D'17'
                          M 
                          M                 while i < D'24'
                          M 
002BB8 34??               M                 RLCF            CEXreg+1,W
002BBA 36??               M                 RLCF            EEXreg, F
002BBC 36??               M                 RLCF            EEXreg+1, F
002BBE 36??               M                 RLCF            EEXreg+2, F
002BC0 36??               M                 RLCF            EEXreg+3, F
002BC2 36??               M                 RLCF            TEMP, F
002BC4 5000               M                 MOVFP           DEXreg,WREG
002BC6 A0??               M                 BTFSS           CEXreg+1,LSB
002BC8 EF?? F???          M                 GOTO            NADD2217
002BCC 5E??               M                 SUBWF           EEXreg, F
002BCE 5000               M                 MOVFP           DEXreg+1,WREG
002BD0 5A??               M                 SUBWFB          EEXreg+1, F
002BD2 5000               M                 MOVFP           DEXreg+2,WREG
002BD4 5A??               M                 SUBWFB          EEXreg+2, F
002BD6 5000               M                 MOVFP           DEXreg+3,WREG
002BD8 5A??               M                 SUBWFB          EEXreg+3, F
002BDA 6AE8               M                 CLRF            WREG
002BDC 5A??               M                 SUBWFB          TEMP, F
002BDE EF?? F???          M                 GOTO            NOK2217
                          M 
002BE2 26??               M NADD2217        ADDWF           EEXreg, F
002BE4 5000               M                 MOVFP           DEXreg+1,WREG
002BE6 22??               M                 ADDWFC          EEXreg+1, F
002BE8 5000               M                 MOVFP           DEXreg+2,WREG
002BEA 22??               M                 ADDWFC          EEXreg+2, F
002BEC 5000               M                 MOVFP           DEXreg+3,WREG
002BEE 22??               M                 ADDWFC          EEXreg+3, F
002BF0 6AE8               M                 CLRF            WREG
002BF2 22??               M                 ADDWFC          TEMP, F
                          M         
002BF4 36??               M NOK2217         RLCF            CEXreg+1, F
                          M 
  0012                    M                 variable i=i+1
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 188


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M 
                          M 
002BF6 34??               M                 RLCF            CEXreg+1,W
002BF8 36??               M                 RLCF            EEXreg, F
002BFA 36??               M                 RLCF            EEXreg+1, F
002BFC 36??               M                 RLCF            EEXreg+2, F
002BFE 36??               M                 RLCF            EEXreg+3, F
002C00 36??               M                 RLCF            TEMP, F
002C02 5000               M                 MOVFP           DEXreg,WREG
002C04 A0??               M                 BTFSS           CEXreg+1,LSB
002C06 EF?? F???          M                 GOTO            NADD2218
002C0A 5E??               M                 SUBWF           EEXreg, F
002C0C 5000               M                 MOVFP           DEXreg+1,WREG
002C0E 5A??               M                 SUBWFB          EEXreg+1, F
002C10 5000               M                 MOVFP           DEXreg+2,WREG
002C12 5A??               M                 SUBWFB          EEXreg+2, F
002C14 5000               M                 MOVFP           DEXreg+3,WREG
002C16 5A??               M                 SUBWFB          EEXreg+3, F
002C18 6AE8               M                 CLRF            WREG
002C1A 5A??               M                 SUBWFB          TEMP, F
002C1C EF?? F???          M                 GOTO            NOK2218
                          M 
002C20 26??               M NADD2218        ADDWF           EEXreg, F
002C22 5000               M                 MOVFP           DEXreg+1,WREG
002C24 22??               M                 ADDWFC          EEXreg+1, F
002C26 5000               M                 MOVFP           DEXreg+2,WREG
002C28 22??               M                 ADDWFC          EEXreg+2, F
002C2A 5000               M                 MOVFP           DEXreg+3,WREG
002C2C 22??               M                 ADDWFC          EEXreg+3, F
002C2E 6AE8               M                 CLRF            WREG
002C30 22??               M                 ADDWFC          TEMP, F
                          M         
002C32 36??               M NOK2218         RLCF            CEXreg+1, F
                          M 
  0013                    M                 variable i=i+1
                          M 
                          M 
002C34 34??               M                 RLCF            CEXreg+1,W
002C36 36??               M                 RLCF            EEXreg, F
002C38 36??               M                 RLCF            EEXreg+1, F
002C3A 36??               M                 RLCF            EEXreg+2, F
002C3C 36??               M                 RLCF            EEXreg+3, F
002C3E 36??               M                 RLCF            TEMP, F
002C40 5000               M                 MOVFP           DEXreg,WREG
002C42 A0??               M                 BTFSS           CEXreg+1,LSB
002C44 EF?? F???          M                 GOTO            NADD2219
002C48 5E??               M                 SUBWF           EEXreg, F
002C4A 5000               M                 MOVFP           DEXreg+1,WREG
002C4C 5A??               M                 SUBWFB          EEXreg+1, F
002C4E 5000               M                 MOVFP           DEXreg+2,WREG
002C50 5A??               M                 SUBWFB          EEXreg+2, F
002C52 5000               M                 MOVFP           DEXreg+3,WREG
002C54 5A??               M                 SUBWFB          EEXreg+3, F
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 189


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

002C56 6AE8               M                 CLRF            WREG
002C58 5A??               M                 SUBWFB          TEMP, F
002C5A EF?? F???          M                 GOTO            NOK2219
                          M 
002C5E 26??               M NADD2219        ADDWF           EEXreg, F
002C60 5000               M                 MOVFP           DEXreg+1,WREG
002C62 22??               M                 ADDWFC          EEXreg+1, F
002C64 5000               M                 MOVFP           DEXreg+2,WREG
002C66 22??               M                 ADDWFC          EEXreg+2, F
002C68 5000               M                 MOVFP           DEXreg+3,WREG
002C6A 22??               M                 ADDWFC          EEXreg+3, F
002C6C 6AE8               M                 CLRF            WREG
002C6E 22??               M                 ADDWFC          TEMP, F
                          M         
002C70 36??               M NOK2219         RLCF            CEXreg+1, F
                          M 
  0014                    M                 variable i=i+1
                          M 
                          M 
002C72 34??               M                 RLCF            CEXreg+1,W
002C74 36??               M                 RLCF            EEXreg, F
002C76 36??               M                 RLCF            EEXreg+1, F
002C78 36??               M                 RLCF            EEXreg+2, F
002C7A 36??               M                 RLCF            EEXreg+3, F
002C7C 36??               M                 RLCF            TEMP, F
002C7E 5000               M                 MOVFP           DEXreg,WREG
002C80 A0??               M                 BTFSS           CEXreg+1,LSB
002C82 EF?? F???          M                 GOTO            NADD2220
002C86 5E??               M                 SUBWF           EEXreg, F
002C88 5000               M                 MOVFP           DEXreg+1,WREG
002C8A 5A??               M                 SUBWFB          EEXreg+1, F
002C8C 5000               M                 MOVFP           DEXreg+2,WREG
002C8E 5A??               M                 SUBWFB          EEXreg+2, F
002C90 5000               M                 MOVFP           DEXreg+3,WREG
002C92 5A??               M                 SUBWFB          EEXreg+3, F
002C94 6AE8               M                 CLRF            WREG
002C96 5A??               M                 SUBWFB          TEMP, F
002C98 EF?? F???          M                 GOTO            NOK2220
                          M 
002C9C 26??               M NADD2220        ADDWF           EEXreg, F
002C9E 5000               M                 MOVFP           DEXreg+1,WREG
002CA0 22??               M                 ADDWFC          EEXreg+1, F
002CA2 5000               M                 MOVFP           DEXreg+2,WREG
002CA4 22??               M                 ADDWFC          EEXreg+2, F
002CA6 5000               M                 MOVFP           DEXreg+3,WREG
002CA8 22??               M                 ADDWFC          EEXreg+3, F
002CAA 6AE8               M                 CLRF            WREG
002CAC 22??               M                 ADDWFC          TEMP, F
                          M         
002CAE 36??               M NOK2220         RLCF            CEXreg+1, F
                          M 
  0015                    M                 variable i=i+1
                          M 
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 190


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M 
002CB0 34??               M                 RLCF            CEXreg+1,W
002CB2 36??               M                 RLCF            EEXreg, F
002CB4 36??               M                 RLCF            EEXreg+1, F
002CB6 36??               M                 RLCF            EEXreg+2, F
002CB8 36??               M                 RLCF            EEXreg+3, F
002CBA 36??               M                 RLCF            TEMP, F
002CBC 5000               M                 MOVFP           DEXreg,WREG
002CBE A0??               M                 BTFSS           CEXreg+1,LSB
002CC0 EF?? F???          M                 GOTO            NADD2221
002CC4 5E??               M                 SUBWF           EEXreg, F
002CC6 5000               M                 MOVFP           DEXreg+1,WREG
002CC8 5A??               M                 SUBWFB          EEXreg+1, F
002CCA 5000               M                 MOVFP           DEXreg+2,WREG
002CCC 5A??               M                 SUBWFB          EEXreg+2, F
002CCE 5000               M                 MOVFP           DEXreg+3,WREG
002CD0 5A??               M                 SUBWFB          EEXreg+3, F
002CD2 6AE8               M                 CLRF            WREG
002CD4 5A??               M                 SUBWFB          TEMP, F
002CD6 EF?? F???          M                 GOTO            NOK2221
                          M 
002CDA 26??               M NADD2221        ADDWF           EEXreg, F
002CDC 5000               M                 MOVFP           DEXreg+1,WREG
002CDE 22??               M                 ADDWFC          EEXreg+1, F
002CE0 5000               M                 MOVFP           DEXreg+2,WREG
002CE2 22??               M                 ADDWFC          EEXreg+2, F
002CE4 5000               M                 MOVFP           DEXreg+3,WREG
002CE6 22??               M                 ADDWFC          EEXreg+3, F
002CE8 6AE8               M                 CLRF            WREG
002CEA 22??               M                 ADDWFC          TEMP, F
                          M         
002CEC 36??               M NOK2221         RLCF            CEXreg+1, F
                          M 
  0016                    M                 variable i=i+1
                          M 
                          M 
002CEE 34??               M                 RLCF            CEXreg+1,W
002CF0 36??               M                 RLCF            EEXreg, F
002CF2 36??               M                 RLCF            EEXreg+1, F
002CF4 36??               M                 RLCF            EEXreg+2, F
002CF6 36??               M                 RLCF            EEXreg+3, F
002CF8 36??               M                 RLCF            TEMP, F
002CFA 5000               M                 MOVFP           DEXreg,WREG
002CFC A0??               M                 BTFSS           CEXreg+1,LSB
002CFE EF?? F???          M                 GOTO            NADD2222
002D02 5E??               M                 SUBWF           EEXreg, F
002D04 5000               M                 MOVFP           DEXreg+1,WREG
002D06 5A??               M                 SUBWFB          EEXreg+1, F
002D08 5000               M                 MOVFP           DEXreg+2,WREG
002D0A 5A??               M                 SUBWFB          EEXreg+2, F
002D0C 5000               M                 MOVFP           DEXreg+3,WREG
002D0E 5A??               M                 SUBWFB          EEXreg+3, F
002D10 6AE8               M                 CLRF            WREG
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 191


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

002D12 5A??               M                 SUBWFB          TEMP, F
002D14 EF?? F???          M                 GOTO            NOK2222
                          M 
002D18 26??               M NADD2222        ADDWF           EEXreg, F
002D1A 5000               M                 MOVFP           DEXreg+1,WREG
002D1C 22??               M                 ADDWFC          EEXreg+1, F
002D1E 5000               M                 MOVFP           DEXreg+2,WREG
002D20 22??               M                 ADDWFC          EEXreg+2, F
002D22 5000               M                 MOVFP           DEXreg+3,WREG
002D24 22??               M                 ADDWFC          EEXreg+3, F
002D26 6AE8               M                 CLRF            WREG
002D28 22??               M                 ADDWFC          TEMP, F
                          M         
002D2A 36??               M NOK2222         RLCF            CEXreg+1, F
                          M 
  0017                    M                 variable i=i+1
                          M 
                          M 
002D2C 34??               M                 RLCF            CEXreg+1,W
002D2E 36??               M                 RLCF            EEXreg, F
002D30 36??               M                 RLCF            EEXreg+1, F
002D32 36??               M                 RLCF            EEXreg+2, F
002D34 36??               M                 RLCF            EEXreg+3, F
002D36 36??               M                 RLCF            TEMP, F
002D38 5000               M                 MOVFP           DEXreg,WREG
002D3A A0??               M                 BTFSS           CEXreg+1,LSB
002D3C EF?? F???          M                 GOTO            NADD2223
002D40 5E??               M                 SUBWF           EEXreg, F
002D42 5000               M                 MOVFP           DEXreg+1,WREG
002D44 5A??               M                 SUBWFB          EEXreg+1, F
002D46 5000               M                 MOVFP           DEXreg+2,WREG
002D48 5A??               M                 SUBWFB          EEXreg+2, F
002D4A 5000               M                 MOVFP           DEXreg+3,WREG
002D4C 5A??               M                 SUBWFB          EEXreg+3, F
002D4E 6AE8               M                 CLRF            WREG
002D50 5A??               M                 SUBWFB          TEMP, F
002D52 EF?? F???          M                 GOTO            NOK2223
                          M 
002D56 26??               M NADD2223        ADDWF           EEXreg, F
002D58 5000               M                 MOVFP           DEXreg+1,WREG
002D5A 22??               M                 ADDWFC          EEXreg+1, F
002D5C 5000               M                 MOVFP           DEXreg+2,WREG
002D5E 22??               M                 ADDWFC          EEXreg+2, F
002D60 5000               M                 MOVFP           DEXreg+3,WREG
002D62 22??               M                 ADDWFC          EEXreg+3, F
002D64 6AE8               M                 CLRF            WREG
002D66 22??               M                 ADDWFC          TEMP, F
                          M         
002D68 36??               M NOK2223         RLCF            CEXreg+1, F
                          M 
  0018                    M                 variable i=i+1
                          M 
                          M                 endw
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 192


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M 
002D6A 34??               M                 RLCF            CEXreg,W
002D6C 36??               M                 RLCF            EEXreg, F
002D6E 36??               M                 RLCF            EEXreg+1, F
002D70 36??               M                 RLCF            EEXreg+2, F
002D72 36??               M                 RLCF            EEXreg+3, F
002D74 36??               M                 RLCF            TEMP, F
002D76 5000               M                 MOVFP           DEXreg,WREG
002D78 A0??               M                 BTFSS           CEXreg+1,LSB
002D7A EF?? F???          M                 GOTO            NADD2224
002D7E 5E??               M                 SUBWF           EEXreg, F
002D80 5000               M                 MOVFP           DEXreg+1,WREG
002D82 5A??               M                 SUBWFB          EEXreg+1, F
002D84 5000               M                 MOVFP           DEXreg+2,WREG
002D86 5A??               M                 SUBWFB          EEXreg+2, F
002D88 5000               M                 MOVFP           DEXreg+3,WREG
002D8A 5A??               M                 SUBWFB          EEXreg+3, F
002D8C 6AE8               M                 CLRF            WREG
002D8E 5A??               M                 SUBWFB          TEMP, F
002D90 EF?? F???          M                 GOTO            NOK2224
                          M 
002D94 26??               M NADD2224        ADDWF           EEXreg, F
002D96 5000               M                 MOVFP           DEXreg+1,WREG
002D98 22??               M                 ADDWFC          EEXreg+1, F
002D9A 5000               M                 MOVFP           DEXreg+2,WREG
002D9C 22??               M                 ADDWFC          EEXreg+2, F
002D9E 5000               M                 MOVFP           DEXreg+3,WREG
002DA0 22??               M                 ADDWFC          EEXreg+3, F
002DA2 6AE8               M                 CLRF            WREG
002DA4 22??               M                 ADDWFC          TEMP, F
                          M         
002DA6 36??               M NOK2224         RLCF            CEXreg, F
                          M 
  0019                    M                 variable i = D'25'
                          M 
                          M                 while i < D'32'
                          M 
002DA8 34??               M                 RLCF            CEXreg,W
002DAA 36??               M                 RLCF            EEXreg, F
002DAC 36??               M                 RLCF            EEXreg+1, F
002DAE 36??               M                 RLCF            EEXreg+2, F
002DB0 36??               M                 RLCF            EEXreg+3, F
002DB2 36??               M                 RLCF            TEMP, F
002DB4 5000               M                 MOVFP           DEXreg,WREG
002DB6 A0??               M                 BTFSS           CEXreg,LSB
002DB8 EF?? F???          M                 GOTO            NADD2225
002DBC 5E??               M                 SUBWF           EEXreg, F
002DBE 5000               M                 MOVFP           DEXreg+1,WREG
002DC0 5A??               M                 SUBWFB          EEXreg+1, F
002DC2 5000               M                 MOVFP           DEXreg+2,WREG
002DC4 5A??               M                 SUBWFB          EEXreg+2, F
002DC6 5000               M                 MOVFP           DEXreg+3,WREG
002DC8 5A??               M                 SUBWFB          EEXreg+3, F
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 193


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

002DCA 6AE8               M                 CLRF            WREG
002DCC 5A??               M                 SUBWFB          TEMP, F
002DCE EF?? F???          M                 GOTO            NOK2225
                          M 
002DD2 26??               M NADD2225        ADDWF           EEXreg, F
002DD4 5000               M                 MOVFP           DEXreg+1,WREG
002DD6 22??               M                 ADDWFC          EEXreg+1, F
002DD8 5000               M                 MOVFP           DEXreg+2,WREG
002DDA 22??               M                 ADDWFC          EEXreg+2, F
002DDC 5000               M                 MOVFP           DEXreg+3,WREG
002DDE 22??               M                 ADDWFC          EEXreg+3, F
002DE0 6AE8               M                 CLRF            WREG
002DE2 22??               M                 ADDWFC          TEMP, F
                          M         
002DE4 36??               M NOK2225         RLCF            CEXreg, F
                          M 
  001A                    M                 variable i=i+1
                          M 
                          M 
002DE6 34??               M                 RLCF            CEXreg,W
002DE8 36??               M                 RLCF            EEXreg, F
002DEA 36??               M                 RLCF            EEXreg+1, F
002DEC 36??               M                 RLCF            EEXreg+2, F
002DEE 36??               M                 RLCF            EEXreg+3, F
002DF0 36??               M                 RLCF            TEMP, F
002DF2 5000               M                 MOVFP           DEXreg,WREG
002DF4 A0??               M                 BTFSS           CEXreg,LSB
002DF6 EF?? F???          M                 GOTO            NADD2226
002DFA 5E??               M                 SUBWF           EEXreg, F
002DFC 5000               M                 MOVFP           DEXreg+1,WREG
002DFE 5A??               M                 SUBWFB          EEXreg+1, F
002E00 5000               M                 MOVFP           DEXreg+2,WREG
002E02 5A??               M                 SUBWFB          EEXreg+2, F
002E04 5000               M                 MOVFP           DEXreg+3,WREG
002E06 5A??               M                 SUBWFB          EEXreg+3, F
002E08 6AE8               M                 CLRF            WREG
002E0A 5A??               M                 SUBWFB          TEMP, F
002E0C EF?? F???          M                 GOTO            NOK2226
                          M 
002E10 26??               M NADD2226        ADDWF           EEXreg, F
002E12 5000               M                 MOVFP           DEXreg+1,WREG
002E14 22??               M                 ADDWFC          EEXreg+1, F
002E16 5000               M                 MOVFP           DEXreg+2,WREG
002E18 22??               M                 ADDWFC          EEXreg+2, F
002E1A 5000               M                 MOVFP           DEXreg+3,WREG
002E1C 22??               M                 ADDWFC          EEXreg+3, F
002E1E 6AE8               M                 CLRF            WREG
002E20 22??               M                 ADDWFC          TEMP, F
                          M         
002E22 36??               M NOK2226         RLCF            CEXreg, F
                          M 
  001B                    M                 variable i=i+1
                          M 
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 194


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M 
002E24 34??               M                 RLCF            CEXreg,W
002E26 36??               M                 RLCF            EEXreg, F
002E28 36??               M                 RLCF            EEXreg+1, F
002E2A 36??               M                 RLCF            EEXreg+2, F
002E2C 36??               M                 RLCF            EEXreg+3, F
002E2E 36??               M                 RLCF            TEMP, F
002E30 5000               M                 MOVFP           DEXreg,WREG
002E32 A0??               M                 BTFSS           CEXreg,LSB
002E34 EF?? F???          M                 GOTO            NADD2227
002E38 5E??               M                 SUBWF           EEXreg, F
002E3A 5000               M                 MOVFP           DEXreg+1,WREG
002E3C 5A??               M                 SUBWFB          EEXreg+1, F
002E3E 5000               M                 MOVFP           DEXreg+2,WREG
002E40 5A??               M                 SUBWFB          EEXreg+2, F
002E42 5000               M                 MOVFP           DEXreg+3,WREG
002E44 5A??               M                 SUBWFB          EEXreg+3, F
002E46 6AE8               M                 CLRF            WREG
002E48 5A??               M                 SUBWFB          TEMP, F
002E4A EF?? F???          M                 GOTO            NOK2227
                          M 
002E4E 26??               M NADD2227        ADDWF           EEXreg, F
002E50 5000               M                 MOVFP           DEXreg+1,WREG
002E52 22??               M                 ADDWFC          EEXreg+1, F
002E54 5000               M                 MOVFP           DEXreg+2,WREG
002E56 22??               M                 ADDWFC          EEXreg+2, F
002E58 5000               M                 MOVFP           DEXreg+3,WREG
002E5A 22??               M                 ADDWFC          EEXreg+3, F
002E5C 6AE8               M                 CLRF            WREG
002E5E 22??               M                 ADDWFC          TEMP, F
                          M         
002E60 36??               M NOK2227         RLCF            CEXreg, F
                          M 
  001C                    M                 variable i=i+1
                          M 
                          M 
002E62 34??               M                 RLCF            CEXreg,W
002E64 36??               M                 RLCF            EEXreg, F
002E66 36??               M                 RLCF            EEXreg+1, F
002E68 36??               M                 RLCF            EEXreg+2, F
002E6A 36??               M                 RLCF            EEXreg+3, F
002E6C 36??               M                 RLCF            TEMP, F
002E6E 5000               M                 MOVFP           DEXreg,WREG
002E70 A0??               M                 BTFSS           CEXreg,LSB
002E72 EF?? F???          M                 GOTO            NADD2228
002E76 5E??               M                 SUBWF           EEXreg, F
002E78 5000               M                 MOVFP           DEXreg+1,WREG
002E7A 5A??               M                 SUBWFB          EEXreg+1, F
002E7C 5000               M                 MOVFP           DEXreg+2,WREG
002E7E 5A??               M                 SUBWFB          EEXreg+2, F
002E80 5000               M                 MOVFP           DEXreg+3,WREG
002E82 5A??               M                 SUBWFB          EEXreg+3, F
002E84 6AE8               M                 CLRF            WREG
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 195


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

002E86 5A??               M                 SUBWFB          TEMP, F
002E88 EF?? F???          M                 GOTO            NOK2228
                          M 
002E8C 26??               M NADD2228        ADDWF           EEXreg, F
002E8E 5000               M                 MOVFP           DEXreg+1,WREG
002E90 22??               M                 ADDWFC          EEXreg+1, F
002E92 5000               M                 MOVFP           DEXreg+2,WREG
002E94 22??               M                 ADDWFC          EEXreg+2, F
002E96 5000               M                 MOVFP           DEXreg+3,WREG
002E98 22??               M                 ADDWFC          EEXreg+3, F
002E9A 6AE8               M                 CLRF            WREG
002E9C 22??               M                 ADDWFC          TEMP, F
                          M         
002E9E 36??               M NOK2228         RLCF            CEXreg, F
                          M 
  001D                    M                 variable i=i+1
                          M 
                          M 
002EA0 34??               M                 RLCF            CEXreg,W
002EA2 36??               M                 RLCF            EEXreg, F
002EA4 36??               M                 RLCF            EEXreg+1, F
002EA6 36??               M                 RLCF            EEXreg+2, F
002EA8 36??               M                 RLCF            EEXreg+3, F
002EAA 36??               M                 RLCF            TEMP, F
002EAC 5000               M                 MOVFP           DEXreg,WREG
002EAE A0??               M                 BTFSS           CEXreg,LSB
002EB0 EF?? F???          M                 GOTO            NADD2229
002EB4 5E??               M                 SUBWF           EEXreg, F
002EB6 5000               M                 MOVFP           DEXreg+1,WREG
002EB8 5A??               M                 SUBWFB          EEXreg+1, F
002EBA 5000               M                 MOVFP           DEXreg+2,WREG
002EBC 5A??               M                 SUBWFB          EEXreg+2, F
002EBE 5000               M                 MOVFP           DEXreg+3,WREG
002EC0 5A??               M                 SUBWFB          EEXreg+3, F
002EC2 6AE8               M                 CLRF            WREG
002EC4 5A??               M                 SUBWFB          TEMP, F
002EC6 EF?? F???          M                 GOTO            NOK2229
                          M 
002ECA 26??               M NADD2229        ADDWF           EEXreg, F
002ECC 5000               M                 MOVFP           DEXreg+1,WREG
002ECE 22??               M                 ADDWFC          EEXreg+1, F
002ED0 5000               M                 MOVFP           DEXreg+2,WREG
002ED2 22??               M                 ADDWFC          EEXreg+2, F
002ED4 5000               M                 MOVFP           DEXreg+3,WREG
002ED6 22??               M                 ADDWFC          EEXreg+3, F
002ED8 6AE8               M                 CLRF            WREG
002EDA 22??               M                 ADDWFC          TEMP, F
                          M         
002EDC 36??               M NOK2229         RLCF            CEXreg, F
                          M 
  001E                    M                 variable i=i+1
                          M 
                          M 
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 196


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

002EDE 34??               M                 RLCF            CEXreg,W
002EE0 36??               M                 RLCF            EEXreg, F
002EE2 36??               M                 RLCF            EEXreg+1, F
002EE4 36??               M                 RLCF            EEXreg+2, F
002EE6 36??               M                 RLCF            EEXreg+3, F
002EE8 36??               M                 RLCF            TEMP, F
002EEA 5000               M                 MOVFP           DEXreg,WREG
002EEC A0??               M                 BTFSS           CEXreg,LSB
002EEE EF?? F???          M                 GOTO            NADD2230
002EF2 5E??               M                 SUBWF           EEXreg, F
002EF4 5000               M                 MOVFP           DEXreg+1,WREG
002EF6 5A??               M                 SUBWFB          EEXreg+1, F
002EF8 5000               M                 MOVFP           DEXreg+2,WREG
002EFA 5A??               M                 SUBWFB          EEXreg+2, F
002EFC 5000               M                 MOVFP           DEXreg+3,WREG
002EFE 5A??               M                 SUBWFB          EEXreg+3, F
002F00 6AE8               M                 CLRF            WREG
002F02 5A??               M                 SUBWFB          TEMP, F
002F04 EF?? F???          M                 GOTO            NOK2230
                          M 
002F08 26??               M NADD2230        ADDWF           EEXreg, F
002F0A 5000               M                 MOVFP           DEXreg+1,WREG
002F0C 22??               M                 ADDWFC          EEXreg+1, F
002F0E 5000               M                 MOVFP           DEXreg+2,WREG
002F10 22??               M                 ADDWFC          EEXreg+2, F
002F12 5000               M                 MOVFP           DEXreg+3,WREG
002F14 22??               M                 ADDWFC          EEXreg+3, F
002F16 6AE8               M                 CLRF            WREG
002F18 22??               M                 ADDWFC          TEMP, F
                          M         
002F1A 36??               M NOK2230         RLCF            CEXreg, F
                          M 
  001F                    M                 variable i=i+1
                          M 
                          M 
002F1C 34??               M                 RLCF            CEXreg,W
002F1E 36??               M                 RLCF            EEXreg, F
002F20 36??               M                 RLCF            EEXreg+1, F
002F22 36??               M                 RLCF            EEXreg+2, F
002F24 36??               M                 RLCF            EEXreg+3, F
002F26 36??               M                 RLCF            TEMP, F
002F28 5000               M                 MOVFP           DEXreg,WREG
002F2A A0??               M                 BTFSS           CEXreg,LSB
002F2C EF?? F???          M                 GOTO            NADD2231
002F30 5E??               M                 SUBWF           EEXreg, F
002F32 5000               M                 MOVFP           DEXreg+1,WREG
002F34 5A??               M                 SUBWFB          EEXreg+1, F
002F36 5000               M                 MOVFP           DEXreg+2,WREG
002F38 5A??               M                 SUBWFB          EEXreg+2, F
002F3A 5000               M                 MOVFP           DEXreg+3,WREG
002F3C 5A??               M                 SUBWFB          EEXreg+3, F
002F3E 6AE8               M                 CLRF            WREG
002F40 5A??               M                 SUBWFB          TEMP, F
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 197


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

002F42 EF?? F???          M                 GOTO            NOK2231
                          M 
002F46 26??               M NADD2231        ADDWF           EEXreg, F
002F48 5000               M                 MOVFP           DEXreg+1,WREG
002F4A 22??               M                 ADDWFC          EEXreg+1, F
002F4C 5000               M                 MOVFP           DEXreg+2,WREG
002F4E 22??               M                 ADDWFC          EEXreg+2, F
002F50 5000               M                 MOVFP           DEXreg+3,WREG
002F52 22??               M                 ADDWFC          EEXreg+3, F
002F54 6AE8               M                 CLRF            WREG
002F56 22??               M                 ADDWFC          TEMP, F
                          M         
002F58 36??               M NOK2231         RLCF            CEXreg, F
                          M 
  0020                    M                 variable i=i+1
                          M 
                          M                 endw
                          M 
002F5A B0??               M                 BTFSC           CEXreg,LSB
002F5C EF?? F???          M                 GOTO            NOK22
002F60 5000               M                 MOVFP           DEXreg,WREG
002F62 26??               M                 ADDWF           EEXreg, F
002F64 5000               M                 MOVFP           DEXreg+1,WREG
002F66 22??               M                 ADDWFC          EEXreg+1, F
002F68 5000               M                 MOVFP           DEXreg+2,WREG
002F6A 22??               M                 ADDWFC          EEXreg+2, F
002F6C 5000               M                 MOVFP           DEXreg+3,WREG
002F6E 22??               M                 ADDWFC          EEXreg+3, F
                          M 
002F70                    M NOK22
                      00332 
002F70 0C00           00333                 RETLW           0x00
                      02810                 Include <Monitor.asm>
                      00001 ;
                      00002 ; Monitor.asm
                      00003 ;
                      00004 ; This function allows the pilot to display the channel position information on the LCD
                      00005 ; screen using the digitial trim bar graph display. This is designed to aid the pilot in
                      00006 ; setup and testing of the transmitter. To enable this mode of operation the pilot must
                      00007 ; hold down the option key when power is applied and then release the key a few seconds 
                      00008 ; after power up. When in the mode the option key will advance from channel to channel.
                      00009 ; The only way to exit this mode of operation is to cycle power on the transmitter.
                      00010 ;
                      00011 ; AutoTrimMonitor allows the pilot to monitor the status of the three autotrim positions.
                      00012 ; This data is displayed in percentage. The pilot holds down the Auto Trim button on power
                      00013 ; up to enable this display mode. Pressing the option button will advance the display from
                      00014 ; channel to channel. 
                      00015 ;
                      00016 ; Gordon Anderson
                      00017 ; 25 December 2008
                      00018 ; 12 June 2011
                      00019 ;
                      00020 
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 198


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00021 
                      00022 ;================================================================================
                      00023 ;
                      00024 ; Display headers for each channel
                      00025 ;
                      00026 ;================================================================================
002F72 204C 4120 6C69 00027 AilMes          DB      "L  Ail  xxx%   R"
       2020 7878 2578 
       2020 5220 
002F82 2055 4520 656C 00028 EleMes          DB      "U  Ele  xxx%   D"
       2020 7878 2578 
       2020 4420 
002F92 204C 5220 6475 00029 RudMes          DB      "L  Rud  xxx%   R"
       2020 7878 2578 
       2020 5220 
002FA2 204C 5420 7468 00030 ThtMes          DB      "L  Tht  xxx%   H"
       2020 7878 2578 
       2020 4820 
002FB2 2041 4320 3548 00031 CH5Mes          DB      "A  CH5  xxx%   B"
       2020 7878 2578 
       2020 4220 
002FC2 2055 4320 3648 00032 CH6Mes          DB      "U  CH6  xxx%   D"
       2020 7878 2578 
       2020 4420 
002FD2 2055 4320 3748 00033 CH7Mes          DB      "U  CH7  xxx%   D"
       2020 7878 2578 
       2020 4420 
002FE2 2043 4320 3848 00034 CH8Mes          DB      "C  CH8  xxx%   A"
       2020 7878 2578 
       2020 4120 
                      00035 ; Now display the servo output pulse width data for each channel
002FF2 6C45 7665 7461 00036 SV1Mes          DB      "Elevator        "
       726F 2020 2020 
       2020 2020 
003002 6941 656C 6F72 00037 SV2Mes          DB      "Aileron         "
       206E 2020 2020 
       2020 2020 
003012 7552 6464 7265 00038 SV3Mes          DB      "Rudder          "
       2020 2020 2020 
       2020 2020 
003022 6854 6F72 7474 00039 SV4Mes          DB      "Throttle        "
       656C 2020 2020 
       2020 2020 
003032 4843 2035 2020 00040 SV5Mes          DB      "CH5             "
       2020 2020 2020 
       2020 2020 
003042 4843 2036 2020 00041 SV6Mes          DB      "CH6             "
       2020 2020 2020 
       2020 2020 
003052 4843 2037 2020 00042 SV7Mes          DB      "CH7             "
       2020 2020 2020 
       2020 2020 
003062 4843 2038 2020 00043 SV8Mes          DB      "CH8             "
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 199


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

       2020 2020 2020 
       2020 2020 
                      00044 
                      00045 ; This function performes the channel and servo output position display.
003072                00046 Monitor
                      00047         SingleLine
                      00048    ; It is assumed that the enable flag is tested before this call.
                      00049    ; First build a pointer to the display header
                      00050         MOVEC   AilMes,AXreg
003072 01??               M                 MOVLR   HIGH (AXreg)
003074 0E??               M                 MOVLW   LOW (AilMes)
003076 6E??               M                 MOVWF   (AXreg)
003078 0E??               M                 MOVLW   HIGH (AilMes)
00307A 6E??               M                 MOVWF   (AXreg+1)
00307C C??? FFE8      00051         MOVFF   MonChan,WREG
003080 3AE8           00052         SWAPF   WREG                    ; This will multiply by 16 and make index into an offset
003082 01??           00053         MOVLB   HIGH AXreg
003084 26??           00054         ADDWF   AXreg,F
003086 B0D8           00055         BTFSC   ALUSTA,C
003088 2A??           00056         INCF    AXreg+1
                      00057         ; Now print the first line of the display
00308A EC?? F???      00058         CALL    LCDsendAX
                      00059    ; Output pulse width data if selected channel is over 7
00308E EC?? F???      00060         CALL    MonitorPulseWidth
003092 B0D8           00061         BTFSC   ALUSTA,C
003094 EF?? F???      00062         GOTO    Mon2
                      00063    ; Load the selected channel into AXreg
                      00064         MOVEC   Apos,FSR1L
003098 010F               M                 MOVLR   HIGH (FSR1L)
00309A 0E??               M                 MOVLW   LOW (Apos)
00309C 6EE1               M                 MOVWF   (FSR1L)
00309E 0E??               M                 MOVLW   HIGH (Apos)
0030A0 6EE2               M                 MOVWF   (FSR1L+1)
0030A2 C??? FFE8      00065         MOVFF   MonChan,WREG
0030A6 0B07           00066         ANDLW   07                      ; Only channels 0 - 7 are valid
0030A8 46E8           00067         RLNCF   WREG                    ; Make into word pointer
0030AA 26E1           00068         ADDWF   FSR1L,F,A
0030AC B0D8           00069         BTFSC   ALUSTA,C
0030AE 2AE2           00070         INCF    FSR1H,F,A       
0030B0 50E6           00071         MOVF    POSTINC1,W              ; Load value into AXreg
0030B2 CFE8 F???      00072         MOVFF   WREG,AXreg
0030B6 50E6           00073         MOVF    POSTINC1,W
0030B8 CFE8 F???      00074         MOVFF   WREG,AXreg+1
                      00075    ; Divide the normalized position by 10 to make it into a percentage, then display
                      00076    ; in on the first line of the display
                      00077         MOVE    AXreg,CEXreg
0030BC C??? F???          M                 MOVFF   AXreg,CEXreg
0030C0 C??? F???          M                 MOVFF   (AXreg+1),(CEXreg+1)
0030C4 0E0A           00078         MOVLW   D'10'
0030C6 6E??           00079         MOVWF   DEXreg
0030C8 EC?? F???      00080         CALL    Divide168
                      00081         ; CEX now contains the percentage, now display it
0030CC 0E87           00082         MOVLW   LINE1 + D'7'
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 200


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

0030CE EC?? F???      00083         CALL    LCDsendCMD      
0030D2 EC?? F???      00084         CALL    LCDsign
0030D6 EC?? F???      00085         CALL    LCDint3
                      00086    ; If this is the throttle channel then use the paint bar function because the
                      00087    ; throottle channel range is 0 to 1000
0030DA CFE1 FFE8      00088         MOVFF   FSR1L,WREG
0030DE 0A??           00089         XORLW   LOW (Tpos + 2)
0030E0 A4D8           00090         BTFSS   ALUSTA,Z
0030E2 EF?? F???      00091         GOTO    Mon1
0030E6 EC?? F???      00092         CALL    PaintBar
0030EA EF?? F???      00093         GOTO    Mon2
                      00094    ; Paint the trim position on second line
0030EE EC?? F???      00095 Mon1    CALL    PaintRightBar
0030F2 EC?? F???      00096         CALL    PaintLeftBar
                      00097    ; If the option button is pressed then advance the Moniton Channel value
0030F6 EC?? F???      00098 Mon2    CALL    Option
0030FA 01??           00099         MOVLR   HIGH MonChan
0030FC B0D8           00100         BTFSC   ALUSTA,C
0030FE 2A??           00101         INCF    MonChan
003100 0E0F           00102         MOVLW   0F
003102 16??           00103         ANDWF   MonChan,F
                      00104         DualLine
003104 0012           00105         RETURN
                      00106 
                      00107 ; In this mode I use the top display line to show the channel name and servo position 
                      00108 ; pulse width. Use the second line as a bar graph position indicator
                      00109 ; with min and max servo positions defining the range of the bar graph.
003106                00110 MonitorPulseWidth
                      00111    ; Exit if the channel number if under 8
003106 90D8           00112         BCF     ALUSTA,C
003108 C??? FFE8      00113         MOVFF   MonChan,WREG
00310C A6E8           00114         BTFSS   WREG,3
00310E 0012           00115         RETURN
                      00116    ; Build index into the pulse width data
                      00117         MOVEC   chELE,FSR1L
003110 010F               M                 MOVLR   HIGH (FSR1L)
003112 0E??               M                 MOVLW   LOW (chELE)
003114 6EE1               M                 MOVWF   (FSR1L)
003116 0E??               M                 MOVLW   HIGH (chELE)
003118 6EE2               M                 MOVWF   (FSR1L+1)
00311A C??? FFE8      00118         MOVFF   MonChan,WREG
00311E 0B07           00119         ANDLW   07                      ; Only channels 0 - 7 are valid
003120 46E8           00120         RLNCF   WREG                    ; Make into word pointer
003122 26E1           00121         ADDWF   FSR1L,F,A
003124 B0D8           00122         BTFSC   ALUSTA,C
003126 2AE2           00123         INCF    FSR1H,F,A       
003128 50E6           00124         MOVF    POSTINC1,W              ; Load value into CEXreg
00312A CFE8 F???      00125         MOVFF   WREG,CEXreg
00312E 50E5           00126         MOVF    POSTDEC1,W
003130 CFE8 F???      00127         MOVFF   WREG,CEXreg+1
                      00128    ; Display the value on the top line of the display
003134 0E89           00129         MOVLW   LINE1+LCDRIGHT + D'1'
003136 EC?? F???      00130         CALL    LCDsendCMD
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 201


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

00313A EC?? F???      00131         CALL    LCDmSfix   
                      00132    ; Display a bar graph on the second line of the display
00313E 50E6           00133         MOVF    POSTINC1,W              ; Load value into AXreg
003140 CFE8 F???      00134         MOVFF   WREG,AXreg
003144 50E5           00135         MOVF    POSTDEC1,W              ; Load value into AXreg
003146 CFE8 F???      00136         MOVFF   WREG,AXreg+1
00314A EC?? F???      00137         CALL    DisplayServoMS
00314E 80D8           00138         BSF     ALUSTA,C
003150 0012           00139         RETURN
                      00140 
                      00141 ; This function display a bar graph on the second line of the display.
                      00142 ; The value to be displayed is in AXreg and its a servo position in
                      00143 ; .5 uS units. The display range is defined by the servo min and max values.
                      00144 ; The following equation is used to put the data into a 0 to 1000 range
                      00145 ; for display.
                      00146 ;
                      00147 ; DisplayValue = (ServoPos - ServoMin) * 1000 / (ServoMax - ServoMin)
                      00148 ; 
                      00149 ; Called with ServoPos in reg AXreg
                      00150 ;
003152                00151 DisplayServoMS
                      00152    ; AXreg = ServoPos - ServoMin
003152 01??           00153         MOVLB   HIGH AXreg
003154 C??? FFE8      00154         MOVFF   ServoMin,WREG
003158 5E??           00155         SUBWF   AXreg,F
00315A C??? FFE8      00156         MOVFF   ServoMin+1,WREG
00315E 5A??           00157         SUBWFB  AXreg+1,F
                      00158    ; Multiply by 1000
                      00159         MOVEC   D'1000',BXreg
003160 01??               M                 MOVLR   HIGH (BXreg)
003162 0EE8               M                 MOVLW   LOW (D'1000')
003164 6E??               M                 MOVWF   (BXreg)
003166 0E03               M                 MOVLW   HIGH (D'1000')
003168 6E??               M                 MOVWF   (BXreg+1)
00316A EC?? F???      00160         CALL    Mult1616
                      00161    ; DEXreg = ServoMax - ServoMin
                      00162         MOVE    ServoMax,DEXreg
00316E C??? F???          M                 MOVFF   ServoMax,DEXreg
003172 C??? F???          M                 MOVFF   (ServoMax+1),(DEXreg+1)
003176 01??           00163         MOVLB   HIGH DEXreg
003178 C??? FFE8      00164         MOVFF   ServoMin,WREG
00317C 5E??           00165         SUBWF   DEXreg,F
00317E C??? FFE8      00166         MOVFF   ServoMin+1,WREG
003182 5A??           00167         SUBWFB  DEXreg+1,F
                      00168    ; Result in CEXreg
003184 EC?? F???      00169         CALL    Divide2416
                      00170    ; Now display this bar on the second line of the display
003188 0EC0           00171         MOVLW   LINE2
00318A EC?? F???      00172         CALL    LCDsendCMD
                      00173         MOVE    CEXreg,AXreg
00318E C??? F???          M                 MOVFF   CEXreg,AXreg
003192 C??? F???          M                 MOVFF   (CEXreg+1),(AXreg+1)
003196 EC?? F???      00174         CALL    PaintBar        
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 202


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

00319A 0012           00175         RETURN
                      00176 
                      00177 ; This is an optional entry point into the LCDmS function, this entry point will
                      00178 ; divide the value by 2 before its displayed, this is to correct for the fact that
                      00179 ; the times are saved in 0.5 uS units
00319C                00180 LCDmSfix
                      00181         ; Divide by two
00319C 01??           00182         MOVLB   HIGH CEXreg
00319E 90D8           00183         BCF     ALUSTA,C
0031A0 32??           00184         RRCF    CEXreg+1
0031A2 32??           00185         RRCF    CEXreg
0031A4 6A??           00186         CLRF    CEXreg+2
0031A6 6A??           00187         CLRF    CEXreg+3
                      00188 ; This function prints the value in CEXreg to the LCD display at the current
                      00189 ; character position.
0031A8                00190 LCDmS
                      00191 ; Convert to string
0031A8 EC?? F???      00192         CALL    Int2Str
                      00193 ; Position the print position and print...
                      00194         CALLFF  LCDsendData,Buffer+1
0031AC 5000               M                 MOVFP   (Buffer+1),WREG
0031AE EC?? F???          M                 CALL    (LCDsendData)
                      00195         CALLFL  LCDsendData,'.'
0031B2 0E2E               M                 MOVLW   ('.')
0031B4 EC?? F???          M                 CALL    (LCDsendData)
                      00196         CALLFF  LCDsendData,Buffer+2
0031B8 5000               M                 MOVFP   (Buffer+2),WREG
0031BA EC?? F???          M                 CALL    (LCDsendData)
                      00197         CALLFF  LCDsendData,Buffer+3
0031BE 5000               M                 MOVFP   (Buffer+3),WREG
0031C0 EC?? F???          M                 CALL    (LCDsendData)
                      00198         CALLFF  LCDsendData,Buffer+4
0031C4 5000               M                 MOVFP   (Buffer+4),WREG
0031C6 EC?? F???          M                 CALL    (LCDsendData)
                      00199         CALLFL  LCDsendData,'m'
0031CA 0E6D               M                 MOVLW   ('m')
0031CC EC?? F???          M                 CALL    (LCDsendData)
                      00200         CALLFL  LCDsendData,'S'
0031D0 0E53               M                 MOVLW   ('S')
0031D2 EC?? F???          M                 CALL    (LCDsendData)
0031D6 0012           00201         RETURN
                      00202 
                      00203 ; This function is used to display the Auto Trim position data.
0031D8                00204 AutoTrimMonitor
                      00205         SingleLine
                      00206    ; It is assumed that the enable flag is tested before this call.
                      00207    ; First build a pointer to the display header
                      00208         MOVEC   AilMes,AXreg
0031D8 01??               M                 MOVLR   HIGH (AXreg)
0031DA 0E??               M                 MOVLW   LOW (AilMes)
0031DC 6E??               M                 MOVWF   (AXreg)
0031DE 0E??               M                 MOVLW   HIGH (AilMes)
0031E0 6E??               M                 MOVWF   (AXreg+1)
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 203


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

0031E2 C??? FFE8      00209         MOVFF   MonChan,WREG
0031E6 3AE8           00210         SWAPF   WREG                    ; This will multiply by 16 and make index into an offset
0031E8 01??           00211         MOVLB   HIGH AXreg
0031EA 26??           00212         ADDWF   AXreg,F
0031EC B0D8           00213         BTFSC   ALUSTA,C
0031EE 2A??           00214         INCF    AXreg+1
                      00215         ; Now print the first line of the display
0031F0 EC?? F???      00216         CALL    LCDsendAX
                      00217    ; Load the selected channel into AXreg
0031F4 01??           00218         MOVLR   HIGH MonChan
0031F6 6AE8           00219         CLRF    WREG
0031F8 CFE8 F???      00220         MOVFF   WREG,AXreg+1
0031FC 60??           00221         CPFSLT  MonChan
0031FE C??? F???      00222         MOVFF   AAT,AXreg
003202 2AE8           00223         INCF    WREG
003204 60??           00224         CPFSLT  MonChan
003206 C??? F???      00225         MOVFF   EAT,AXreg
00320A 2AE8           00226         INCF    WREG
00320C 60??           00227         CPFSLT  MonChan
00320E C??? F???      00228         MOVFF   RAT,AXreg
                      00229         ; Extend the sign
003212 01??           00230         MOVLR   HIGH AXreg
003214 BE??           00231         BTFSC   AXreg,7
003216 68??           00232         SETF    AXreg+1
                      00233    ; Display in on the first line of the display
                      00234         MOVE    AXreg,CEXreg
003218 C??? F???          M                 MOVFF   AXreg,CEXreg
00321C C??? F???          M                 MOVFF   (AXreg+1),(CEXreg+1)
                      00235         ; CEX now contains the percentage, now display it
003220 0E87           00236         MOVLW   LINE1 + D'7'
003222 EC?? F???      00237         CALL    LCDsendCMD      
003226 EC?? F???      00238         CALL    LCDsign
00322A EC?? F???      00239         CALL    LCDint3
                      00240    ; Multiply the percentage in the AXreg by 10 for the bar graph display
                      00241         MOVEC   D'10',BXreg
00322E 01??               M                 MOVLR   HIGH (BXreg)
003230 0E0A               M                 MOVLW   LOW (D'10')
003232 6E??               M                 MOVWF   (BXreg)
003234 0E00               M                 MOVLW   HIGH (D'10')
003236 6E??               M                 MOVWF   (BXreg+1)
003238 EC?? F???      00242         CALL    Mult1616
                      00243         MOVE    CEXreg,AXreg
00323C C??? F???          M                 MOVFF   CEXreg,AXreg
003240 C??? F???          M                 MOVFF   (CEXreg+1),(AXreg+1)
                      00244    ; Paint the trim position on second line
003244 EC?? F???      00245         CALL    PaintRightBar
003248 EC?? F???      00246         CALL    PaintLeftBar
                      00247    ; If the option button is pressed then advance the Auto Trim Channel number
00324C EC?? F???      00248         CALL    Option
003250 01??           00249         MOVLR   HIGH MonChan
003252 B0D8           00250         BTFSC   ALUSTA,C
003254 2A??           00251         INCF    MonChan
003256 0E03           00252         MOVLW   03
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 204


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

003258 60??           00253         CPFSLT  MonChan
00325A 6A??           00254         CLRF    MonChan
                      00255         DualLine
00325C 0012           00256         RETURN
                      02811 
                      02812 ; This function is called in the run mode. When the Auto Trim and and Preset buttons
                      02813 ; are held down the throttle low point adjustment mode is entered. In this mode the
                      02814 ; elevator stick will adjust the throttle low value as long as the buttons are held.
                      02815 ; This function is called after the stick positions are read and normalized.
                      02816 ; Returns:
                      02817 ;       Z flag clear if not selected
                      02818 ;       Z flag set if mode is selected
00325E                02819 ThrottleTrim
                      02820         ; Test the buttons
                      02821                 Pressed PORTD,PRESET
                          M                 State   PORTD,PRESET
00325E 010F               M                 MOVLB   HIGH PORTD
003260 90D8               M                 BCF     ALUSTA,C
003262 B683               M                 BTFSC   PORTD,PRESET
003264 80D8               M                 BSF     ALUSTA,C
003266 B0D8               M                 BTFSC   ALUSTA,C
003268 EF?? F???          M                 GOTO    $ + D'14'
00326C 0E0A               M                 MOVLW   D'10'
00326E EC?? F???          M                 CALL    Delay1mS
                          M                 State   PORTD,PRESET
003272 010F               M                 MOVLB   HIGH PORTD
003274 90D8               M                 BCF     ALUSTA,C
003276 B683               M                 BTFSC   PORTD,PRESET
003278 80D8               M                 BSF     ALUSTA,C
00327A B0D8           02822                 BTFSC   ALUSTA,C
00327C EF?? F???      02823                 GOTO    TTexit
                      02824                 Pressed PORTE,AUTOT
                          M                 State   PORTE,AUTOT
003280 010F               M                 MOVLB   HIGH PORTE
003282 90D8               M                 BCF     ALUSTA,C
003284 B284               M                 BTFSC   PORTE,AUTOT
003286 80D8               M                 BSF     ALUSTA,C
003288 B0D8               M                 BTFSC   ALUSTA,C
00328A EF?? F???          M                 GOTO    $ + D'14'
00328E 0E0A               M                 MOVLW   D'10'
003290 EC?? F???          M                 CALL    Delay1mS
                          M                 State   PORTE,AUTOT
003294 010F               M                 MOVLB   HIGH PORTE
003296 90D8               M                 BCF     ALUSTA,C
003298 B284               M                 BTFSC   PORTE,AUTOT
00329A 80D8               M                 BSF     ALUSTA,C
00329C B0D8           02825                 BTFSC   ALUSTA,C
00329E EF?? F???      02826                 GOTO    TTexit
                      02827         ; Here if the two buttons are pressed
                      02828                 ; If the throttle trim flag is not set then init the variables needed
                      02829                 ; and set the TTflag
0032A2 01??           02830                 MOVLR   HIGH TTflag
0032A4 66??           02831                 TSTFSZ  TTflag
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 205


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

0032A6 EF?? F???      02832                 GOTO    TTinited
                      02833         ; Here to set the flag and init the variables
0032AA 01??           02834                 MOVLR   HIGH TTflag
0032AC 68??           02835                 SETF    TTflag          
                      02836                 ; Convert throttle gains to uS
0032AE 01??           02837                 MOVLR   HIGH TBH
                      02838                 MOVE    TMH,AXreg
0032B0 C??? F???          M                 MOVFF   TMH,AXreg
0032B4 C??? F???          M                 MOVFF   (TMH+1),(AXreg+1)
                      02839                 MOVEC   D'1000',BXreg
0032B8 01??               M                 MOVLR   HIGH (BXreg)
0032BA 0EE8               M                 MOVLW   LOW (D'1000')
0032BC 6E??               M                 MOVWF   (BXreg)
0032BE 0E03               M                 MOVLW   HIGH (D'1000')
0032C0 6E??               M                 MOVWF   (BXreg+1)
0032C2 EC?? F???      02840                 CALL    Mult1616
0032C6 C??? F???      02841                 MOVFF   CEXreg+1,TTMH
0032CA C??? F???      02842                 MOVFF   CEXreg+2,TTMH+1
0032CE 01??           02843                 MOVLR   HIGH TBH
0032D0 5000           02844                 MOVFP   TBH,WREG
0032D2 01??           02845                 MOVLR   HIGH TTMH
0032D4 26??           02846                 ADDWF   TTMH,F
0032D6 01??           02847                 MOVLR   HIGH TBH
0032D8 5000           02848                 MOVFP   TBH+1,WREG
0032DA 01??           02849                 MOVLR   HIGH TTMH
0032DC 22??           02850                 ADDWFC  TTMH+1,F
                      02851                 MOVE    TBH,TTBH
0032DE C??? F???          M                 MOVFF   TBH,TTBH
0032E2 C??? F???          M                 MOVFF   (TBH+1),(TTBH+1)
0032E6                02852 TTinited
                      02853                 ; See if the Elevator stick indicates an adjustment     
                      02854                 CALLF   Elevator        ; C set for Up, Z set for Down
0032E6 EC?? F???          M                 CALL    (Elevator)
0032EA B0D8           02855                 BTFSC   ALUSTA,C
0032EC EF?? F???      02856                 GOTO    TTup
0032F0 A4D8           02857                 BTFSS   ALUSTA,Z
0032F2 EF?? F???      02858                 GOTO    TTgo
                      02859                 ; Here to decrease the low throttle position
0032F6 01??           02860                 MOVLR   HIGH TTBH
0032F8 06??           02861                 DECF    TTBH
0032FA A0D8           02862                 BTFSS   ALUSTA,C
0032FC 06??           02863                 DECF    TTBH+1
0032FE 06??           02864                 DECF    TTBH
003300 A0D8           02865                 BTFSS   ALUSTA,C
003302 06??           02866                 DECF    TTBH+1
003304 EF?? F???      02867                 GOTO    TTgo            
                      02868                 ; Here to increase the low throttle position
003308                02869 TTup
003308 01??           02870                 MOVLR   HIGH TTBH
00330A 2A??           02871                 INCF    TTBH
00330C B4D8           02872                 BTFSC   ALUSTA,Z
00330E 2A??           02873                 INCF    TTBH+1
003310 2A??           02874                 INCF    TTBH
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 206


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

003312 B4D8           02875                 BTFSC   ALUSTA,Z
003314 2A??           02876                 INCF    TTBH+1
                      02877                 ; Convert the throttle positions to gains
003316                02878 TTgo
                      02879                 MOVE    TTMH,AXreg
003316 C??? F???          M                 MOVFF   TTMH,AXreg
00331A C??? F???          M                 MOVFF   (TTMH+1),(AXreg+1)
00331E 01??           02880                 MOVLR   HIGH TTMH
003320 5000           02881                 MOVFP   TTBH,WREG
003322 01??           02882                 MOVLR   HIGH AXreg
003324 5E??           02883                 SUBWF   AXreg,F
003326 01??           02884                 MOVLR   HIGH TTBH
003328 5000           02885                 MOVFP   TTBH+1,WREG
00332A 01??           02886                 MOVLR   HIGH AXreg
00332C 5A??           02887                 SUBWFB  AXreg+1,F
                      02888                 MOVEC   D'256',BXreg
00332E 01??               M                 MOVLR   HIGH (BXreg)
003330 0E00               M                 MOVLW   LOW (D'256')
003332 6E??               M                 MOVWF   (BXreg)
003334 0E01               M                 MOVLW   HIGH (D'256')
003336 6E??               M                 MOVWF   (BXreg+1)
003338 EC?? F???      02889                 CALL    Mult1616
                      02890                 MOVEC   D'1000',DEXreg
00333C 01??               M                 MOVLR   HIGH (DEXreg)
00333E 0EE8               M                 MOVLW   LOW (D'1000')
003340 6E??               M                 MOVWF   (DEXreg)
003342 0E03               M                 MOVLW   HIGH (D'1000')
003344 6E??               M                 MOVWF   (DEXreg+1)
003346 EC?? F???      02891                 CALL    Divide2416
                      02892                 MOVE    CEXreg,TMH
00334A C??? F???          M                 MOVFF   CEXreg,TMH
00334E C??? F???          M                 MOVFF   (CEXreg+1),(TMH+1)
                      02893                 MOVE    TTBH,TBH
003352 C??? F???          M                 MOVFF   TTBH,TBH
003356 C??? F???          M                 MOVFF   (TTBH+1),(TBH+1)
                      02894                 ; Apply the trims and exit with the Z flag set
00335A EC?? F???      02895                 CALL    ApplyTrims
00335E 84D8           02896                 BSF     ALUSTA,Z
003360 0012           02897                 RETURN
003362                02898 TTexit
                      02899         ; Clear the Z flag and exit
                      02900                 ; If TTflag is set, save the throttle gains and clear the flag
003362 01??           02901                 MOVLR   HIGH TTflag
003364 66??           02902                 TSTFSZ  TTflag
003366 EF?? F???      02903                 GOTO    TTsave
                      02904                 ; here if flag was clear so just exit now
00336A 94D8           02905                 BCF     ALUSTA,Z
00336C 0012           02906                 RETURN
00336E                02907 TTsave:
                      02908                 ; here to clear flag and save
00336E 6A??           02909                 CLRF    TTflag
003370 EC?? F???      02910                 CALL    SaveAircraftPage1
                      02911                 ; exit 
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 207


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

003374 94D8           02912                 BCF     ALUSTA,Z
003376 0012           02913                 RETURN
                      02914 
                      02915 ; This function uses the generic parameter locations to calculate
                      02916 ; the joy stick position.
003378                02917 CenterNormalize
                      02918         ; Is pos > center ?
003378 01??           02919                 MOVLR   HIGH AXreg
                      02920                 ; AXreg = Pos - Ct
00337A 50??           02921                 MOVFP   Pos,W
00337C CFE8 F???      02922                 MOVPF   WREG,AXreg
003380 50??           02923                 MOVFP   Pos+1,W
003382 CFE8 F???      02924                 MOVPF   WREG,AXreg+1
003386 50??           02925                 MOVFP   Ct,W
003388 5E??           02926                 SUBWF   AXreg
00338A 50??           02927                 MOVFP   Ct+1,W
00338C 5A??           02928                 SUBWFB  AXreg+1
                      02929                 ; If carry is set then Pos was less than Ct
00338E A0D8           02930                 BTFSS   ALUSTA,C,A
003390 EF?? F???      02931                 GOTO    CN1
                      02932         ; If here then Pos >= Ct
003394 50??           02933                 MOVFP   Gh,W
003396 CFE8 F???      02934                 MOVPF   WREG,BXreg
00339A 50??           02935                 MOVFP   Gh+1,W
00339C CFE8 F???      02936                 MOVPF   WREG,BXreg+1
0033A0 EC?? F???      02937                 CALL    Mult1616
                      02938                 ; Get the ans divided by 256
0033A4 50??           02939                 MOVFP   CEXreg+1,W
0033A6 CFE8 F???      02940                 MOVPF   WREG,Npos
0033AA 50??           02941                 MOVFP   CEXreg+2,W
0033AC CFE8 F???      02942                 MOVPF   WREG,Npos+1
0033B0 0012           02943                 RETURN
                      02944         ; If here then Pos < Ct
0033B2                02945 CN1
0033B2 50??           02946                 MOVFP   Gl,W
0033B4 CFE8 F???      02947                 MOVPF   WREG,BXreg
0033B8 50??           02948                 MOVFP   Gl+1,W
0033BA CFE8 F???      02949                 MOVPF   WREG,BXreg+1
0033BE EC?? F???      02950                 CALL    Mult1616
                      02951                 ; Get the ans divided by 256
0033C2 50??           02952                 MOVFP   CEXreg+1,W
0033C4 CFE8 F???      02953                 MOVPF   WREG,Npos
0033C8 50??           02954                 MOVFP   CEXreg+2,W
0033CA CFE8 F???      02955                 MOVPF   WREG,Npos+1
0033CE 0012           02956                 RETURN
                      02957 
                      02958 ; This function is used to calculate the normalized position for a non
                      02959 ; centering input channel.
                      02960 ; 
                      02961 ; Inputs:
                      02962 ;       Pos = 16 bit variable containing the ADC counts
                      02963 ;       Ct  = 16 bit variable containing the offset
                      02964 ;       Gh  = 16 bit variable containing the gain
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 208


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      02965 ; Outputs:
                      02966 ;       Npos = 16 bit variable containing the normailized result.
                      02967 ;       Npos = (Pos - Ct) * Gt / 256
0033D0                02968 NonCenterNormalize
                      02969         ; AXreg = Pos - Ct
                      02970                 MOVE    Pos,AXreg
0033D0 C??? F???          M                 MOVFF   Pos,AXreg
0033D4 C??? F???          M                 MOVFF   (Pos+1),(AXreg+1)
0033D8 50??           02971                 MOVF    Ct,W
0033DA 5E??           02972                 SUBWF   AXreg,F
0033DC 50??           02973                 MOVF    Ct+1,W
0033DE 5A??           02974                 SUBWFB  AXreg+1,F
                      02975         ; CEXreg = AXreg * Gh
                      02976                 MOVE    Gh,BXreg
0033E0 C??? F???          M                 MOVFF   Gh,BXreg
0033E4 C??? F???          M                 MOVFF   (Gh+1),(BXreg+1)
0033E8 EC?? F???      02977                 CALL    Mult1616        ; CEXreg = AXreg * BXreg
                      02978         ; Npos = CEXreg/256
0033EC 50??           02979                 MOVF    CEXreg+1,W
0033EE CFE8 F???      02980                 MOVPF   WREG,Npos
0033F2 50??           02981                 MOVF    CEXreg+2,W
0033F4 CFE8 F???      02982                 MOVPF   WREG,Npos+1
0033F8 0012           02983                 RETURN
                      02984 ;
                      02985 ; This function will convert the raw ADC cound data into normalized
                      02986 ; joy stick position information. All channels except the throttle
                      02987 ; are normalized to -1000 to 1000. The throttle channel is normalized
                      02988 ; 0 to 1000.
                      02989 ; This function also allows a translation table to be refined to remap
                      02990 ; the control using a programmable table. This support is provided
                      02991 ; for, Ail,Ele,Rud,Tht,CH^, and CH7.
                      02992 ;
                      02993 ; The joy stick calibration parameters are used for this calculation.
                      02994 ;
0033FA                02995 CalculateNormalizedPositions
                      02996         ; Copy the position data to page 8 for use my the PC interface
                      02997                 MOVEC   Apos, Src
0033FA 01??               M                 MOVLR   HIGH (Src)
0033FC 0E??               M                 MOVLW   LOW (Apos)
0033FE 6E??               M                 MOVWF   (Src)
003400 0E??               M                 MOVLW   HIGH (Apos)
003402 6E??               M                 MOVWF   (Src+1)
                      02998                 MOVEC   Apos, Dst
003404 01??               M                 MOVLR   HIGH (Dst)
003406 0E??               M                 MOVLW   LOW (Apos)
003408 6E??               M                 MOVWF   (Dst)
00340A 0E??               M                 MOVLW   HIGH (Apos)
00340C 6E??               M                 MOVWF   (Dst+1)
00340E 0E08           02999                 MOVLW   8
003410 CFE8 F???      03000                 MOVFF   WREG,Dst+1
003414 0E26           03001                 MOVLW   26
003416 6E??           03002                 MOVWF   Cnt
003418 EC?? F???      03003                 CALL    BlkMove
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 209


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      03004         ; Aielron
00341C 0E04           03005                 MOVLW   ADCail
00341E EC?? F???      03006                 CALL    ADCread
                      03007                 ; Move all parameters to normalized space
                      03008                 MOVE    AHG,Gh
003422 C??? F???          M                 MOVFF   AHG,Gh
003426 C??? F???          M                 MOVFF   (AHG+1),(Gh+1)
                      03009                 MOVE    ACT,Ct
00342A C??? F???          M                 MOVFF   ACT,Ct
00342E C??? F???          M                 MOVFF   (ACT+1),(Ct+1)
                      03010                 MOVE    ALG,Gl
003432 C??? F???          M                 MOVFF   ALG,Gl
003436 C??? F???          M                 MOVFF   (ALG+1),(Gl+1)
                      03011                 ; Normalize it!
00343A EC?? F???      03012                 CALL    CenterNormalize
                      03013                 MOVE    Npos,AXreg
00343E C??? F???          M                 MOVFF   Npos,AXreg
003442 C??? F???          M                 MOVFF   (Npos+1),(AXreg+1)
003446 C??? F???      03014                 MOVFF   AILremap,Breg
00344A 3A00           03015                 SWAPF   Breg,F,A
00344C EC?? F???      03016                 CALL    Translation
                      03017                 MOVE    AXreg,ATpos
003450 C??? F???          M                 MOVFF   AXreg,ATpos
003454 C??? F???          M                 MOVFF   (AXreg+1),(ATpos+1)
                      03018                 MOVE    AXreg,Apos
003458 C??? F???          M                 MOVFF   AXreg,Apos
00345C C??? F???          M                 MOVFF   (AXreg+1),(Apos+1)
                      03019         ; Elevator
003460 0E05           03020                 MOVLW   ADCele
003462 EC?? F???      03021                 CALL    ADCread
                      03022                 ; Move all parameters to normalized space
                      03023                 MOVE    EHG,Gh
003466 C??? F???          M                 MOVFF   EHG,Gh
00346A C??? F???          M                 MOVFF   (EHG+1),(Gh+1)
                      03024                 MOVE    ECT,Ct
00346E C??? F???          M                 MOVFF   ECT,Ct
003472 C??? F???          M                 MOVFF   (ECT+1),(Ct+1)
                      03025                 MOVE    ELG,Gl
003476 C??? F???          M                 MOVFF   ELG,Gl
00347A C??? F???          M                 MOVFF   (ELG+1),(Gl+1)
                      03026                 ; Normalize it!
00347E EC?? F???      03027                 CALL    CenterNormalize
                      03028                 MOVE    Npos,AXreg
003482 C??? F???          M                 MOVFF   Npos,AXreg
003486 C??? F???          M                 MOVFF   (Npos+1),(AXreg+1)
00348A C??? F???      03029                 MOVFF   ELEremap,Breg
00348E 3A00           03030                 SWAPF   Breg,F,A
003490 EC?? F???      03031                 CALL    Translation
                      03032                 MOVE    AXreg,ETpos
003494 C??? F???          M                 MOVFF   AXreg,ETpos
003498 C??? F???          M                 MOVFF   (AXreg+1),(ETpos+1)
                      03033                 MOVE    AXreg,Epos
00349C C??? F???          M                 MOVFF   AXreg,Epos
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 210


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

0034A0 C??? F???          M                 MOVFF   (AXreg+1),(Epos+1)
                      03034         ; Rudder
0034A4 0E06           03035                 MOVLW   ADCrud
0034A6 EC?? F???      03036                 CALL    ADCread
                      03037                 ; Move all parameters to normalized space
                      03038                 MOVE    RHG,Gh
0034AA C??? F???          M                 MOVFF   RHG,Gh
0034AE C??? F???          M                 MOVFF   (RHG+1),(Gh+1)
                      03039                 MOVE    RCT,Ct
0034B2 C??? F???          M                 MOVFF   RCT,Ct
0034B6 C??? F???          M                 MOVFF   (RCT+1),(Ct+1)
                      03040                 MOVE    RLG,Gl
0034BA C??? F???          M                 MOVFF   RLG,Gl
0034BE C??? F???          M                 MOVFF   (RLG+1),(Gl+1)
                      03041                 ; Normalize it!
0034C2 EC?? F???      03042                 CALL    CenterNormalize
                      03043                 MOVE    Npos,AXreg
0034C6 C??? F???          M                 MOVFF   Npos,AXreg
0034CA C??? F???          M                 MOVFF   (Npos+1),(AXreg+1)
0034CE C??? F???      03044                 MOVFF   RUDremap,Breg
0034D2 3A00           03045                 SWAPF   Breg,F,A
0034D4 EC?? F???      03046                 CALL    Translation
                      03047                 MOVE    AXreg,RTpos
0034D8 C??? F???          M                 MOVFF   AXreg,RTpos
0034DC C??? F???          M                 MOVFF   (AXreg+1),(RTpos+1)
                      03048                 MOVE    AXreg,Rpos
0034E0 C??? F???          M                 MOVFF   AXreg,Rpos
0034E4 C??? F???          M                 MOVFF   (AXreg+1),(Rpos+1)
                      03049         ; Throttle
0034E8 0E07           03050                 MOVLW   ADCthr
0034EA EC?? F???      03051                 CALL    ADCread
0034EE 0E07           03052                 MOVLW   ADCthr
0034F0 EC?? F???      03053                 CALL    ADCread
                      03054                 ; Move all parameters to normalized space
                      03055                 MOVE    THG,Gh
0034F4 C??? F???          M                 MOVFF   THG,Gh
0034F8 C??? F???          M                 MOVFF   (THG+1),(Gh+1)
                      03056                 MOVE    TCT,Ct
0034FC C??? F???          M                 MOVFF   TCT,Ct
003500 C??? F???          M                 MOVFF   (TCT+1),(Ct+1)
                      03057                 ; Normalize it!
003504 EC?? F???      03058                 CALL    NonCenterNormalize
                      03059                 MOVE    Npos,AXreg
003508 C??? F???          M                 MOVFF   Npos,AXreg
00350C C??? F???          M                 MOVFF   (Npos+1),(AXreg+1)
003510 C??? F???      03060                 MOVFF   THTremap,Breg
003514 3A00           03061                 SWAPF   Breg,F,A
003516 EC?? F???      03062                 CALL    Translation
                      03063                 MOVE    AXreg,TTpos
00351A C??? F???          M                 MOVFF   AXreg,TTpos
00351E C??? F???          M                 MOVFF   (AXreg+1),(TTpos+1)
                      03064                 MOVE    AXreg,Tpos
003522 C??? F???          M                 MOVFF   AXreg,Tpos
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 211


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

003526 C??? F???          M                 MOVFF   (AXreg+1),(Tpos+1)
                      03065                 MOVE    AXreg,Tnorm
00352A C??? F???          M                 MOVFF   AXreg,Tnorm
00352E C??? F???          M                 MOVFF   (AXreg+1),(Tnorm+1)
                      03066         ; The ADC reference input is read and saved here, this value represent the battery
                      03067         ; voltage.
003532 0E03           03068                 MOVLW   ADCref
003534 EC?? F???      03069                 CALL    ADCread
                      03070                 ; Save data in Vbat
003538 01??           03071                 MOVLR   HIGH Vbat
00353A 010F           03072                 MOVLB   HIGH ADRESL
00353C CFC3 FFE8      03073                 MOVPF   ADRESL,WREG
003540 CFE8 F???      03074                 MOVPF   WREG,Vbat
003544 CFC4 FFE8      03075                 MOVPF   ADRESH,WREG
003548 CFE8 F???      03076                 MOVPF   WREG,Vbat+1
                      03077         ; This section contains the normalization code for the trims found
                      03078         ; on a MicroPro 8000
                      03079         ; Aielron trim
00354C 0E08           03080                 MOVLW   ADCailTrim
00354E EC?? F???      03081                 CALL    ADCread
                      03082                 ; Now normalize
                      03083                 MOVE    AtrimCT,Ct
003552 C??? F???          M                 MOVFF   AtrimCT,Ct
003556 C??? F???          M                 MOVFF   (AtrimCT+1),(Ct+1)
                      03084                 MOVE    AtrimHG,Gh      
00355A C??? F???          M                 MOVFF   AtrimHG,Gh
00355E C??? F???          M                 MOVFF   (AtrimHG+1),(Gh+1)
003562 EC?? F???      03085                 CALL    NonCenterNormalize
                      03086                 MOVE    Npos,Atrim
003566 C??? F???          M                 MOVFF   Npos,Atrim
00356A C??? F???          M                 MOVFF   (Npos+1),(Atrim+1)
                      03087         ; Elevator trim
00356E 0E09           03088                 MOVLW   ADCeleTrim
003570 EC?? F???      03089                 CALL    ADCread
                      03090                 ; Now normalize
                      03091                 MOVE    EtrimCT,Ct
003574 C??? F???          M                 MOVFF   EtrimCT,Ct
003578 C??? F???          M                 MOVFF   (EtrimCT+1),(Ct+1)
                      03092                 MOVE    EtrimHG,Gh      
00357C C??? F???          M                 MOVFF   EtrimHG,Gh
003580 C??? F???          M                 MOVFF   (EtrimHG+1),(Gh+1)
003584 EC?? F???      03093                 CALL    NonCenterNormalize
                      03094                 MOVE    Npos,Etrim
003588 C??? F???          M                 MOVFF   Npos,Etrim
00358C C??? F???          M                 MOVFF   (Npos+1),(Etrim+1)
                      03095         ; Rudder trim
003590 0E0A           03096                 MOVLW   ADCrudTrim
003592 EC?? F???      03097                 CALL    ADCread
                      03098                 ; Now normalize
                      03099                 MOVE    RtrimCT,Ct
003596 C??? F???          M                 MOVFF   RtrimCT,Ct
00359A C??? F???          M                 MOVFF   (RtrimCT+1),(Ct+1)
                      03100                 MOVE    RtrimHG,Gh      
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 212


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

00359E C??? F???          M                 MOVFF   RtrimHG,Gh
0035A2 C??? F???          M                 MOVFF   (RtrimHG+1),(Gh+1)
0035A6 EC?? F???      03101                 CALL    NonCenterNormalize
                      03102                 MOVE    Npos,Rtrim
0035AA C??? F???          M                 MOVFF   Npos,Rtrim
0035AE C??? F???          M                 MOVFF   (Npos+1),(Rtrim+1)
                      03103         ; Throttle trim
0035B2 0E0B           03104                 MOVLW   ADCthrTrim
0035B4 EC?? F???      03105                 CALL    ADCread
                      03106                 ; Now normalize
                      03107                 MOVE    TtrimCT,Ct
0035B8 C??? F???          M                 MOVFF   TtrimCT,Ct
0035BC C??? F???          M                 MOVFF   (TtrimCT+1),(Ct+1)
                      03108                 MOVE    TtrimHG,Gh      
0035C0 C??? F???          M                 MOVFF   TtrimHG,Gh
0035C4 C??? F???          M                 MOVFF   (TtrimHG+1),(Gh+1)
0035C8 EC?? F???      03109                 CALL    NonCenterNormalize
                      03110                 MOVE    Npos,Ttrim
0035CC C??? F???          M                 MOVFF   Npos,Ttrim
0035D0 C??? F???          M                 MOVFF   (Npos+1),(Ttrim+1)
                      03111         ; CH5, -1000 or 1000
0035D4 01??           03112                 MOVLR   HIGH SWCH5
0035D6 5000           03113                 MOVFP   SWCH5,WREG
0035D8 EC?? F???      03114                 CALL    SwitchTest
0035DC A0D8           03115                 BTFSS   ALUSTA,C
0035DE EF?? F???      03116                 GOTO    CH5_OFF
                      03117                 MOVEC   D'1000',CH5pos
0035E2 01??               M                 MOVLR   HIGH (CH5pos)
0035E4 0EE8               M                 MOVLW   LOW (D'1000')
0035E6 6E??               M                 MOVWF   (CH5pos)
0035E8 0E03               M                 MOVLW   HIGH (D'1000')
0035EA 6E??               M                 MOVWF   (CH5pos+1)
0035EC EF?? F???      03118                 GOTO    CH5_Done
0035F0                03119 CH5_OFF
                      03120                 MOVEC   -D'1000',CH5pos 
0035F0 01??               M                 MOVLR   HIGH (CH5pos)
0035F2 0E18               M                 MOVLW   LOW (-D'1000')
0035F4 6E??               M                 MOVWF   (CH5pos)
0035F6 0EFC               M                 MOVLW   HIGH (-D'1000')
0035F8 6E??               M                 MOVWF   (CH5pos+1)
0035FA                03121 CH5_Done
                      03122         ; CH6
0035FA 0E00           03123                 MOVLW   ADCch6
0035FC EC?? F???      03124                 CALL    ADCread
                      03125                 ; Move all parameters to normalized space
                      03126                 MOVE    CH6HG,Gh
003600 C??? F???          M                 MOVFF   CH6HG,Gh
003604 C??? F???          M                 MOVFF   (CH6HG+1),(Gh+1)
                      03127                 MOVE    CH6CT,Ct
003608 C??? F???          M                 MOVFF   CH6CT,Ct
00360C C??? F???          M                 MOVFF   (CH6CT+1),(Ct+1)
                      03128                 ; Normalize it!
003610 EC?? F???      03129                 CALL    NonCenterNormalize
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 213


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      03130                 MOVE    Npos,AXreg
003614 C??? F???          M                 MOVFF   Npos,AXreg
003618 C??? F???          M                 MOVFF   (Npos+1),(AXreg+1)
00361C C??? F???      03131                 MOVFF   CH6remap,Breg
003620 3A00           03132                 SWAPF   Breg,F,A
003622 EC?? F???      03133                 CALL    Translation
                      03134                 MOVE    AXreg,CH6pos
003626 C??? F???          M                 MOVFF   AXreg,CH6pos
00362A C??? F???          M                 MOVFF   (AXreg+1),(CH6pos+1)
                      03135         ; CH7
00362E 0E01           03136                 MOVLW   ADCch7
003630 EC?? F???      03137                 CALL    ADCread
                      03138                 ; Move all parameters to normalized space
                      03139                 MOVE    CH7HG,Gh
003634 C??? F???          M                 MOVFF   CH7HG,Gh
003638 C??? F???          M                 MOVFF   (CH7HG+1),(Gh+1)
                      03140                 MOVE    CH7CT,Ct
00363C C??? F???          M                 MOVFF   CH7CT,Ct
003640 C??? F???          M                 MOVFF   (CH7CT+1),(Ct+1)
                      03141                 ; Normalize it!
003644 EC?? F???      03142                 CALL    NonCenterNormalize
                      03143                 MOVE    Npos,AXreg
003648 C??? F???          M                 MOVFF   Npos,AXreg
00364C C??? F???          M                 MOVFF   (Npos+1),(AXreg+1)
003650 C??? F???      03144                 MOVFF   CH7remap,Breg
003654 3A00           03145                 SWAPF   Breg,F,A
003656 EC?? F???      03146                 CALL    Translation
                      03147                 MOVE    AXreg,CH7pos
00365A C??? F???          M                 MOVFF   AXreg,CH7pos
00365E C??? F???          M                 MOVFF   (AXreg+1),(CH7pos+1)
                      03148         ; CH8, -1000, 0, or 1000
003662 01??           03149                 MOVLR   HIGH SWCH8A
003664 5000           03150                 MOVFP   SWCH8A,WREG
003666 EC?? F???      03151                 CALL    SwitchTest
00366A A0D8           03152                 BTFSS   ALUSTA,C
00366C EF?? F???      03153                 GOTO    CH8_c
                      03154                 MOVEC   D'1000',CH8pos
003670 01??               M                 MOVLR   HIGH (CH8pos)
003672 0EE8               M                 MOVLW   LOW (D'1000')
003674 6E??               M                 MOVWF   (CH8pos)
003676 0E03               M                 MOVLW   HIGH (D'1000')
003678 6E??               M                 MOVWF   (CH8pos+1)
00367A EF?? F???      03155                 GOTO    CH8_Done
00367E                03156 CH8_c
00367E 01??           03157                 MOVLR   HIGH SWCH8C
003680 5000           03158                 MOVFP   SWCH8C,WREG
003682 EC?? F???      03159                 CALL    SwitchTest
003686 A0D8           03160                 BTFSS   ALUSTA,C
003688 EF?? F???      03161                 GOTO    CH8_b
                      03162                 MOVEC   0FC18,CH8pos
00368C 01??               M                 MOVLR   HIGH (CH8pos)
00368E 0E18               M                 MOVLW   LOW (0FC18)
003690 6E??               M                 MOVWF   (CH8pos)
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 214


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

003692 0EFC               M                 MOVLW   HIGH (0FC18)
003694 6E??               M                 MOVWF   (CH8pos+1)
003696 EF?? F???      03163                 GOTO    CH8_Done
00369A                03164 CH8_b
00369A 01??           03165                 MOVLR   HIGH SWCH8B
00369C 5000           03166                 MOVFP   SWCH8B,WREG
00369E EC?? F???      03167                 CALL    SwitchTest
0036A2 A0D8           03168                 BTFSS   ALUSTA,C
0036A4 EF?? F???      03169                 GOTO    CH8_Done
                      03170                 MOVEC   0,CH8pos
0036A8 01??               M                 MOVLR   HIGH (CH8pos)
0036AA 0E00               M                 MOVLW   LOW (0)
0036AC 6E??               M                 MOVWF   (CH8pos)
0036AE 0E00               M                 MOVLW   HIGH (0)
0036B0 6E??               M                 MOVWF   (CH8pos+1)
0036B2                03171 CH8_Done
0036B2 0012           03172                 RETURN
                      03173 
                      03174 ;
                      03175 ; This function applies the expo to Aileron, Elevator and Rudder. There are
                      03176 ; two expo values for each channel. A high rate and low rate expo value.
                      03177 ; Below are the two expo functions:
                      03178 ;  High rate function (E = expo percentage)
                      03179 ;   Pos = Pos - (E * Pos/100 - E * Pos * Pos/100000)
                      03180 ;  Low rate function (E = expo percentage, G = low rate percentage)
                      03181 ;   Pos = Pos - (E * Pos/100 - E * Pos * Pos/(1000 * G))
                      03182 ;
                      03183 
                      03184 ; Generic function, assumes:
                      03185 ;       BXreg   =       Expo percentage
                      03186 ;       Breg    =       Channel gain
                      03187 ;       AXreg   =       Pos
                      03188 ; Result returned in AXreg
                      03189 ;
0036B4                03190 Expo:
                      03191         ; Sign extend BXreg
0036B4 01??           03192                 MOVLR   HIGH BXreg
0036B6 6A??           03193                 CLRF    BXreg+1
0036B8 BE??           03194                 BTFSC   BXreg,7
0036BA 1E??           03195                 COMF    BXreg+1
                      03196         ; Calculate E * Pos/100
0036BC EC?? F???      03197                 CALL    Mult1616
                      03198                 MOVEC   D'100',DEXreg
0036C0 01??               M                 MOVLR   HIGH (DEXreg)
0036C2 0E64               M                 MOVLW   LOW (D'100')
0036C4 6E??               M                 MOVWF   (DEXreg)
0036C6 0E00               M                 MOVLW   HIGH (D'100')
0036C8 6E??               M                 MOVWF   (DEXreg+1)
0036CA EC?? F???      03199                 CALL    Divide2416
                      03200         ; CEXreg contains E * Pos/100
                      03201                 MOVE    CEXreg,CXreg    ; E * Pos/100 to CXreg
0036CE C??? F???          M                 MOVFF   CEXreg,CXreg
0036D2 C??? F???          M                 MOVFF   (CEXreg+1),(CXreg+1)
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 215


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      03202                 MOVE    CEXreg,BXreg    ; E * Pos/100 to BXreg
0036D6 C??? F???          M                 MOVFF   CEXreg,BXreg
0036DA C??? F???          M                 MOVFF   (CEXreg+1),(BXreg+1)
                      03203                 ; Because Pos*Pos will always be positive, we must take
                      03204                 ; the complement of Pos if its negative, make sense??
0036DE AE??           03205                 BTFSS   AXreg+1,7
0036E0 EF?? F???      03206                 GOTO    ExpoPos
0036E4 1E??           03207                 COMF    BXreg
0036E6 1E??           03208                 COMF    BXreg+1
0036E8 2A??           03209                 INCF    BXreg
0036EA B0D8           03210                 BTFSC   ALUSTA,C
0036EC 2A??           03211                 INCF    BXreg+1 
0036EE                03212 ExpoPos:
0036EE EC?? F???      03213                 CALL    Mult1616
                      03214                 MOVEC   D'10',DEXreg
0036F2 01??               M                 MOVLR   HIGH (DEXreg)
0036F4 0E0A               M                 MOVLW   LOW (D'10')
0036F6 6E??               M                 MOVWF   (DEXreg)
0036F8 0E00               M                 MOVLW   HIGH (D'10')
0036FA 6E??               M                 MOVWF   (DEXreg+1)
0036FC EC?? F???      03215                 CALL    Divide2416      ; ans in CEXreg
003700 5000           03216                 MOVFP   Breg,WREG
003702 CFE8 F???      03217                 MOVPF   WREG,DEXreg
003706 6A??           03218                 CLRF    DEXreg+1        
003708 BE??           03219                 BTFSC   DEXreg,7
00370A 1E??           03220                 COMF    DEXreg+1
00370C EC?? F???      03221                 CALL    Divide2416      ; ans in CEXreg
                      03222         ; Now wrap it up... do the additions...
003710 5000           03223                 MOVFP   CXreg,WREG
003712 5E??           03224                 SUBWF   AXreg,F
003714 5000           03225                 MOVFP   CXreg+1,WREG
003716 5A??           03226                 SUBWFB  AXreg+1,F
003718 5000           03227                 MOVFP   CEXreg,WREG
00371A 26??           03228                 ADDWF   AXreg,F
00371C 5000           03229                 MOVFP   CEXreg+1,WREG
00371E 22??           03230                 ADDWFC  AXreg+1,F
                      03231         ; Done
003720 0012           03232                 RETURN
                      03233 
                      03234                 
                      03235 ; This function applies the generic expo function to all of the 
                      03236 ; channels, A,E, and R.
003722                03237 ApplyExpo:
                      03238         ; Aileron expo
                      03239                 ; Test dual rate switch
003722 01??           03240                 MOVLR   HIGH SWAILDR
003724 5000           03241                 MOVFP   SWAILDR,WREG
003726 EC?? F???      03242                 CALL    SwitchTest
                      03243                 MOVE    Apos,AXreg
00372A C??? F???          M                 MOVFF   Apos,AXreg
00372E C??? F???          M                 MOVFF   (Apos+1),(AXreg+1)
003732 A0D8           03244                 BTFSS   ALUSTA,C
003734 EF?? F???      03245                 GOTO    AEX1
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 216


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      03246                 ; Here if Low rate
003738 01??           03247                 MOVLR   HIGH AEXLOW
00373A 5000           03248                 MOVFP   AEXLOW,WREG
00373C 01??           03249                 MOVLR   HIGH BXreg
00373E CFE8 F???      03250                 MOVPF   WREG,BXreg
003742 01??           03251                 MOVLR   HIGH ALR
003744 5000           03252                 MOVFP   ALR,WREG
003746 CFE8 F???      03253                 MOVPF   WREG,Breg
00374A EF?? F???      03254                 GOTO    AEX1a
                      03255                 ; Here if high rate
00374E                03256 AEX1:
00374E 01??           03257                 MOVLR   HIGH AEXHI
003750 5000           03258                 MOVFP   AEXHI,WREG
003752 01??           03259                 MOVLR   HIGH BXreg
003754 CFE8 F???      03260                 MOVPF   WREG,BXreg
003758 0E64           03261                 MOVLW   D'100'
00375A CFE8 F???      03262                 MOVPF   WREG,Breg
00375E                03263 AEX1a:
00375E EC?? F???      03264                 CALL    Expo
                      03265                 MOVE    AXreg,Apos
003762 C??? F???          M                 MOVFF   AXreg,Apos
003766 C??? F???          M                 MOVFF   (AXreg+1),(Apos+1)
                      03266         ; Elevator expo
                      03267                 ; Test dual rate switch
00376A 01??           03268                 MOVLR   HIGH SWELEDR
00376C 5000           03269                 MOVFP   SWELEDR,WREG
00376E EC?? F???      03270                 CALL    SwitchTest
                      03271                 MOVE    Epos,AXreg
003772 C??? F???          M                 MOVFF   Epos,AXreg
003776 C??? F???          M                 MOVFF   (Epos+1),(AXreg+1)
00377A A0D8           03272                 BTFSS   ALUSTA,C
00377C EF?? F???      03273                 GOTO    EEX1
                      03274                 ; Here if Low rate
003780 01??           03275                 MOVLR   HIGH EEXLOW
003782 5000           03276                 MOVFP   EEXLOW,WREG
003784 01??           03277                 MOVLR   HIGH BXreg
003786 CFE8 F???      03278                 MOVPF   WREG,BXreg
00378A 01??           03279                 MOVLR   HIGH ELR
00378C 5000           03280                 MOVFP   ELR,WREG
00378E CFE8 F???      03281                 MOVPF   WREG,Breg
003792 EF?? F???      03282                 GOTO    EEX1a
003796                03283 EEX1:
                      03284                 ; Here if high rate
003796 01??           03285                 MOVLR   HIGH EEXHI
003798 5000           03286                 MOVFP   EEXHI,WREG
00379A 01??           03287                 MOVLR   HIGH BXreg
00379C CFE8 F???      03288                 MOVPF   WREG,BXreg
0037A0 0E64           03289                 MOVLW   D'100'
0037A2 CFE8 F???      03290                 MOVPF   WREG,Breg
0037A6                03291 EEX1a:
0037A6 EC?? F???      03292                 CALL    Expo
                      03293                 MOVE    AXreg,Epos
0037AA C??? F???          M                 MOVFF   AXreg,Epos
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 217


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

0037AE C??? F???          M                 MOVFF   (AXreg+1),(Epos+1)
                      03294         ; Rudder expo
                      03295                 ; Test dual rate switch
0037B2 01??           03296                 MOVLR   HIGH SWRUDDR
0037B4 5000           03297                 MOVFP   SWRUDDR,WREG
0037B6 EC?? F???      03298                 CALL    SwitchTest
                      03299                 MOVE    Rpos,AXreg
0037BA C??? F???          M                 MOVFF   Rpos,AXreg
0037BE C??? F???          M                 MOVFF   (Rpos+1),(AXreg+1)
0037C2 A0D8           03300                 BTFSS   ALUSTA,C
0037C4 EF?? F???      03301                 GOTO    REX1
                      03302                 ; Here if Low rate
0037C8 01??           03303                 MOVLR   HIGH REXLOW
0037CA 5000           03304                 MOVFP   REXLOW,WREG
0037CC 01??           03305                 MOVLR   HIGH BXreg
0037CE CFE8 F???      03306                 MOVPF   WREG,BXreg
0037D2 01??           03307                 MOVLR   HIGH RLR
0037D4 5000           03308                 MOVFP   RLR,WREG
0037D6 CFE8 F???      03309                 MOVPF   WREG,Breg
0037DA EF?? F???      03310                 GOTO    REX1a
0037DE                03311 REX1:
                      03312                 ; Here if high rate
0037DE 01??           03313                 MOVLR   HIGH REXHI
0037E0 5000           03314                 MOVFP   REXHI,WREG
0037E2 01??           03315                 MOVLR   HIGH BXreg
0037E4 CFE8 F???      03316                 MOVPF   WREG,BXreg
0037E8 0E64           03317                 MOVLW   D'100'
0037EA CFE8 F???      03318                 MOVPF   WREG,Breg
0037EE                03319 REX1a:
0037EE EC?? F???      03320                 CALL    Expo
                      03321                 MOVE    AXreg,Rpos
0037F2 C??? F???          M                 MOVFF   AXreg,Rpos
0037F6 C??? F???          M                 MOVFF   (AXreg+1),(Rpos+1)
0037FA 0012           03322                 RETURN
                      03323 
                      03324 ;
                      03325 ; This function calculates the dual rate servo positions. Here is the math
                      03326 ; Pos = (G * Pos) /100
                      03327 ;
0037FC                03328 ApplyDualRates
                      03329         ;
                      03330         ; Aielron, Lin dual rate, Pos = (Pos * G)/100
                      03331         ;
0037FC 01??           03332                 MOVLR   HIGH SWAILDR
0037FE 5000           03333                 MOVFP   SWAILDR,WREG
003800 EC?? F???      03334                 CALL    SwitchTest
003804 A0D8           03335                 BTFSS   ALUSTA,C
003806 EF?? F???      03336                 GOTO    ADR1
                      03337                 MOVE    Apos,BXreg
00380A C??? F???          M                 MOVFF   Apos,BXreg
00380E C??? F???          M                 MOVFF   (Apos+1),(BXreg+1)
                      03338                 MOVE    ALR,AXreg
003812 C??? F???          M                 MOVFF   ALR,AXreg
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 218


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

003816 C??? F???          M                 MOVFF   (ALR+1),(AXreg+1)
00381A 6A??           03339                 CLRF    AXreg+1
00381C BE??           03340                 BTFSC   AXreg,7
00381E 1E??           03341                 COMF    AXreg+1
003820 EC?? F???      03342                 CALL    Mult1616
                      03343                 MOVEC   D'100',DEXreg
003824 01??               M                 MOVLR   HIGH (DEXreg)
003826 0E64               M                 MOVLW   LOW (D'100')
003828 6E??               M                 MOVWF   (DEXreg)
00382A 0E00               M                 MOVLW   HIGH (D'100')
00382C 6E??               M                 MOVWF   (DEXreg+1)
00382E EC?? F???      03344                 CALL    Divide2416
                      03345                 MOVE    CEXreg,Apos
003832 C??? F???          M                 MOVFF   CEXreg,Apos
003836 C??? F???          M                 MOVFF   (CEXreg+1),(Apos+1)
                      03346         ;
                      03347         ; Elevator
                      03348         ;
00383A                03349 ADR1
00383A 01??           03350                 MOVLR   HIGH SWAILDR
00383C 5000           03351                 MOVFP   SWELEDR,WREG
00383E EC?? F???      03352                 CALL    SwitchTest
003842 A0D8           03353                 BTFSS   ALUSTA,C
003844 EF?? F???      03354                 GOTO    ADR2
                      03355                 MOVE    Epos,BXreg
003848 C??? F???          M                 MOVFF   Epos,BXreg
00384C C??? F???          M                 MOVFF   (Epos+1),(BXreg+1)
                      03356                 MOVE    ELR,AXreg
003850 C??? F???          M                 MOVFF   ELR,AXreg
003854 C??? F???          M                 MOVFF   (ELR+1),(AXreg+1)
003858 6A??           03357                 CLRF    AXreg+1
00385A BE??           03358                 BTFSC   AXreg,7
00385C 1E??           03359                 COMF    AXreg+1
00385E EC?? F???      03360                 CALL    Mult1616
                      03361                 MOVEC   D'100',DEXreg
003862 01??               M                 MOVLR   HIGH (DEXreg)
003864 0E64               M                 MOVLW   LOW (D'100')
003866 6E??               M                 MOVWF   (DEXreg)
003868 0E00               M                 MOVLW   HIGH (D'100')
00386A 6E??               M                 MOVWF   (DEXreg+1)
00386C EC?? F???      03362                 CALL    Divide2416
                      03363                 MOVE    CEXreg,Epos
003870 C??? F???          M                 MOVFF   CEXreg,Epos
003874 C??? F???          M                 MOVFF   (CEXreg+1),(Epos+1)
                      03364         ;
                      03365         ; Rudder
                      03366         ;
003878                03367 ADR2
003878 01??           03368                 MOVLR   HIGH SWAILDR
00387A 5000           03369                 MOVFP   SWRUDDR,WREG
00387C EC?? F???      03370                 CALL    SwitchTest
003880 A0D8           03371                 BTFSS   ALUSTA,C
003882 EF?? F???      03372                 GOTO    ADR3
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 219


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      03373                 MOVE    Rpos,BXreg
003886 C??? F???          M                 MOVFF   Rpos,BXreg
00388A C??? F???          M                 MOVFF   (Rpos+1),(BXreg+1)
                      03374                 MOVE    RLR,AXreg
00388E C??? F???          M                 MOVFF   RLR,AXreg
003892 C??? F???          M                 MOVFF   (RLR+1),(AXreg+1)
003896 6A??           03375                 CLRF    AXreg+1
003898 BE??           03376                 BTFSC   AXreg,7
00389A 1E??           03377                 COMF    AXreg+1
00389C EC?? F???      03378                 CALL    Mult1616
                      03379                 MOVEC   D'100',DEXreg
0038A0 01??               M                 MOVLR   HIGH (DEXreg)
0038A2 0E64               M                 MOVLW   LOW (D'100')
0038A4 6E??               M                 MOVWF   (DEXreg)
0038A6 0E00               M                 MOVLW   HIGH (D'100')
0038A8 6E??               M                 MOVWF   (DEXreg+1)
0038AA EC?? F???      03380                 CALL    Divide2416
                      03381                 MOVE    CEXreg,Rpos
0038AE C??? F???          M                 MOVFF   CEXreg,Rpos
0038B2 C??? F???          M                 MOVFF   (CEXreg+1),(Rpos+1)
0038B6                03382 ADR3
0038B6 0012           03383                 RETURN
                      03384 
                      03385 ; This function is called to test the center beep for all the trims and CH6/7. If any one of these
                      03386 ; has changed sign, crossed center, and it has been enabled, then a sound is generated.
0038B8                03387 CenterBeep
                      03388         ; Test sign change beep flag and exit is clear  
0038B8 C??? FFE8      03389                 MOVFF   TrimBeepSignChange,WREG
0038BC 1EE8           03390                 COMF    WREG
0038BE 66E8           03391                 TSTFSZ  WREG
0038C0 0012           03392                 RETURN
                      03393         ; Clear the flag and beep!              
0038C2 6AE8           03394                 CLRF    WREG
0038C4 CFE8 F???      03395                 MOVFF   WREG,TrimBeepSignChange
0038C8 0E03           03396                 MOVLW   D'3'  
0038CA 01??           03397                 MOVLR   HIGH BeepCyl
0038CC 6E??           03398                 MOVWF   BeepCyl
0038CE 0E03           03399                 MOVLW   D'3'
0038D0 EC?? F???      03400                 CALL    Beep
0038D4 0012           03401                 RETURN
                      03402                 
                      03403 ; This function updates all the center beep controls based on the state of the enable flags. These
                      03404 ; center beep functions support A,E,R, and T trims as well as channels 6 and 7. This routine sets
                      03405 ; a center beed flag if any control is detected to cross center. Three flags control this routine
                      03406 ; and only enabled center beep channels are tested. The flag has to be set to enable the center
                      03407 ; beep test:
                      03408 ;
                      03409 ;       TrimCenterBeepFlag = enables A,E,R trims
                      03410 ;       ThtTCenterBeepFlag = enables T trim
                      03411 ;       CH67CenterBeepFlag = CH6 and CH7
                      03412 ;
0038D6                03413 UpdateLastPos
                      03414         ; Test enable flag and bypass the test is not set
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 220


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

0038D6 C??? FFE8      03415                 MOVFF   TrimCenterBeepFlag,WREG
0038DA 1EE8           03416                 COMF    WREG
0038DC 66E8           03417                 TSTFSZ  WREG
0038DE EF?? F???      03418                 GOTO    ULP0
                      03419         ; Aileron
                      03420                 MOVE    DTail,BXreg                     ; in case its a digital trim
0038E2 C??? F???          M                 MOVFF   DTail,BXreg
0038E6 C??? F???          M                 MOVFF   (DTail+1),(BXreg+1)
0038EA 01??           03421                 MOVLR   HIGH AilTrimCh
0038EC 5000           03422                 MOVFP   AilTrimCh,WREG
0038EE EC?? F???      03423                 CALL    SelectTrim                      ; Loads BXreg with trim value
                      03424                 MOVE    BXreg,AXreg
0038F2 C??? F???          M                 MOVFF   BXreg,AXreg
0038F6 C??? F???          M                 MOVFF   (BXreg+1),(AXreg+1)
                      03425                 MOVE    AtrimLast,BXreg
0038FA C??? F???          M                 MOVFF   AtrimLast,BXreg
0038FE C??? F???          M                 MOVFF   (AtrimLast+1),(BXreg+1)
003902 EC?? F???      03426                 CALL    UpdateLast
003906 68E8           03427                 SETF    WREG
003908 B0D8           03428                 BTFSC   ALUSTA,C
00390A CFE8 F???      03429                 MOVFF   WREG,TrimBeepSignChange
                      03430                 MOVE    BXreg,AtrimLast
00390E C??? F???          M                 MOVFF   BXreg,AtrimLast
003912 C??? F???          M                 MOVFF   (BXreg+1),(AtrimLast+1)
                      03431         ; Elevator
                      03432                 MOVE    DTele,BXreg                     ; in case its a digital trim
003916 C??? F???          M                 MOVFF   DTele,BXreg
00391A C??? F???          M                 MOVFF   (DTele+1),(BXreg+1)
00391E 01??           03433                 MOVLR   HIGH EleTrimCh
003920 5000           03434                 MOVFP   EleTrimCh,WREG
003922 EC?? F???      03435                 CALL    SelectTrim                      ; Loads BXreg with trim value
                      03436                 MOVE    BXreg,AXreg
003926 C??? F???          M                 MOVFF   BXreg,AXreg
00392A C??? F???          M                 MOVFF   (BXreg+1),(AXreg+1)
                      03437                 MOVE    EtrimLast,BXreg
00392E C??? F???          M                 MOVFF   EtrimLast,BXreg
003932 C??? F???          M                 MOVFF   (EtrimLast+1),(BXreg+1)
003936 EC?? F???      03438                 CALL    UpdateLast
00393A 68E8           03439                 SETF    WREG
00393C B0D8           03440                 BTFSC   ALUSTA,C
00393E CFE8 F???      03441                 MOVFF   WREG,TrimBeepSignChange
                      03442                 MOVE    BXreg,EtrimLast
003942 C??? F???          M                 MOVFF   BXreg,EtrimLast
003946 C??? F???          M                 MOVFF   (BXreg+1),(EtrimLast+1)
                      03443         ; Rudder
                      03444                 MOVE    DTrud,BXreg                     ; in case its a digital trim
00394A C??? F???          M                 MOVFF   DTrud,BXreg
00394E C??? F???          M                 MOVFF   (DTrud+1),(BXreg+1)
003952 01??           03445                 MOVLR   HIGH RudTrimCh
003954 5000           03446                 MOVFP   RudTrimCh,WREG
003956 EC?? F???      03447                 CALL    SelectTrim                      ; Loads BXreg with trim value
                      03448                 MOVE    BXreg,AXreg
00395A C??? F???          M                 MOVFF   BXreg,AXreg
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 221


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

00395E C??? F???          M                 MOVFF   (BXreg+1),(AXreg+1)
                      03449                 MOVE    RtrimLast,BXreg
003962 C??? F???          M                 MOVFF   RtrimLast,BXreg
003966 C??? F???          M                 MOVFF   (RtrimLast+1),(BXreg+1)
00396A EC?? F???      03450                 CALL    UpdateLast
00396E 68E8           03451                 SETF    WREG
003970 B0D8           03452                 BTFSC   ALUSTA,C
003972 CFE8 F???      03453                 MOVFF   WREG,TrimBeepSignChange
                      03454                 MOVE    BXreg,RtrimLast         
003976 C??? F???          M                 MOVFF   BXreg,RtrimLast
00397A C??? F???          M                 MOVFF   (BXreg+1),(RtrimLast+1)
00397E                03455 ULP0
                      03456         ; Test enable flag and bypass the test is not set
00397E C??? FFE8      03457                 MOVFF   ThtTCenterBeepFlag,WREG
003982 1EE8           03458                 COMF    WREG
003984 66E8           03459                 TSTFSZ  WREG
003986 EF?? F???      03460                 GOTO    ULP1
                      03461         ; Throttle
                      03462                 MOVE    DTtht,BXreg                     ; in case its a digital trim
00398A C??? F???          M                 MOVFF   DTtht,BXreg
00398E C??? F???          M                 MOVFF   (DTtht+1),(BXreg+1)
003992 01??           03463                 MOVLR   HIGH ThtTrimCh
003994 5000           03464                 MOVFP   ThtTrimCh,WREG
003996 EC?? F???      03465                 CALL    SelectTrim                      ; Loads BXreg with trim value
                      03466                 MOVE    BXreg,AXreg
00399A C??? F???          M                 MOVFF   BXreg,AXreg
00399E C??? F???          M                 MOVFF   (BXreg+1),(AXreg+1)
                      03467                 MOVE    TtrimLast,BXreg
0039A2 C??? F???          M                 MOVFF   TtrimLast,BXreg
0039A6 C??? F???          M                 MOVFF   (TtrimLast+1),(BXreg+1)
0039AA EC?? F???      03468                 CALL    UpdateLast
0039AE 68E8           03469                 SETF    WREG
0039B0 B0D8           03470                 BTFSC   ALUSTA,C
0039B2 CFE8 F???      03471                 MOVFF   WREG,TrimBeepSignChange
                      03472                 MOVE    BXreg,TtrimLast         
0039B6 C??? F???          M                 MOVFF   BXreg,TtrimLast
0039BA C??? F???          M                 MOVFF   (BXreg+1),(TtrimLast+1)
0039BE                03473 ULP1
                      03474         ; Test enable flag and bypass the test is not set
0039BE C??? FFE8      03475                 MOVFF   CH67CenterBeepFlag,WREG
0039C2 1EE8           03476                 COMF    WREG
0039C4 66E8           03477                 TSTFSZ  WREG
0039C6 0012           03478                 RETURN
                      03479         ; CH6
                      03480                 MOVE    CH6pos,AXreg
0039C8 C??? F???          M                 MOVFF   CH6pos,AXreg
0039CC C??? F???          M                 MOVFF   (CH6pos+1),(AXreg+1)
                      03481                 MOVE    CH6Last,BXreg
0039D0 C??? F???          M                 MOVFF   CH6Last,BXreg
0039D4 C??? F???          M                 MOVFF   (CH6Last+1),(BXreg+1)
0039D8 EC?? F???      03482                 CALL    UpdateLast
0039DC 68E8           03483                 SETF    WREG
0039DE B0D8           03484                 BTFSC   ALUSTA,C
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 222


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

0039E0 CFE8 F???      03485                 MOVFF   WREG,TrimBeepSignChange
                      03486                 MOVE    BXreg,CH6Last           
0039E4 C??? F???          M                 MOVFF   BXreg,CH6Last
0039E8 C??? F???          M                 MOVFF   (BXreg+1),(CH6Last+1)
                      03487         ; CH7
                      03488                 MOVE    CH7pos,AXreg
0039EC C??? F???          M                 MOVFF   CH7pos,AXreg
0039F0 C??? F???          M                 MOVFF   (CH7pos+1),(AXreg+1)
                      03489                 MOVE    CH7Last,BXreg
0039F4 C??? F???          M                 MOVFF   CH7Last,BXreg
0039F8 C??? F???          M                 MOVFF   (CH7Last+1),(BXreg+1)
0039FC EC?? F???      03490                 CALL    UpdateLast
003A00 68E8           03491                 SETF    WREG
003A02 B0D8           03492                 BTFSC   ALUSTA,C
003A04 CFE8 F???      03493                 MOVFF   WREG,TrimBeepSignChange
                      03494                 MOVE    BXreg,CH7Last           
003A08 C??? F???          M                 MOVFF   BXreg,CH7Last
003A0C C??? F???          M                 MOVFF   (BXreg+1),(CH7Last+1)
003A10 0012           03495                 RETURN
                      03496                 
                      03497 ; This funcion will update the last values for the beep function. The last
                      03498 ; values are set to the current values if they have changed by a minimun 
                      03499 ; amount. This is to keep the beep function from going off all the time if the 
                      03500 ; Trim is sitting on zero.
                      03501 ; On call
                      03502 ;       AXreg = Current trim position
                      03503 ;       BXreg = Last trim position
                      03504 ;       CXreg is used
                      03505 ; On return
                      03506 ;       BXrex = New last position value
                      03507 ;       The carry flag is set if the last value is updated and its sign changed
003A12                03508 UpdateLast
                      03509         ; Subtract the trim from the last value
                      03510                 MOVE    AXreg,CXreg
003A12 C??? F???          M                 MOVFF   AXreg,CXreg
003A16 C??? F???          M                 MOVFF   (AXreg+1),(CXreg+1)
003A1A 01??           03511                 MOVLR   HIGH CXreg
003A1C C??? FFE8      03512                 MOVFF   BXreg,WREG
003A20 5E??           03513                 SUBWF   CXreg
003A22 C??? FFE8      03514                 MOVFF   BXreg+1,WREG
003A26 5A??           03515                 SUBWFB  CXreg+1
                      03516                 ; determine the absolute value
003A28 AE??           03517                 BTFSS   CXreg+1,7
003A2A EF?? F???      03518                 GOTO    UL1
003A2E 1E??           03519                 COMF    CXreg
003A30 1E??           03520                 COMF    CXreg+1
003A32 2A??           03521                 INCF    CXreg
003A34 B4D8           03522                 BTFSC   ALUSTA,Z
003A36 2A??           03523                 INCF    CXreg+1
003A38                03524 UL1
                      03525                 ; Divide by 32
003A38 90D8           03526                 BCF     ALUSTA,C
003A3A 32??           03527                 RRCF    CXreg+1
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 223


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

003A3C 32??           03528                 RRCF    CXreg
003A3E 90D8           03529                 BCF     ALUSTA,C
003A40 32??           03530                 RRCF    CXreg+1
003A42 32??           03531                 RRCF    CXreg
003A44 90D8           03532                 BCF     ALUSTA,C
003A46 32??           03533                 RRCF    CXreg+1
003A48 32??           03534                 RRCF    CXreg
003A4A 90D8           03535                 BCF     ALUSTA,C
003A4C 32??           03536                 RRCF    CXreg+1
003A4E 32??           03537                 RRCF    CXreg
003A50 90D8           03538                 BCF     ALUSTA,C
003A52 32??           03539                 RRCF    CXreg+1
003A54 32??           03540                 RRCF    CXreg
                      03541                 ; If CXreg is zero then change is too small to update the last value
003A56 C??? FFE8      03542                 MOVFF   CXreg,WREG
003A5A 12??           03543                 IORWF   CXreg+1
003A5C 90D8           03544                 BCF     ALUSTA,C
003A5E B4D8           03545                 BTFSC   ALUSTA,Z
003A60 0012           03546                 RETURN
                      03547                 ; If the sign changed then set the carry flag
003A62 C??? FFE8      03548                 MOVFF   AXreg+1,WREG
003A66 18??           03549                 XORWF   BXreg+1,W
003A68 36E8           03550                 RLCF    WREG
                      03551                 ; Move current position to last
                      03552                 MOVE    AXreg,BXreg
003A6A C??? F???          M                 MOVFF   AXreg,BXreg
003A6E C??? F???          M                 MOVFF   (AXreg+1),(BXreg+1)
003A72 0012           03553                 RETURN
                      03554 
                      03555 ; This function is called to apply the trim position information to the
                      03556 ; normalized final channel position.
003A74                03557 ApplyTrims
                      03558         ; Aielron
                      03559                 MOVE    DTail,BXreg                     ; in case its a digital trim
003A74 C??? F???          M                 MOVFF   DTail,BXreg
003A78 C??? F???          M                 MOVFF   (DTail+1),(BXreg+1)
003A7C 01??           03560                 MOVLR   HIGH AilTrimCh
003A7E 5000           03561                 MOVFP   AilTrimCh,WREG
003A80 EC?? F???      03562                 CALL    SelectTrim                      ; Loads BXreg with trim value
                      03563                 ; Now add the trim zero values...
003A84 01??           03564                 MOVLR   HIGH TrimZeroAil
003A86 5000           03565                 MOVFP   TrimZeroAil,WREG
003A88 01??           03566                 MOVLR   HIGH BXreg
003A8A 26??           03567                 ADDWF   BXreg
003A8C 01??           03568                 MOVLR   HIGH TrimZeroAil
003A8E 5000           03569                 MOVFP   TrimZeroAil+1,WREG
003A90 01??           03570                 MOVLR   HIGH BXreg
003A92 22??           03571                 ADDWFC  BXreg+1
                      03572                 ; 
                      03573                 MOVE    APT,AXreg
003A94 C??? F???          M                 MOVFF   APT,AXreg
003A98 C??? F???          M                 MOVFF   (APT+1),(AXreg+1)
003A9C 01??           03574                 MOVLR   HIGH AXreg
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 224


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

003A9E 6A??           03575                 CLRF    AXreg+1
003AA0 0EFF           03576                 MOVLW   0FF
003AA2 BE??           03577                 BTFSC   AXreg,7
003AA4 6E??           03578                 MOVWF   AXreg+1
003AA6 EC?? F???      03579                 CALL    Mult1616
003AAA 01??           03580                 MOVLR   HIGH DEXreg
003AAC 0E64           03581                 MOVLW   D'100'
003AAE 6E??           03582                 MOVWF   DEXreg
003AB0 6A??           03583                 CLRF    DEXreg+1
003AB2 6A??           03584                 CLRF    DEXreg+2
003AB4 6A??           03585                 CLRF    DEXreg+3
003AB6 EC?? F???      03586                 CALL    Divide2416
003ABA 01??           03587                 MOVLR   HIGH CEXreg
                      03588                 ; Autotrim...
003ABC 01??           03589                 MOVLR   HIGH AAT
003ABE 5000           03590                 MOVFP   AAT,WREG
003AC0 01??           03591                 MOVLR   HIGH AXreg
003AC2 6E??           03592                 MOVWF   AXreg
003AC4 6A??           03593                 CLRF    AXreg+1
003AC6 BE??           03594                 BTFSC   AXreg,7
003AC8 1E??           03595                 COMF    AXreg+1
003ACA 36??           03596                 RLCF    AXreg                           ; Multiply by 2
003ACC 36??           03597                 RLCF    AXreg+1
003ACE 5000           03598                 MOVFP   AXreg,WREG
003AD0 26??           03599                 ADDWF   CEXreg,F
003AD2 5000           03600                 MOVFP   AXreg+1,WREG
003AD4 22??           03601                 ADDWFC  CEXreg+1,F
                      03602                 ; End Autotrim...
003AD6 5000           03603                 MOVFP   CEXreg,WREG
003AD8 26??           03604                 ADDWF   Apos,F
003ADA 5000           03605                 MOVFP   CEXreg+1,WREG
003ADC 22??           03606                 ADDWFC  Apos+1,F
                      03607         ; Elevator
                      03608                 MOVE    DTele,BXreg                     ; in case its a digital trim
003ADE C??? F???          M                 MOVFF   DTele,BXreg
003AE2 C??? F???          M                 MOVFF   (DTele+1),(BXreg+1)
003AE6 01??           03609                 MOVLR   HIGH EleTrimCh
003AE8 5000           03610                 MOVFP   EleTrimCh,WREG
003AEA EC?? F???      03611                 CALL    SelectTrim
                      03612                 ; Now add the trim zero values...
003AEE 01??           03613                 MOVLR   HIGH TrimZeroEle
003AF0 5000           03614                 MOVFP   TrimZeroEle,WREG
003AF2 01??           03615                 MOVLR   HIGH BXreg
003AF4 26??           03616                 ADDWF   BXreg
003AF6 01??           03617                 MOVLR   HIGH TrimZeroEle
003AF8 5000           03618                 MOVFP   TrimZeroEle+1,WREG
003AFA 01??           03619                 MOVLR   HIGH BXreg
003AFC 22??           03620                 ADDWFC  BXreg+1
                      03621                 ; 
                      03622                 MOVE    EPT,AXreg
003AFE C??? F???          M                 MOVFF   EPT,AXreg
003B02 C??? F???          M                 MOVFF   (EPT+1),(AXreg+1)
003B06 01??           03623                 MOVLR   HIGH AXreg
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 225


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

003B08 6A??           03624                 CLRF    AXreg+1
003B0A 0EFF           03625                 MOVLW   0FF
003B0C BE??           03626                 BTFSC   AXreg,7
003B0E 6E??           03627                 MOVWF   AXreg+1
003B10 EC?? F???      03628                 CALL    Mult1616
003B14 01??           03629                 MOVLR   HIGH DEXreg
003B16 0E64           03630                 MOVLW   D'100'
003B18 6E??           03631                 MOVWF   DEXreg
003B1A 6A??           03632                 CLRF    DEXreg+1
003B1C 6A??           03633                 CLRF    DEXreg+2
003B1E 6A??           03634                 CLRF    DEXreg+3
003B20 EC?? F???      03635                 CALL    Divide2416
003B24 01??           03636                 MOVLR   HIGH CEXreg
                      03637                 ; Autotrim...
003B26 01??           03638                 MOVLR   HIGH EAT
003B28 5000           03639                 MOVFP   EAT,WREG
003B2A 01??           03640                 MOVLR   HIGH AXreg
003B2C 6E??           03641                 MOVWF   AXreg
003B2E 6A??           03642                 CLRF    AXreg+1
003B30 BE??           03643                 BTFSC   AXreg,7
003B32 1E??           03644                 COMF    AXreg+1
003B34 36??           03645                 RLCF    AXreg                   ; Multiply by 2
003B36 36??           03646                 RLCF    AXreg+1
003B38 5000           03647                 MOVFP   AXreg,WREG
003B3A 26??           03648                 ADDWF   CEXreg,F
003B3C 5000           03649                 MOVFP   AXreg+1,WREG
003B3E 22??           03650                 ADDWFC  CEXreg+1,F
                      03651                 ; End Autotrim...
003B40 5000           03652                 MOVFP   CEXreg,WREG
003B42 26??           03653                 ADDWF   Epos,F
003B44 5000           03654                 MOVFP   CEXreg+1,WREG
003B46 22??           03655                 ADDWFC  Epos+1,F
                      03656         ; Rudder
                      03657                 MOVE    DTrud,BXreg                     ; in case its a digital trim
003B48 C??? F???          M                 MOVFF   DTrud,BXreg
003B4C C??? F???          M                 MOVFF   (DTrud+1),(BXreg+1)
003B50 01??           03658                 MOVLR   HIGH RudTrimCh
003B52 5000           03659                 MOVFP   RudTrimCh,WREG
003B54 EC?? F???      03660                 CALL    SelectTrim
                      03661                 ; Now add the trim zero values...
003B58 01??           03662                 MOVLR   HIGH TrimZeroRud
003B5A 5000           03663                 MOVFP   TrimZeroRud,WREG
003B5C 01??           03664                 MOVLR   HIGH BXreg
003B5E 26??           03665                 ADDWF   BXreg
003B60 01??           03666                 MOVLR   HIGH TrimZeroRud
003B62 5000           03667                 MOVFP   TrimZeroRud+1,WREG
003B64 01??           03668                 MOVLR   HIGH BXreg
003B66 22??           03669                 ADDWFC  BXreg+1
                      03670                 ; 
                      03671                 MOVE    RPT,AXreg
003B68 C??? F???          M                 MOVFF   RPT,AXreg
003B6C C??? F???          M                 MOVFF   (RPT+1),(AXreg+1)
003B70 01??           03672                 MOVLR   HIGH AXreg
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 226


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

003B72 6A??           03673                 CLRF    AXreg+1
003B74 0EFF           03674                 MOVLW   0FF
003B76 BE??           03675                 BTFSC   AXreg,7
003B78 6E??           03676                 MOVWF   AXreg+1
003B7A EC?? F???      03677                 CALL    Mult1616
003B7E 01??           03678                 MOVLR   HIGH DEXreg
003B80 0E64           03679                 MOVLW   D'100'
003B82 6E??           03680                 MOVWF   DEXreg
003B84 6A??           03681                 CLRF    DEXreg+1
003B86 6A??           03682                 CLRF    DEXreg+2
003B88 6A??           03683                 CLRF    DEXreg+3
003B8A EC?? F???      03684                 CALL    Divide2416
003B8E 01??           03685                 MOVLR   HIGH CEXreg
                      03686                 ; Autotrim...
003B90 01??           03687                 MOVLR   HIGH RAT
003B92 5000           03688                 MOVFP   RAT,WREG
003B94 01??           03689                 MOVLR   HIGH AXreg
003B96 6E??           03690                 MOVWF   AXreg
003B98 6A??           03691                 CLRF    AXreg+1
003B9A BE??           03692                 BTFSC   AXreg,7
003B9C 1E??           03693                 COMF    AXreg+1
003B9E 36??           03694                 RLCF    AXreg                   ; Multiply by 2
003BA0 36??           03695                 RLCF    AXreg+1
003BA2 5000           03696                 MOVFP   AXreg,WREG
003BA4 26??           03697                 ADDWF   CEXreg,F
003BA6 5000           03698                 MOVFP   AXreg+1,WREG
003BA8 22??           03699                 ADDWFC  CEXreg+1,F
                      03700                 ; End Autotrim...
003BAA 5000           03701                 MOVFP   CEXreg,WREG
003BAC 26??           03702                 ADDWF   Rpos,F
003BAE 5000           03703                 MOVFP   CEXreg+1,WREG
003BB0 22??           03704                 ADDWFC  Rpos+1,F
                      03705         ; Throttle, TMODE control out this trim is applied
                      03706         ; 0 = normal
                      03707         ; 1 = trim at low throttle only
                      03708         ; 2 = trim at high throttle only
                      03709                 ; First calculate the trim...
                      03710                 MOVE    DTtht,BXreg                     ; in case its a digital trim
003BB2 C??? F???          M                 MOVFF   DTtht,BXreg
003BB6 C??? F???          M                 MOVFF   (DTtht+1),(BXreg+1)
003BBA 01??           03711                 MOVLR   HIGH ThtTrimCh
003BBC 5000           03712                 MOVFP   ThtTrimCh,WREG
003BBE EC?? F???      03713                 CALL    SelectTrim
                      03714                 MOVE    TPT,AXreg
003BC2 C??? F???          M                 MOVFF   TPT,AXreg
003BC6 C??? F???          M                 MOVFF   (TPT+1),(AXreg+1)
003BCA 01??           03715                 MOVLR   HIGH AXreg
003BCC 6A??           03716                 CLRF    AXreg+1
003BCE 0EFF           03717                 MOVLW   0FF
003BD0 BE??           03718                 BTFSC   AXreg,7
003BD2 6E??           03719                 MOVWF   AXreg+1
003BD4 EC?? F???      03720                 CALL    Mult1616
003BD8 01??           03721                 MOVLR   HIGH DEXreg
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 227


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

003BDA 0E64           03722                 MOVLW   D'100'
003BDC 6E??           03723                 MOVWF   DEXreg
003BDE 6A??           03724                 CLRF    DEXreg+1
003BE0 6A??           03725                 CLRF    DEXreg+2
003BE2 6A??           03726                 CLRF    DEXreg+3
003BE4 EC?? F???      03727                 CALL    Divide2416      ; Trim is now in CEXreg
                      03728                 ; Test the trim mode
003BE8 01??           03729                 MOVLR   HIGH TMODE
003BEA 0E01           03730                 MOVLW   1
003BEC 62??           03731                 CPFSEQ  TMODE
003BEE EF?? F???      03732                 GOTO    AT1
                      03733                 ; Here for mode 1, trim at low
003BF2 01??           03734                 MOVLR   HIGH AXreg
003BF4 0E03           03735                 MOVLW   HIGH D'1000'
003BF6 6E??           03736                 MOVWF   AXreg+1
003BF8 6E??           03737                 MOVWF   DEXreg+1
003BFA 0EE8           03738                 MOVLW   LOW D'1000'
003BFC 6E??           03739                 MOVWF   AXreg
003BFE 6E??           03740                 MOVWF   DEXreg
003C00 5000           03741                 MOVFP   Tpos,WREG
003C02 5E??           03742                 SUBWF   AXreg,F
003C04 5000           03743                 MOVFP   Tpos+1,WREG
003C06 5A??           03744                 SUBWFB  AXreg+1,F
003C08 6A??           03745                 CLRF    DEXreg+2
003C0A 6A??           03746                 CLRF    DEXreg+3
                      03747                 MOVE    CEXreg,BXreg
003C0C C??? F???          M                 MOVFF   CEXreg,BXreg
003C10 C??? F???          M                 MOVFF   (CEXreg+1),(BXreg+1)
003C14 EC?? F???      03748                 CALL    Mult1616
003C18 EC?? F???      03749                 CALL    Divide2416              
003C1C EF?? F???      03750                 GOTO    AT2
003C20                03751 AT1
003C20 0E02           03752                 MOVLW   2
003C22 62??           03753                 CPFSEQ  TMODE
003C24 EF?? F???      03754                 GOTO    AT2
                      03755                 ; Here for mode 2, trim at high
003C28 01??           03756                 MOVLR   HIGH AXreg
003C2A 5000           03757                 MOVFP   Tpos,WREG
003C2C 6E??           03758                 MOVWF   AXreg
003C2E 5000           03759                 MOVFP   Tpos+1,WREG
003C30 6E??           03760                 MOVWF   AXreg+1
                      03761                 MOVE    CEXreg,BXreg
003C32 C??? F???          M                 MOVFF   CEXreg,BXreg
003C36 C??? F???          M                 MOVFF   (CEXreg+1),(BXreg+1)
003C3A EC?? F???      03762                 CALL    Mult1616
003C3E 01??           03763                 MOVLR   HIGH DEXreg
003C40 0E03           03764                 MOVLW   HIGH D'1000'
003C42 CFE8 F???      03765                 MOVPF   WREG,DEXreg+1
003C46 0EE8           03766                 MOVLW   LOW D'1000'
003C48 CFE8 F???      03767                 MOVPF   WREG,DEXreg
003C4C 6A??           03768                 CLRF    DEXreg+2
003C4E 6A??           03769                 CLRF    DEXreg+3
003C50 EC?? F???      03770                 CALL    Divide2416              
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 228


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

003C54                03771 AT2             ; Apply the trim to the throttle position
003C54 01??           03772                 MOVLR   HIGH CEXreg
003C56 5000           03773                 MOVFP   CEXreg,WREG
003C58 26??           03774                 ADDWF   Tpos,F
003C5A 5000           03775                 MOVFP   CEXreg+1,WREG
003C5C 22??           03776                 ADDWFC  Tpos+1,F
003C5E 0012           03777                 RETURN
                      03778                 
003C60                03779 ApplySubTrims
                      03780         ; Add all the sub trim values to the position data
                      03781                 ; Aileron sub trim
003C60 01??           03782                 MOVLB   HIGH AXreg
003C62 6A??           03783                 CLRF    AXreg+1
003C64 C??? F???      03784                 MOVFF   SubTrim,AXreg
003C68 BE??           03785                 BTFSC   AXreg,7
003C6A 68??           03786                 SETF    AXreg+1
                      03787                 MOVEC   D'10',BXreg
003C6C 01??               M                 MOVLR   HIGH (BXreg)
003C6E 0E0A               M                 MOVLW   LOW (D'10')
003C70 6E??               M                 MOVWF   (BXreg)
003C72 0E00               M                 MOVLW   HIGH (D'10')
003C74 6E??               M                 MOVWF   (BXreg+1)
003C76 EC?? F???      03788                 CALL    Mult1616
003C7A 5000           03789                 MOVFP   CEXreg,WREG
003C7C 26??           03790                 ADDWF   Apos,F
003C7E 5000           03791                 MOVFP   CEXreg+1,WREG
003C80 22??           03792                 ADDWFC  Apos+1,F
                      03793                 ; Elevator sub trim
003C82 01??           03794                 MOVLB   HIGH AXreg
003C84 6A??           03795                 CLRF    AXreg+1
003C86 C??? F???      03796                 MOVFF   SubTrim+1,AXreg
003C8A BE??           03797                 BTFSC   AXreg,7
003C8C 68??           03798                 SETF    AXreg+1
                      03799                 MOVEC   D'10',BXreg
003C8E 01??               M                 MOVLR   HIGH (BXreg)
003C90 0E0A               M                 MOVLW   LOW (D'10')
003C92 6E??               M                 MOVWF   (BXreg)
003C94 0E00               M                 MOVLW   HIGH (D'10')
003C96 6E??               M                 MOVWF   (BXreg+1)
003C98 EC?? F???      03800                 CALL    Mult1616
003C9C 5000           03801                 MOVFP   CEXreg,WREG
003C9E 26??           03802                 ADDWF   Epos,F
003CA0 5000           03803                 MOVFP   CEXreg+1,WREG
003CA2 22??           03804                 ADDWFC  Epos+1,F
                      03805                 ; Rudder sub trim
003CA4 01??           03806                 MOVLB   HIGH AXreg
003CA6 6A??           03807                 CLRF    AXreg+1
003CA8 C??? F???      03808                 MOVFF   SubTrim+2,AXreg
003CAC BE??           03809                 BTFSC   AXreg,7
003CAE 68??           03810                 SETF    AXreg+1
                      03811                 MOVEC   D'10',BXreg
003CB0 01??               M                 MOVLR   HIGH (BXreg)
003CB2 0E0A               M                 MOVLW   LOW (D'10')
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 229


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

003CB4 6E??               M                 MOVWF   (BXreg)
003CB6 0E00               M                 MOVLW   HIGH (D'10')
003CB8 6E??               M                 MOVWF   (BXreg+1)
003CBA EC?? F???      03812                 CALL    Mult1616
003CBE 5000           03813                 MOVFP   CEXreg,WREG
003CC0 26??           03814                 ADDWF   Rpos,F
003CC2 5000           03815                 MOVFP   CEXreg+1,WREG
003CC4 22??           03816                 ADDWFC  Rpos+1,F
                      03817                 ; Throttle sub trim
003CC6 01??           03818                 MOVLB   HIGH AXreg
003CC8 6A??           03819                 CLRF    AXreg+1
003CCA C??? F???      03820                 MOVFF   SubTrim+3,AXreg
003CCE BE??           03821                 BTFSC   AXreg,7
003CD0 68??           03822                 SETF    AXreg+1
                      03823                 MOVEC   D'10',BXreg
003CD2 01??               M                 MOVLR   HIGH (BXreg)
003CD4 0E0A               M                 MOVLW   LOW (D'10')
003CD6 6E??               M                 MOVWF   (BXreg)
003CD8 0E00               M                 MOVLW   HIGH (D'10')
003CDA 6E??               M                 MOVWF   (BXreg+1)
003CDC EC?? F???      03824                 CALL    Mult1616
003CE0 5000           03825                 MOVFP   CEXreg,WREG
003CE2 26??           03826                 ADDWF   Tpos,F
003CE4 5000           03827                 MOVFP   CEXreg+1,WREG
003CE6 22??           03828                 ADDWFC  Tpos+1,F
                      03829                 ; CH5 sub trim
003CE8 01??           03830                 MOVLB   HIGH AXreg
003CEA 6A??           03831                 CLRF    AXreg+1
003CEC C??? F???      03832                 MOVFF   SubTrim+4,AXreg
003CF0 BE??           03833                 BTFSC   AXreg,7
003CF2 68??           03834                 SETF    AXreg+1
                      03835                 MOVEC   D'10',BXreg
003CF4 01??               M                 MOVLR   HIGH (BXreg)
003CF6 0E0A               M                 MOVLW   LOW (D'10')
003CF8 6E??               M                 MOVWF   (BXreg)
003CFA 0E00               M                 MOVLW   HIGH (D'10')
003CFC 6E??               M                 MOVWF   (BXreg+1)
003CFE EC?? F???      03836                 CALL    Mult1616
003D02 5000           03837                 MOVFP   CEXreg,WREG
003D04 26??           03838                 ADDWF   CH5pos,F
003D06 5000           03839                 MOVFP   CEXreg+1,WREG
003D08 22??           03840                 ADDWFC  CH5pos+1,F
                      03841                 ; CH6 sub trim
003D0A 01??           03842                 MOVLB   HIGH AXreg
003D0C 6A??           03843                 CLRF    AXreg+1
003D0E C??? F???      03844                 MOVFF   SubTrim+5,AXreg
003D12 BE??           03845                 BTFSC   AXreg,7
003D14 68??           03846                 SETF    AXreg+1
                      03847                 MOVEC   D'10',BXreg
003D16 01??               M                 MOVLR   HIGH (BXreg)
003D18 0E0A               M                 MOVLW   LOW (D'10')
003D1A 6E??               M                 MOVWF   (BXreg)
003D1C 0E00               M                 MOVLW   HIGH (D'10')
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 230


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

003D1E 6E??               M                 MOVWF   (BXreg+1)
003D20 EC?? F???      03848                 CALL    Mult1616
003D24 5000           03849                 MOVFP   CEXreg,WREG
003D26 26??           03850                 ADDWF   CH6pos,F
003D28 5000           03851                 MOVFP   CEXreg+1,WREG
003D2A 22??           03852                 ADDWFC  CH6pos+1,F
                      03853                 ; CH7 sub trim
003D2C 01??           03854                 MOVLB   HIGH AXreg
003D2E 6A??           03855                 CLRF    AXreg+1
003D30 C??? F???      03856                 MOVFF   SubTrim+6,AXreg
003D34 BE??           03857                 BTFSC   AXreg,7
003D36 68??           03858                 SETF    AXreg+1
                      03859                 MOVEC   D'10',BXreg
003D38 01??               M                 MOVLR   HIGH (BXreg)
003D3A 0E0A               M                 MOVLW   LOW (D'10')
003D3C 6E??               M                 MOVWF   (BXreg)
003D3E 0E00               M                 MOVLW   HIGH (D'10')
003D40 6E??               M                 MOVWF   (BXreg+1)
003D42 EC?? F???      03860                 CALL    Mult1616
003D46 5000           03861                 MOVFP   CEXreg,WREG
003D48 26??           03862                 ADDWF   CH7pos,F
003D4A 5000           03863                 MOVFP   CEXreg+1,WREG
003D4C 22??           03864                 ADDWFC  CH7pos+1,F
                      03865                 ; CH8 sub trim
003D4E 01??           03866                 MOVLB   HIGH AXreg
003D50 6A??           03867                 CLRF    AXreg+1
003D52 C??? F???      03868                 MOVFF   SubTrim+7,AXreg
003D56 BE??           03869                 BTFSC   AXreg,7
003D58 68??           03870                 SETF    AXreg+1
                      03871                 MOVEC   D'10',BXreg
003D5A 01??               M                 MOVLR   HIGH (BXreg)
003D5C 0E0A               M                 MOVLW   LOW (D'10')
003D5E 6E??               M                 MOVWF   (BXreg)
003D60 0E00               M                 MOVLW   HIGH (D'10')
003D62 6E??               M                 MOVWF   (BXreg+1)
003D64 EC?? F???      03872                 CALL    Mult1616
003D68 5000           03873                 MOVFP   CEXreg,WREG
003D6A 26??           03874                 ADDWF   CH8pos,F
003D6C 5000           03875                 MOVFP   CEXreg+1,WREG
003D6E 22??           03876                 ADDWFC  CH8pos+1,F
003D70 0012           03877                 RETURN
                      03878 
                      03879 ; This function applies the right and left snap switch. The snap position is
                      03880 ; added to the current servo position for A,E, and R. Throttle is set. In all
                      03881 ; cases the channel is changed only if the enable flag is set.
003D72                03882 ApplySnap
                      03883                 MOVEC   D'10',AXreg
003D72 01??               M                 MOVLR   HIGH (AXreg)
003D74 0E0A               M                 MOVLW   LOW (D'10')
003D76 6E??               M                 MOVWF   (AXreg)
003D78 0E00               M                 MOVLW   HIGH (D'10')
003D7A 6E??               M                 MOVWF   (AXreg+1)
                      03884         ; Snap right
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 231


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      03885         ; Test the right snap button
003D7C 01??           03886                 MOVLR   HIGH SWSNAPR
003D7E 5000           03887                 MOVFP   SWSNAPR,WREG
003D80 EC?? F???      03888                 CALL    SwitchTest
003D84 A0D8           03889                 BTFSS   ALUSTA,C
003D86 EF?? F???      03890                 GOTO    AS10
                      03891                 ; If the MSB is clear then set the servo position
003D8A 01??           03892                 MOVLR   HIGH SR_A
003D8C AE??           03893                 BTFSS   SR_A+1,7
003D8E EF?? F???      03894                 GOTO    AS9a
                      03895                 MOVEB   SR_A,BXreg
003D92 C??? F???          M                 MOVFF   SR_A,BXreg
003D96 6A??           03896                 CLRF    BXreg+1
003D98 BE??           03897                 BTFSC   BXreg,7
003D9A 68??           03898                 SETF    BXreg+1
003D9C EC?? F???      03899                 CALL    Mult1616
003DA0 01??           03900                 MOVLR   HIGH Apos
003DA2 C??? FFE8      03901                 MOVFF   CEXreg,WREG
003DA6 26??           03902                 ADDWF   Apos
003DA8 C??? FFE8      03903                 MOVFF   CEXreg+1,WREG
003DAC 22??           03904                 ADDWFC  Apos+1
003DAE                03905 AS9a            
003DAE 01??           03906                 MOVLR   HIGH SR_E
003DB0 AE??           03907                 BTFSS   SR_E+1,7
003DB2 EF?? F???      03908                 GOTO    AS9b
                      03909                 MOVEB   SR_E,BXreg
003DB6 C??? F???          M                 MOVFF   SR_E,BXreg
003DBA 6A??           03910                 CLRF    BXreg+1
003DBC BE??           03911                 BTFSC   BXreg,7
003DBE 68??           03912                 SETF    BXreg+1
003DC0 EC?? F???      03913                 CALL    Mult1616
003DC4 01??           03914                 MOVLR   HIGH Epos
003DC6 C??? FFE8      03915                 MOVFF   CEXreg,WREG
003DCA 26??           03916                 ADDWF   Epos
003DCC C??? FFE8      03917                 MOVFF   CEXreg+1,WREG
003DD0 22??           03918                 ADDWFC  Epos+1
003DD2                03919 AS9b            
003DD2 01??           03920                 MOVLR   HIGH SR_R
003DD4 AE??           03921                 BTFSS   SR_R+1,7
003DD6 EF?? F???      03922                 GOTO    AS9c
                      03923                 MOVEB   SR_R,BXreg
003DDA C??? F???          M                 MOVFF   SR_R,BXreg
003DDE 6A??           03924                 CLRF    BXreg+1
003DE0 BE??           03925                 BTFSC   BXreg,7
003DE2 68??           03926                 SETF    BXreg+1
003DE4 EC?? F???      03927                 CALL    Mult1616
003DE8 01??           03928                 MOVLR   HIGH Rpos
003DEA C??? FFE8      03929                 MOVFF   CEXreg,WREG
003DEE 26??           03930                 ADDWF   Rpos
003DF0 C??? FFE8      03931                 MOVFF   CEXreg+1,WREG
003DF4 22??           03932                 ADDWFC  Rpos+1
003DF6                03933 AS9c            
003DF6 01??           03934                 MOVLR   HIGH SR_T
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 232


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

003DF8 AE??           03935                 BTFSS   SR_T+1,7
003DFA EF?? F???      03936                 GOTO    AS10
                      03937                 MOVEB   SR_T,BXreg
003DFE C??? F???          M                 MOVFF   SR_T,BXreg
003E02 6A??           03938                 CLRF    BXreg+1
003E04 BE??           03939                 BTFSC   BXreg,7
003E06 68??           03940                 SETF    BXreg+1
003E08 EC?? F???      03941                 CALL    Mult1616
                      03942                 MOVE    CEXreg,Tpos             
003E0C C??? F???          M                 MOVFF   CEXreg,Tpos
003E10 C??? F???          M                 MOVFF   (CEXreg+1),(Tpos+1)
003E14                03943 AS10
                      03944         ;  Snap left
003E14 01??           03945                 MOVLR   HIGH SWSNAPL
003E16 5000           03946                 MOVFP   SWSNAPL,WREG
003E18 EC?? F???      03947                 CALL    SwitchTest
003E1C A0D8           03948                 BTFSS   ALUSTA,C
003E1E EF?? F???      03949                 GOTO    AS11
                      03950                 ; If the MSB is clear then set the servo position
003E22 01??           03951                 MOVLR   HIGH SL_A
003E24 AE??           03952                 BTFSS   SL_A+1,7
003E26 EF?? F???      03953                 GOTO    AS10a
                      03954                 MOVEB   SL_A,BXreg
003E2A C??? F???          M                 MOVFF   SL_A,BXreg
003E2E 6A??           03955                 CLRF    BXreg+1
003E30 BE??           03956                 BTFSC   BXreg,7
003E32 68??           03957                 SETF    BXreg+1
003E34 EC?? F???      03958                 CALL    Mult1616
003E38 01??           03959                 MOVLR   HIGH Apos
003E3A C??? FFE8      03960                 MOVFF   CEXreg,WREG
003E3E 26??           03961                 ADDWF   Apos
003E40 C??? FFE8      03962                 MOVFF   CEXreg+1,WREG
003E44 22??           03963                 ADDWFC  Apos+1
003E46                03964 AS10a           
003E46 01??           03965                 MOVLR   HIGH SL_E
003E48 AE??           03966                 BTFSS   SL_E+1,7
003E4A EF?? F???      03967                 GOTO    AS10b
                      03968                 MOVEB   SL_E,BXreg
003E4E C??? F???          M                 MOVFF   SL_E,BXreg
003E52 6A??           03969                 CLRF    BXreg+1
003E54 BE??           03970                 BTFSC   BXreg,7
003E56 68??           03971                 SETF    BXreg+1
003E58 EC?? F???      03972                 CALL    Mult1616
003E5C 01??           03973                 MOVLR   HIGH Epos
003E5E C??? FFE8      03974                 MOVFF   CEXreg,WREG
003E62 26??           03975                 ADDWF   Epos
003E64 C??? FFE8      03976                 MOVFF   CEXreg+1,WREG
003E68 22??           03977                 ADDWFC  Epos+1
003E6A                03978 AS10b           
003E6A 01??           03979                 MOVLR   HIGH SL_R
003E6C AE??           03980                 BTFSS   SL_R+1,7
003E6E EF?? F???      03981                 GOTO    AS10c
                      03982                 MOVEB   SL_R,BXreg
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 233


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

003E72 C??? F???          M                 MOVFF   SL_R,BXreg
003E76 6A??           03983                 CLRF    BXreg+1
003E78 BE??           03984                 BTFSC   BXreg,7
003E7A 68??           03985                 SETF    BXreg+1
003E7C EC?? F???      03986                 CALL    Mult1616
003E80 01??           03987                 MOVLR   HIGH Rpos
003E82 C??? FFE8      03988                 MOVFF   CEXreg,WREG
003E86 26??           03989                 ADDWF   Rpos
003E88 C??? FFE8      03990                 MOVFF   CEXreg+1,WREG
003E8C 22??           03991                 ADDWFC  Rpos+1
003E8E                03992 AS10c           
003E8E 01??           03993                 MOVLR   HIGH SL_T
003E90 AE??           03994                 BTFSS   SL_T+1,7
003E92 EF?? F???      03995                 GOTO    AS11
                      03996                 MOVEB   SL_T,BXreg
003E96 C??? F???          M                 MOVFF   SL_T,BXreg
003E9A 6A??           03997                 CLRF    BXreg+1
003E9C BE??           03998                 BTFSC   BXreg,7
003E9E 68??           03999                 SETF    BXreg+1
003EA0 EC?? F???      04000                 CALL    Mult1616
                      04001                 MOVE    CEXreg,Tpos             
003EA4 C??? F???          M                 MOVFF   CEXreg,Tpos
003EA8 C??? F???          M                 MOVFF   (CEXreg+1),(Tpos+1)
003EAC                04002 AS11
                      04003         ; If Tpos is negative, set it to zero
003EAC 01??           04004                 MOVLR   HIGH Tpos
003EAE AE??           04005                 BTFSS   Tpos+1,7
003EB0 0012           04006                 RETURN
                      04007                 ; Here is Tpos is negative
003EB2 6AE8           04008                 CLRF    WREG
003EB4 6E??           04009                 MOVWF   Tpos
003EB6 6E??           04010                 MOVWF   Tpos+1
003EB8 0012           04011                 RETURN
                      04012 
                      04013 ; This function is used to slow the output channels slew rate. At this time
                      04014 ; only CH5 and CH8 can be programmed with a rate limit.
                      04015 ; The channel position variable i.e. CH5pos, is used as a setpoint and the
                      04016 ; slewed position is saved in CH5posActual. Down stream code has to be updated
                      04017 ; to use the right variable.
003EBA                04018 ApplySlewRate
                      04019         ; Peocess CH5.
                      04020         ; Determine the different between the CH5 current position and its 
                      04021         ; setpoint position
                      04022                 ; If the CH5posActual is set to C0xx then set it to CH5pos, init flag
003EBA C??? FFE8      04023                 MOVFF   CH5posActual+1,WREG
003EBE 0AC0           04024                 XORLW   0xC0                    ; test the flag
003EC0 E0??           04025                 BZ      ASR5final
                      04026                 ; AXreg = Setpoint - Actual
                      04027                 MOVE    CH5pos,AXreg
003EC2 C??? F???          M                 MOVFF   CH5pos,AXreg
003EC6 C??? F???          M                 MOVFF   (CH5pos+1),(AXreg+1)
003ECA 01??           04028                 MOVLR   HIGH AXreg
003ECC C??? FFE8      04029                 MOVFF   CH5posActual,WREG
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 234


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

003ED0 5E??           04030                 SUBWF   AXreg,F
003ED2 C??? FFE8      04031                 MOVFF   CH5posActual+1,WREG
003ED6 5A??           04032                 SUBWFB  AXreg+1,F
003ED8 BE??           04033                 BTFSC   AXreg+1,7
003EDA EF?? F???      04034                 GOTO    ASR0
                      04035                 ; Here if AXreg is positive
                      04036                 ; AXreg = AXreg - step size
003EDE C??? FFE8      04037                 MOVFF   CH5stepSize, WREG
003EE2 5E??           04038                 SUBWF   AXreg,F
003EE4 C??? FFE8      04039                 MOVFF   CH5stepSize+1, WREG
003EE8 5A??           04040                 SUBWFB  AXreg+1,F
                      04041                 ; If AXreg is negative then set the position to setpoint
003EEA BE??           04042                 BTFSC   AXreg+1,7
003EEC EF?? F???      04043                 GOTO    ASR5final
                      04044                 ; If here move actual by step size
003EF0 01??           04045                 MOVLR   HIGH CH5posActual
003EF2 C??? FFE8      04046                 MOVFF   CH5stepSize,WREG
003EF6 26??           04047                 ADDWF   CH5posActual,F
003EF8 C??? FFE8      04048                 MOVFF   CH5stepSize+1,WREG
003EFC 22??           04049                 ADDWFC  CH5posActual+1,F
003EFE EF?? F???      04050                 GOTO    ASRCH8                  ; Done, move to next channel
                      04051                 ; Here if AXreg is negative
003F02                04052 ASR0
                      04053                 ; AXreg = AXreg + step size
003F02 C??? FFE8      04054                 MOVFF   CH5stepSize, WREG
003F06 26??           04055                 ADDWF   AXreg,F
003F08 C??? FFE8      04056                 MOVFF   CH5stepSize+1, WREG
003F0C 22??           04057                 ADDWFC  AXreg+1,F
                      04058                 ; If AXreg is positive then set the position to setpoint
003F0E AE??           04059                 BTFSS   AXreg+1,7
003F10 EF?? F???      04060                 GOTO    ASR5final
                      04061                 ; If here move actual by step size
003F14 01??           04062                 MOVLR   HIGH CH5posActual
003F16 C??? FFE8      04063                 MOVFF   CH5stepSize,WREG
003F1A 5E??           04064                 SUBWF   CH5posActual,F
003F1C C??? FFE8      04065                 MOVFF   CH5stepSize+1,WREG
003F20 5A??           04066                 SUBWFB  CH5posActual+1,F
003F22 EF?? F???      04067                 GOTO    ASRCH8                  ; Done, move to next channel
                      04068                 ; Set to final position
003F26                04069 ASR5final       
                      04070                 MOVE    CH5pos, CH5posActual
003F26 C??? F???          M                 MOVFF   CH5pos,CH5posActual
003F2A C??? F???          M                 MOVFF   (CH5pos+1),(CH5posActual+1)
                      04071         ; Now process CH8
003F2E                04072 ASRCH8
                      04073                 ; If the CH8posActual is set to C0xx then set it to CH8pos, init flag
003F2E C??? FFE8      04074                 MOVFF   CH8posActual+1,WREG
003F32 0AC0           04075                 XORLW   0xC0                    ; test the flag
003F34 E0??           04076                 BZ      ASR8final
                      04077                 ; AXreg = Setpoint - Actual
                      04078                 MOVE    CH8pos,AXreg
003F36 C??? F???          M                 MOVFF   CH8pos,AXreg
003F3A C??? F???          M                 MOVFF   (CH8pos+1),(AXreg+1)
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 235


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

003F3E 01??           04079                 MOVLR   HIGH AXreg
003F40 C??? FFE8      04080                 MOVFF   CH8posActual,WREG
003F44 5E??           04081                 SUBWF   AXreg,F
003F46 C??? FFE8      04082                 MOVFF   CH8posActual+1,WREG
003F4A 5A??           04083                 SUBWFB  AXreg+1,F
003F4C BE??           04084                 BTFSC   AXreg+1,7
003F4E EF?? F???      04085                 GOTO    ASR1
                      04086                 ; Here if AXreg is positive
                      04087                 ; AXreg = AXreg - step size
003F52 C??? FFE8      04088                 MOVFF   CH8stepSize, WREG
003F56 5E??           04089                 SUBWF   AXreg,F
003F58 C??? FFE8      04090                 MOVFF   CH8stepSize+1, WREG
003F5C 5A??           04091                 SUBWFB  AXreg+1,F
                      04092                 ; If AXreg is negative then set the position to setpoint
003F5E BE??           04093                 BTFSC   AXreg+1,7
003F60 EF?? F???      04094                 GOTO    ASR8final
                      04095                 ; If here move actual by step size
003F64 01??           04096                 MOVLR   HIGH CH8posActual
003F66 C??? FFE8      04097                 MOVFF   CH8stepSize,WREG
003F6A 26??           04098                 ADDWF   CH8posActual,F
003F6C C??? FFE8      04099                 MOVFF   CH8stepSize+1,WREG
003F70 22??           04100                 ADDWFC  CH8posActual+1,F
003F72 EF?? F???      04101                 GOTO    ASRtht                  ; Done, move to next channel
                      04102                 ; Here if AXreg is negative
003F76                04103 ASR1
                      04104                 ; AXreg = AXreg + step size
003F76 C??? FFE8      04105                 MOVFF   CH8stepSize, WREG
003F7A 26??           04106                 ADDWF   AXreg,F
003F7C C??? FFE8      04107                 MOVFF   CH8stepSize+1, WREG
003F80 22??           04108                 ADDWFC  AXreg+1,F
                      04109                 ; If AXreg is positive then set the position to setpoint
003F82 AE??           04110                 BTFSS   AXreg+1,7
003F84 EF?? F???      04111                 GOTO    ASR8final
                      04112                 ; If here move actual by step size
003F88 01??           04113                 MOVLR   HIGH CH8posActual
003F8A C??? FFE8      04114                 MOVFF   CH8stepSize,WREG
003F8E 5E??           04115                 SUBWF   CH8posActual,F
003F90 C??? FFE8      04116                 MOVFF   CH8stepSize+1,WREG
003F94 5A??           04117                 SUBWFB  CH8posActual+1,F
003F96 EF?? F???      04118                 GOTO    ASRtht                  ; Done, move to next channel
                      04119                 ; Set to final position
003F9A                04120 ASR8final       
                      04121                 MOVE    CH8pos, CH8posActual
003F9A C??? F???          M                 MOVFF   CH8pos,CH8posActual
003F9E C??? F???          M                 MOVFF   (CH8pos+1),(CH8posActual+1)
                      04122         ; Thw following code processes the slew rate limit for the throttle channel,
                      04123         ; this is only used in the helicopter mode when entering and leaving the
                      04124         ; throttle hold flight mode.    
003FA2                04125 ASRtht
                      04126                 ; If the TposActual is set to C0xx then set it to Tpos, init flag
003FA2 C??? FFE8      04127                 MOVFF   TposActual+1,WREG
003FA6 0AC0           04128                 XORLW   0xC0                    ; test the flag
003FA8 E0??           04129                 BZ      ASRTfinal
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 236


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      04130                 ; AXreg = Setpoint - Actual
                      04131                 MOVE    Tpos,AXreg
003FAA C??? F???          M                 MOVFF   Tpos,AXreg
003FAE C??? F???          M                 MOVFF   (Tpos+1),(AXreg+1)
003FB2 01??           04132                 MOVLR   HIGH AXreg
003FB4 C??? FFE8      04133                 MOVFF   TposActual,WREG
003FB8 5E??           04134                 SUBWF   AXreg,F
003FBA C??? FFE8      04135                 MOVFF   TposActual+1,WREG
003FBE 5A??           04136                 SUBWFB  AXreg+1,F
003FC0 BE??           04137                 BTFSC   AXreg+1,7
003FC2 EF?? F???      04138                 GOTO    ASR2
                      04139                 ; Here if AXreg is positive
                      04140                 ; AXreg = AXreg - step size
003FC6 C??? FFE8      04141                 MOVFF   TstepSize, WREG
003FCA 5E??           04142                 SUBWF   AXreg,F
003FCC C??? FFE8      04143                 MOVFF   TstepSize+1, WREG
003FD0 5A??           04144                 SUBWFB  AXreg+1,F
                      04145                 ; If AXreg is negative then set the position to setpoint
003FD2 BE??           04146                 BTFSC   AXreg+1,7
003FD4 EF?? F???      04147                 GOTO    ASRTfinal
                      04148                 ; If here move actual by step size
003FD8 01??           04149                 MOVLR   HIGH TposActual
003FDA C??? FFE8      04150                 MOVFF   TstepSize,WREG
003FDE 26??           04151                 ADDWF   TposActual,F
003FE0 C??? FFE8      04152                 MOVFF   TstepSize+1,WREG
003FE4 22??           04153                 ADDWFC  TposActual+1,F
003FE6 EF?? F???      04154                 GOTO    ASRdone                 ; Done, move to next channel
                      04155                 ; Here if AXreg is negative
003FEA                04156 ASR2
                      04157                 ; AXreg = AXreg + step size
003FEA C??? FFE8      04158                 MOVFF   TstepSize, WREG
003FEE 26??           04159                 ADDWF   AXreg,F
003FF0 C??? FFE8      04160                 MOVFF   TstepSize+1, WREG
003FF4 22??           04161                 ADDWFC  AXreg+1,F
                      04162                 ; If AXreg is positive then set the position to setpoint
003FF6 AE??           04163                 BTFSS   AXreg+1,7
003FF8 EF?? F???      04164                 GOTO    ASRTfinal
                      04165                 ; If here move actual by step size
003FFC 01??           04166                 MOVLR   HIGH TposActual
003FFE C??? FFE8      04167                 MOVFF   TstepSize,WREG
004002 5E??           04168                 SUBWF   TposActual,F
004004 C??? FFE8      04169                 MOVFF   TstepSize+1,WREG
004008 5A??           04170                 SUBWFB  TposActual+1,F
00400A EF?? F???      04171                 GOTO    ASRdone                 ; Done, move to next channel
                      04172                 ; Set to final position
00400E                04173 ASRTfinal       
                      04174                 MOVE    Tpos, TposActual
00400E C??? F???          M                 MOVFF   Tpos,TposActual
004012 C??? F???          M                 MOVFF   (Tpos+1),(TposActual+1)
                      04175                 MOVEC   D'2000',TstepSize       ; This is a one shot function of the throttle
004016 01??               M                 MOVLR   HIGH (TstepSize)
004018 0ED0               M                 MOVLW   LOW (D'2000')
00401A 6E??               M                 MOVWF   (TstepSize)
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 237


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

00401C 0E07               M                 MOVLW   HIGH (D'2000')
00401E 6E??               M                 MOVWF   (TstepSize+1)
                      04176         ; Exit
004020                04177 ASRdone
004020 0012           04178                 RETURN
                      04179 
                      04180 ; This function perfroms the auto trim algorithm. If the autotrim
                      04181 ; buttom is pressed and one of the centering stick is not 
                      04182 ; centered then the trim position is adjusted.
                      04183 ; There are three AutoTrim modes determined by ATmode.
                      04184 ; ATmode:
                      04185 ;        0 = Standard mode, while you hold the auto trim button the
                      04186 ;            channel is moved in small increments. You can define the
                      04187 ;            increment size and time between adjustments.
                      04188 ;        1 = One shot mode, in this mode the entire adjustment is made
                      04189 ;            in one step.
                      04190 ;        2 = Off
                      04191 ; The Auto Trim function will only allow a maximum of +- 20 percent adjustment
                      04192 ; of a channels position.
                      04193 ;
                      04194 ; Note: The Auto Trim value is saved in a signed 8 bit variable so in order
                      04195 ; to get 20% range the aut trim value is doubled before its added to the
                      04196 ; channel value.
004022                04197 AutoTrim
                      04198         ; Test if the ATmode is 2, off. Exit if this is the case. This is done with a bit
                      04199         ; test because the only value values are 0,1 and 2
004022 01??           04200                 MOVLR   HIGH ATmode
004024 B2??           04201                 BTFSC   ATmode,1
004026 0012           04202                 RETURN          
                      04203         ; If we are in the master mode then exit, do not
                      04204         ; do auto trim in master mode!
004028 01??           04205                 MOVLR   HIGH Master
00402A B0??           04206                 BTFSC   Master,0
00402C 0012           04207                 RETURN
                      04208         ; Test the autotrim button
00402E 01??           04209                 MOVLR   HIGH SWATRIM
004030 5000           04210                 MOVFP   SWATRIM,WREG
004032 EC?? F???      04211                 CALL    SwitchTest
004036 A0D8           04212                 BTFSS   ALUSTA,C
004038 0012           04213                 RETURN
                      04214         ; Make sure its time...
00403A 01??           04215                 MOVLR   HIGH TimeOut2
00403C 66??           04216                 TSTFSZ  TimeOut2
00403E 0012           04217                 RETURN
004040 01??           04218                 MOVLR   HIGH AutoTrimTime
004042 5000           04219                 MOVFP   AutoTrimTime,WREG
004044 01??           04220                 MOVLR   HIGH TimeOut2
004046 6E??           04221                 MOVWF   TimeOut2
                      04222                 ; Test if this is one shot mode
004048 01??           04223                 MOVLR   HIGH ATmode
00404A 0E01           04224                 MOVLW   1
00404C 62??           04225                 CPFSEQ  ATmode
00404E EF?? F???      04226                 GOTO    AutoTrim0
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 238


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      04227                 ; Beep one time to indicate we are doing the adjustment
004052 0E01           04228                 MOVLW   D'1'  
004054 01??           04229                 MOVLR   HIGH BeepCyl
004056 6E??           04230                 MOVWF   BeepCyl
004058 0E05           04231                 MOVLW   D'5'
00405A EC?? F???      04232                 CALL    Beep
                      04233                 ; Set the one shot time, this is a fixed value
00405E 0E28           04234                 MOVLW   AutoTrimOStime  
004060 01??           04235                 MOVLR   HIGH TimeOut2
004062 6E??           04236                 MOVWF   TimeOut2
004064                04237 AutoTrim0               
                      04238         ; Aileron
                      04239                 MOVE    Apos,AXreg
004064 C??? F???          M                 MOVFF   Apos,AXreg
004068 C??? F???          M                 MOVFF   (Apos+1),(AXreg+1)
00406C EC?? F???      04240                 CALL    AutoLimit
004070 A4D8           04241                 BTFSS   ALUSTA,Z
004072 EF?? F???      04242                 GOTO    AutoTrim2
                      04243                 ; Adjust autotrim position
004076 01??           04244                 MOVLR   HIGH ATmode
004078 66??           04245                 TSTFSZ  ATmode
00407A EF?? F???      04246                 GOTO    AutoTrim1e
00407E 01??           04247                 MOVLR   HIGH AutoTrimStep
004080 5000           04248                 MOVFP   AutoTrimStep,WREG
004082 01??           04249 AutoTrim1e      MOVLR   HIGH Apos
004084 BE??           04250                 BTFSC   Apos+1,7
004086 EF?? F???      04251                 GOTO    AutoTrim1a
                      04252                 ; Here if positive
00408A 01??           04253                 MOVLR   HIGH AAT
00408C 26??           04254                 ADDWF   AAT
00408E AE??           04255                 BTFSS   AAT,7
004090 EF?? F???      04256                 GOTO    AutoTrim1c
004094 A6D8           04257                 BTFSS   ALUSTA,OV
004096 EF?? F???      04258                 GOTO    AutoTrim1c
00409A EF?? F???      04259                 GOTO    AutoTrim1plim
00409E                04260 AutoTrim1a      ; Here if negative
00409E 01??           04261                 MOVLR   HIGH AAT
0040A0 5E??           04262                 SUBWF   AAT
0040A2 BE??           04263                 BTFSC   AAT,7
0040A4 EF?? F???      04264                 GOTO    AutoTrim1c
0040A8 A6D8           04265                 BTFSS   ALUSTA,OV
0040AA EF?? F???      04266                 GOTO    AutoTrim1c
0040AE EF?? F???      04267                 GOTO    AutoTrim1b
0040B2                04268 AutoTrim1c      ; Now do the limit testing
0040B2 BE??           04269                 BTFSC   AAT,7
0040B4 EF?? F???      04270                 GOTO    AutoTrim1b
                      04271                 ; Here if positive
0040B8 0E64           04272 AutoTrim1plim   MOVLW   D'100'
0040BA 60??           04273                 CPFSLT  AAT
0040BC 6E??           04274                 MOVWF   AAT
0040BE EF?? F???      04275                 GOTO    AutoTrim1d
0040C2                04276 AutoTrim1b      ; Here if negative
0040C2 0E64           04277                 MOVLW   D'100'
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 239


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

0040C4 1EE8           04278                 COMF    WREG
0040C6 2AE8           04279                 INCF    WREG
0040C8 64??           04280                 CPFSGT  AAT
0040CA 6E??           04281                 MOVWF   AAT
                      04282                 ; Save the new value to Flash
0040CC                04283 AutoTrim1d
0040CC EC?? F???      04284                 CALL    SaveAircraftPage1
                      04285         ; Elevator
0040D0                04286 AutoTrim2
                      04287                 MOVE    Epos,AXreg
0040D0 C??? F???          M                 MOVFF   Epos,AXreg
0040D4 C??? F???          M                 MOVFF   (Epos+1),(AXreg+1)
0040D8 EC?? F???      04288                 CALL    AutoLimit
0040DC A4D8           04289                 BTFSS   ALUSTA,Z
0040DE EF?? F???      04290                 GOTO    AutoTrim3
                      04291                 ; Adjust autotrim position
0040E2 01??           04292                 MOVLR   HIGH ATmode
0040E4 66??           04293                 TSTFSZ  ATmode
0040E6 EF?? F???      04294                 GOTO    AutoTrim2e
0040EA 01??           04295                 MOVLR   HIGH AutoTrimStep
0040EC 5000           04296                 MOVFP   AutoTrimStep,WREG
0040EE 01??           04297 AutoTrim2e      MOVLR   HIGH Epos
0040F0 BE??           04298                 BTFSC   Epos+1,7
0040F2 EF?? F???      04299                 GOTO    AutoTrim2a
                      04300                 ; Here if positive
0040F6 01??           04301                 MOVLR   HIGH EAT
0040F8 26??           04302                 ADDWF   EAT
0040FA AE??           04303                 BTFSS   EAT,7
0040FC EF?? F???      04304                 GOTO    AutoTrim2c
004100 A6D8           04305                 BTFSS   ALUSTA,OV
004102 EF?? F???      04306                 GOTO    AutoTrim2c
004106 EF?? F???      04307                 GOTO    AutoTrim2plim
00410A                04308 AutoTrim2a      ; Here if negative
00410A 01??           04309                 MOVLR   HIGH EAT
00410C 5E??           04310                 SUBWF   EAT
00410E BE??           04311                 BTFSC   EAT,7
004110 EF?? F???      04312                 GOTO    AutoTrim2c
004114 A6D8           04313                 BTFSS   ALUSTA,OV
004116 EF?? F???      04314                 GOTO    AutoTrim2c
00411A EF?? F???      04315                 GOTO    AutoTrim2b
00411E                04316 AutoTrim2c      ; Now do the limit testing
00411E BE??           04317                 BTFSC   EAT,7
004120 EF?? F???      04318                 GOTO    AutoTrim2b
                      04319                 ; Here is positive
004124 0E64           04320 AutoTrim2plim   MOVLW   D'100'
004126 60??           04321                 CPFSLT  EAT
004128 6E??           04322                 MOVWF   EAT
00412A EF?? F???      04323                 GOTO    AutoTrim2d
00412E                04324 AutoTrim2b      ; Here if negative
00412E 0E64           04325                 MOVLW   D'100'
004130 1EE8           04326                 COMF    WREG
004132 2AE8           04327                 INCF    WREG
004134 64??           04328                 CPFSGT  EAT
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 240


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

004136 6E??           04329                 MOVWF   EAT
                      04330                 ; Save the new value to Flash
004138                04331 AutoTrim2d
004138 EC?? F???      04332                 CALL    SaveAircraftPage1
                      04333         ; Rudder
00413C                04334 AutoTrim3
                      04335                 MOVE    Rpos,AXreg
00413C C??? F???          M                 MOVFF   Rpos,AXreg
004140 C??? F???          M                 MOVFF   (Rpos+1),(AXreg+1)
004144 EC?? F???      04336                 CALL    AutoLimit
004148 A4D8           04337                 BTFSS   ALUSTA,Z
00414A EF?? F???      04338                 GOTO    AutoTrim4
                      04339                 ; Adjust autotrim position
00414E 01??           04340                 MOVLR   HIGH ATmode
004150 66??           04341                 TSTFSZ  ATmode
004152 EF?? F???      04342                 GOTO    AutoTrim3e
004156 01??           04343                 MOVLR   HIGH AutoTrimStep
004158 5000           04344                 MOVFP   AutoTrimStep,WREG
00415A 01??           04345 AutoTrim3e      MOVLR   HIGH Rpos
00415C BE??           04346                 BTFSC   Rpos+1,7
00415E EF?? F???      04347                 GOTO    AutoTrim3a
                      04348                 ; Here if positive
004162 01??           04349                 MOVLR   HIGH RAT
004164 26??           04350                 ADDWF   RAT
004166 AE??           04351                 BTFSS   RAT,7
004168 EF?? F???      04352                 GOTO    AutoTrim3c
00416C A6D8           04353                 BTFSS   ALUSTA,OV
00416E EF?? F???      04354                 GOTO    AutoTrim3c
004172 EF?? F???      04355                 GOTO    AutoTrim3plim
004176                04356 AutoTrim3a      ; Here if negative
004176 01??           04357                 MOVLR   HIGH RAT
004178 5E??           04358                 SUBWF   RAT
00417A BE??           04359                 BTFSC   RAT,7
00417C EF?? F???      04360                 GOTO    AutoTrim3c
004180 A6D8           04361                 BTFSS   ALUSTA,OV
004182 EF?? F???      04362                 GOTO    AutoTrim3c
004186 EF?? F???      04363                 GOTO    AutoTrim3b
00418A                04364 AutoTrim3c      ; Now do the limit testing
00418A BE??           04365                 BTFSC   RAT,7
00418C EF?? F???      04366                 GOTO    AutoTrim3b
                      04367                 ; Here is positive
004190 0E64           04368 AutoTrim3plim   MOVLW   D'100'
004192 60??           04369                 CPFSLT  RAT
004194 6E??           04370                 MOVWF   RAT
004196 EF?? F???      04371                 GOTO    AutoTrim3d
00419A                04372 AutoTrim3b      ; Here if negative
00419A 0E64           04373                 MOVLW   D'100'
00419C 1EE8           04374                 COMF    WREG
00419E 2AE8           04375                 INCF    WREG
0041A0 64??           04376                 CPFSGT  RAT
0041A2 6E??           04377                 MOVWF   RAT
                      04378                 ; Save the new value to Flash
0041A4                04379 AutoTrim3d
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 241


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

0041A4 EC?? F???      04380                 CALL    SaveAircraftPage1
0041A8                04381 AutoTrim4
0041A8 0012           04382                 RETURN
                      04383 
                      04384 
                      04385 ; This function takes the absolute value of the number in reg AXreg and limits
                      04386 ; it to 200 (20 %). This function is used by the AutoTrim algorithm
                      04387 ; The channel's normalized position must be in AXreg. Additionally the position
                      04388 ; information is tested to see if its over threshold.
                      04389 ; Zero flag is set if the channel is above threshold.
                      04390 ; The limited value is returned in WREG divided by 2.
                      04391 ;
                      04392 ; The channel value is divided by two before testing, this is done because
                      04393 ; The auto trim value is doubled be its applied.
0041AA                04394 AutoLimit   
                      04395         ; First determine the absolute value
0041AA 01??           04396                 MOVLB   HIGH AXreg
0041AC AE??           04397                 BTFSS   AXreg+1,7
0041AE EF?? F???      04398                 GOTO    AutoLimit1
0041B2 1E??           04399                 COMF    AXreg
0041B4 1E??           04400                 COMF    AXreg+1
0041B6 2A??           04401                 INCF    AXreg
0041B8 B0D8           04402                 BTFSC   ALUSTA,C
0041BA 2A??           04403                 INCF    AXreg+1
                      04404         ; Now determine if its over the 20% limit. First divide by 2 then
                      04405         ; test agianst 100.
0041BC                04406 AutoLimit1
                      04407                 ; Divide by 2
0041BC 90D8           04408                 BCF     ALUSTA,C
0041BE 32??           04409                 RRCF    AXreg+1
0041C0 32??           04410                 RRCF    AXreg
                      04411                 ; Limit test            
0041C2 66??           04412                 TSTFSZ  AXreg+1
0041C4 EF?? F???      04413                 GOTO    AutoLimit3
0041C8 0E64           04414                 MOVLW   D'100'
0041CA 64??           04415                 CPFSGT  AXreg
0041CC EF?? F???      04416                 GOTO    AutoLimit2
                      04417         ; Set limit to 100, this is the value used in the one shot mode it will
                      04418         ; be doubled before its applied to get 20% range.
                      04419 AutoLimit3      MOVEC   D'100',AXreg
0041D0 01??               M                 MOVLR   HIGH (AXreg)
0041D2 0E64               M                 MOVLW   LOW (D'100')
0041D4 6E??               M                 MOVWF   (AXreg)
0041D6 0E00               M                 MOVLW   HIGH (D'100')
0041D8 6E??               M                 MOVWF   (AXreg+1)
                      04420         ; Test Threshold. This is the trigger to indicate if the stick is off center
                      04421         ; indicating auto trim function should be performed.
                      04422         ; Set zero flag if above threshold.
0041DA                04423 AutoLimit2
0041DA C??? FFE8      04424                 MOVFF   AXreg,WREG
0041DE 46E8           04425                 RLNCF   WREG
0041E0 01??           04426                 MOVLB   HIGH ATthreshold
0041E2 5C??           04427                 SUBWF   ATthreshold,W
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 242


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

0041E4 01??           04428                 MOVLB   HIGH AXreg
0041E6 94D8           04429                 BCF     ALUSTA,Z
0041E8 A0D8           04430                 BTFSS   ALUSTA,C
0041EA 84D8           04431                 BSF     ALUSTA,Z
0041EC 0012           04432                 RETURN
                      04433 
                      04434 ;
                      04435 ; This function uses the normalized servo position and the selected aircraft's
                      04436 ; setup information to calculate the servo positions and place the results
                      04437 ; in the timing array. If the dual aileron mixer mode is enabled then channel
                      04438 ; 7 will use the aileron channel gains.
                      04439 ;
0041EE                04440 CalculateServoPositions
                      04441         ; Clear OVERRUN flag
0041EE 01??           04442                 MOVLR   HIGH OVERRUN
0041F0 6A??           04443                 CLRF    OVERRUN
                      04444         ; Aeliron
0041F2 01??           04445                 MOVLR   HIGH Apos
0041F4 BE??           04446                 BTFSC   Apos+1,7
0041F6 EF?? F???      04447                 GOTO    CSP1
                      04448                 ; Here if positive
                      04449                 MOVE    AM1H,AXreg
0041FA C??? F???          M                 MOVFF   AM1H,AXreg
0041FE C??? F???          M                 MOVFF   (AM1H+1),(AXreg+1)
                      04450                 MOVE    Apos,BXreg
004202 C??? F???          M                 MOVFF   Apos,BXreg
004206 C??? F???          M                 MOVFF   (Apos+1),(BXreg+1)
00420A EC?? F???      04451                 CALL    Mult1616
00420E EF?? F???      04452                 GOTO    CSP2
                      04453 
004212                04454 CSP1            ; Here if negative
                      04455                 MOVE    AM2H,AXreg
004212 C??? F???          M                 MOVFF   AM2H,AXreg
004216 C??? F???          M                 MOVFF   (AM2H+1),(AXreg+1)
                      04456                 MOVE    Apos,BXreg
00421A C??? F???          M                 MOVFF   Apos,BXreg
00421E C??? F???          M                 MOVFF   (Apos+1),(BXreg+1)
004222 EC?? F???      04457                 CALL    Mult1616
004226                04458 CSP2
                      04459                 ; Add the offset
                      04460                 MOVE    AB,AXreg
004226 C??? F???          M                 MOVFF   AB,AXreg
00422A C??? F???          M                 MOVFF   (AB+1),(AXreg+1)
00422E 01??           04461                 MOVLR   HIGH AXreg
004230 5000           04462                 MOVFP   CEXreg+1,WREG
004232 26??           04463                 ADDWF   AXreg,F
004234 5000           04464                 MOVFP   CEXreg+2,WREG
004236 22??           04465                 ADDWFC  AXreg+1,F
                      04466                 ; Place in output timing array
004238 EC?? F???      04467                 CALL    ApplyLimit
                      04468                 MOVE    AXreg,chAIL
00423C C??? F???          M                 MOVFF   AXreg,chAIL
004240 C??? F???          M                 MOVFF   (AXreg+1),(chAIL+1)
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 243


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      04469         ; Elevator
004244 01??           04470                 MOVLR   HIGH Epos
004246 BE??           04471                 BTFSC   Epos+1,7
004248 EF?? F???      04472                 GOTO    CSP3
                      04473                 ; Here if positive
                      04474                 MOVE    EM1H,AXreg
00424C C??? F???          M                 MOVFF   EM1H,AXreg
004250 C??? F???          M                 MOVFF   (EM1H+1),(AXreg+1)
                      04475                 MOVE    Epos,BXreg
004254 C??? F???          M                 MOVFF   Epos,BXreg
004258 C??? F???          M                 MOVFF   (Epos+1),(BXreg+1)
00425C EC?? F???      04476                 CALL    Mult1616
004260 EF?? F???      04477                 GOTO    CSP4
                      04478 
004264                04479 CSP3            ; Here if negative
                      04480                 MOVE    EM2H,AXreg
004264 C??? F???          M                 MOVFF   EM2H,AXreg
004268 C??? F???          M                 MOVFF   (EM2H+1),(AXreg+1)
                      04481                 MOVE    Epos,BXreg
00426C C??? F???          M                 MOVFF   Epos,BXreg
004270 C??? F???          M                 MOVFF   (Epos+1),(BXreg+1)
004274 EC?? F???      04482                 CALL    Mult1616
004278                04483 CSP4
                      04484                 ; Add the offset
                      04485                 MOVE    EB,AXreg
004278 C??? F???          M                 MOVFF   EB,AXreg
00427C C??? F???          M                 MOVFF   (EB+1),(AXreg+1)
004280 01??           04486                 MOVLR   HIGH AXreg
004282 5000           04487                 MOVFP   CEXreg+1,WREG
004284 26??           04488                 ADDWF   AXreg,F
004286 5000           04489                 MOVFP   CEXreg+2,WREG
004288 22??           04490                 ADDWFC  AXreg+1,F
                      04491                 ; Place in output timing array
00428A EC?? F???      04492                 CALL    ApplyLimit
                      04493                 MOVE    AXreg,chELE
00428E C??? F???          M                 MOVFF   AXreg,chELE
004292 C??? F???          M                 MOVFF   (AXreg+1),(chELE+1)
                      04494         ; Rudder
004296 01??           04495                 MOVLR   HIGH Rpos
004298 BE??           04496                 BTFSC   Rpos+1,7
00429A EF?? F???      04497                 GOTO    CSP5
                      04498                 ; Here if positive
                      04499                 MOVE    RM1H,AXreg
00429E C??? F???          M                 MOVFF   RM1H,AXreg
0042A2 C??? F???          M                 MOVFF   (RM1H+1),(AXreg+1)
                      04500                 MOVE    Rpos,BXreg
0042A6 C??? F???          M                 MOVFF   Rpos,BXreg
0042AA C??? F???          M                 MOVFF   (Rpos+1),(BXreg+1)
0042AE EC?? F???      04501                 CALL    Mult1616
0042B2 EF?? F???      04502                 GOTO    CSP6
                      04503 
0042B6                04504 CSP5            ; Here if negative
                      04505                 MOVE    RM2H,AXreg
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 244


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

0042B6 C??? F???          M                 MOVFF   RM2H,AXreg
0042BA C??? F???          M                 MOVFF   (RM2H+1),(AXreg+1)
                      04506                 MOVE    Rpos,BXreg
0042BE C??? F???          M                 MOVFF   Rpos,BXreg
0042C2 C??? F???          M                 MOVFF   (Rpos+1),(BXreg+1)
0042C6 EC?? F???      04507                 CALL    Mult1616
0042CA                04508 CSP6
                      04509                 ; Add the offset
                      04510                 MOVE    RB,AXreg
0042CA C??? F???          M                 MOVFF   RB,AXreg
0042CE C??? F???          M                 MOVFF   (RB+1),(AXreg+1)
0042D2 01??           04511                 MOVLR   HIGH AXreg
0042D4 5000           04512                 MOVFP   CEXreg+1,WREG
0042D6 26??           04513                 ADDWF   AXreg,F
0042D8 5000           04514                 MOVFP   CEXreg+2,WREG
0042DA 22??           04515                 ADDWFC  AXreg+1,F
                      04516                 ; Place in output timing array
0042DC EC?? F???      04517                 CALL    ApplyLimit
                      04518                 MOVE    AXreg,chRUD
0042E0 C??? F???          M                 MOVFF   AXreg,chRUD
0042E4 C??? F???          M                 MOVFF   (AXreg+1),(chRUD+1)
                      04519         ; Throttle
                      04520                 MOVE    TMH,AXreg
0042E8 C??? F???          M                 MOVFF   TMH,AXreg
0042EC C??? F???          M                 MOVFF   (TMH+1),(AXreg+1)
                      04521 ;               MOVE    Tpos,BXreg
                      04522                 MOVE    TposActual,BXreg
0042F0 C??? F???          M                 MOVFF   TposActual,BXreg
0042F4 C??? F???          M                 MOVFF   (TposActual+1),(BXreg+1)
0042F8 EC?? F???      04523                 CALL    Mult1616
                      04524                 MOVE    TBH,AXreg
0042FC C??? F???          M                 MOVFF   TBH,AXreg
004300 C??? F???          M                 MOVFF   (TBH+1),(AXreg+1)
004304 01??           04525                 MOVLR   HIGH AXreg
004306 5000           04526                 MOVFP   CEXreg+1,WREG
004308 26??           04527                 ADDWF   AXreg,F
00430A 5000           04528                 MOVFP   CEXreg+2,WREG
00430C 22??           04529                 ADDWFC  AXreg+1,F
                      04530                 ; Place in output timing array
00430E EC?? F???      04531                 CALL    ApplyLimit
                      04532                 MOVE    AXreg,chTHT
004312 C??? F???          M                 MOVFF   AXreg,chTHT
004316 C??? F???          M                 MOVFF   (AXreg+1),(chTHT+1)
                      04533         ; CH5   
                      04534                 MOVE    CH5MH,AXreg
00431A C??? F???          M                 MOVFF   CH5MH,AXreg
00431E C??? F???          M                 MOVFF   (CH5MH+1),(AXreg+1)
                      04535                 MOVE    CH5posActual,BXreg
004322 C??? F???          M                 MOVFF   CH5posActual,BXreg
004326 C??? F???          M                 MOVFF   (CH5posActual+1),(BXreg+1)
00432A EC?? F???      04536                 CALL    Mult1616
                      04537                 MOVE    CH5BH,AXreg
00432E C??? F???          M                 MOVFF   CH5BH,AXreg
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 245


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

004332 C??? F???          M                 MOVFF   (CH5BH+1),(AXreg+1)
004336 01??           04538                 MOVLR   HIGH AXreg
004338 5000           04539                 MOVFP   CEXreg+1,WREG
00433A 26??           04540                 ADDWF   AXreg,F
00433C 5000           04541                 MOVFP   CEXreg+2,WREG
00433E 22??           04542                 ADDWFC  AXreg+1,F
                      04543                 ; Place in output timing array
004340 EC?? F???      04544                 CALL    ApplyLimit
                      04545                 MOVE    AXreg,chCH5
004344 C??? F???          M                 MOVFF   AXreg,chCH5
004348 C??? F???          M                 MOVFF   (AXreg+1),(chCH5+1)
                      04546         ; CH6
                      04547                 MOVE    CH6MH,AXreg
00434C C??? F???          M                 MOVFF   CH6MH,AXreg
004350 C??? F???          M                 MOVFF   (CH6MH+1),(AXreg+1)
                      04548                 MOVE    CH6pos,BXreg
004354 C??? F???          M                 MOVFF   CH6pos,BXreg
004358 C??? F???          M                 MOVFF   (CH6pos+1),(BXreg+1)
00435C EC?? F???      04549                 CALL    Mult1616
                      04550                 MOVE    CH6BH,AXreg
004360 C??? F???          M                 MOVFF   CH6BH,AXreg
004364 C??? F???          M                 MOVFF   (CH6BH+1),(AXreg+1)
004368 01??           04551                 MOVLR   HIGH AXreg
00436A 5000           04552                 MOVFP   CEXreg+1,WREG
00436C 26??           04553                 ADDWF   AXreg,F
00436E 5000           04554                 MOVFP   CEXreg+2,WREG
004370 22??           04555                 ADDWFC  AXreg+1,F
                      04556                 ; Place in output timing array
004372                04557 CH6save
004372 EC?? F???      04558                 CALL    ApplyLimit
                      04559                 MOVE    AXreg,chCH6
004376 C??? F???          M                 MOVFF   AXreg,chCH6
00437A C??? F???          M                 MOVFF   (AXreg+1),(chCH6+1)
                      04560         ; CH7
                      04561                 MOVE    CH7MH,AXreg
00437E C??? F???          M                 MOVFF   CH7MH,AXreg
004382 C??? F???          M                 MOVFF   (CH7MH+1),(AXreg+1)
                      04562                 MOVE    CH7pos,BXreg
004386 C??? F???          M                 MOVFF   CH7pos,BXreg
00438A C??? F???          M                 MOVFF   (CH7pos+1),(BXreg+1)
00438E EC?? F???      04563                 CALL    Mult1616
                      04564                 MOVE    CH7BH,AXreg
004392 C??? F???          M                 MOVFF   CH7BH,AXreg
004396 C??? F???          M                 MOVFF   (CH7BH+1),(AXreg+1)
00439A 01??           04565                 MOVLR   HIGH AXreg
00439C 5000           04566                 MOVFP   CEXreg+1,WREG
00439E 26??           04567                 ADDWF   AXreg,F
0043A0 5000           04568                 MOVFP   CEXreg+2,WREG
0043A2 22??           04569                 ADDWFC  AXreg+1,F
                      04570                 ; Place in output timing array
0043A4                04571 CH7save
0043A4 EC?? F???      04572                 CALL    ApplyLimit
                      04573                 MOVE    AXreg,chCH7
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 246


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

0043A8 C??? F???          M                 MOVFF   AXreg,chCH7
0043AC C??? F???          M                 MOVFF   (AXreg+1),(chCH7+1)
                      04574         ; CH8
                      04575                 MOVE    CH8posActual,AXreg
0043B0 C??? F???          M                 MOVFF   CH8posActual,AXreg
0043B4 C??? F???          M                 MOVFF   (CH8posActual+1),(AXreg+1)
                      04576                 ; Test the sign
0043B8 BE??           04577                 BTFSC   AXreg+1,7
0043BA EF?? F???      04578                 GOTO    CSP7
                      04579                 ; Here if postive
                      04580                 MOVE    CH8_A,BXreg
0043BE C??? F???          M                 MOVFF   CH8_A,BXreg
0043C2 C??? F???          M                 MOVFF   (CH8_A+1),(BXreg+1)
0043C6 EC?? F???      04581                 CALL    Mult1616
0043CA EF?? F???      04582                 GOTO    CSP8            
0043CE                04583 CSP7            ; Here if negative
                      04584                 MOVE    CH8_C,BXreg
0043CE C??? F???          M                 MOVFF   CH8_C,BXreg
0043D2 C??? F???          M                 MOVFF   (CH8_C+1),(BXreg+1)
0043D6 EC?? F???      04585                 CALL    Mult1616
0043DA                04586 CSP8            ; Add the offset term...
                      04587                 MOVE    CH8_B,AXreg
0043DA C??? F???          M                 MOVFF   CH8_B,AXreg
0043DE C??? F???          M                 MOVFF   (CH8_B+1),(AXreg+1)
0043E2 5000           04588                 MOVFP   AXreg,WREG
0043E4 26??           04589                 ADDWF   CEXreg+1,F
0043E6 5000           04590                 MOVFP   AXreg+1,WREG
0043E8 22??           04591                 ADDWFC  CEXreg+2,F
0043EA C??? F???      04592                 MOVFF    CEXreg+1,AXreg
0043EE C??? F???      04593                 MOVFF    CEXreg+2,AXreg+1
0043F2 EC?? F???      04594                 CALL    ApplyLimit
                      04595                 MOVE    AXreg,chCH8
0043F6 C??? F???          M                 MOVFF   AXreg,chCH8
0043FA C??? F???          M                 MOVFF   (AXreg+1),(chCH8+1)
                      04596         ; Now proccess all of the buttons:
                      04597         ;  Throttle preset
0043FE 01??           04598                 MOVLR   HIGH TTflag             ; If the throttle trim adjust flag is set then
004400 66??           04599                 TSTFSZ  TTflag                  ; ignore the preset button test.
004402 EF?? F???      04600                 GOTO    CSP9
004406 01??           04601                 MOVLR   HIGH SWPRESET
004408 5000           04602                 MOVFP   SWPRESET,WREG
00440A EC?? F???      04603                 CALL    SwitchTest
00440E A0D8           04604                 BTFSS   ALUSTA,C
004410 EF?? F???      04605                 GOTO    CSP9
                      04606                 MOVE    Tpreset,chTHT
004414 C??? F???          M                 MOVFF   Tpreset,chTHT
004418 C??? F???          M                 MOVFF   (Tpreset+1),(chTHT+1)
00441C                04607 CSP9
00441C 0012           04608                 RETURN
                      04609         
                      04610 ; This function will test the value in AXreg using the variables in
                      04611 ; ServoMin and ServoMax. If the value in AXreg exceeds the limts, AXreg
                      04612 ; will be set to limit. 
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 247


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

00441E                04613 ApplyLimit
                      04614         ; Test the minimum limit by subtrating it from the servo position
00441E 01??           04615                 MOVLR   HIGH ServoMin
004420 5000           04616                 MOVFP   ServoMin,WREG
004422 01??           04617                 MOVLR   HIGH AXreg
004424 5C??           04618                 SUBWF   AXreg,W
004426 01??           04619                 MOVLR   HIGH ServoMin
004428 5000           04620                 MOVFP   ServoMin+1,WREG
00442A 01??           04621                 MOVLR   HIGH AXreg
00442C 58??           04622                 SUBWFB  AXreg+1,W
                      04623          ; If its negative then its below the minimum limit
00442E AEE8           04624                 BTFSS   WREG,7
004430 EF?? F???      04625                 GOTO    AL1
                      04626                 ; Here is negative, so set to minimum and exit
                      04627                 MOVE    ServoMin,AXreg
004434 C??? F???          M                 MOVFF   ServoMin,AXreg
004438 C??? F???          M                 MOVFF   (ServoMin+1),(AXreg+1)
00443C 0012           04628                 RETURN                
                      04629         ; Test the maximum limit by subtracting the maximum from the servo position
00443E                04630 AL1
00443E 01??           04631                 MOVLR   HIGH ServoMax
004440 5000           04632                 MOVFP   ServoMax,WREG
004442 01??           04633                 MOVLR   HIGH AXreg
004444 5C??           04634                 SUBWF   AXreg,W
004446 01??           04635                 MOVLR   HIGH ServoMax
004448 5000           04636                 MOVFP   ServoMax+1,WREG
00444A 01??           04637                 MOVLR   HIGH AXreg
00444C 58??           04638                 SUBWFB  AXreg+1,W
                      04639          ; If its negative then its below the minimum limit
00444E BEE8           04640                 BTFSC   WREG,7
004450 0012           04641                 RETURN
                      04642                 ; Here is negative, so set to minimum and exit
                      04643                 MOVE    ServoMax,AXreg
004452 C??? F???          M                 MOVFF   ServoMax,AXreg
004456 C??? F???          M                 MOVFF   (ServoMax+1),(AXreg+1)
00445A 0012           04644                 RETURN
                      04645 
                      04646 
                      04647 ; This function tests the Option button and returns its state
                      04648 ; in the carry flag.
                      04649 ;       C set if Option button was pressed
00445C                04650 Option
00445C 01??           04651                 MOVLR   HIGH PORTElatchLow
00445E A4??           04652                 BTFSS   PORTElatchLow,OPTION
004460 EF?? F???      04653                 GOTO    Option1
004464 94??           04654                 BCF     PORTElatchLow,OPTION
                      04655                 ; Test if its been processed
004466 A4??           04656                 BTFSS   PORTElatch,OPTION
004468 EF?? F???      04657                 GOTO    Option1
                      04658                 ; Beep one time to indicate we detected the
                      04659                 ; button...
00446C 94??           04660                 BCF     PORTElatch,OPTION
00446E 0E01           04661                 MOVLW   D'1'
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 248


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

004470 6E??           04662                 MOVWF   BeepCyl
004472 0E05           04663                 MOVLW   D'5'
004474 EC?? F???      04664                 CALL    Beep
004478 80D8           04665                 BSF     ALUSTA,C,A
00447A 0012           04666                 RETURN
00447C                04667 Option1
00447C 90D8           04668                 BCF     ALUSTA,C,A
00447E 0012           04669                 RETURN
                      04670 
                      04671 ; This function will load the general setup data from Flash into bank 2
                      04672 ; This data applies to all aircraft and includes the joy stick calibration
                      04673 ; parameters.
004480                04674 LoadGeneral
                      04675         ; Setup variables...
                      04676         ;   AXreg  = Destination address in ram
                      04677         ;   CEXreg = Flash memory address 
                      04678         ;   Areg   = Number of bytes to read
                      04679                 MOVEC   200,AXreg
004480 01??               M                 MOVLR   HIGH (AXreg)
004482 0E00               M                 MOVLW   LOW (200)
004484 6E??               M                 MOVWF   (AXreg)
004486 0E02               M                 MOVLW   HIGH (200)
004488 6E??               M                 MOVWF   (AXreg+1)
                      04680                 MOVEC24 ConfigLoc,CEXreg
00448A 01??               M                 MOVLR   HIGH (CEXreg)
00448C 0E??               M                 MOVLW   LOW (ConfigLoc)
00448E 6E??               M                 MOVWF   (CEXreg)
004490 0E??               M                 MOVLW   HIGH (ConfigLoc)
004492 6E??               M                 MOVWF   (CEXreg+1)
004494 0E??               M                 MOVLW   UPPER (ConfigLoc)
004496 6E??               M                 MOVWF   (CEXreg+2)
004498 6AE8           04681                 CLRF    WREG,A
00449A 6E00           04682                 MOVWF   Areg,A
                      04683         
00449C EC?? F???      04684                 CALL    FlashRead       ; Read the data
                      04685         ; Load Aircraft number into current aircraft
0044A0 01??           04686                 MOVLR   HIGH Aircraft
0044A2 50??           04687                 MOVFP   Aircraft,W
0044A4 01??           04688                 MOVLR   HIGH DefaultAircraft
0044A6 6E??           04689                 MOVWF   DefaultAircraft
                      04690         ; Save the version data into the general area
0044A8 0E??           04691                 MOVLW   UPPER (MES2+D'10')              ; Load pointer the the version number
0044AA 6EF8           04692                 MOVWF   TBLPTRU,A
0044AC 0E??           04693                 MOVLW   HIGH (MES2+D'10')
0044AE 6EF7           04694                 MOVWF   TBLPTRH,A
0044B0 0E??           04695                 MOVLW   LOW (MES2+D'10')
0044B2 6EF6           04696                 MOVWF   TBLPTRL,A
                      04697                 ; Read the version number into RAM
0044B4 0009           04698                 TBLRD*+
0044B6 CFF5 F???      04699                 MOVFF   TABLAT,Gversion
0044BA 0009           04700                 TBLRD*+
0044BC 0009           04701                 TBLRD*+
0044BE CFF5 F???      04702                 MOVFF   TABLAT,Gversion+1
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 249


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

0044C2 0009           04703                 TBLRD*+
0044C4 CFF5 F???      04704                 MOVFF   TABLAT,Gversion+2
0044C8 0012           04705                 RETURN
                      04706 
                      04707 ; Writes the general parameters to Flash
0044CA                04708 SaveGeneral
                      04709         ; Setup variables...
                      04710         ;   AXreg  = Destination address in ram
                      04711         ;   CEXreg = Flash memory address 
                      04712         ;   Areg   = Number of bytes to read
                      04713                 MOVEC   200,AXreg
0044CA 01??               M                 MOVLR   HIGH (AXreg)
0044CC 0E00               M                 MOVLW   LOW (200)
0044CE 6E??               M                 MOVWF   (AXreg)
0044D0 0E02               M                 MOVLW   HIGH (200)
0044D2 6E??               M                 MOVWF   (AXreg+1)
                      04714                 MOVEC24 ConfigLoc,CEXreg
0044D4 01??               M                 MOVLR   HIGH (CEXreg)
0044D6 0E??               M                 MOVLW   LOW (ConfigLoc)
0044D8 6E??               M                 MOVWF   (CEXreg)
0044DA 0E??               M                 MOVLW   HIGH (ConfigLoc)
0044DC 6E??               M                 MOVWF   (CEXreg+1)
0044DE 0E??               M                 MOVLW   UPPER (ConfigLoc)
0044E0 6E??               M                 MOVWF   (CEXreg+2)
0044E2 0E04           04715                 MOVLW   4
0044E4 6E00           04716                 MOVWF   Areg,A
0044E6 EC?? F???      04717                 CALL    FlashWrite      ; Read the data
0044EA 0012           04718                 RETURN
                      04719                 
                      04720 ; This function loads just the aircraft name for the current aircraft
                      04721 ; number defined in WREG.
0044EC                04722 LoadAircraftName
                      04723         ;   AXreg  = Destination address in ram
                      04724         ;   CEXreg = Flash memory address 
                      04725         ;   Areg   = Number of bytes to read
                      04726                 ; Convert aircraft number to page pointer into config area
0044EC 46E8           04727                 RLNCF   WREG
0044EE 06E8           04728                 DECF    WREG
0044F0 6E00           04729                 MOVWF   Breg,A          ; Save page pointer
                      04730         ; Load 16 bytes
                      04731                 MOVEC   300,AXreg
0044F2 01??               M                 MOVLR   HIGH (AXreg)
0044F4 0E00               M                 MOVLW   LOW (300)
0044F6 6E??               M                 MOVWF   (AXreg)
0044F8 0E03               M                 MOVLW   HIGH (300)
0044FA 6E??               M                 MOVWF   (AXreg+1)
                      04732                 MOVEC24 ConfigLoc,CEXreg
0044FC 01??               M                 MOVLR   HIGH (CEXreg)
0044FE 0E??               M                 MOVLW   LOW (ConfigLoc)
004500 6E??               M                 MOVWF   (CEXreg)
004502 0E??               M                 MOVLW   HIGH (ConfigLoc)
004504 6E??               M                 MOVWF   (CEXreg+1)
004506 0E??               M                 MOVLW   UPPER (ConfigLoc)
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 250


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

004508 6E??               M                 MOVWF   (CEXreg+2)
00450A 5000           04733                 MOVF    Breg,W,A
00450C 26??           04734                 ADDWF   CEXreg+1
00450E 6AE8           04735                 CLRF    WREG,A
004510 22??           04736                 ADDWFC  CEXreg+2
004512 0E10           04737                 MOVLW   D'16'
004514 6E00           04738                 MOVWF   Areg,A
004516 EC?? F???      04739                 CALL    FlashRead
00451A 0012           04740                 RETURN
                      04741 
                      04742 ; This function saves the Name (16 bytes) in the aircraft number defined in 
                      04743 ; WREG. The first 64 bytes of the selected aircraft is copied to ram block 8
                      04744 ; and then the Name is updated and copied back to flash.
00451C                04745 SaveAircraftName
                      04746         ; First read the first 64 bytes (1 page) of the selected aircraft
                      04747         ;   AXreg  = Destination address in ram
                      04748         ;   CEXreg = Flash memory address 
                      04749         ;   Areg   = Number of bytes to read
                      04750                 ; Convert aircraft number to page pointer into config area
00451C 46E8           04751                 RLNCF   WREG
00451E 06E8           04752                 DECF    WREG
004520 6E00           04753                 MOVWF   Breg,A          ; Save page pointer
                      04754                 
                      04755                 MOVEC   800,AXreg
004522 01??               M                 MOVLR   HIGH (AXreg)
004524 0E00               M                 MOVLW   LOW (800)
004526 6E??               M                 MOVWF   (AXreg)
004528 0E08               M                 MOVLW   HIGH (800)
00452A 6E??               M                 MOVWF   (AXreg+1)
                      04756                 MOVEC24 ConfigLoc,CEXreg
00452C 01??               M                 MOVLR   HIGH (CEXreg)
00452E 0E??               M                 MOVLW   LOW (ConfigLoc)
004530 6E??               M                 MOVWF   (CEXreg)
004532 0E??               M                 MOVLW   HIGH (ConfigLoc)
004534 6E??               M                 MOVWF   (CEXreg+1)
004536 0E??               M                 MOVLW   UPPER (ConfigLoc)
004538 6E??               M                 MOVWF   (CEXreg+2)
00453A 5000           04757                 MOVFP   Breg,W,A
00453C 26??           04758                 ADDWF   CEXreg+1
00453E 6AE8           04759                 CLRF    WREG,A
004540 22??           04760                 ADDWFC  CEXreg+2
004542 0E40           04761                 MOVLW   D'64'
004544 6E00           04762                 MOVWF   Areg,A
                      04763         
004546 EC?? F???      04764                 CALL    FlashRead
                      04765         ; Now update the Name
                      04766                 MOVEC   Name, Src
00454A 01??               M                 MOVLR   HIGH (Src)
00454C 0E??               M                 MOVLW   LOW (Name)
00454E 6E??               M                 MOVWF   (Src)
004550 0E??               M                 MOVLW   HIGH (Name)
004552 6E??               M                 MOVWF   (Src+1)
                      04767                 MOVEC   Name, Dst
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 251


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

004554 01??               M                 MOVLR   HIGH (Dst)
004556 0E??               M                 MOVLW   LOW (Name)
004558 6E??               M                 MOVWF   (Dst)
00455A 0E??               M                 MOVLW   HIGH (Name)
00455C 6E??               M                 MOVWF   (Dst+1)
00455E 01??           04768                 MOVLR   HIGH Dst
004560 0E08           04769                 MOVLW   8               ; Block 8
004562 6E??           04770                 MOVWF   Dst+1
004564 0E10           04771                 MOVLW   D'16'
004566 6E??           04772                 MOVWF   Cnt
004568 EC?? F???      04773                 CALL    BlkMove
                      04774         ; Write back to flash aircraft number
                      04775         ;   AXreg  = Destination address in ram
                      04776         ;   CEXreg = Flash memory address 
                      04777         ;   Areg   = Number of bytes to read
                      04778                 MOVEC   800,AXreg
00456C 01??               M                 MOVLR   HIGH (AXreg)
00456E 0E00               M                 MOVLW   LOW (800)
004570 6E??               M                 MOVWF   (AXreg)
004572 0E08               M                 MOVLW   HIGH (800)
004574 6E??               M                 MOVWF   (AXreg+1)
                      04779                 MOVEC24 ConfigLoc,CEXreg
004576 01??               M                 MOVLR   HIGH (CEXreg)
004578 0E??               M                 MOVLW   LOW (ConfigLoc)
00457A 6E??               M                 MOVWF   (CEXreg)
00457C 0E??               M                 MOVLW   HIGH (ConfigLoc)
00457E 6E??               M                 MOVWF   (CEXreg+1)
004580 0E??               M                 MOVLW   UPPER (ConfigLoc)
004582 6E??               M                 MOVWF   (CEXreg+2)
004584 5000           04780                 MOVFP   Breg,W,A
004586 26??           04781                 ADDWF   CEXreg+1
004588 6AE8           04782                 CLRF    WREG,A
00458A 22??           04783                 ADDWFC  CEXreg+2
00458C 0E01           04784                 MOVLW   1
00458E 6E00           04785                 MOVWF   Areg,A
                      04786         
004590 EC?? F???      04787                 CALL    FlashWrite      ; Read the data
004594 0012           04788                 RETURN
                      04789 
                      04790 ; This function will load the aircraft data from Flash memory.
                      04791 ;       WERG = Aircraft number
004596                04792 LoadAircraft
                      04793         ; Setup variables...
                      04794         ;   AXreg  = Destination address in ram
                      04795         ;   CEXreg = Flash memory address 
                      04796         ;   Areg   = Number of bytes to read
                      04797                 ; Convert aircraft number to page pointer into config area
004596 46E8           04798                 RLNCF   WREG
004598 06E8           04799                 DECF    WREG
00459A 6E00           04800                 MOVWF   Breg,A          ; Save page pointer
                      04801         ; Read first page               
                      04802                 MOVEC   300,AXreg
00459C 01??               M                 MOVLR   HIGH (AXreg)
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 252


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

00459E 0E00               M                 MOVLW   LOW (300)
0045A0 6E??               M                 MOVWF   (AXreg)
0045A2 0E03               M                 MOVLW   HIGH (300)
0045A4 6E??               M                 MOVWF   (AXreg+1)
                      04803                 MOVEC24 ConfigLoc,CEXreg
0045A6 01??               M                 MOVLR   HIGH (CEXreg)
0045A8 0E??               M                 MOVLW   LOW (ConfigLoc)
0045AA 6E??               M                 MOVWF   (CEXreg)
0045AC 0E??               M                 MOVLW   HIGH (ConfigLoc)
0045AE 6E??               M                 MOVWF   (CEXreg+1)
0045B0 0E??               M                 MOVLW   UPPER (ConfigLoc)
0045B2 6E??               M                 MOVWF   (CEXreg+2)
0045B4 5000           04804                 MOVFP   Breg,W,A
0045B6 26??           04805                 ADDWF   CEXreg+1
0045B8 6AE8           04806                 CLRF    WREG,A
0045BA 22??           04807                 ADDWFC  CEXreg+2
0045BC 6E00           04808                 MOVWF   Areg,A
0045BE EC?? F???      04809                 CALL    FlashRead       ; Read the data
                      04810         ; Read second page              
                      04811                 MOVEC   400,AXreg
0045C2 01??               M                 MOVLR   HIGH (AXreg)
0045C4 0E00               M                 MOVLW   LOW (400)
0045C6 6E??               M                 MOVWF   (AXreg)
0045C8 0E04               M                 MOVLW   HIGH (400)
0045CA 6E??               M                 MOVWF   (AXreg+1)
                      04812                 MOVEC24 ConfigLoc,CEXreg
0045CC 01??               M                 MOVLR   HIGH (CEXreg)
0045CE 0E??               M                 MOVLW   LOW (ConfigLoc)
0045D0 6E??               M                 MOVWF   (CEXreg)
0045D2 0E??               M                 MOVLW   HIGH (ConfigLoc)
0045D4 6E??               M                 MOVWF   (CEXreg+1)
0045D6 0E??               M                 MOVLW   UPPER (ConfigLoc)
0045D8 6E??               M                 MOVWF   (CEXreg+2)
0045DA 5000           04813                 MOVFP   Breg,W,A
0045DC 2AE8           04814                 INCF    WREG
0045DE 26??           04815                 ADDWF   CEXreg+1
0045E0 6AE8           04816                 CLRF    WREG,A
0045E2 22??           04817                 ADDWFC  CEXreg+2
0045E4 6E00           04818                 MOVWF   Areg,A
0045E6 EC?? F???      04819                 CALL    FlashRead       ; Read the data
0045EA 0012           04820                 RETURN
                      04821 ;       WERG = Aircraft number
0045EC                04822 SaveAircraft
                      04823         ; Setup variables...
                      04824         ;   AXreg  = Destination address in ram
                      04825         ;   CEXreg = Flash memory address 
                      04826         ;   Areg   = Number of bytes to read
                      04827                 ; Convert aircraft number to page pointer into config area
0045EC 46E8           04828                 RLNCF   WREG
0045EE 06E8           04829                 DECF    WREG
0045F0 6E00           04830                 MOVWF   Creg,A          ; Save Page pointer
                      04831         ; Save first page
                      04832                 MOVEC   300,AXreg
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 253


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

0045F2 01??               M                 MOVLR   HIGH (AXreg)
0045F4 0E00               M                 MOVLW   LOW (300)
0045F6 6E??               M                 MOVWF   (AXreg)
0045F8 0E03               M                 MOVLW   HIGH (300)
0045FA 6E??               M                 MOVWF   (AXreg+1)
                      04833                 MOVEC24 ConfigLoc,CEXreg
0045FC 01??               M                 MOVLR   HIGH (CEXreg)
0045FE 0E??               M                 MOVLW   LOW (ConfigLoc)
004600 6E??               M                 MOVWF   (CEXreg)
004602 0E??               M                 MOVLW   HIGH (ConfigLoc)
004604 6E??               M                 MOVWF   (CEXreg+1)
004606 0E??               M                 MOVLW   UPPER (ConfigLoc)
004608 6E??               M                 MOVWF   (CEXreg+2)
00460A 5000           04834                 MOVFP   Creg,W,A
00460C 26??           04835                 ADDWF   CEXreg+1
00460E 6AE8           04836                 CLRF    WREG,A
004610 22??           04837                 ADDWFC  CEXreg+2
004612 0E04           04838                 MOVLW   4
004614 6E00           04839                 MOVWF   Areg,A
004616 EC?? F???      04840                 CALL    FlashWrite      ; Write the data
                      04841         ; Save second page
                      04842                 MOVEC   400,AXreg
00461A 01??               M                 MOVLR   HIGH (AXreg)
00461C 0E00               M                 MOVLW   LOW (400)
00461E 6E??               M                 MOVWF   (AXreg)
004620 0E04               M                 MOVLW   HIGH (400)
004622 6E??               M                 MOVWF   (AXreg+1)
                      04843                 MOVEC24 ConfigLoc,CEXreg
004624 01??               M                 MOVLR   HIGH (CEXreg)
004626 0E??               M                 MOVLW   LOW (ConfigLoc)
004628 6E??               M                 MOVWF   (CEXreg)
00462A 0E??               M                 MOVLW   HIGH (ConfigLoc)
00462C 6E??               M                 MOVWF   (CEXreg+1)
00462E 0E??               M                 MOVLW   UPPER (ConfigLoc)
004630 6E??               M                 MOVWF   (CEXreg+2)
004632 5000           04844                 MOVFP   Creg,W,A
004634 2AE8           04845                 INCF    WREG
004636 26??           04846                 ADDWF   CEXreg+1
004638 6AE8           04847                 CLRF    WREG,A
00463A 22??           04848                 ADDWFC  CEXreg+2
00463C 0E04           04849                 MOVLW   4
00463E 6E00           04850                 MOVWF   Areg,A
004640 EC?? F???      04851                 CALL    FlashWrite      ; Write the data                
004644 0012           04852                 RETURN
                      04853                 
                      04854 ; This function copies the aircraft setup data stored in page 3 and 4 to its backup
                      04855 ; location in page 6 and 7. This backup data is used for the alternate aircraft function.
004646                04856 BackupAircraft
                      04857                 MOVEC   300, Src
004646 01??               M                 MOVLR   HIGH (Src)
004648 0E00               M                 MOVLW   LOW (300)
00464A 6E??               M                 MOVWF   (Src)
00464C 0E03               M                 MOVLW   HIGH (300)
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 254


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

00464E 6E??               M                 MOVWF   (Src+1)
                      04858                 MOVEC   600, Dst
004650 01??               M                 MOVLR   HIGH (Dst)
004652 0E00               M                 MOVLW   LOW (600)
004654 6E??               M                 MOVWF   (Dst)
004656 0E06               M                 MOVLW   HIGH (600)
004658 6E??               M                 MOVWF   (Dst+1)
00465A 0E00           04859                 MOVLW   0
00465C 6E??           04860                 MOVWF   Cnt
00465E EC?? F???      04861                 CALL    BlkMove
                      04862 
                      04863                 MOVEC   400, Src
004662 01??               M                 MOVLR   HIGH (Src)
004664 0E00               M                 MOVLW   LOW (400)
004666 6E??               M                 MOVWF   (Src)
004668 0E04               M                 MOVLW   HIGH (400)
00466A 6E??               M                 MOVWF   (Src+1)
                      04864                 MOVEC   700, Dst
00466C 01??               M                 MOVLR   HIGH (Dst)
00466E 0E00               M                 MOVLW   LOW (700)
004670 6E??               M                 MOVWF   (Dst)
004672 0E07               M                 MOVLW   HIGH (700)
004674 6E??               M                 MOVWF   (Dst+1)
004676 0E00           04865                 MOVLW   0
004678 6E??           04866                 MOVWF   Cnt
00467A EC?? F???      04867                 CALL    BlkMove
00467E 0012           04868                 RETURN
                      04869                 
                      04870 ; This functions saves the first page (64 bytes) of the aircraft configuration
                      04871 ; data to flash memory. The Aircraft number is used for the storage location.
004680                04872 SaveAircraftPage1
                      04873         ; Setup variables...
                      04874         ;   AXreg  = Destination address in ram
                      04875         ;   CEXreg = Flash memory address 
                      04876         ;   Areg   = Number of bytes to read
004680 01??           04877                 MOVLR   HIGH Aircraft
004682 50??           04878                 MOVFP   Aircraft,W
                      04879                 ; Convert aircraft number to page pointer into config area
004684 46E8           04880                 RLNCF   WREG
004686 06E8           04881                 DECF    WREG
004688 6E00           04882                 MOVWF   Areg,A          ; Save page pointer
                      04883                 
                      04884                 MOVEC   300,AXreg
00468A 01??               M                 MOVLR   HIGH (AXreg)
00468C 0E00               M                 MOVLW   LOW (300)
00468E 6E??               M                 MOVWF   (AXreg)
004690 0E03               M                 MOVLW   HIGH (300)
004692 6E??               M                 MOVWF   (AXreg+1)
                      04885                 MOVEC24 ConfigLoc,CEXreg
004694 01??               M                 MOVLR   HIGH (CEXreg)
004696 0E??               M                 MOVLW   LOW (ConfigLoc)
004698 6E??               M                 MOVWF   (CEXreg)
00469A 0E??               M                 MOVLW   HIGH (ConfigLoc)
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 255


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

00469C 6E??               M                 MOVWF   (CEXreg+1)
00469E 0E??               M                 MOVLW   UPPER (ConfigLoc)
0046A0 6E??               M                 MOVWF   (CEXreg+2)
0046A2 5000           04886                 MOVFP   Areg,W,A
0046A4 26??           04887                 ADDWF   CEXreg+1
0046A6 6AE8           04888                 CLRF    WREG,A
0046A8 22??           04889                 ADDWFC  CEXreg+2
0046AA 0E01           04890                 MOVLW   1
0046AC 6E00           04891                 MOVWF   Areg,A
                      04892         
0046AE EC?? F???      04893                 CALL    FlashWrite      ; Read the data
0046B2 0012           04894                 RETURN
                      04895 
                      04896 ;
                      04897 ; Mixer routines...
                      04898 ;
                      04899 ; This routine will move all of the channel position data to the Mixed
                      04900 ; position variables.
                      04901 ;
                      04902 ; Scan all 12 mixers, if the from and to channel are the same and they are
                      04903 ; equal to Throttle, CH5 or CH8 (4,5, or 8), then do not use the actual
                      04904 ; position variables. This is to allow a mix to itself to work on the
                      04905 ; slew rate chanels. You cannot make slew rate work when mixing a channel
                      04906 ; to itself.
                      04907 ;
0046B4                04908 Move2Mix
                      04909         ; Set the Mix values
                      04910                 MOVE16  Apos,AposM
0046B4 C??? F???          M                 MOVFF   Apos,AposM
0046B8 C??? F???          M                 MOVFF   (Apos+1),(AposM+1)
                      04911                 MOVE16  Epos,EposM
0046BC C??? F???          M                 MOVFF   Epos,EposM
0046C0 C??? F???          M                 MOVFF   (Epos+1),(EposM+1)
                      04912                 MOVE16  Rpos,RposM
0046C4 C??? F???          M                 MOVFF   Rpos,RposM
0046C8 C??? F???          M                 MOVFF   (Rpos+1),(RposM+1)
                      04913                 MOVE16  Tpos,TposM
0046CC C??? F???          M                 MOVFF   Tpos,TposM
0046D0 C??? F???          M                 MOVFF   (Tpos+1),(TposM+1)
                      04914                 MOVE16  TposActual,TposM
0046D4 C??? F???          M                 MOVFF   TposActual,TposM
0046D8 C??? F???          M                 MOVFF   (TposActual+1),(TposM+1)
                      04915                 MOVE16  CH5posActual,CH5posM
0046DC C??? F???          M                 MOVFF   CH5posActual,CH5posM
0046E0 C??? F???          M                 MOVFF   (CH5posActual+1),(CH5posM+1)
                      04916                 MOVE16  CH6pos,CH6posM
0046E4 C??? F???          M                 MOVFF   CH6pos,CH6posM
0046E8 C??? F???          M                 MOVFF   (CH6pos+1),(CH6posM+1)
                      04917                 MOVE16  CH7pos,CH7posM
0046EC C??? F???          M                 MOVFF   CH7pos,CH7posM
0046F0 C??? F???          M                 MOVFF   (CH7pos+1),(CH7posM+1)
                      04918                 MOVE16  CH8posActual,CH8posM
0046F4 C??? F???          M                 MOVFF   CH8posActual,CH8posM
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 256


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

0046F8 C??? F???          M                 MOVFF   (CH8posActual+1),(CH8posM+1)
                      04919         ; Look through all mixers for mix to self examples
0046FC 0E??           04920                 MOVLW   HIGH M1Afrom
0046FE 6EE2           04921                 MOVWF   FSR1H,A
004700 0E??           04922                 MOVLW   LOW M1Afrom
004702 6EE1           04923                 MOVWF   FSR1L,A
004704 0E0C           04924                 MOVLW   D'12'
004706 CFE8 F???      04925                 MOVFF   WREG,Areg
00470A                04926 M2Mloop
                      04927                 ; Loop through all the mixers
00470A CFE6 FFE8      04928                 MOVFF   POSTINC1,WREG
00470E 0B0F           04929                 ANDLW   0x0F
004710 B4D8           04930                 BTFSC   ALUSTA,Z
004712 EF?? F???      04931                 GOTO    M2Mnext
                      04932                 ; Here if the mixer is defined
004716 18E7           04933                 XORWF   INDF1,W,A
004718 0B0F           04934                 ANDLW   0x0F
00471A A4D8           04935                 BTFSS   ALUSTA,Z
00471C EF?? F???      04936                 GOTO    M2Mnext
                      04937                 ; Here with a mix to self detected
004720 CFE7 FFE8      04938                 MOVFF   INDF1,WREG
004724 0BF0           04939                 ANDLW   0xF0
004726 0904           04940                 IORLW   4
004728 62E7           04941                 CPFSEQ  INDF1
00472A EF?? F???      04942                 GOTO    M2MtryCH5
                      04943                 ; Here if Throttle
                      04944                 MOVE16  Tpos,TposM
00472E C??? F???          M                 MOVFF   Tpos,TposM
004732 C??? F???          M                 MOVFF   (Tpos+1),(TposM+1)
004736 EF?? F???      04945                 GOTO    M2Mnext 
00473A                04946 M2MtryCH5
00473A CFE7 FFE8      04947                 MOVFF   INDF1,WREG
00473E 0BF0           04948                 ANDLW   0xF0
004740 0905           04949                 IORLW   5
004742 62E7           04950                 CPFSEQ  INDF1
004744 EF?? F???      04951                 GOTO    M2MtryCH8
                      04952                 ; Here if CH5
                      04953                 MOVE16  CH5posActual,CH5posM
004748 C??? F???          M                 MOVFF   CH5posActual,CH5posM
00474C C??? F???          M                 MOVFF   (CH5posActual+1),(CH5posM+1)
004750 EF?? F???      04954                 GOTO    M2Mnext 
004754                04955 M2MtryCH8
004754 CFE7 FFE8      04956                 MOVFF   INDF1,WREG
004758 0BF0           04957                 ANDLW   0xF0
00475A 0908           04958                 IORLW   8
00475C 62E7           04959                 CPFSEQ  INDF1
00475E EF?? F???      04960                 GOTO    M2Mnext
                      04961                 ; Here if CH8
                      04962                 MOVE16  CH8posActual,CH8posM
004762 C??? F???          M                 MOVFF   CH8posActual,CH8posM
004766 C??? F???          M                 MOVFF   (CH8posActual+1),(CH8posM+1)
                      04963                 ; Advanced through all mixers
00476A                04964 M2Mnext
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 257


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

00476A 0E04           04965                 MOVLW   4               ; Advanced to next mixer, this was 5 fixed 12/19/2010
00476C 26E1           04966                 ADDWF   FSR1L
00476E 06??           04967                 DECF    Areg
004770 A4D8           04968                 BTFSS   ALUSTA,Z
004772 EF?? F???      04969                 GOTO    M2Mloop
004776 0012           04970                 RETURN
                      04971 
                      04972 ; This function applies the mixers to all servo channels. The mixer switch
                      04973 ; position are tested and if on the mixers are applied. The preprogramed mix
                      04974 ; function are not applied by the routine
004778                04975 ApplyMixers
004778 EC?? F???      04976                 CALL    Move2Mix
                      04977         ; Test Mixer 1
00477C 01??           04978                 MOVLR   HIGH SWMIX1
00477E 5000           04979                 MOVFP   SWMIX1,WREG
004780 EC?? F???      04980                 CALL    SwitchTest
004784 A0D8           04981                 BTFSS   ALUSTA,C
004786 EF?? F???      04982                 GOTO    APmix2
                      04983                 ; Apply all four mix channels
00478A 0E??           04984                 MOVLW   HIGH M1Afrom
00478C 6EE2           04985                 MOVWF   FSR1H,A
00478E 0E??           04986                 MOVLW   LOW M1Afrom
004790 6EE1           04987                 MOVWF   FSR1L,A
004792 EC?? F???      04988                 CALL    Mixer
004796 0E??           04989                 MOVLW   LOW M1Bfrom
004798 6EE1           04990                 MOVWF   FSR1L,A
00479A EC?? F???      04991                 CALL    Mixer
00479E 0E??           04992                 MOVLW   LOW M1Cfrom
0047A0 6EE1           04993                 MOVWF   FSR1L,A
0047A2 EC?? F???      04994                 CALL    Mixer
0047A6 0E??           04995                 MOVLW   LOW M1Dfrom
0047A8 6EE1           04996                 MOVWF   FSR1L,A
0047AA EC?? F???      04997                 CALL    Mixer
0047AE                04998 APmix2
0047AE EC?? F???      04999                 CALL    Move2Mix
0047B2 01??           05000                 MOVLR   HIGH SWMIX2
0047B4 5000           05001                 MOVFP   SWMIX2,WREG
0047B6 EC?? F???      05002                 CALL    SwitchTest
0047BA A0D8           05003                 BTFSS   ALUSTA,C
0047BC EF?? F???      05004                 GOTO    APmix3
0047C0 0E??           05005                 MOVLW   HIGH M2Afrom
0047C2 6EE2           05006                 MOVWF   FSR1H,A
0047C4 0E??           05007                 MOVLW   LOW M2Afrom
0047C6 6EE1           05008                 MOVWF   FSR1L,A
0047C8 EC?? F???      05009                 CALL    Mixer
0047CC EC?? F???      05010                 CALL    Move2Mix
0047D0 0E??           05011                 MOVLW   LOW M2Bfrom
0047D2 6EE1           05012                 MOVWF   FSR1L,A
0047D4 EC?? F???      05013                 CALL    Mixer
0047D8 EC?? F???      05014                 CALL    Move2Mix
0047DC 0E??           05015                 MOVLW   LOW M2Cfrom
0047DE 6EE1           05016                 MOVWF   FSR1L,A
0047E0 EC?? F???      05017                 CALL    Mixer
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 258


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

0047E4 EC?? F???      05018                 CALL    Move2Mix
0047E8 0E??           05019                 MOVLW   LOW M2Dfrom
0047EA 6EE1           05020                 MOVWF   FSR1L,A
0047EC EC?? F???      05021                 CALL    Mixer
0047F0                05022 APmix3
0047F0 EC?? F???      05023                 CALL    Move2Mix
0047F4 01??           05024                 MOVLR   HIGH SWMIX3
0047F6 5000           05025                 MOVFP   SWMIX3,WREG
0047F8 EC?? F???      05026                 CALL    SwitchTest
0047FC A0D8           05027                 BTFSS   ALUSTA,C
0047FE EF?? F???      05028                 GOTO    APdone
004802 0E??           05029                 MOVLW   HIGH M3Afrom
004804 6EE2           05030                 MOVWF   FSR1H,A
004806 0E??           05031                 MOVLW   LOW M3Afrom
004808 6EE1           05032                 MOVWF   FSR1L,A
00480A EC?? F???      05033                 CALL    Mixer
00480E 0E??           05034                 MOVLW   LOW M3Bfrom
004810 6EE1           05035                 MOVWF   FSR1L,A
004812 EC?? F???      05036                 CALL    Mixer
004816 0E??           05037                 MOVLW   LOW M3Cfrom
004818 6EE1           05038                 MOVWF   FSR1L,A
00481A EC?? F???      05039                 CALL    Mixer
00481E 0E??           05040                 MOVLW   LOW M3Dfrom
004820 6EE1           05041                 MOVWF   FSR1L,A
004822 EC?? F???      05042                 CALL    Mixer
004826                05043 APdone
004826 0012           05044                 RETURN
                      05045 
                      05046 ; This function calculates the fixed mixer functions:
                      05047 ;       Aileron to rudder
                      05048 ;       Rudder to aileron
                      05049 ;       Rudder to elevator
                      05050 ;       Throttle to elevator
                      05051 ; After these functions are performed the mixer
                      05052 ; position array data is copied back to the input
                      05053 ; position array. 
                      05054 ;       Dual elevator
                      05055 ;       VTAIL           Rudder and Elevator mix
                      05056 ;       ELEVON          Aileron and Elevator mix
                      05057 ;       DUALA           Dual aileron
                      05058 ; It is assumed the position variables have been copied to 
                      05059 ; the mixer array. The information is calculated using the
                      05060 ; mixer array as the source and the standard array as the 
                      05061 ; destination.
004828                05062 CalculateFixedMixers
                      05063         ; Aileron to rudder mix
                      05064                 MOVE    AposM,AXreg             ; Load position data
004828 C??? F???          M                 MOVFF   AposM,AXreg
00482C C??? F???          M                 MOVFF   (AposM+1),(AXreg+1)
004830 C??? F???      05065                 MOVFF   AilRudPos,BXreg         ; Load positive mix level as default
004834 01??           05066                 MOVLB   HIGH BXreg
004836 BE??           05067                 BTFSC   AXreg+1,7
004838 C??? F???      05068                 MOVFF   AilRudNeg,BXreg         ; If pos is neg, load neg gain
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 259


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

00483C 6A??           05069                 CLRF    BXreg+1
00483E BE??           05070                 BTFSC   BXreg,7
004840 68??           05071                 SETF    BXreg+1                 ; Sign extend
004842 EC?? F???      05072                 CALL    Mult1616                ; CEXreg = AXreg * BXreg
                      05073                 MOVEC   D'100',DEXreg
004846 01??               M                 MOVLR   HIGH (DEXreg)
004848 0E64               M                 MOVLW   LOW (D'100')
00484A 6E??               M                 MOVWF   (DEXreg)
00484C 0E00               M                 MOVLW   HIGH (D'100')
00484E 6E??               M                 MOVWF   (DEXreg+1)
004850 EC?? F???      05074                 CALL    Divide2416              ; CEXreg = CEXreg / DEXreg
                      05075                 ; Add mix level in CEXreg to rudder position
004854 01??           05076                 MOVLB   HIGH RposM
004856 C??? FFE8      05077                 MOVFF   CEXreg,WREG
00485A 26??           05078                 ADDWF   RposM
00485C C??? FFE8      05079                 MOVFF   CEXreg+1,WREG
004860 22??           05080                 ADDWFC  RposM+1
                      05081         ; Rudder to aileron mix
                      05082                 MOVE    RposM,AXreg             ; Load position data
004862 C??? F???          M                 MOVFF   RposM,AXreg
004866 C??? F???          M                 MOVFF   (RposM+1),(AXreg+1)
00486A C??? F???      05083                 MOVFF   RudAilPos,BXreg         ; Load positive mix level as default
00486E 01??           05084                 MOVLB   HIGH BXreg
004870 BE??           05085                 BTFSC   AXreg+1,7
004872 C??? F???      05086                 MOVFF   RudAilNeg,BXreg         ; If pos is neg, load neg gain
004876 6A??           05087                 CLRF    BXreg+1
004878 BE??           05088                 BTFSC   BXreg,7
00487A 68??           05089                 SETF    BXreg+1                 ; Sign extend
00487C EC?? F???      05090                 CALL    Mult1616                ; CEXreg = AXreg * BXreg
                      05091                 MOVEC   D'100',DEXreg
004880 01??               M                 MOVLR   HIGH (DEXreg)
004882 0E64               M                 MOVLW   LOW (D'100')
004884 6E??               M                 MOVWF   (DEXreg)
004886 0E00               M                 MOVLW   HIGH (D'100')
004888 6E??               M                 MOVWF   (DEXreg+1)
00488A EC?? F???      05092                 CALL    Divide2416              ; CEXreg = CEXreg / DEXreg
                      05093                 ; Add mix level in CEXreg to aileron position
00488E 01??           05094                 MOVLB   HIGH AposM
004890 C??? FFE8      05095                 MOVFF   CEXreg,WREG
004894 26??           05096                 ADDWF   AposM
004896 C??? FFE8      05097                 MOVFF   CEXreg+1,WREG
00489A 22??           05098                 ADDWFC  AposM+1
                      05099         ; Rudder to elevator mix
                      05100                 MOVE    RposM,AXreg             ; Load position data
00489C C??? F???          M                 MOVFF   RposM,AXreg
0048A0 C??? F???          M                 MOVFF   (RposM+1),(AXreg+1)
0048A4 C??? F???      05101                 MOVFF   RudElePos,BXreg         ; Load positive mix level as default
0048A8 01??           05102                 MOVLB   HIGH BXreg
0048AA BE??           05103                 BTFSC   AXreg+1,7
0048AC C??? F???      05104                 MOVFF   RudEleNeg,BXreg         ; If pos is neg, load neg gain
0048B0 6A??           05105                 CLRF    BXreg+1
0048B2 BE??           05106                 BTFSC   BXreg,7
0048B4 68??           05107                 SETF    BXreg+1                 ; Sign extend
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 260


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

0048B6 EC?? F???      05108                 CALL    Mult1616                ; CEXreg = AXreg * BXreg
                      05109                 MOVEC   D'100',DEXreg
0048BA 01??               M                 MOVLR   HIGH (DEXreg)
0048BC 0E64               M                 MOVLW   LOW (D'100')
0048BE 6E??               M                 MOVWF   (DEXreg)
0048C0 0E00               M                 MOVLW   HIGH (D'100')
0048C2 6E??               M                 MOVWF   (DEXreg+1)
0048C4 EC?? F???      05110                 CALL    Divide2416              ; CEXreg = CEXreg / DEXreg
                      05111                 ; Add mix level in CEXreg to elevator position
0048C8 01??           05112                 MOVLB   HIGH EposM
0048CA C??? FFE8      05113                 MOVFF   CEXreg,WREG
0048CE 26??           05114                 ADDWF   EposM
0048D0 C??? FFE8      05115                 MOVFF   CEXreg+1,WREG
0048D4 22??           05116                 ADDWFC  EposM+1
                      05117         ; Throttle to elevator mix
                      05118                 MOVE    TposM,AXreg             ; Load position data
0048D6 C??? F???          M                 MOVFF   TposM,AXreg
0048DA C??? F???          M                 MOVFF   (TposM+1),(AXreg+1)
0048DE C??? F???      05119                 MOVFF   ThtEle,BXreg            ; Load mix level
0048E2 01??           05120                 MOVLB   HIGH BXreg
                      05121 ;               BTFSC   AXreg+1,7               ; This statement is a bug! GAA 12/19/11
0048E4 6A??           05122                 CLRF    BXreg+1
0048E6 BE??           05123                 BTFSC   BXreg,7
0048E8 68??           05124                 SETF    BXreg+1                 ; Sign extend
0048EA EC?? F???      05125                 CALL    Mult1616                ; CEXreg = AXreg * BXreg
                      05126                 MOVEC   D'100',DEXreg
0048EE 01??               M                 MOVLR   HIGH (DEXreg)
0048F0 0E64               M                 MOVLW   LOW (D'100')
0048F2 6E??               M                 MOVWF   (DEXreg)
0048F4 0E00               M                 MOVLW   HIGH (D'100')
0048F6 6E??               M                 MOVWF   (DEXreg+1)
0048F8 EC?? F???      05127                 CALL    Divide2416              ; CEXreg = CEXreg / DEXreg
                      05128                 ; Add mix level in CEXreg to elevator position
0048FC 01??           05129                 MOVLB   HIGH EposM
0048FE C??? FFE8      05130                 MOVFF   CEXreg,WREG
004902 26??           05131                 ADDWF   EposM
004904 C??? FFE8      05132                 MOVFF   CEXreg+1,WREG
004908 22??           05133                 ADDWFC  EposM+1 
                      05134         ; Copy the mix results to the position array
                      05135                 MOVE    AposM,Apos
00490A C??? F???          M                 MOVFF   AposM,Apos
00490E C??? F???          M                 MOVFF   (AposM+1),(Apos+1)
                      05136                 MOVE    EposM,Epos
004912 C??? F???          M                 MOVFF   EposM,Epos
004916 C??? F???          M                 MOVFF   (EposM+1),(Epos+1)
                      05137                 MOVE    RposM,Rpos
00491A C??? F???          M                 MOVFF   RposM,Rpos
00491E C??? F???          M                 MOVFF   (RposM+1),(Rpos+1)
                      05138 ;               MOVE    TposM,Tpos
                      05139                 MOVE    TposM,TposActual
004922 C??? F???          M                 MOVFF   TposM,TposActual
004926 C??? F???          M                 MOVFF   (TposM+1),(TposActual+1)
                      05140         ; Dual Elevator mixing function. Use CH6 for the second elevator
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 261


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

00492A 01??           05141                 MOVLR   HIGH DualE
00492C A0??           05142                 BTFSS   DualE,0
00492E EF?? F???      05143                 GOTO    AFM0z
                      05144                 ; Here if dual elevator mixing is enabled
                      05145                 MOVE    EposM,CH6pos
004932 C??? F???          M                 MOVFF   EposM,CH6pos
004936 C??? F???          M                 MOVFF   (EposM+1),(CH6pos+1)
00493A                05146 AFM0z
                      05147         ; VTAIL mixing, VTAIL flag is 0 if off
                      05148         ;    Rudder   = Elevator/2 + Rudder/2
                      05149         ;    Elevator = Elevator/2 - Rudder/2
00493A 01??           05150                 MOVLR   HIGH VTAIL
00493C A0??           05151                 BTFSS   VTAIL,0
00493E EF?? F???      05152                 GOTO    AFM1
                      05153                 ; Here if the Vtail is enabled.
                      05154                 MOVE    EposM,AXreg
004942 C??? F???          M                 MOVFF   EposM,AXreg
004946 C??? F???          M                 MOVFF   (EposM+1),(AXreg+1)
                      05155                 MOVE    RposM,BXreg
00494A C??? F???          M                 MOVFF   RposM,BXreg
00494E C??? F???          M                 MOVFF   (RposM+1),(BXreg+1)
004952 01??           05156                 MOVLR   HIGH AXreg
                      05157                 ; Do the math...
                      05158                 MOVE    AXreg,Epos
004954 C??? F???          M                 MOVFF   AXreg,Epos
004958 C??? F???          M                 MOVFF   (AXreg+1),(Epos+1)
                      05159                 MOVE    AXreg,Rpos
00495C C??? F???          M                 MOVFF   AXreg,Rpos
004960 C??? F???          M                 MOVFF   (AXreg+1),(Rpos+1)
004964 5000           05160                 MOVFP   BXreg,WREG
004966 26??           05161                 ADDWF   Rpos
004968 5000           05162                 MOVFP   BXreg+1,WREG
00496A 22??           05163                 ADDWFC  Rpos+1
00496C 5000           05164                 MOVFP   BXreg,WREG
00496E 5E??           05165                 SUBWF   Epos
004970 5000           05166                 MOVFP   BXreg+1,WREG
004972 5A??           05167                 SUBWFB  Epos+1
                      05168         ; ELEVON mixing, ELEVON flag is 0 if off
                      05169         ;    Aileron  = Elevator/2 + Aileron/2
                      05170         ;    Elevator = Elevator/2 - Aileron/2
004974                05171 AFM1
004974 01??           05172                 MOVLR   HIGH ELEVON
004976 A0??           05173                 BTFSS   ELEVON,0
004978 EF?? F???      05174                 GOTO    AFM2
                      05175                 ; Here if the ELEVON is enabled.
                      05176                 MOVE    EposM,AXreg
00497C C??? F???          M                 MOVFF   EposM,AXreg
004980 C??? F???          M                 MOVFF   (EposM+1),(AXreg+1)
                      05177                 MOVE    AposM,BXreg
004984 C??? F???          M                 MOVFF   AposM,BXreg
004988 C??? F???          M                 MOVFF   (AposM+1),(BXreg+1)
00498C 01??           05178                 MOVLR   HIGH AXreg
                      05179                 ; Do the math...
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 262


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      05180                 MOVE    AXreg,Epos
00498E C??? F???          M                 MOVFF   AXreg,Epos
004992 C??? F???          M                 MOVFF   (AXreg+1),(Epos+1)
                      05181                 MOVE    AXreg,Apos
004996 C??? F???          M                 MOVFF   AXreg,Apos
00499A C??? F???          M                 MOVFF   (AXreg+1),(Apos+1)
00499E 5000           05182                 MOVFP   BXreg,WREG
0049A0 26??           05183                 ADDWF   Apos
0049A2 5000           05184                 MOVFP   BXreg+1,WREG
0049A4 22??           05185                 ADDWFC  Apos+1
0049A6 5000           05186                 MOVFP   BXreg,WREG
0049A8 5E??           05187                 SUBWF   Epos
0049AA 5000           05188                 MOVFP   BXreg+1,WREG
0049AC 5A??           05189                 SUBWFB  Epos+1
                      05190         ; DUALA, dual aileron mixing. CH7 used for second
                      05191         ; aileron channel
0049AE                05192 AFM2
0049AE 01??           05193                 MOVLR   HIGH DUALA
0049B0 A0??           05194                 BTFSS   DUALA,0
0049B2 EF?? F???      05195                 GOTO    AFM3
                      05196                 ; Here if the DUALA is enabled.
                      05197                 MOVE    AposM,AXreg
0049B6 C??? F???          M                 MOVFF   AposM,AXreg
0049BA C??? F???          M                 MOVFF   (AposM+1),(AXreg+1)
                      05198                 MOVE    AXreg,Apos
0049BE C??? F???          M                 MOVFF   AXreg,Apos
0049C2 C??? F???          M                 MOVFF   (AXreg+1),(Apos+1)
                      05199                 MOVE    AXreg,CH7pos
0049C6 C??? F???          M                 MOVFF   AXreg,CH7pos
0049CA C??? F???          M                 MOVFF   (AXreg+1),(CH7pos+1)
0049CE 01??           05200                 MOVLR   HIGH CH7pos
0049D0 1E??           05201                 COMF    CH7pos
0049D2 1E??           05202                 COMF    CH7pos+1
0049D4 4A??           05203                 INFSNZ  CH7pos
0049D6 2A??           05204                 INCF    CH7pos+1
                      05205                 ; Apply the diferential.
                      05206                 MOVEC   D'100',DEXreg
0049D8 01??               M                 MOVLR   HIGH (DEXreg)
0049DA 0E64               M                 MOVLW   LOW (D'100')
0049DC 6E??               M                 MOVWF   (DEXreg)
0049DE 0E00               M                 MOVLW   HIGH (D'100')
0049E0 6E??               M                 MOVWF   (DEXreg+1)
0049E2 01??           05207                 MOVLR   HIGH DIFFA
0049E4 5000           05208                 MOVFP   DIFFA,WREG
0049E6 12E8           05209                 IORWF   WREG
0049E8 B4D8           05210                 BTFSC   ALUSTA,Z
0049EA EF?? F???      05211                 GOTO    AFM2a
                      05212                 ; If the percentage is positive then apply to positive servo 
                      05213                 ; position, if negative apply to negative servo positions.
0049EE BEE8           05214                 BTFSC   WREG,7
0049F0 EF?? F???      05215                 GOTO    AFM2b
                      05216                 ; Here if positive
0049F4 0864           05217                 SUBLW   D'100'          ; WREG = 100 - DIFFA
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 263


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

0049F6 01??           05218                 MOVLR   HIGH Apos
0049F8 6E??           05219                 MOVWF   BXreg
0049FA 6A??           05220                 CLRF    BXreg+1
0049FC BE??           05221                 BTFSC   Apos+1,7
0049FE EF?? F???      05222                 GOTO    AFM2c
                      05223                 MOVE    Apos,AXreg
004A02 C??? F???          M                 MOVFF   Apos,AXreg
004A06 C??? F???          M                 MOVFF   (Apos+1),(AXreg+1)
004A0A EC?? F???      05224                 CALL    Mult1616        ; CEXreg = AXreg * BXreg
004A0E EC?? F???      05225                 CALL    Divide2416
                      05226                 MOVE    CEXreg,Apos
004A12 C??? F???          M                 MOVFF   CEXreg,Apos
004A16 C??? F???          M                 MOVFF   (CEXreg+1),(Apos+1)
004A1A EF?? F???      05227                 GOTO    AFM2a
004A1E                05228 AFM2c
004A1E 01??           05229                 MOVLR   HIGH CH7pos
                      05230                 MOVE    CH7pos,AXreg
004A20 C??? F???          M                 MOVFF   CH7pos,AXreg
004A24 C??? F???          M                 MOVFF   (CH7pos+1),(AXreg+1)
004A28 EC?? F???      05231                 CALL    Mult1616        ; CEXreg = AXreg * BXreg
004A2C EC?? F???      05232                 CALL    Divide2416
                      05233                 MOVE    CEXreg,CH7pos
004A30 C??? F???          M                 MOVFF   CEXreg,CH7pos
004A34 C??? F???          M                 MOVFF   (CEXreg+1),(CH7pos+1)
004A38 EF?? F???      05234                 GOTO    AFM2a
004A3C                05235 AFM2b           ; Here if negative
004A3C 0F64           05236                 ADDLW   D'100'          ; WREG = 100 + DIFFA
004A3E 01??           05237                 MOVLR   HIGH Apos
004A40 6E??           05238                 MOVWF   BXreg
004A42 6A??           05239                 CLRF    BXreg+1
004A44 AE??           05240                 BTFSS   Apos+1,7
004A46 EF?? F???      05241                 GOTO    AFM2d
                      05242                 MOVE    Apos,AXreg
004A4A C??? F???          M                 MOVFF   Apos,AXreg
004A4E C??? F???          M                 MOVFF   (Apos+1),(AXreg+1)
004A52 EC?? F???      05243                 CALL    Mult1616        ; CEXreg = AXreg * BXreg
004A56 EC?? F???      05244                 CALL    Divide2416
                      05245                 MOVE    CEXreg,Apos
004A5A C??? F???          M                 MOVFF   CEXreg,Apos
004A5E C??? F???          M                 MOVFF   (CEXreg+1),(Apos+1)
004A62 EF?? F???      05246                 GOTO    AFM2a
004A66                05247 AFM2d
004A66 01??           05248                 MOVLR   HIGH CH7pos
                      05249                 MOVE    CH7pos,AXreg
004A68 C??? F???          M                 MOVFF   CH7pos,AXreg
004A6C C??? F???          M                 MOVFF   (CH7pos+1),(AXreg+1)
004A70 EC?? F???      05250                 CALL    Mult1616        ; CEXreg = AXreg * BXreg
004A74 EC?? F???      05251                 CALL    Divide2416
                      05252                 MOVE    CEXreg,CH7pos
004A78 C??? F???          M                 MOVFF   CEXreg,CH7pos
004A7C C??? F???          M                 MOVFF   (CEXreg+1),(CH7pos+1)
004A80                05253 AFM2a
                      05254                 ; Apply flapperrons:
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 264


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      05255                 ;  Use the old CH7pos signal as the flap control.
                      05256                 ;  CH7pos/2 * gain / 100
                      05257                 ;  FPgain for positive gain
                      05258                 ;  FPgainN for negative gain
                      05259                 MOVEC   D'100',DEXreg   ; Will be used later as a divisor
004A80 01??               M                 MOVLR   HIGH (DEXreg)
004A82 0E64               M                 MOVLW   LOW (D'100')
004A84 6E??               M                 MOVWF   (DEXreg)
004A86 0E00               M                 MOVLW   HIGH (D'100')
004A88 6E??               M                 MOVWF   (DEXreg+1)
                      05260                 ; If CROW is enabled and CROW switch is OFF then jump out
004A8A 01??           05261                 MOVLR   HIGH CROWENA    ; Test for CROW enable...
004A8C 5000           05262                 MOVFP   CROWENA,WREG
004A8E 12E8           05263                 IORWF   WREG
004A90 B4D8           05264                 BTFSC   ALUSTA,Z
004A92 EF?? F???      05265                 GOTO    AFM2aa          ; Jump if CROW is disabled
004A96 01??           05266                 MOVLR   HIGH SWCROW
004A98 5000           05267                 MOVFP   SWCROW,WREG
004A9A EC?? F???      05268                 CALL    SwitchTest
004A9E A0D8           05269                 BTFSS   ALUSTA,C
004AA0 EF?? F???      05270                 GOTO    AFM2e           ; Jump out if CROW switch is off
                      05271                 ; Here if CROW mixing is enabled.
                      05272                 MOVEC   D'1000',AXreg
004AA4 01??               M                 MOVLR   HIGH (AXreg)
004AA6 0EE8               M                 MOVLW   LOW (D'1000')
004AA8 6E??               M                 MOVWF   (AXreg)
004AAA 0E03               M                 MOVLW   HIGH (D'1000')
004AAC 6E??               M                 MOVWF   (AXreg+1)
004AAE 5000           05273                 MOVFP   TposM,WREG
004AB0 5E??           05274                 SUBWF   AXreg,F
004AB2 5000           05275                 MOVFP   TposM+1,WREG
004AB4 5A??           05276                 SUBWFB  AXreg+1,F       ; AXreg = 1000 - TposM
004AB6 EF?? F???      05277                 GOTO    AFM2aaa
                      05278                 ; Here to apply the flap, first calculate the position
004ABA                05279 AFM2aa
                      05280                 MOVE    CH7posM,AXreg
004ABA C??? F???          M                 MOVFF   CH7posM,AXreg
004ABE C??? F???          M                 MOVFF   (CH7posM+1),(AXreg+1)
004AC2 C??? F???      05281 AFM2aaa         MOVFF   FPgain,BXreg
004AC6 01??           05282                 MOVLR   HIGH AXreg
004AC8 BE??           05283                 BTFSC   AXreg+1,7
004ACA C??? F???      05284                 MOVFF   FPgainN,BXreg
004ACE 6A??           05285                 CLRF    BXreg+1
004AD0 BE??           05286                 BTFSC   BXreg,7
004AD2 1E??           05287                 COMF    BXreg+1
004AD4 EC?? F???      05288                 CALL    Mult1616
004AD8 EC?? F???      05289                 CALL    Divide2416              ; Ans is now in CExreg
                      05290                 ; Apply to Apos...
004ADC 5000           05291                 MOVFP   CEXreg,WREG
004ADE 26??           05292                 ADDWF   Apos,F
004AE0 5000           05293                 MOVFP   CEXreg+1,WREG
004AE2 22??           05294                 ADDWFC  Apos+1,F
                      05295                 ; Apply to CH7pos...
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 265


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

004AE4 01??           05296                 MOVLR   HIGH CEXreg
004AE6 5000           05297                 MOVFP   CEXreg,WREG
004AE8 26??           05298                 ADDWF   CH7pos,F
004AEA 5000           05299                 MOVFP   CEXreg+1,WREG
004AEC 22??           05300                 ADDWFC  CH7pos+1,F
004AEE                05301 AFM2e
004AEE                05302 AFM3
004AEE 0012           05303                 RETURN
                      05304 
004AF0                05305 ApplyFixedMixersPrior
                      05306         ; If the FixedFirst flag is clear then exit
004AF0 01??           05307                 MOVLR   HIGH FixedFirst
004AF2 A0??           05308                 BTFSS   FixedFirst,0
004AF4 0012           05309                 RETURN
                      05310         ; Now do the processing...
004AF6 EC?? F???      05311                 CALL    Move2Mix
004AFA EC?? F???      05312                 CALL    CalculateFixedMixers    
004AFE 0012           05313                 RETURN
                      05314 
                      05315 ; This function is designed to apply the fixed mixers used for the
                      05316 ; follwoing functions:
                      05317 ;       VTAIL           Rudder and Elevator mix
                      05318 ;       ELEVON          Aileron and Elevator mix
                      05319 ;       DUALA           Dual aileron
                      05320 ;       Throttle hold   Using channel 5
                      05321 ;       Idle up         Using channel 8
004B00                05322 ApplyFixedMixers
                      05323         ; Calculate the fixed mixer functions...
                      05324                 ; If the FixedFirst flag is clear...
004B00 01??           05325                 MOVLR   HIGH FixedFirst
004B02 B0??           05326                 BTFSC   FixedFirst,0
004B04 EF?? F???      05327                 GOTO    AFM0
004B08 EC?? F???      05328                 CALL    Move2Mix
004B0C EC?? F???      05329                 CALL    CalculateFixedMixers
                      05330         ; Idle up. If set then channel 8 is used to enable
                      05331         ; two idle up levels
004B10                05332 AFM0
004B10 01??           05333                 MOVLR   HIGH IDLEUP
004B12 A0??           05334                 BTFSS   IDLEUP,0
004B14 EF?? F???      05335                 GOTO    AFM5
                      05336                 ; Here if idle up is enabled, test switch
004B18 01??           05337                 MOVLR   HIGH SWIDLEUP1
004B1A 5000           05338                 MOVFP   SWIDLEUP1,WREG
004B1C EC?? F???      05339                 CALL    SwitchTest
004B20 A0D8           05340                 BTFSS   ALUSTA,C
004B22 EF?? F???      05341                 GOTO    AFM4a
004B26 01??           05342                 MOVLR   HIGH IDLEUPpA
004B28 5000           05343                 MOVFP   IDLEUPpA,WREG
004B2A EF?? F???      05344                 GOTO    AFM4c
                      05345                 ; Test for idle up position 2
004B2E 01??           05346 AFM4a           MOVLR   HIGH SWIDLEUP2
004B30 5000           05347                 MOVFP   SWIDLEUP2,WREG
004B32 EC?? F???      05348                 CALL    SwitchTest
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 266


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

004B36 A0D8           05349                 BTFSS   ALUSTA,C
004B38 EF?? F???      05350                 GOTO    AFM5
004B3C 01??           05351                 MOVLR   HIGH IDLEUPpB
004B3E 5000           05352                 MOVFP   IDLEUPpB,WREG
                      05353                 ; WREG has the idle up percentage...
004B40 01??           05354 AFM4c           MOVLR   HIGH AXreg
004B42 6E??           05355                 MOVWF   AXreg
004B44 6A??           05356                 CLRF    AXreg+1
                      05357                 MOVEC   D'10',BXreg
004B46 01??               M                 MOVLR   HIGH (BXreg)
004B48 0E0A               M                 MOVLW   LOW (D'10')
004B4A 6E??               M                 MOVWF   (BXreg)
004B4C 0E00               M                 MOVLW   HIGH (D'10')
004B4E 6E??               M                 MOVWF   (BXreg+1)
004B50 EC?? F???      05358                 CALL    Mult1616
                      05359                 ; Test IDLE position, if less that CEXreg then set throttle
                      05360                 ; position to CEXreg
004B54 5000           05361                 MOVFP   CEXreg,WREG
004B56 5C??           05362                 SUBWF   Tpos,W
004B58 5000           05363                 MOVFP   CEXreg+1,WREG
004B5A 58??           05364                 SUBWFB  Tpos+1,W
004B5C AEE8           05365                 BTFSS   WREG,7
004B5E EF?? F???      05366                 GOTO    AFM5
                      05367                 MOVE    CEXreg,Tpos
004B62 C??? F???          M                 MOVFF   CEXreg,Tpos
004B66 C??? F???          M                 MOVFF   (CEXreg+1),(Tpos+1)
004B6A                05368 AFM5
004B6A 0012           05369                 RETURN
                      05370 
                      05371 ;
                      05372 ; This function applies the CCPM mixer. The CCPMmode flag defines the type of mixing that
                      05373 ; is applied:
                      05374 ;       0 = off
                      05375 ;       1 = 3 servo 120 degree
                      05376 ;       2 = 3 servo 140 degree
                      05377 ;       3 = 3 servo 90 degree
                      05378 ;
                      05379 ;    CH6   Ail
                      05380 ;       \ /
                      05381 ;        |
                      05382 ;       Ele
                      05383 ;
                      05384 ; For 3 servos 120 degrees
                      05385 ;       CH6 = CH6 - Ail - .5Ele
                      05386 ;       Ail = CH6 + Ail - .5Ele
                      05387 ;       Ele = CH6 + Ele
                      05388 ;
                      05389 ; For 3 servos 140 degrees, equal arm lengths
                      05390 ;       CH6 = CH6 - Ail - Ele
                      05391 ;       Ail = CH6 + Ail - Ele
                      05392 ;       Ele = CH6 + Ele
                      05393 ;
                      05394 ;    CH6- -Ail
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 267


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      05395 ;        |
                      05396 ;       Ele
                      05397 ;
                      05398 ; For 3 servos 90 degrees
                      05399 ;       CH6 = CH6 - Ail
                      05400 ;       Ail = CH6 + Ail
                      05401 ;       Ele = CH6 + Ele
                      05402 ;
004B6C                05403 CCPMmixer
                      05404         ; Exit if we are not in the helicopter mode
004B6C 01??           05405                 MOVLR   HIGH Henable
004B6E A0??           05406                 BTFSS   Henable,0
004B70 0012           05407                 RETURN
                      05408         ; If mode is zero, exit
004B72 C??? FFE8      05409                 MOVFF   CCPMmode,WREG
004B76 12E8           05410                 IORWF   WREG
004B78 B4D8           05411                 BTFSC   ALUSTA,Z
004B7A 0012           05412                 RETURN
                      05413         ; Reverse the Ail input if the HArev flag is set
004B7C 01??           05414                 MOVLR   HIGH HArev
004B7E A0??           05415                 BTFSS   HArev,0
004B80 EF?? F???      05416                 GOTO    CCPM1
                      05417                 ; Here to reverse the sign
004B84 01??           05418                 MOVLR   HIGH Apos
004B86 1E??           05419                 COMF    Apos
004B88 1E??           05420                 COMF    Apos+1
004B8A 2A??           05421                 INCF    Apos
004B8C B4D8           05422                 BTFSC   ALUSTA,Z
004B8E 2A??           05423                 INCF    Apos+1
004B90                05424 CCPM1
                      05425         ; Reverse the Ele input if the HErev flag is set
004B90 01??           05426                 MOVLR   HIGH HErev
004B92 A0??           05427                 BTFSS   HErev,0
004B94 EF?? F???      05428                 GOTO    CCPM2
                      05429                 ; Here to reverse the sign
004B98 01??           05430                 MOVLR   HIGH Epos
004B9A 1E??           05431                 COMF    Epos
004B9C 1E??           05432                 COMF    Epos+1
004B9E 2A??           05433                 INCF    Epos
004BA0 B4D8           05434                 BTFSC   ALUSTA,Z
004BA2 2A??           05435                 INCF    Epos+1
004BA4                05436 CCPM2
                      05437         ; First calculate 3 servo 90 degree because all 3 modes need these values
                      05438         ; as a starting point
                      05439                 MOVE    Apos,AXreg
004BA4 C??? F???          M                 MOVFF   Apos,AXreg
004BA8 C??? F???          M                 MOVFF   (Apos+1),(AXreg+1)
                      05440                 MOVE    Epos,BXreg
004BAC C??? F???          M                 MOVFF   Epos,BXreg
004BB0 C??? F???          M                 MOVFF   (Epos+1),(BXreg+1)
                      05441                 MOVE    CH6pos,Apos
004BB4 C??? F???          M                 MOVFF   CH6pos,Apos
004BB8 C??? F???          M                 MOVFF   (CH6pos+1),(Apos+1)
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 268


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      05442                 MOVE    CH6pos,Epos
004BBC C??? F???          M                 MOVFF   CH6pos,Epos
004BC0 C??? F???          M                 MOVFF   (CH6pos+1),(Epos+1)
004BC4 01??           05443                 MOVLR   HIGH Apos
004BC6 C??? FFE8      05444                 MOVFF   AXreg,WREG
004BCA 26??           05445                 ADDWF   Apos
004BCC C??? FFE8      05446                 MOVFF   AXreg+1,WREG
004BD0 22??           05447                 ADDWFC  Apos+1
004BD2 C??? FFE8      05448                 MOVFF   AXreg,WREG
004BD6 5E??           05449                 SUBWF   CH6pos
004BD8 C??? FFE8      05450                 MOVFF   AXreg+1,WREG
004BDC 5A??           05451                 SUBWFB  CH6pos+1
004BDE C??? FFE8      05452                 MOVFF   BXreg,WREG
004BE2 26??           05453                 ADDWF   Epos
004BE4 C??? FFE8      05454                 MOVFF   BXreg+1,WREG
004BE8 22??           05455                 ADDWFC  Epos+1
                      05456                 ; Exit if the CCPMmode is 3
004BEA C??? FFE8      05457                 MOVFF   CCPMmode,WREG
004BEE 0803           05458                 SUBLW   3
004BF0 B4D8           05459                 BTFSC   ALUSTA,Z
004BF2 0012           05460                 RETURN
                      05461         ; Divide BXreg by 2
004BF4 01??           05462                 MOVLR   HIGH BXreg
004BF6 90D8           05463                 BCF     ALUSTA,C
004BF8 BE??           05464                 BTFSC   BXreg+1,7
004BFA 80D8           05465                 BSF     ALUSTA,C
004BFC 32??           05466                 RRCF    BXreg+1
004BFE 32??           05467                 RRCF    BXreg
                      05468         ; Calculate the 120 degree mode
004C00 01??           05469                 MOVLR   HIGH Apos
004C02 C??? FFE8      05470                 MOVFF   BXreg,WREG
004C06 5E??           05471                 SUBWF   CH6pos
004C08 C??? FFE8      05472                 MOVFF   BXreg+1,WREG
004C0C 5A??           05473                 SUBWFB  CH6pos+1
004C0E C??? FFE8      05474                 MOVFF   BXreg,WREG
004C12 5E??           05475                 SUBWF   Apos
004C14 C??? FFE8      05476                 MOVFF   BXreg+1,WREG
004C18 5A??           05477                 SUBWFB  Apos+1
                      05478                 ; Exit if CCPMmode is 1
004C1A C??? FFE8      05479                 MOVFF   CCPMmode,WREG
004C1E 0801           05480                 SUBLW   1
004C20 B4D8           05481                 BTFSC   ALUSTA,Z
004C22 0012           05482                 RETURN
                      05483         ; Calculate the 140 degree mode
004C24 01??           05484                 MOVLR   HIGH Apos
004C26 C??? FFE8      05485                 MOVFF   BXreg,WREG
004C2A 5E??           05486                 SUBWF   CH6pos
004C2C C??? FFE8      05487                 MOVFF   BXreg+1,WREG
004C30 5A??           05488                 SUBWFB  CH6pos+1
004C32 C??? FFE8      05489                 MOVFF   BXreg,WREG
004C36 5E??           05490                 SUBWF   Apos
004C38 C??? FFE8      05491                 MOVFF   BXreg+1,WREG
004C3C 5A??           05492                 SUBWFB  Apos+1
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 269


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

004C3E 0012           05493                 RETURN
                      05494 
                      05495 ; This function applies the translation table, pointed to by the MS 4 bits
                      05496 ; of Breg, to the 16 bit value in AXreg.
004C40                05497 Translation
                      05498         ; Exit if table address is 0
004C40 C??? FFE8      05499                 MOVFF   Breg,WREG
004C44 0BF0           05500                 ANDLW   0F0
004C46 B4D8           05501                 BTFSC   ALUSTA,Z
004C48 0012           05502                 RETURN
                      05503                 MOVE    AXreg,Pos
004C4A C??? F???          M                 MOVFF   AXreg,Pos
004C4E C??? F???          M                 MOVFF   (AXreg+1),(Pos+1)
                      05504         ; If AXreg is neg, change its sign...
004C52 AE??           05505                 BTFSS   AXreg+1,7
004C54 EF?? F???      05506                 GOTO    Trans1
004C58 1E??           05507                 COMF    AXreg
004C5A 1E??           05508                 COMF    AXreg+1
004C5C 2A??           05509                 INCF    AXreg
004C5E B0D8           05510                 BTFSC   ALUSTA,C
004C60 2A??           05511                 INCF    AXreg+1
004C62                05512 Trans1
                      05513         ; Here if we have a table address in Breg
                      05514         ; Calculate the table index
                      05515                 MOVE    AXreg,CEXreg
004C62 C??? F???          M                 MOVFF   AXreg,CEXreg
004C66 C??? F???          M                 MOVFF   (AXreg+1),(CEXreg+1)
004C6A 0E64           05516                 MOVLW   D'100'
004C6C 6E??           05517                 MOVWF   DEXreg
004C6E EC?? F???      05518                 CALL    Divide168
004C72 01??           05519                 MOVLB   HIGH EEXreg
004C74 6A??           05520                 CLRF    EEXreg+1
                      05521                 ; CEXreg now contains the index into the tables number defined
                      05522                 ; in the upper 4 bit of Breg. Test this value, if its greater than
                      05523                 ; 9 set it to 9
004C76 0E09           05524                 MOVLW   D'9'
004C78 60??           05525                 CPFSLT  CEXreg
004C7A EF?? F???      05526                 GOTO    Trans5
004C7E C??? FFE8      05527                 MOVFF   Breg,WREG
004C82 3AE8           05528                 SWAPF   WREG
004C84 06E8           05529                 DECF    WREG
004C86 0B0F           05530                 ANDLW   0F
004C88 CFE8 F???      05531                 MOVFF   WREG,Breg
004C8C B6E8           05532                 BTFSC   WREG,3
004C8E EF?? F???      05533                 GOTO    Trans3
004C92 EF?? F???      05534                 GOTO    Trans4
                      05535         ; Here if index is over 9, need to calculate a new remainder
004C96                05536 Trans5
004C96 6E??           05537                 MOVWF   CEXreg
                      05538                 MOVE    AXreg,EEXreg
004C98 C??? F???          M                 MOVFF   AXreg,EEXreg
004C9C C??? F???          M                 MOVFF   (AXreg+1),(EEXreg+1)
004CA0 0E84           05539                 MOVLW   LOW D'900'
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 270


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

004CA2 01??           05540                 MOVLB   HIGH EEXreg
004CA4 5E??           05541                 SUBWF   EEXreg
004CA6 0E03           05542                 MOVLW   HIGH D'900'
004CA8 5A??           05543                 SUBWFB  EEXreg+1
004CAA C??? FFE8      05544                 MOVFF   Breg,WREG
004CAE 3AE8           05545                 SWAPF   WREG
004CB0 06E8           05546                 DECF    WREG
004CB2 0B0F           05547                 ANDLW   0F
004CB4 CFE8 F???      05548                 MOVFF   WREG,Breg
004CB8 B6E8           05549                 BTFSC   WREG,3
004CBA EF?? F???      05550                 GOTO    Trans3          
                      05551         ; Load pointer to global table
004CBE                05552 Trans4
004CBE 0E??           05553                 MOVLW   HIGH Table1
004CC0 CFE8 FFDA      05554                 MOVFF   WREG,FSR2H
                      05555                 ; Index into table based table number in Breg
004CC4 C??? FFE8      05556                 MOVFF   Breg,WREG
004CC8 0D0B           05557                 MULLW   D'11'
004CCA 50F3           05558                 MOVFP   PRODL,WREG
004CCC 0F??           05559                 ADDLW   LOW Table1      ; WREG now holds index into the proper table
004CCE EF?? F???      05560                 GOTO    Trans2
                      05561         ; Load pointer to aircraft table
004CD2                05562 Trans3
004CD2 0E??           05563                 MOVLW   HIGH Atable1
004CD4 CFE8 FFDA      05564                 MOVFF   WREG,FSR2H
                      05565                 ; Index into table based table number in Breg
004CD8 C??? FFE8      05566                 MOVFF   Breg,WREG
004CDC 96E8           05567                 BCF     WREG,3
004CDE 0D0B           05568                 MULLW   D'11'
004CE0 50F3           05569                 MOVFP   PRODL,WREG
004CE2 0F??           05570                 ADDLW   LOW Atable1     ; WREG now holds index into proper table
                      05571         ; Load the table's last value and adjust pointer to selected byte
004CE4                05572 Trans2
004CE4 CFE8 FFD9      05573                 MOVFF   WREG,FSR2L
                      05574                 ; Load the table last value into Creg, we may need it on exit
004CE8 CFDF F???      05575                 MOVFF   INDF2,Creg                              
                      05576                 ; Index back to selected byte of table
004CEC C??? FFE8      05577                 MOVFF   CEXreg,WREG
004CF0 26D9           05578                 ADDWF   FSR2L,F,A
                      05579         ; Here to load the table pointers and calculate the translation
004CF2 CFDE F???      05580                 MOVFF   POSTINC2,Areg   ; A point in table
004CF6 CFDF F???      05581                 MOVFF   INDF2,Breg      ; B point in table
                      05582                 ; AXreg = B - A
004CFA 01??           05583                 MOVLB   HIGH AXreg
004CFC C??? F???      05584                 MOVFF   Breg,AXreg 
004D00 6A??           05585                 CLRF    AXreg+1
004D02 BE??           05586                 BTFSC   Breg,7
004D04 68??           05587                 SETF    AXreg+1
004D06 C??? FFE8      05588                 MOVFF   Areg,WREG  
004D0A 5E??           05589                 SUBWF   AXreg,F
004D0C 0E00           05590                 MOVLW   00
004D0E BE??           05591                 BTFSC   Areg,7
004D10 0EFF           05592                 MOVLW   0xFF    
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 271


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

004D12 5A??           05593                 SUBWFB  AXreg+1,F               
                      05594 ;               MOVLB   HIGH AXreg      ; Updated to code shown above as per Andrey Kondratev
                      05595 ;               MOVFF   Breg,AXreg
                      05596 ;               MOVFF   Areg,WREG
                      05597 ;               SUBWF   AXreg,F
                      05598 ;               CLRF    AXreg+1
                      05599 ;               BTFSC   AXreg,7
                      05600 ;               SETF    AXreg+1
                      05601                 MOVE    EEXreg,BXreg
004D14 C??? F???          M                 MOVFF   EEXreg,BXreg
004D18 C??? F???          M                 MOVFF   (EEXreg+1),(BXreg+1)
004D1C EC?? F???      05602                 CALL    Mult1616
                      05603                 MOVEC   D'10',DEXreg
004D20 01??               M                 MOVLR   HIGH (DEXreg)
004D22 0E0A               M                 MOVLW   LOW (D'10')
004D24 6E??               M                 MOVWF   (DEXreg)
004D26 0E00               M                 MOVLW   HIGH (D'10')
004D28 6E??               M                 MOVWF   (DEXreg+1)
004D2A EC?? F???      05604                 CALL    Divide2416
                      05605                 ; A * 10 + CEXreg = the final position
004D2E 5000           05606                 MOVF    Areg, W, A      ; signed multiply
004D30 0D0A           05607                 MULLW   D'10'
004D32 0E0A           05608                 MOVLW   D'10'
004D34 BE00           05609                 BTFSC   Areg, 7, A
004D36 5EF4           05610                 SUBWF   PRODH, F
004D38 CFF3 FFE8      05611                 MOVFF   PRODL,WREG
004D3C 26??           05612                 ADDWF   CEXreg,F
004D3E CFF4 FFE8      05613                 MOVFF   PRODH,WREG
004D42 22??           05614                 ADDWFC  CEXreg+1,F
                      05615         ; Now the final step, test the sign of Pos and adjust the result
                      05616                 MOVE    CEXreg,AXreg
004D44 C??? F???          M                 MOVFF   CEXreg,AXreg
004D48 C??? F???          M                 MOVFF   (CEXreg+1),(AXreg+1)
004D4C 01??           05617                 MOVLB   HIGH Pos
004D4E AE??           05618                 BTFSS   Pos+1,7
004D50 0012           05619                 RETURN
                      05620                 ; Here if input was negative, adjust output to 2(low) - AXreg
                      05621                 ; The table's final value is in the Creg
004D52 C??? FFE8      05622                 MOVFF   Creg,WREG
004D56 0D14           05623                 MULLW   D'20'
004D58 0E14           05624                 MOVLW   D'20'           
004D5A BE00           05625                 BTFSC   Creg,7,A
004D5C 5EF4           05626                 SUBWF   PRODH,F
                      05627                 
004D5E CFF3 F???      05628                 MOVFF   PRODL,AXreg
004D62 CFF4 F???      05629                 MOVFF   PRODH,AXreg+1
004D66 01??           05630                 MOVLB   HIGH AXreg
004D68 C??? FFE8      05631                 MOVFF   CEXreg,WREG
004D6C 5E??           05632                 SUBWF   AXreg,F
004D6E C??? FFE8      05633                 MOVFF   CEXreg+1,WREG
004D72 5A??           05634                 SUBWFB  AXreg+1,F
004D74 0012           05635                 RETURN
                      05636 ;
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 272


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      05637 ; This routine performes the mixer calculations for the mixer pointed
                      05638 ; to by FSR1. The mixer data tables are assumed to be located in bank 3.
                      05639 ; The From variable contains the from channel in the lower 4 bits
                      05640 ; and a translation table number in the upper 4 bits. If the upper 4 bits
                      05641 ; are zero then no translation table is applied.
                      05642 ; The To channel MSB is a flag indicating the results should be
                      05643 ; added to the To channel (0) or replace the To channel (1).
                      05644 ; To channel bit 6 set indicates indirect level control and the channel is in Gp
                      05645 ; To channel bit 5 set indicates indirect level control and the channel is in Gn
                      05646 ;
004D76                05647 Mixer
                      05648         ; Get the from channel
004D76 50E6           05649                 MOVFP   POSTINC1,WREG
004D78 CFE8 F???      05650                 MOVFF   WREG,Breg
004D7C 0B0F           05651                 ANDLW   0F
004D7E B4D8           05652                 BTFSC   ALUSTA,Z
004D80 0012           05653                 RETURN                  ; Not selected so exit!
004D82 C??? FFE8      05654                 MOVFF   Breg,WREG
004D86 EC?? F???      05655                 CALL    GetFrom         ; From channel data in AXreg
004D8A EC?? F???      05656                 CALL    Translation     ; Apply the Translation table
                      05657                 MOVE    AXreg,CXreg
004D8E C??? F???          M                 MOVFF   AXreg,CXreg
004D92 C??? F???          M                 MOVFF   (AXreg+1),(CXreg+1)
004D96 CFE6 F???      05658                 MOVFF   POSTINC1,Areg   ; To channel to Areg
                      05659         ; Now get the Zero point in percent
004D9A CFE6 FFE8      05660                 MOVPF   POSTINC1,WREG
004D9E 01??           05661                 MOVLR   HIGH AXreg
004DA0 CFE8 F???      05662                 MOVPF   WREG,AXreg
004DA4 6A??           05663                 CLRF    AXreg+1
004DA6 BE??           05664                 BTFSC   AXreg,7
004DA8 1E??           05665                 COMF    AXreg+1         ; Sign extend
                      05666                 MOVEC   d'10',BXreg
004DAA 01??               M                 MOVLR   HIGH (BXreg)
004DAC 0E0A               M                 MOVLW   LOW (d'10')
004DAE 6E??               M                 MOVWF   (BXreg)
004DB0 0E00               M                 MOVLW   HIGH (d'10')
004DB2 6E??               M                 MOVWF   (BXreg+1)
004DB4 EC?? F???      05667                 CALL    Mult1616
                      05668                 MOVE    CXreg,AXreg
004DB8 C??? F???          M                 MOVFF   CXreg,AXreg
004DBC C??? F???          M                 MOVFF   (CXreg+1),(AXreg+1)
004DC0 5000           05669                 MOVFP   CEXreg,WREG
004DC2 5E??           05670                 SUBWF   AXreg,F
004DC4 5000           05671                 MOVFP   CEXreg+1,WREG
004DC6 5A??           05672                 SUBWFB  AXreg+1,F
                      05673         ; AXreg is now = ChannelPos - Zp. Test the sign and apply the correct
                      05674         ; gain factor...
004DC8 BE??           05675                 BTFSC   AXreg+1,7
004DCA EF?? F???      05676                 GOTO    MixNeg
                      05677                 ; Here if positive...
004DCE CFE6 FFE8      05678                 MOVPF   POSTINC1,WREG
004DD2 01??           05679                 MOVLR   HIGH AXreg
                      05680                 ; Test bit 6 of the To channel in Areg. If this bit is
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 273


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      05681                 ; set then we are going to do indirect mixing and the 
                      05682                 ; 4 LSBs of WREG define the channel number that is the mix level
004DD4 AC00           05683                 BTFSS   Areg,6,A
004DD6 EF?? F???      05684                 GOTO    MixNoIdP
                      05685                 ; Here if is an indirect mix...
                      05686                 MOVE    WREG,CEXreg
004DDA CFE8 F???          M                 MOVFF   WREG,CEXreg
004DDE CFE9 F???          M                 MOVFF   (WREG+1),(CEXreg+1)
                      05687                 MOVE    AXreg,CXreg
004DE2 C??? F???          M                 MOVFF   AXreg,CXreg
004DE6 C??? F???          M                 MOVFF   (AXreg+1),(CXreg+1)
004DEA 5000           05688                 MOVFP   CEXreg,WREG
004DEC EC?? F???      05689                 CALL    GetFrom
                      05690                 MOVE    AXreg,CEXreg
004DF0 C??? F???          M                 MOVFF   AXreg,CEXreg
004DF4 C??? F???          M                 MOVFF   (AXreg+1),(CEXreg+1)
004DF8 0E0A           05691                 MOVLW   D'10'
004DFA 6E??           05692                 MOVWF   DEXreg
004DFC EC?? F???      05693                 CALL    Divide168
                      05694                 MOVE    CXreg,AXreg
004E00 C??? F???          M                 MOVFF   CXreg,AXreg
004E04 C??? F???          M                 MOVFF   (CXreg+1),(AXreg+1)
004E08 5000           05695                 MOVFP   CEXreg,WREG
004E0A                05696 MixNoIdP
004E0A 6E??           05697                 MOVWF   BXreg
004E0C 6A??           05698                 CLRF    BXreg+1
004E0E BE??           05699                 BTFSC   BXreg,7
004E10 1E??           05700                 COMF    BXreg+1         ; Sign extend
004E12 EC?? F???      05701                 CALL    Mult1616
                      05702                 MOVEC   D'100',DEXreg
004E16 01??               M                 MOVLR   HIGH (DEXreg)
004E18 0E64               M                 MOVLW   LOW (D'100')
004E1A 6E??               M                 MOVWF   (DEXreg)
004E1C 0E00               M                 MOVLW   HIGH (D'100')
004E1E 6E??               M                 MOVWF   (DEXreg+1)
004E20 6A??           05703                 CLRF    DEXreg+2
004E22 6A??           05704                 CLRF    DEXreg+3
004E24 EC?? F???      05705                 CALL    Divide2416
                      05706                 MOVE    CEXreg,AXreg
004E28 C??? F???          M                 MOVFF   CEXreg,AXreg
004E2C C??? F???          M                 MOVFF   (CEXreg+1),(AXreg+1)
004E30 5000           05707                 MOVF    Areg,W,A
004E32 EC?? F???      05708                 CALL    ApplyMix
004E36 0012           05709                 RETURN
004E38                05710 MixNeg          ; Here if negative...
004E38 CFE6 FFE8      05711                 MOVPF   POSTINC1,WREG
004E3C CFE6 FFE8      05712                 MOVPF   POSTINC1,WREG
004E40 01??           05713                 MOVLR   HIGH AXreg
                      05714                 ; Test bit 5 of the To channel in Areg. If this bit is
                      05715                 ; set then we are going to do indirect mixing and the 
                      05716                 ; 4 LSBs of WREG define the channel number that is the mix level
004E42 AA00           05717                 BTFSS   Areg,5,A
004E44 EF?? F???      05718                 GOTO    MixNoIdN
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 274


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      05719                 ; Here if is an indirect mix...
004E48 CFE8 F???      05720                 MOVPF   WREG,CEXreg
                      05721                 MOVE    AXreg,CXreg
004E4C C??? F???          M                 MOVFF   AXreg,CXreg
004E50 C??? F???          M                 MOVFF   (AXreg+1),(CXreg+1)
004E54 5000           05722                 MOVFP   CEXreg,WREG
004E56 EC?? F???      05723                 CALL    GetFrom
                      05724                 MOVE    AXreg,CEXreg
004E5A C??? F???          M                 MOVFF   AXreg,CEXreg
004E5E C??? F???          M                 MOVFF   (AXreg+1),(CEXreg+1)
004E62 0E0A           05725                 MOVLW   D'10'
004E64 6E??           05726                 MOVWF   DEXreg
004E66 EC?? F???      05727                 CALL    Divide168
                      05728                 MOVE    CXreg,AXreg
004E6A C??? F???          M                 MOVFF   CXreg,AXreg
004E6E C??? F???          M                 MOVFF   (CXreg+1),(AXreg+1)
004E72 5000           05729                 MOVFP   CEXreg,WREG
004E74                05730 MixNoIdN
004E74 6E??           05731                 MOVWF   BXreg
004E76 6A??           05732                 CLRF    BXreg+1
004E78 BE??           05733                 BTFSC   BXreg,7
004E7A 1E??           05734                 COMF    BXreg+1         ; Sign extend
004E7C EC?? F???      05735                 CALL    Mult1616
                      05736                 MOVEC   D'100',DEXreg
004E80 01??               M                 MOVLR   HIGH (DEXreg)
004E82 0E64               M                 MOVLW   LOW (D'100')
004E84 6E??               M                 MOVWF   (DEXreg)
004E86 0E00               M                 MOVLW   HIGH (D'100')
004E88 6E??               M                 MOVWF   (DEXreg+1)
004E8A 6A??           05737                 CLRF    DEXreg+2
004E8C 6A??           05738                 CLRF    DEXreg+3
004E8E EC?? F???      05739                 CALL    Divide2416
                      05740                 MOVE    CEXreg,AXreg
004E92 C??? F???          M                 MOVFF   CEXreg,AXreg
004E96 C??? F???          M                 MOVFF   (CEXreg+1),(AXreg+1)
004E9A 5000           05741                 MOVF    Areg,W,A
004E9C EC?? F???      05742                 CALL    ApplyMix
004EA0 0012           05743                 RETURN
                      05744 
                      05745 
                      05746 ; This function will switch the aircraft parameters between
                      05747 ; the selected aircraft and the alternate aircraft. This 
                      05748 ; function is only valid in the RUN mode. An Alternate Aircraft
                      05749 ; array is used to support multiple switches, if more than one
                      05750 ; switch is on the higher array index takes precedence.
004EA2                05751 AlternateAircraft
                      05752         ; Save the timer variables
                      05753                 MOVEC   CNTmode,Src
004EA2 01??               M                 MOVLR   HIGH (Src)
004EA4 0E??               M                 MOVLW   LOW (CNTmode)
004EA6 6E??               M                 MOVWF   (Src)
004EA8 0E??               M                 MOVLW   HIGH (CNTmode)
004EAA 6E??               M                 MOVWF   (Src+1)
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 275


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      05754                 MOVEC   TempBlock,Dst
004EAC 01??               M                 MOVLR   HIGH (Dst)
004EAE 0E??               M                 MOVLW   LOW (TempBlock)
004EB0 6E??               M                 MOVWF   (Dst)
004EB2 0E??               M                 MOVLW   HIGH (TempBlock)
004EB4 6E??               M                 MOVWF   (Dst+1)
004EB6 0E05           05755                 MOVLW   5
004EB8 6E??           05756                 MOVWF   Cnt
                      05757                 CALLF   BlkMove
004EBA EC?? F???          M                 CALL    (BlkMove)
                      05758         ; Search the alternate aircraft array looking for a active 
                      05759         ; selection. 
004EBE 0E??           05760                 MOVLW   LOW AltAircraft         ; Point to end of array
004EC0 0F0B           05761                 ADDLW   (2 * NumAlt) - 1
004EC2 CFE8 FFD9      05762                 MOVFF   WREG,FSR2L
004EC6 0E??           05763                 MOVLW   HIGH Backup
004EC8 CFE8 FFDA      05764                 MOVFF   WREG,FSR2H
004ECC 0E06           05765                 MOVLW   NumAlt                  ; Load counter
004ECE CFE8 F???      05766                 MOVFF   WREG,Creg
                      05767         ; Loop through all the alternate aircraft entries
004ED2                05768 AAloop
004ED2 CFDD FFE8      05769                 MOVFF   POSTDEC2,WREG           ; Get the alternate aircraft number
004ED6 12E8           05770                 IORWF   WREG                    ; Set flags
004ED8 B4D8           05771                 BTFSC   STATUS,Z
004EDA EF?? F???      05772                 GOTO    AAnext
                      05773                 ; Here with non zero aircraft number
004EDE CFDF FFE8      05774                 MOVFF   INDF2,WREG              ; Get the switch code
004EE2 EC?? F???      05775                 CALL    SwitchTest
004EE6 B0D8           05776                 BTFSC   STATUS,C
004EE8 EF?? F???      05777                 GOTO    AAselected              ; Load the selected aircraft
                      05778         ; Advance to next entry and loop till done
004EEC                05779 AAnext
004EEC CFDD FFE8      05780                 MOVFF   POSTDEC2,WREG           ; Advance to next array entry
004EF0 2E00           05781                 DECFSZ  Creg,F,A
004EF2 EF?? F???      05782                 GOTO    AAloop
                      05783         ; Exit if no alternate aircraft located. Make sure the default aircraft is loaded
004EF6 C??? FFE8      05784                 MOVFF   DefaultAircraft,WREG
004EFA 01??           05785                 MOVLB   HIGH Aircraft
004EFC 62??           05786                 CPFSEQ  Aircraft
004EFE EF?? F???      05787                 GOTO    AAload  
004F02 0012           05788                 RETURN
                      05789         ; Here to load the selected aircraft
004F04                05790 AAselected
004F04 CFDE FFE8      05791                 MOVFF   POSTINC2,WREG
004F08 CFDE FFE8      05792                 MOVFF   POSTINC2,WREG           ; Get the aircraft number 
                      05793                 ; If this aircraft is loaded then exit
004F0C 01??           05794                 MOVLB   HIGH Aircraft
004F0E 62??           05795                 CPFSEQ  Aircraft
004F10 EF?? F???      05796                 GOTO    AAload
004F14 0012           05797                 RETURN
                      05798         ; Here to load the aircraft
004F16                05799 AAload
004F16 CFE8 F???      05800                 MOVFF   WREG,Aircraft
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 276


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

004F1A EC?? F???      05801                 CALL    LoadAircraft
                      05802                 ; Restore the timer variables
                      05803                 MOVEC   TempBlock,Src
004F1E 01??               M                 MOVLR   HIGH (Src)
004F20 0E??               M                 MOVLW   LOW (TempBlock)
004F22 6E??               M                 MOVWF   (Src)
004F24 0E??               M                 MOVLW   HIGH (TempBlock)
004F26 6E??               M                 MOVWF   (Src+1)
                      05804                 MOVEC   CNTmode,Dst
004F28 01??               M                 MOVLR   HIGH (Dst)
004F2A 0E??               M                 MOVLW   LOW (CNTmode)
004F2C 6E??               M                 MOVWF   (Dst)
004F2E 0E??               M                 MOVLW   HIGH (CNTmode)
004F30 6E??               M                 MOVWF   (Dst+1)
004F32 0E05           05805                 MOVLW   5
004F34 6E??           05806                 MOVWF   Cnt
                      05807                 CALLF   BlkMove
004F36 EC?? F???          M                 CALL    (BlkMove)
004F3A 0012           05808                 RETURN          
                      05809 
                      05810 
                      05811 ; This function moves data from the Src to Dst. Cnt contains the number
                      05812 ; of bytes to move.
                      05813 ; Uses: Areg
                      05814 ;       Indirect reg set 1 used for source
                      05815 ;       Indirect reg set 2 used for destination
004F3C                05816 BlkMove
                      05817         ; Set up the regesters
004F3C 01??           05818                 MOVLB   HIGH Src
004F3E 50??           05819                 MOVF    Src,W
004F40 6EE1           05820                 MOVWF   FSR1L   
004F42 50??           05821                 MOVF    Src+1,W
004F44 6EE2           05822                 MOVWF   FSR1H   
                      05823 
004F46 01??           05824                 MOVLB   HIGH Dst
004F48 50??           05825                 MOVF    Dst,W
004F4A 6ED9           05826                 MOVWF   FSR2L   
004F4C 50??           05827                 MOVF    Dst+1,W
004F4E 6EDA           05828                 MOVWF   FSR2H   
                      05829         ; Get source byte
004F50                05830 BlkMove1
004F50 CFE6 FFE8      05831                 MOVFF   POSTINC1,WREG
004F54 CFE8 FFDE      05832                 MOVFF   WREG,POSTINC2
                      05833         ; Loop till all are sent...
004F58 01??           05834                 MOVLB   HIGH Cnt
004F5A 2E??           05835                 DECFSZ  Cnt
004F5C EF?? F???      05836                 GOTO    BlkMove1
004F60 0012           05837                 RETURN
                      05838 
                      05839 ;
                      05840 ; This function is called to initialize the button ID byte.
                      05841 ;
004F62                05842 ButtonIDinit
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 277


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      05843         ; Clear the switch ID byte
004F62 01??           05844                 MOVLB   HIGH SWID
004F64 6A??           05845                 CLRF    SWID
                      05846         ; Do the aileron DR
004F66 01??           05847                 MOVLB   HIGH SWAILDR
004F68 50??           05848                 MOVF    SWAILDR,W
004F6A EC?? F???      05849                 CALL    SwitchTest
004F6E 01??           05850                 MOVLB   HIGH SWID
004F70 B0D8           05851                 BTFSC   ALUSTA,C,A
004F72 80??           05852                 BSF             SWID,0
                      05853         ; Do the elevator DR
004F74 01??           05854                 MOVLB   HIGH SWELEDR
004F76 50??           05855                 MOVF    SWELEDR,W
004F78 EC?? F???      05856                 CALL    SwitchTest
004F7C 01??           05857                 MOVLB   HIGH SWID
004F7E B0D8           05858                 BTFSC   ALUSTA,C,A
004F80 82??           05859                 BSF         SWID,1
                      05860         ; Do the rudder DR
004F82 01??           05861                 MOVLB   HIGH SWRUDDR
004F84 50??           05862                 MOVF    SWRUDDR,W
004F86 EC?? F???      05863                 CALL    SwitchTest
004F8A 01??           05864                 MOVLB   HIGH SWID
004F8C B0D8           05865                 BTFSC   ALUSTA,C,A
004F8E 84??           05866                 BSF             SWID,2
                      05867         ; Do the preset
004F90 01??           05868                 MOVLB   HIGH SWPRESET
004F92 50??           05869                 MOVF    SWPRESET,W
004F94 EC?? F???      05870                 CALL    SwitchTest
004F98 01??           05871                 MOVLB   HIGH SWID
004F9A B0D8           05872                 BTFSC   ALUSTA,C,A
004F9C 86??           05873                 BSF             SWID,3
                      05874         ; Do the Auto Trim
004F9E 01??           05875                 MOVLB   HIGH SWATRIM
004FA0 50??           05876                 MOVF    SWATRIM,W
004FA2 EC?? F???      05877                 CALL    SwitchTest
004FA6 01??           05878                 MOVLB   HIGH SWID
004FA8 B0D8           05879                 BTFSC   ALUSTA,C,A
004FAA 88??           05880                 BSF             SWID,4
                      05881         ; Do the Snap R
004FAC 01??           05882                 MOVLB   HIGH SWSNAPR
004FAE 50??           05883                 MOVF    SWSNAPR,W
004FB0 EC?? F???      05884                 CALL    SwitchTest
004FB4 01??           05885                 MOVLB   HIGH SWID
004FB6 B0D8           05886                 BTFSC   ALUSTA,C,A
004FB8 8A??           05887                 BSF             SWID,5
                      05888         ; Do the Snap L
004FBA 01??           05889                 MOVLB   HIGH SWSNAPL
004FBC 50??           05890                 MOVF    SWSNAPL,W
004FBE EC?? F???      05891                 CALL    SwitchTest
004FC2 01??           05892                 MOVLB   HIGH SWID
004FC4 B0D8           05893                 BTFSC   ALUSTA,C,A
004FC6 8C??           05894                 BSF             SWID,6
                      05895         ; Bye!
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 278


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

004FC8 0012           05896                 RETURN
                      05897 ;
                      05898 ; This function looks at the button image ports and prints the name of the
                      05899 ; last change, if one has been detected. This message will be displayed for
                      05900 ; a few seconds.
                      05901 ;
004FCA                05902 ButtonID
                      05903         ; Set display to line 2
004FCA 0EC0           05904                 MOVLW   LINE2
004FCC EC?? F???      05905                 CALL    LCDsendCMD
                      05906         ; Test each funcion looking for a state change
                      05907                 ; Aileron DR
004FD0 01??           05908                 MOVLB   HIGH SWAILDR
004FD2 50??           05909                 MOVF    SWAILDR,W
004FD4 EC?? F???      05910                 CALL    SwitchTest
004FD8 01??           05911                 MOVLB   HIGH SWID
004FDA 6AE8           05912                 CLRF    WREG,A
004FDC 80E8           05913                 BSF     WREG,0,A
004FDE 14??           05914                 ANDWF   SWID,W
                      05915                 ; If carry flag is set and z flag is clear then no change
004FE0 A0D8           05916                 BTFSS   ALUSTA,C,A
004FE2 EF?? F???      05917                 GOTO    BID0
004FE6 A4D8           05918                 BTFSS   ALUSTA,Z,A
004FE8 EF?? F???      05919                 GOTO    BIDELE
                      05920                 ; Here with a change
004FEC 70??           05921                 BTG     SWID,0
                      05922                 PrintMess IDAILLOW
004FEE 0E??               M                 MOVLW   UPPER (IDAILLOW)
004FF0 6EF8               M                 MOVWF   TBLPTRU,A
004FF2 0E??               M                 MOVLW   HIGH (IDAILLOW)
004FF4 6EF7               M                 MOVWF   TBLPTRH,A
004FF6 0E??               M                 MOVLW   LOW (IDAILLOW)
004FF8 6EF6               M                 MOVWF   TBLPTRL,A
004FFA EC?? F???          M                 CALL    LCDsendMess
004FFE EF?? F???      05923                 GOTO    BIDEXIT
                      05924                 ; If carry flag is clear and z flag is set then no change
005002                05925 BID0
005002 B0D8           05926                 BTFSC   ALUSTA,C,A
005004 EF?? F???      05927                 GOTO    BIDELE
005008 B4D8           05928                 BTFSC   ALUSTA,Z,A
00500A EF?? F???      05929                 GOTO    BIDELE
                      05930                 ; Here with a change
00500E 70??           05931                 BTG     SWID,0
                      05932                 PrintMess IDAILHI
005010 0E??               M                 MOVLW   UPPER (IDAILHI)
005012 6EF8               M                 MOVWF   TBLPTRU,A
005014 0E??               M                 MOVLW   HIGH (IDAILHI)
005016 6EF7               M                 MOVWF   TBLPTRH,A
005018 0E??               M                 MOVLW   LOW (IDAILHI)
00501A 6EF6               M                 MOVWF   TBLPTRL,A
00501C EC?? F???          M                 CALL    LCDsendMess
005020 EF?? F???      05933                 GOTO    BIDEXIT
005024                05934 BIDELE
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 279


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      05935                 ; Elevator DR
005024 01??           05936                 MOVLB   HIGH SWELEDR
005026 50??           05937                 MOVF    SWELEDR,W
005028 EC?? F???      05938                 CALL    SwitchTest
00502C 01??           05939                 MOVLB   HIGH SWID
00502E 6AE8           05940                 CLRF    WREG,A
005030 82E8           05941                 BSF             WREG,1,A
005032 14??           05942                 ANDWF   SWID,W
                      05943                 ; If carry flag is set and z flag is clear then no change
005034 A0D8           05944                 BTFSS   ALUSTA,C,A
005036 EF?? F???      05945                 GOTO    BID1
00503A A4D8           05946                 BTFSS   ALUSTA,Z,A
00503C EF?? F???      05947                 GOTO    BIDRUD
                      05948                 ; Here with a change
005040 72??           05949                 BTG             SWID,1
                      05950                 PrintMess IDELELOW
005042 0E??               M                 MOVLW   UPPER (IDELELOW)
005044 6EF8               M                 MOVWF   TBLPTRU,A
005046 0E??               M                 MOVLW   HIGH (IDELELOW)
005048 6EF7               M                 MOVWF   TBLPTRH,A
00504A 0E??               M                 MOVLW   LOW (IDELELOW)
00504C 6EF6               M                 MOVWF   TBLPTRL,A
00504E EC?? F???          M                 CALL    LCDsendMess
005052 EF?? F???      05951                 GOTO    BIDEXIT
                      05952                 ; If carry flag is clear and z flag is set then no change
005056                05953 BID1
005056 B0D8           05954                 BTFSC   ALUSTA,C,A
005058 EF?? F???      05955                 GOTO    BIDRUD
00505C B4D8           05956                 BTFSC   ALUSTA,Z,A
00505E EF?? F???      05957                 GOTO    BIDRUD
                      05958                 ; Here with a change
005062 72??           05959                 BTG             SWID,1
                      05960                 PrintMess IDELEHI
005064 0E??               M                 MOVLW   UPPER (IDELEHI)
005066 6EF8               M                 MOVWF   TBLPTRU,A
005068 0E??               M                 MOVLW   HIGH (IDELEHI)
00506A 6EF7               M                 MOVWF   TBLPTRH,A
00506C 0E??               M                 MOVLW   LOW (IDELEHI)
00506E 6EF6               M                 MOVWF   TBLPTRL,A
005070 EC?? F???          M                 CALL    LCDsendMess
005074 EF?? F???      05961                 GOTO    BIDEXIT
005078                05962 BIDRUD
                      05963                 ; Rudder DR
005078 01??           05964                 MOVLB   HIGH SWRUDDR
00507A 50??           05965                 MOVF    SWRUDDR,W
00507C EC?? F???      05966                 CALL    SwitchTest
005080 01??           05967                 MOVLB   HIGH SWID
005082 6AE8           05968                 CLRF    WREG,A
005084 84E8           05969                 BSF             WREG,2,A
005086 14??           05970                 ANDWF   SWID,W
                      05971                 ; If carry flag is set and z flag is clear then no change
005088 A0D8           05972                 BTFSS   ALUSTA,C,A
00508A EF?? F???      05973                 GOTO    BID2
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 280


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

00508E A4D8           05974                 BTFSS   ALUSTA,Z,A
005090 EF?? F???      05975                 GOTO    BIDPRESET
                      05976                 ; Here with a change
005094 74??           05977                 BTG             SWID,2
                      05978                 PrintMess IDRUDLOW
005096 0E??               M                 MOVLW   UPPER (IDRUDLOW)
005098 6EF8               M                 MOVWF   TBLPTRU,A
00509A 0E??               M                 MOVLW   HIGH (IDRUDLOW)
00509C 6EF7               M                 MOVWF   TBLPTRH,A
00509E 0E??               M                 MOVLW   LOW (IDRUDLOW)
0050A0 6EF6               M                 MOVWF   TBLPTRL,A
0050A2 EC?? F???          M                 CALL    LCDsendMess
0050A6 EF?? F???      05979                 GOTO    BIDEXIT
                      05980                 ; If carry flag is clear and z flag is set then no change
0050AA                05981 BID2
0050AA B0D8           05982                 BTFSC   ALUSTA,C,A
0050AC EF?? F???      05983                 GOTO    BIDPRESET
0050B0 B4D8           05984                 BTFSC   ALUSTA,Z,A
0050B2 EF?? F???      05985                 GOTO    BIDPRESET
                      05986                 ; Here with a change
0050B6 74??           05987                 BTG             SWID,2
                      05988                 PrintMess IDRUDHI
0050B8 0E??               M                 MOVLW   UPPER (IDRUDHI)
0050BA 6EF8               M                 MOVWF   TBLPTRU,A
0050BC 0E??               M                 MOVLW   HIGH (IDRUDHI)
0050BE 6EF7               M                 MOVWF   TBLPTRH,A
0050C0 0E??               M                 MOVLW   LOW (IDRUDHI)
0050C2 6EF6               M                 MOVWF   TBLPTRL,A
0050C4 EC?? F???          M                 CALL    LCDsendMess
0050C8 EF?? F???      05989                 GOTO    BIDEXIT
0050CC                05990 BIDPRESET
                      05991                 ; Preset
0050CC 01??           05992                 MOVLB   HIGH SWPRESET
0050CE 50??           05993                 MOVF    SWPRESET,W
0050D0 EC?? F???      05994                 CALL    SwitchTest
                      05995                 ; If carry flag is set and bit 3 is not then display message.
0050D4 01??           05996                 MOVLB   HIGH SWID
0050D6 A0D8           05997                 BTFSS   ALUSTA,C,A
0050D8 EF?? F???      05998                 GOTO    BID3
0050DC B6??           05999                 BTFSC   SWID,3
0050DE EF?? F???      06000                 GOTO    BIDAUTOT
0050E2 76??           06001                 BTG             SWID,3
                      06002                 PrintMess IDPRESET
0050E4 0E??               M                 MOVLW   UPPER (IDPRESET)
0050E6 6EF8               M                 MOVWF   TBLPTRU,A
0050E8 0E??               M                 MOVLW   HIGH (IDPRESET)
0050EA 6EF7               M                 MOVWF   TBLPTRH,A
0050EC 0E??               M                 MOVLW   LOW (IDPRESET)
0050EE 6EF6               M                 MOVWF   TBLPTRL,A
0050F0 EC?? F???          M                 CALL    LCDsendMess
0050F4 EF?? F???      06003                 GOTO    BIDEXIT
0050F8                06004 BID3
0050F8 96??           06005                 BCF     SWID,3
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 281


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

0050FA                06006 BIDAUTOT
                      06007                 ; Auto trim
0050FA 01??           06008                 MOVLB   HIGH SWATRIM
0050FC 50??           06009                 MOVF    SWATRIM,W
0050FE EC?? F???      06010                 CALL    SwitchTest
                      06011                 ; If carry flag is set and bit 4 is not then display message.
005102 01??           06012                 MOVLB   HIGH SWID
005104 A0D8           06013                 BTFSS   ALUSTA,C,A
005106 EF?? F???      06014                 GOTO    BID4
00510A B8??           06015                 BTFSC   SWID,4
00510C EF?? F???      06016                 GOTO    BIDSNAPR
005110 78??           06017                 BTG             SWID,4
                      06018                 PrintMess IDAUTOT
005112 0E??               M                 MOVLW   UPPER (IDAUTOT)
005114 6EF8               M                 MOVWF   TBLPTRU,A
005116 0E??               M                 MOVLW   HIGH (IDAUTOT)
005118 6EF7               M                 MOVWF   TBLPTRH,A
00511A 0E??               M                 MOVLW   LOW (IDAUTOT)
00511C 6EF6               M                 MOVWF   TBLPTRL,A
00511E EC?? F???          M                 CALL    LCDsendMess
005122 EF?? F???      06019                 GOTO    BIDEXIT
005126                06020 BID4
005126 98??           06021                 BCF     SWID,4
005128                06022 BIDSNAPR
                      06023                 ; SNAP right
005128 01??           06024                 MOVLB   HIGH SWSNAPR
00512A 50??           06025                 MOVF    SWSNAPR,W
00512C EC?? F???      06026                 CALL    SwitchTest
                      06027                 ; If carry flag is set and bit 5 is not then display message.
005130 01??           06028                 MOVLB   HIGH SWID
005132 A0D8           06029                 BTFSS   ALUSTA,C,A
005134 EF?? F???      06030                 GOTO    BID5
005138 BA??           06031                 BTFSC   SWID,5
00513A EF?? F???      06032                 GOTO    BIDSNAPL
00513E 7A??           06033                 BTG             SWID,5
                      06034                 PrintMess IDSNAPR
005140 0E??               M                 MOVLW   UPPER (IDSNAPR)
005142 6EF8               M                 MOVWF   TBLPTRU,A
005144 0E??               M                 MOVLW   HIGH (IDSNAPR)
005146 6EF7               M                 MOVWF   TBLPTRH,A
005148 0E??               M                 MOVLW   LOW (IDSNAPR)
00514A 6EF6               M                 MOVWF   TBLPTRL,A
00514C EC?? F???          M                 CALL    LCDsendMess
005150 EF?? F???      06035                 GOTO    BIDEXIT
005154                06036 BID5
005154 9A??           06037                 BCF     SWID,5
005156                06038 BIDSNAPL
                      06039                 ; SNAP left
005156 01??           06040                 MOVLB   HIGH SWSNAPL
005158 50??           06041                 MOVF    SWSNAPL,W
00515A EC?? F???      06042                 CALL    SwitchTest
                      06043                 ; If carry flag is set and bit 6 is not then display message.
00515E 01??           06044                 MOVLB   HIGH SWID
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 282


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

005160 A0D8           06045                 BTFSS   ALUSTA,C,A
005162 EF?? F???      06046                 GOTO    BID6
005166 BC??           06047                 BTFSC   SWID,6
005168 EF?? F???      06048                 GOTO    BIDNEXT
00516C 7C??           06049                 BTG     SWID,6
                      06050                 PrintMess IDSNAPL
00516E 0E??               M                 MOVLW   UPPER (IDSNAPL)
005170 6EF8               M                 MOVWF   TBLPTRU,A
005172 0E??               M                 MOVLW   HIGH (IDSNAPL)
005174 6EF7               M                 MOVWF   TBLPTRH,A
005176 0E??               M                 MOVLW   LOW (IDSNAPL)
005178 6EF6               M                 MOVWF   TBLPTRL,A
00517A EC?? F???          M                 CALL    LCDsendMess
00517E EF?? F???      06051                 GOTO    BIDEXIT
005182                06052 BID6
005182 9C??           06053                 BCF     SWID,6
005184                06054 BIDNEXT
005184 0012           06055                 RETURN
005186                06056 BIDEXIT
005186 0E50           06057                 MOVLW   D'80'
005188 CFE8 F???      06058                 MOVFF   WREG,TimeOut5
00518C 0012           06059                 RETURN
                      06060 
                      06061 
                      06062 ;
                      06063 ; This function will test the switch code passed in WREG. If the
                      06064 ; code is true then the Carry flag is set, else its reset. Here
                      06065 ; is the definition of a switch code:
                      06066 ;   
                      06067 ;   7 6 5 4 3 2 1 0
                      06068 ;   x x x x x x x x
                      06069 ;   | | | | | | | +-- \
                      06070 ;   | | | | | | +----  > Bit position, 0 to 7
                      06071 ;   | | | | | +------ /
                      06072 ;   | | | | +-------- Port select, 0 = PORTD, 1 = PORTE
                      06073 ;   | | | +---------- ON  \ If both the ON and OFF bits are set then
                      06074 ;   | | +------------ OFF / this is a control position switch
                      06075 ;   | +-------------- And with next bit
                      06076 ;   +---------------- Invert
                      06077 ;
                      06078 ; The port data is read from the debounced data saved in regs:
                      06079 ;    PORTDimage
                      06080 ;    PORTEimage
                      06081 ;
                      06082 ; For control position mode (bits 4 and 5 set:
                      06083 ;   Bit codes
                      06084 ;      0 = aileron
                      06085 ;      1 = elevator
                      06086 ;      2 = rudder
                      06087 ;      3 = throttle
                      06088 ;   Invert bit 7 changes trigger polarity
                      06089 ;
                      06090 ; Uses:
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 283


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      06091 ;       Areg
                      06092 ;
00518E                06093 SwitchTest
                      06094         ; Test if this is control position trigger flag
00518E AAE8           06095                 BTFSS   WREG,5
005190 EF?? F???      06096                 GOTO    STgo
005194 A8E8           06097                 BTFSS   WREG,4
005196 EF?? F???      06098                 GOTO    STgo
                      06099                 ; Here if bits 4 and 5 are set
                      06100                 ; Load the percentage and multiply it by 10 to make it
                      06101                 ; into normalized position
00519A 6E00           06102                 MOVWF   Areg,A          ; Save WREG
00519C 0B07           06103                 ANDLW   07              ; Get the selection bits
00519E 0F??           06104                 ADDLW   LOW ATP         ; Make index to percentage
0051A0 6EE1           06105                 MOVWF   FSR1L,A
0051A2 0E??           06106                 MOVLW   HIGH ATP
0051A4 6EE2           06107                 MOVWF   FSR1H,A
0051A6 50E6           06108                 MOVF    POSTINC1,W,A    ; Load the percentage into Wreg
                      06109                 ; Multiply by 10
0051A8 01??           06110                 MOVLR   HIGH AXreg
0051AA 6E??           06111                 MOVWF   AXreg
0051AC 6A??           06112                 CLRF    AXreg+1
0051AE BEE8           06113                 BTFSC   WREG,7
0051B0 68??           06114                 SETF    AXreg+1         ; Sign extended into AXreg
                      06115                 MOVEC   D'10',BXreg
0051B2 01??               M                 MOVLR   HIGH (BXreg)
0051B4 0E0A               M                 MOVLW   LOW (D'10')
0051B6 6E??               M                 MOVWF   (BXreg)
0051B8 0E00               M                 MOVLW   HIGH (D'10')
0051BA 6E??               M                 MOVWF   (BXreg+1)
0051BC EC?? F???      06116                 CALL    Mult1616        ; Result in CEXreg
                      06117                 ; Now load the position pointer
0051C0 5000           06118                 MOVF    Areg,W,A
0051C2 0B07           06119                 ANDLW   07
0051C4 46E8           06120                 RLNCF   WREG            ; Make it into a word pointer
0051C6 0F??           06121                 ADDLW   LOW ATpos
0051C8 6EE1           06122                 MOVWF   FSR1L,A         ; Load the position pointer
0051CA 0E??           06123                 MOVLW   HIGH ATpos
0051CC 6EE2           06124                 MOVWF   FSR1H,A
0051CE CFE6 F???      06125                 MOVFF   POSTINC1,AXreg
0051D2 CFE6 F???      06126                 MOVFF   POSTINC1,AXreg+1 ; Load the position
                      06127                 ; Absolute value of AXreg
0051D6 01??           06128                 MOVLB   HIGH AXreg
0051D8 AE??           06129                 BTFSS   AXreg+1,7
0051DA EF?? F???      06130                 GOTO    ST01
0051DE 1E??           06131                 COMF    AXreg
0051E0 1E??           06132                 COMF    AXreg+1
0051E2 4A??           06133                 INFSNZ  AXreg
0051E4 2A??           06134                 INCF    AXreg+1
0051E6                06135 ST01:
                      06136                 ; Test the position
0051E6 C??? FFE8      06137                 MOVFF   AXreg,WREG
0051EA 5E??           06138                 SUBWF   CEXreg
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 284


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

0051EC C??? FFE8      06139                 MOVFF   AXreg+1,WREG
0051F0 58??           06140                 SUBWFB  CEXreg+1,W   
0051F2 36E8           06141                 RLCF    WREG
0051F4 70D8           06142                 BTG     ALUSTA,C,A
                      06143                 ; If the Invert bit is set then invert the carry flag
0051F6 BE00           06144                 BTFSC   Areg,7,A
0051F8 0012           06145                 RETURN
0051FA 70D8           06146                 BTG     ALUSTA,C,A
0051FC 0012           06147                 RETURN
                      06148         ; Test the on and off bits first
0051FE                06149 STgo
0051FE 90D8           06150                 BCF     ALUSTA,C,A
005200 BAE8           06151                 BTFSC   WREG,5
005202 0012           06152                 RETURN
005204 80D8           06153                 BSF     ALUSTA,C,A
005206 B8E8           06154                 BTFSC   WREG,4
005208 0012           06155                 RETURN
                      06156         ; Now process the swith options...
00520A 01??           06157                 MOVLB   HIGH Atemp
00520C 6E??           06158                 MOVWF   Atemp           ; Save WREG
00520E 6A??           06159                 CLRF    Btemp
                      06160         ; If the And with next bit is set then set the LSB of Btemp
005210 BCE8           06161                 BTFSC   WREG,6,A
005212 80??           06162                 BSF     Btemp,0
005214 0B07           06163                 ANDLW   07              ; get just the 3 LSBs
005216 2AE8           06164                 INCF    WREG
005218 80D8           06165                 BSF     ALUSTA,C,A      ; Set the carry flag
00521A                06166 ST00
00521A 36??           06167                 RLCF    Btemp,F
00521C 2EE8           06168                 DECFSZ  WREG
00521E EF?? F???      06169                 GOTO    ST00
                      06170         ; Now the proper bit is set in Btemp
005222 50??           06171                 MOVF    PORTDimage,W
005224 B6??           06172                 BTFSC   Atemp,3
005226 50??           06173                 MOVF    PORTEimage,W
005228 14??           06174                 ANDWF   Btemp,W
00522A 80D8           06175                 BSF     ALUSTA,C,A
00522C 62??           06176                 CPFSEQ  Btemp
00522E 90D8           06177                 BCF     ALUSTA,C,A
                      06178         ; Test if the invert flag is set
005230 BE??           06179                 BTFSC   Atemp,7
005232 70D8           06180                 BTG     ALUSTA,C,A      
005234 0012           06181                 RETURN
                      06182 
                      06183 INCLUDE         <helicopter.asm>
                      00001 ;
                      00002 ; This file contails all of the helicopter functions. This includes both the run time mixing
                      00003 ; functions as well as the user interface calibration functions.
                      00004 ;
                      00005 ; CCPM mixing is supported as well as 3 flight modes and a throttle hold mode. This capability
                      00006 ; was added based on collborations with Jack Dice.
                      00007 ;
                      00008 ; Gordon Anderson
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 285


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00009 ; December 25, 2009
                      00010 ;
                      00011 
                      00012 ;
                      00013 ; This is the run time helicoper function and applies the proper mixes to
                      00014 ; enable helicopter operation. Note; CCPM is applied the the mixer section 
                      00015 ; application, not in this routine.
                      00016 ;
005236                00017 ApplyHelicopter
                      00018         ; If the helicopter mode is not enabled then exit this function.
005236 01??           00019                 MOVLR   HIGH Henable
005238 A0??           00020                 BTFSS   Henable,0
00523A 0012           00021                 RETURN
                      00022         ; Here if in helicopter mode.
                      00023         ; Apply IdleUp to throttle position
00523C EC?? F???      00024                 CALL    HsetIdleUp
                      00025                 ; Apply throttle tables if no idle up value was set
005240 A0D8           00026                 BTFSS   ALUSTA,C
005242 EC?? F???      00027                 CALL    HsetThrottle
                      00028         ; Apply Throttle hold position if switch is on, detect a switch state
                      00029         ; change so we can use it to apply the transition time
005246 01??           00030                 MOVLR   HIGH SWTHOLD
005248 5000           00031                 MOVFP   SWTHOLD,WREG
00524A EC?? F???      00032                 CALL    SwitchTest
00524E A0D8           00033                 BTFSS   ALUSTA,C
005250 EF?? F???      00034                 GOTO    AHnotHold
                      00035                 ; Here if the hold switch is on
005254 01??           00036                 MOVLR   HIGH THOLDp
005256 5000           00037                 MOVFP   THOLDp,WREG
005258 01??           00038                 MOVLR   HIGH AXreg
00525A 6E??           00039                 MOVWF   AXreg
00525C 6A??           00040                 CLRF    AXreg+1
                      00041                 MOVEC   D'10',BXreg
00525E 01??               M                 MOVLR   HIGH (BXreg)
005260 0E0A               M                 MOVLW   LOW (D'10')
005262 6E??               M                 MOVWF   (BXreg)
005264 0E00               M                 MOVLW   HIGH (D'10')
005266 6E??               M                 MOVWF   (BXreg+1)
005268 EC?? F???      00042                 CALL    Mult1616
                      00043                 MOVE    CEXreg,Tpos
00526C C??? F???          M                 MOVFF   CEXreg,Tpos
005270 C??? F???          M                 MOVFF   (CEXreg+1),(Tpos+1)
                      00044                 ; Look at the state file, if its reset then there was a state change,
                      00045                 ; this is needed for the slew rate control.
005274 01??           00046                 MOVLB   HIGH TholdState
005276 50??           00047                 MOVF    TholdState,W
005278 A4D8           00048                 BTFSS   ALUSTA,Z
00527A EF?? F???      00049                 GOTO    AHtrim
                      00050                 ; Here with state change on Throttle hold, process the transistion time.
00527E 68??           00051                 SETF    TholdState
                      00052                 MOVE    TtransistionT,TstepSize
005280 C??? F???          M                 MOVFF   TtransistionT,TstepSize
005284 C??? F???          M                 MOVFF   (TtransistionT+1),(TstepSize+1)
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 286


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

005288 EF?? F???      00053                 GOTO    AHtrim
00528C                00054 AHnotHold       
                      00055                 ; Here if the hold switch is off, State flag is set when the switch is on and
                      00056                 ; reset when its off
00528C 01??           00057                 MOVLB   HIGH TholdState
00528E 50??           00058                 MOVF    TholdState,W
005290 B4D8           00059                 BTFSC   ALUSTA,Z
005292 EF?? F???      00060                 GOTO    AHtrim
                      00061                 ; Here with state change on Throttle hold, process the transistion time.
005296 6A??           00062                 CLRF    TholdState
                      00063                 MOVE    TtransistionT,TstepSize         
005298 C??? F???          M                 MOVFF   TtransistionT,TstepSize
00529C C??? F???          M                 MOVFF   (TtransistionT+1),(TstepSize+1)
                      00064         ; Apply CH6 control trim to throttle position and apply pitch
                      00065         ; table
0052A0                00066 AHtrim
                      00067                 ; If thepitch reverse flag is set then reverse the CH6pos, it
                      00068                 ; will be use for pitch trim
0052A0 01??           00069                 MOVLR   HIGH HPrev
0052A2 A0??           00070                 BTFSS   HPrev,0
0052A4 EF?? F???      00071                 GOTO    AHnoRev
                      00072                 ; Here to reverse the sign
0052A8 01??           00073                 MOVLR   HIGH CH6pos
0052AA 1E??           00074                 COMF    CH6pos
0052AC 1E??           00075                 COMF    CH6pos+1
0052AE 2A??           00076                 INCF    CH6pos
0052B0 B4D8           00077                 BTFSC   ALUSTA,Z
0052B2 2A??           00078                 INCF    CH6pos+1
0052B4                00079 AHnoRev
                      00080                 ; Adjust CH6 by the trim pecentage from the throttle channel
0052B4 C??? F???      00081                 MOVFF   TPT,AXreg
0052B8 01??           00082                 MOVLR   HIGH AXreg
0052BA 6A??           00083                 CLRF    AXreg+1
0052BC 0EFF           00084                 MOVLW   0FF
0052BE BE??           00085                 BTFSC   AXreg,7
0052C0 6E??           00086                 MOVWF   AXreg+1
                      00087                 MOVE    CH6pos,BXreg
0052C2 C??? F???          M                 MOVFF   CH6pos,BXreg
0052C6 C??? F???          M                 MOVFF   (CH6pos+1),(BXreg+1)
0052CA EC?? F???      00088                 CALL    Mult1616
0052CE 01??           00089                 MOVLR   HIGH DEXreg
0052D0 0E64           00090                 MOVLW   D'100'
0052D2 6E??           00091                 MOVWF   DEXreg
0052D4 6A??           00092                 CLRF    DEXreg+1
0052D6 6A??           00093                 CLRF    DEXreg+2
0052D8 6A??           00094                 CLRF    DEXreg+3
0052DA EC?? F???      00095                 CALL    Divide2416      ; CEXreg has the trim value
                      00096                 MOVE    CEXreg,CH6pos   ; Save the trim value back to the CH6 pos variable
0052DE C??? F???          M                 MOVFF   CEXreg,CH6pos
0052E2 C??? F???          M                 MOVFF   (CEXreg+1),(CH6pos+1)
                      00097                                         ; Apply the trim after the table is applied
                      00098                 ; Apply the pitch table, result in AXreg
0052E6 EC?? F???      00099                 CALL    HsetPitch
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 287


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00100                 ; Add the pitch trim
0052EA 01??           00101                 MOVLB   HIGH CH6pos
0052EC C??? FFE8      00102                 MOVFF   AXreg,WREG
0052F0 26??           00103                 ADDWF   CH6pos,F
0052F2 C??? FFE8      00104                 MOVFF   AXreg+1,WREG            
0052F6 22??           00105                 ADDWFC  CH6pos+1,F
                      00106         ; Apply the gyro sensitivity setpoint. This is in percentage, 0 to 100.
                      00107         ; 0 to 100 needs to be maped to -1000 to 1000 and sent to channel 5.
0052F8 EC?? F???      00108                 CALL    HsetSensitivity 
0052FC 0012           00109                 RETURN
                      00110         
                      00111 ; The following functions support the ApplyHelicopter function
                      00112 
                      00113 ; This function is called to apply the idle up logic to the normal, stunt 1, and stunt 2 
                      00114 ; flight modes. If the mode is selected and the idle up switch is on then the throttle
                      00115 ; position is set to the idle up value.
                      00116 ; On return the carry flag is set if the idleup mode is active and a throttle position
                      00117 ; has been set.
0052FE                00118 HsetIdleUp
                      00119         ; Test Stunt mode 2 switch
0052FE C??? FFE8      00120                 MOVFF   SWSTUNT2,WREG
005302 EC?? F???      00121                 CALL    SwitchTest
005306 A0D8           00122                 BTFSS   ALUSTA,C
005308 EF?? F???      00123                 GOTO    HIUP_ST1                ; If not stunt mode 2 then jump
                      00124                 ; Here if stunt mode 2, test idle up switch
00530C C??? FFE8      00125                 MOVFF   SWIDLEUPST2,WREG
005310 EC?? F???      00126                 CALL    SwitchTest
005314 A0D8           00127                 BTFSS   ALUSTA,C
005316 0012           00128                 RETURN                          ; Exit if switch is off         
005318 C??? F???      00129                 MOVFF   IdleUpST2,Breg
00531C EF?? F???      00130                 GOTO    HIUP_SET                ; Set the throttle
005320                00131 HIUP_ST1
                      00132         ; Test Stunt mode 1 switch
005320 C??? FFE8      00133                 MOVFF   SWSTUNT1,WREG
005324 EC?? F???      00134                 CALL    SwitchTest
005328 A0D8           00135                 BTFSS   ALUSTA,C
00532A EF?? F???      00136                 GOTO    HIUP_NORM               ; If not stunt mode 1 then jump
                      00137                 ; Here if stunt mode 1, test idle up switch
00532E C??? FFE8      00138                 MOVFF   SWIDLEUPST1,WREG
005332 EC?? F???      00139                 CALL    SwitchTest
005336 A0D8           00140                 BTFSS   ALUSTA,C
005338 0012           00141                 RETURN                          ; Exit if switch is off         
00533A C??? F???      00142                 MOVFF   IdleUpST1,Breg
00533E EF?? F???      00143                 GOTO    HIUP_SET                ; Set the throttle
005342                00144 HIUP_NORM
                      00145         ; Here if in normal flight mode, test idle up switch
005342 C??? FFE8      00146                 MOVFF   SWIDLEUPN,WREG
005346 EC?? F???      00147                 CALL    SwitchTest
00534A A0D8           00148                 BTFSS   ALUSTA,C
00534C 0012           00149                 RETURN                          ; Exit if switch is off         
00534E C??? F???      00150                 MOVFF   IdleUpNorm,Breg
                      00151         ; Set the throttle position
005352                00152 HIUP_SET
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 288


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

005352 01??           00153                 MOVLR   HIGH AXreg
005354 C??? F???      00154                 MOVFF   Breg,AXreg
005358 6A??           00155                 CLRF    AXreg+1
                      00156                 MOVEC   D'10',BXreg
00535A 01??               M                 MOVLR   HIGH (BXreg)
00535C 0E0A               M                 MOVLW   LOW (D'10')
00535E 6E??               M                 MOVWF   (BXreg)
005360 0E00               M                 MOVLW   HIGH (D'10')
005362 6E??               M                 MOVWF   (BXreg+1)
005364 EC?? F???      00157                 CALL    Mult1616
                      00158                 MOVE    CEXreg,Tpos
005368 C??? F???          M                 MOVFF   CEXreg,Tpos
00536C C??? F???          M                 MOVFF   (CEXreg+1),(Tpos+1)
                      00159                 ; Set the carry flag
005370 80D8           00160                 BSF     ALUSTA,C
005372 0012           00161                 RETURN
                      00162                 
                      00163 ; This function is called with the throttle position in reg AXreg. The
                      00164 ; proper translation table is applied based on mode and then the pitch
                      00165 ; output value is calculated and returned in the AXreg.
005374                00166 HsetPitch
                      00167         ; Set the normal flight mode value
005374 C??? F???      00168                 MOVFF   HPitch,Breg
                      00169         ; Test Stunt mode 1 switch
005378 C??? FFE8      00170                 MOVFF   SWSTUNT1,WREG
00537C EC?? F???      00171                 CALL    SwitchTest
005380 B0D8           00172                 BTFSC   ALUSTA,C
005382 C??? F???      00173                 MOVFF   Hst1Pitch,Breg  
                      00174         ; Test Stunt mode 2 switch
005386 C??? FFE8      00175                 MOVFF   SWSTUNT2,WREG
00538A EC?? F???      00176                 CALL    SwitchTest
00538E B0D8           00177                 BTFSC   ALUSTA,C
005390 C??? F???      00178                 MOVFF   Hst2Pitch,Breg
                      00179         ; Test the Throttle hold switch
005394 C??? FFE8      00180                 MOVFF   SWTHOLD,WREG
005398 EC?? F???      00181                 CALL    SwitchTest
00539C B0D8           00182                 BTFSC   ALUSTA,C
00539E C??? F???      00183                 MOVFF   HthtPitch,Breg
                      00184         ; Here with translation table number in Breg
                      00185                 MOVE    Tnorm,AXreg
0053A2 C??? F???          M                 MOVFF   Tnorm,AXreg
0053A6 C??? F???          M                 MOVFF   (Tnorm+1),(AXreg+1)
0053AA EC?? F???      00186                 CALL    Translation
                      00187         ; Test the Pitch reverse flag, if set reverse the pitch sign
0053AE 01??           00188                 MOVLR   HIGH HPrev
0053B0 A0??           00189                 BTFSS   HPrev,0
0053B2 EF?? F???      00190                 GOTO    HPrevDone
                      00191                 ; Here to reverse the sign
0053B6 01??           00192                 MOVLR   HIGH AXreg
0053B8 1E??           00193                 COMF    AXreg
0053BA 1E??           00194                 COMF    AXreg+1
0053BC 2A??           00195                 INCF    AXreg
0053BE B4D8           00196                 BTFSC   ALUSTA,Z
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 289


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

0053C0 2A??           00197                 INCF    AXreg+1
0053C2                00198 HPrevDone
                      00199         ; Return result in AXreg
0053C2 0012           00200                 RETURN
                      00201 
                      00202 ; This function is called with the throttle position in Tpos. The
                      00203 ; proper translation table is applied based on mode and then the throttle
                      00204 ; output value is calculated and sent to Throttle output.
0053C4                00205 HsetThrottle
                      00206         ; Set the normal flight mode value
0053C4 C??? F???      00207                 MOVFF   HTht,Breg
                      00208         ; Test Stunt mode 1 switch
0053C8 C??? FFE8      00209                 MOVFF   SWSTUNT1,WREG
0053CC EC?? F???      00210                 CALL    SwitchTest
0053D0 B0D8           00211                 BTFSC   ALUSTA,C
0053D2 C??? F???      00212                 MOVFF   Hst1Tht,Breg    
                      00213         ; Test Stunt mode 2 switch
0053D6 C??? FFE8      00214                 MOVFF   SWSTUNT2,WREG
0053DA EC?? F???      00215                 CALL    SwitchTest
0053DE B0D8           00216                 BTFSC   ALUSTA,C
0053E0 C??? F???      00217                 MOVFF   Hst2Tht,Breg
                      00218         ; Test the Throttle hold switch, No table is used for Throttle hold
0053E4 C??? FFE8      00219                 MOVFF   SWTHOLD,WREG
0053E8 EC?? F???      00220                 CALL    SwitchTest
0053EC B0D8           00221                 BTFSC   ALUSTA,C
0053EE 6A00           00222                 CLRF    Breg,A
                      00223         ; Here with translation table number in Breg
                      00224                 MOVE    Tpos,AXreg
0053F0 C??? F???          M                 MOVFF   Tpos,AXreg
0053F4 C??? F???          M                 MOVFF   (Tpos+1),(AXreg+1)
0053F8 EC?? F???      00225                 CALL    Translation
                      00226         ; Save the position information in Throttle output
                      00227                 MOVE    AXreg,Tpos
0053FC C??? F???          M                 MOVFF   AXreg,Tpos
005400 C??? F???          M                 MOVFF   (AXreg+1),(Tpos+1)
005404 0012           00228                 RETURN
                      00229                 
005406                00230 HsetSensitivity
                      00231         ; If the GyroTune flag is set then send CH7 channel to CH5 and exit
                      00232                 MOVE    CH7pos,CH5pos
005406 C??? F???          M                 MOVFF   CH7pos,CH5pos
00540A C??? F???          M                 MOVFF   (CH7pos+1),(CH5pos+1)
00540E 01??           00233                 MOVLB   HIGH GyroTune
005410 50??           00234                 MOVF    GyroTune,W
005412 A4D8           00235                 BTFSS   ALUSTA,Z
005414 0012           00236                 RETURN
                      00237         ; Set the normal flight mode value
005416 C??? F???      00238                 MOVFF   HSen,Breg
                      00239         ; Test Stunt mode 1 switch
00541A C??? FFE8      00240                 MOVFF   SWSTUNT1,WREG
00541E EC?? F???      00241                 CALL    SwitchTest
005422 B0D8           00242                 BTFSC   ALUSTA,C
005424 C??? F???      00243                 MOVFF   Hst1Sen,Breg    
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 290


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00244         ; Test Stunt mode 2 switch
005428 C??? FFE8      00245                 MOVFF   SWSTUNT2,WREG
00542C EC?? F???      00246                 CALL    SwitchTest
005430 B0D8           00247                 BTFSC   ALUSTA,C
005432 C??? F???      00248                 MOVFF   Hst2Sen,Breg
                      00249         ; Test the Throttle hold switch
005436 C??? FFE8      00250                 MOVFF   SWTHOLD,WREG
00543A EC?? F???      00251                 CALL    SwitchTest
00543E B0D8           00252                 BTFSC   ALUSTA,C
005440 C??? F???      00253                 MOVFF   HthtSen,Breg
                      00254         ; Here with gyro sensitivity in percentage in Breg, convert
                      00255         ; 0 to 100 to -1000 to 100. subtract 50 then multiply by 20
005444 C??? FFE8      00256                 MOVFF   Breg,WREG
005448 0FCE           00257                 ADDLW   -D'50'                  ; WREG - 50 -> WREG
00544A CFE8 F???      00258                 MOVFF   WREG,AXreg
00544E 01??           00259                 MOVLB   HIGH AXreg
005450 6A??           00260                 CLRF    AXreg+1
005452 BE??           00261                 BTFSC   AXreg,7
005454 68??           00262                 SETF    AXreg+1
                      00263                 MOVEC   D'20',BXreg
005456 01??               M                 MOVLR   HIGH (BXreg)
005458 0E14               M                 MOVLW   LOW (D'20')
00545A 6E??               M                 MOVWF   (BXreg)
00545C 0E00               M                 MOVLW   HIGH (D'20')
00545E 6E??               M                 MOVWF   (BXreg+1)
005460 EC?? F???      00264                 CALL    Mult1616
                      00265         ; Save the gyro sensitivity information in CH5 output
                      00266                 MOVE    CEXreg,CH5pos
005464 C??? F???          M                 MOVFF   CEXreg,CH5pos
005468 C??? F???          M                 MOVFF   (CEXreg+1),(CH5pos+1)
00546C 0012           00267                 RETURN
                      00268         
                      00269 ; This routine is called when the option button is pressed in the run mode. If the
                      00270 ; helicopter mode is active and if the GyroTune flag is active then the option 
                      00271 ; button press is used to signal capture of the CH7 control to the gyro sensitivity 
                      00272 ; variable for the select flight mode.
                      00273 ; On exit carry flag is set if the mode is active.
                      00274 ;
                      00275 ; Note! Need to write the variables to FLASH, but only save if we are not in an
                      00276 ;       alternate aircraft mode. Make sure DefaultAircraft equals Aircraft
                      00277 ;       then call SaveAircraft.
00546E                00278 GyroTuneProcess
                      00279         ; Exit if not in the helicopter mode
00546E 90D8           00280                 BCF     ALUSTA,C
005470 01??           00281                 MOVLR   HIGH Henable
005472 A0??           00282                 BTFSS   Henable,0
005474 0012           00283                 RETURN  
                      00284         ; Exit if the GyroTune flag is not set
005476 01??           00285                 MOVLB   HIGH GyroTune
005478 50??           00286                 MOVF    GyroTune,W
00547A B4D8           00287                 BTFSC   ALUSTA,Z
00547C 0012           00288                 RETURN
                      00289         ; Here if we need to process the option button in this function.
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 291


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00290         ; Adjust the beep to signal the action
00547E 0E03           00291                 MOVLW   D'3'
005480 CFE8 F???      00292                 MOVFF   WREG,BeepCyl
005484 0E02           00293                 MOVLW   D'2'
005486 EC?? F???      00294                 CALL    Beep
                      00295         ; Calculate the percentage from the CH7 control position.
                      00296         ; Percentage = (CH7pos+1000)/20
                      00297                 MOVE    CH7pos,CEXreg
00548A C??? F???          M                 MOVFF   CH7pos,CEXreg
00548E C??? F???          M                 MOVFF   (CH7pos+1),(CEXreg+1)
005492 01??           00298                 MOVLB   HIGH CEXreg
005494 0EE8           00299                 MOVLW   LOW D'1000'
005496 26??           00300                 ADDWF   CEXreg,F
005498 0E03           00301                 MOVLW   HIGH D'1000'
00549A 22??           00302                 ADDWFC  CEXreg+1
00549C 6A??           00303                 CLRF    CEXreg+2
00549E 0E14           00304                 MOVLW   D'20'
0054A0 CFE8 F???      00305                 MOVFF   WREG,DEXreg
0054A4 EC?? F???      00306                 CALL    Divide168
                      00307         ; The percentage position data in now in the CEXreg's LS byte.
                      00308         ; Now determine the flight mode and save in the proper location.
                      00309         
                      00310         ; Test Throttle hold
0054A8 C??? FFE8      00311                 MOVFF   SWTHOLD,WREG
0054AC EC?? F???      00312                 CALL    SwitchTest
0054B0 A0D8           00313                 BTFSS   ALUSTA,C
0054B2 EF?? F???      00314                 GOTO    GTP_Stunt2
0054B6 C??? F???      00315                 MOVFF   CEXreg,HthtSen
0054BA EF?? F???      00316                 GOTO    GTP_Save
                      00317         ; Test Stunt 2
0054BE                00318 GTP_Stunt2
0054BE C??? FFE8      00319                 MOVFF   SWSTUNT2,WREG
0054C2 EC?? F???      00320                 CALL    SwitchTest
0054C6 A0D8           00321                 BTFSS   ALUSTA,C
0054C8 EF?? F???      00322                 GOTO    GTP_Stunt1
0054CC C??? F???      00323                 MOVFF   CEXreg,Hst2Sen
0054D0 EF?? F???      00324                 GOTO    GTP_Save
                      00325         ; Test Stunt 1
0054D4                00326 GTP_Stunt1
0054D4 C??? FFE8      00327                 MOVFF   SWSTUNT1,WREG
0054D8 EC?? F???      00328                 CALL    SwitchTest
0054DC A0D8           00329                 BTFSS   ALUSTA,C
0054DE EF?? F???      00330                 GOTO    GTP_Norm
0054E2 C??? F???      00331                 MOVFF   CEXreg,Hst1Sen
0054E6 EF?? F???      00332                 GOTO    GTP_Save
                      00333         ; Here if normal mode
0054EA                00334 GTP_Norm
0054EA C??? F???      00335                 MOVFF   CEXreg,HSen
0054EE 80D8           00336                 BSF     ALUSTA,C
                      00337         ; Here is save the results is we are not in the alternut aircraft mode
0054F0                00338 GTP_Save
                      00339         ; Compare Aircraft and DefaultAircraft, if different then exit
0054F0 C??? FFE8      00340                 MOVFF   Aircraft,WREG
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 292


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

0054F4 01??           00341                 MOVLB   HIGH DefaultAircraft
0054F6 18??           00342                 XORWF   DefaultAircraft,W
0054F8 80D8           00343                 BSF     ALUSTA,C
0054FA A4D8           00344                 BTFSS   ALUSTA,Z
0054FC 0012           00345                 RETURN
                      00346         ; Here is the same so save
0054FE C??? FFE8      00347                 MOVFF   Aircraft,WREG
005502 EC?? F???      00348                 CALL    SaveAircraft
005506 80D8           00349                 BSF     ALUSTA,C
005508 0012           00350                 RETURN
                      00351                 
                      00352 ;
                      00353 ; This function will display the helicopter flight mode. The mode is displayed on the
                      00354 ; second line of the display using the two right most characters.
                      00355 ;
                      00356 ;       Mode                    Display
                      00357 ;       Throttle Hold           TH
                      00358 ;       Stunt 1                 S1
                      00359 ;       Stunt 2                 S2
                      00360 ;
00550A                00361 HelicopterModeDisplay
                      00362         ; Exit if not helicopter mode
00550A 01??           00363                 MOVLR   HIGH Henable
00550C A0??           00364                 BTFSS   Henable,0
00550E 0012           00365                 RETURN
                      00366         ; Position the display to line 2
005510 0ECE           00367                 MOVLW   LINE2+D'14'
005512 EC?? F???      00368                 CALL    LCDsendCMD
                      00369         ; Test the Throttle hold switch
005516 C??? FFE8      00370                 MOVFF   SWTHOLD,WREG
00551A EC?? F???      00371                 CALL    SwitchTest
00551E B0D8           00372                 BTFSC   ALUSTA,C
005520 EF?? F???      00373                 GOTO    HMD_TH
                      00374         ; Test Stunt mode 2 switch
005524 C??? FFE8      00375                 MOVFF   SWSTUNT2,WREG
005528 EC?? F???      00376                 CALL    SwitchTest
00552C B0D8           00377                 BTFSC   ALUSTA,C
00552E EF?? F???      00378                 GOTO    HMD_S2
                      00379         ; Test Stunt mode 1 switch
005532 C??? FFE8      00380                 MOVFF   SWSTUNT1,WREG
005536 EC?? F???      00381                 CALL    SwitchTest
00553A B0D8           00382                 BTFSC   ALUSTA,C
00553C EF?? F???      00383                 GOTO    HMD_S1
                      00384         ; Here if in normal mode so just exit
005540 0012           00385                 RETURN
                      00386         ; Print mode tags on the right side of the display
005542                00387 HMD_TH
                      00388                 PrintMess       TH_Mode
005542 0E??               M                 MOVLW   UPPER (TH_Mode)
005544 6EF8               M                 MOVWF   TBLPTRU,A
005546 0E??               M                 MOVLW   HIGH (TH_Mode)
005548 6EF7               M                 MOVWF   TBLPTRH,A
00554A 0E??               M                 MOVLW   LOW (TH_Mode)
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 293


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

00554C 6EF6               M                 MOVWF   TBLPTRL,A
00554E EC?? F???          M                 CALL    LCDsendMess
005552 0012           00389                 RETURN
005554                00390 HMD_S1
                      00391                 PrintMess       S1_Mode
005554 0E??               M                 MOVLW   UPPER (S1_Mode)
005556 6EF8               M                 MOVWF   TBLPTRU,A
005558 0E??               M                 MOVLW   HIGH (S1_Mode)
00555A 6EF7               M                 MOVWF   TBLPTRH,A
00555C 0E??               M                 MOVLW   LOW (S1_Mode)
00555E 6EF6               M                 MOVWF   TBLPTRL,A
005560 EC?? F???          M                 CALL    LCDsendMess
005564 0012           00392                 RETURN
005566                00393 HMD_S2
                      00394                 PrintMess       S2_Mode
005566 0E??               M                 MOVLW   UPPER (S2_Mode)
005568 6EF8               M                 MOVWF   TBLPTRU,A
00556A 0E??               M                 MOVLW   HIGH (S2_Mode)
00556C 6EF7               M                 MOVWF   TBLPTRH,A
00556E 0E??               M                 MOVLW   LOW (S2_Mode)
005570 6EF6               M                 MOVWF   TBLPTRL,A
005572 EC?? F???          M                 CALL    LCDsendMess
005576 0012           00395                 RETURN
                      00396 
                      00397 ; Mode display text             
005578 4854 0000      00398 TH_Mode         DB      "TH",0
00557C 3153 0000      00399 S1_Mode         DB      "S1",0
005580 3253 0000      00400 S2_Mode         DB      "S2",0
                      00401 
                      00402 ; The following are pre and post processing routines for the Throttle hold transistion time
                      00403 ; function.
005584                00404 PreTTT
                      00405         ; t = 500 / step size
005584 6AE8           00406                 CLRF    WREG
005586 CFE8 F???      00407                 MOVFF   WREG,CEXreg+2
                      00408                 MOVEC   D'500',CEXreg
00558A 01??               M                 MOVLR   HIGH (CEXreg)
00558C 0EF4               M                 MOVLW   LOW (D'500')
00558E 6E??               M                 MOVWF   (CEXreg)
005590 0E01               M                 MOVLW   HIGH (D'500')
005592 6E??               M                 MOVWF   (CEXreg+1)
                      00409                 MOVE    TtransistionT,DEXreg
005594 C??? F???          M                 MOVFF   TtransistionT,DEXreg
005598 C??? F???          M                 MOVFF   (TtransistionT+1),(DEXreg+1)
00559C EC?? F???      00410                 CALL    Divide2416
                      00411         ; Move results to step size
                      00412                 MOVE    CEXreg,TtransistionT
0055A0 C??? F???          M                 MOVFF   CEXreg,TtransistionT
0055A4 C??? F???          M                 MOVFF   (CEXreg+1),(TtransistionT+1)
0055A8 6AE8           00413                 CLRF    WREG
0055AA CFE8 F???      00414                 MOVFF   WREG,TtransistionT+1
0055AE C??? FFE8      00415                 MOVFF   TtransistionT,WREG
0055B2 0012           00416                 RETURN
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 294


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

0055B4                00417 PostTTT
                      00418         ; If user set the time to 0 then set the step size to 2000 and exit
0055B4 C??? FFE8      00419                 MOVFF   TtransistionT,WREG
0055B8 66E8           00420                 TSTFSZ  WREG,A
0055BA EF?? F???      00421                 GOTO    PreTTT
                      00422                 MOVEC   D'2000',TtransistionT
0055BE 01??               M                 MOVLR   HIGH (TtransistionT)
0055C0 0ED0               M                 MOVLW   LOW (D'2000')
0055C2 6E??               M                 MOVWF   (TtransistionT)
0055C4 0E07               M                 MOVLW   HIGH (D'2000')
0055C6 6E??               M                 MOVWF   (TtransistionT+1)
0055C8 0012           00423                 RETURN
                      00424 
                      06184 INCLUDE         <tach.asm>
                      00001 ; 
                      00002 ; This file contains the routines that support the tachometer feature. This feature uses
                      00003 ; an enternal module that contains the photo cell used to detect the prop. Timer 0 is
                      00004 ; used to count the pulses from the detector and RB1/INT1 is used to count prop revolutions.
                      00005 ;
                      00006 ; Tach algorithm
                      00007 ; The CPU is interrupted on each detection of the prop and the prop dectections are
                      00008 ; counted. Timer 0 is set to free running count mode. Every second the following
                      00009 ; parameters are measured:
                      00010 ;       Number of prop blade detections, 16 bit number (BladeDet)
                      00011 ;       Total timer counts, 16 bit number (BladeTime)
                      00012 ; The timer is set to 62500 Hz clock rate. At each blade detection the timer value is
                      00013 ; read and added to the blade time value.
                      00014 ; To calculate the RPM:
                      00015 ; RPM = ((Clock/BladeTime)*BladeDet)*60/NumBlades
                      00016 
                      00017 
                      00018 ; This function is called on power up to initalize the Tach. Set to 16 bit mode free running
                      00019 ; with a clock rate of 62500Hz.
                      00020 ; Timer is stoped after init, it will start on first blade detection.
0055CA                00021 TachInit
0055CA 0E04           00022         MOVLW   04H
0055CC 6ED5           00023         MOVWF   T0CON
0055CE 0012           00024         RETURN
                      00025 
                      00026 ; This function is called every second to stop the processing of blade detection
                      00027 ; interrupts. This is done by disabling timer0.
0055D0                00028 TachRead
0055D0 9ED5           00029         BCF     T0CON,TMR0ON,A
0055D2 0012           00030         RETURN  
                      00031 
                      00032 ; This function tests the TachEnable bit and if its clear the RPM is calculated
                      00033 ; and displayed on line two of the display. If the Tach is enabled this routine
                      00034 ; returns with the carry flag set.
0055D4                00035 TackDisplay
0055D4 90D8           00036         BCF     ALUSTA,C
                      00037 ifdef   NOTACHENA
                      00038         RETURN
                      00039 endif
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 295


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

0055D6 B287           00040         BTFSC   PORTH,TACHENA
0055D8 0012           00041         RETURN
                      00042    ; Here if the tach is enabled
0055DA 80D8           00043         BSF     ALUSTA,C
                      00044         ; Exit if the timer is enabled
0055DC BED5           00045         BTFSC   T0CON,TMR0ON
0055DE 0012           00046         RETURN
                      00047    ; Here with valid data to calculate the RPM and display the value    
                      00048         ; RPM = ((Clock/BladeTime)*BladeDet)*60/NumBlades, calculated this way:
                      00049         ; RPM = (Clock * BladeDet * 60) / (NumBlades * BladeTime)
                      00050         ; First; 60 * BladeDet
                      00051         MOVE    BladeDet, AXreg
0055E0 C??? F???          M                 MOVFF   BladeDet,AXreg
0055E4 C??? F???          M                 MOVFF   (BladeDet+1),(AXreg+1)
                      00052         MOVEC   D'60', BXreg
0055E8 01??               M                 MOVLR   HIGH (BXreg)
0055EA 0E3C               M                 MOVLW   LOW (D'60')
0055EC 6E??               M                 MOVWF   (BXreg)
0055EE 0E00               M                 MOVLW   HIGH (D'60')
0055F0 6E??               M                 MOVWF   (BXreg+1)
0055F2 EC?? F???      00053         CALL    Mult1616u
                      00054         ; Ans fits in 16 bits, move ans from CEXreg to AXreg
                      00055         MOVE    CEXreg,AXreg
0055F6 C??? F???          M                 MOVFF   CEXreg,AXreg
0055FA C??? F???          M                 MOVFF   (CEXreg+1),(AXreg+1)
                      00056         MOVEC   D'62500', BXreg
0055FE 01??               M                 MOVLR   HIGH (BXreg)
005600 0E24               M                 MOVLW   LOW (D'62500')
005602 6E??               M                 MOVWF   (BXreg)
005604 0EF4               M                 MOVLW   HIGH (D'62500')
005606 6E??               M                 MOVWF   (BXreg+1)
005608 EC?? F???      00057         CALL    Mult1616u
                      00058         ; CEXreg  = (Clock * BladeDet * 60)
                      00059         ; Now divide by BladeTime
                      00060         MOVEC32 D'0',DEXreg
00560C 01??               M                 MOVLR   HIGH (DEXreg)
00560E 0E00               M                 MOVLW   LOW (D'0')
005610 6E??               M                 MOVWF   (DEXreg)
005612 0E00               M                 MOVLW   LOW (D'0'/100)
005614 6E??               M                 MOVWF   (DEXreg+1)
005616 0E00               M                 MOVLW   HIGH (D'0'/100)
005618 6E??               M                 MOVWF   (DEXreg+2)
00561A 0E00               M                 MOVLW   UPPER (D'0'/100)
00561C 6E??               M                 MOVWF   (DEXreg+3)
                      00061         MOVE    BladeTime,DEXreg
00561E C??? F???          M                 MOVFF   BladeTime,DEXreg
005622 C??? F???          M                 MOVFF   (BladeTime+1),(DEXreg+1)
005626 EC?? F???      00062         CALL    Divide3232u
                      00063         ; Now divide by NumBlades
                      00064         MOVE    NumBlades,DEXreg
00562A C??? F???          M                 MOVFF   NumBlades,DEXreg
00562E C??? F???          M                 MOVFF   (NumBlades+1),(DEXreg+1)
005632 01??           00065         MOVLR   HIGH DEXreg
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 296


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

005634 6A??           00066         CLRF    DEXreg+1
005636 EC?? F???      00067         CALL    Divide2416
                      00068    ; RPM in CEXreg, now display the result
                      00069         ; Display the template
00563A 0EC0           00070         MOVLW   LINE2
00563C EC?? F???      00071         CALL    LCDsendCMD
                      00072         PrintMess MES15
005640 0E??               M                 MOVLW   UPPER (MES15)
005642 6EF8               M                 MOVWF   TBLPTRU,A
005644 0E??               M                 MOVLW   HIGH (MES15)
005646 6EF7               M                 MOVWF   TBLPTRH,A
005648 0E??               M                 MOVLW   LOW (MES15)
00564A 6EF6               M                 MOVWF   TBLPTRL,A
00564C EC?? F???          M                 CALL    LCDsendMess
                      00073         ; Display the RPM
005650 0ECB           00074         MOVLW   LINE2+TACHRPMPOS
005652 EC?? F???      00075         CALL    LCDsendCMD
005656 EC?? F???      00076         CALL    LCDintZS
                      00077         ; Diplay the number of blades
                      00078         MOVE    NumBlades,CEXreg
00565A C??? F???          M                 MOVFF   NumBlades,CEXreg
00565E C??? F???          M                 MOVFF   (NumBlades+1),(CEXreg+1)
005662 6A??           00079         CLRF    CEXreg+1
005664 0EC0           00080         MOVLW   LINE2
005666 EC?? F???      00081         CALL    LCDsendCMD
00566A EC?? F???      00082         CALL    LCDint1
                      00083         ; Set carry flag and exit
                      00084         MOVEC   0,BladeDet
00566E 01??               M                 MOVLR   HIGH (BladeDet)
005670 0E00               M                 MOVLW   LOW (0)
005672 6E??               M                 MOVWF   (BladeDet)
005674 0E00               M                 MOVLW   HIGH (0)
005676 6E??               M                 MOVWF   (BladeDet+1)
005678 80D8           00085         BSF     ALUSTA,C
00567A 0012           00086         RETURN
                      00087 
                      00088         
                      06185 INCLUDE         <ui.asm>
                      00001 ;
                      00002 ; This function will exit the Calibration mode if the run/cal
                      00003 ; switch is set to the run mode while we are in the calibration
                      00004 ; mode. The stack pointer is reset and we are vectored to main
                      00005 ;
00567C                00006 CALexit
                      00007         ; Test mode, if not in Cal mode then return
00567C 01??           00008                 MOVLR   HIGH Mode
00567E 0E02           00009                 MOVLW   modeCAL
005680 62??           00010                 CPFSEQ  Mode
005682 0012           00011                 RETURN
                      00012         ; Here if in the CAL mode, so test the switch
005684 01??           00013                 MOVLR   HIGH PORTEimage
005686 A0??           00014                 BTFSS   PORTEimage,RUNCAL
005688 0012           00015                 RETURN  ; Still in CAL mode
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 297


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00016                 ; Switched to run mode, reset the stack and goto main...
                      00017                 ; No stack reset function provided, so just jump to main
                      00018                 ; after clearing the stack pointer
00568A 6AFC           00019                 CLRF    STKPTR
00568C EF?? F???      00020                 GOTO    main
                      00021                 
                      00022 ; This function is called from the UI data entry wait loops, if the
                      00023 ; preset button is pressed then this function will save the general
                      00024 ; and aircraft data and return to the "Press Option" cal mode.
005690                00025 CalSaveAndExit
005690 EC?? F???      00026                 CALL    Preset
005694 A0D8           00027                 BTFSS   STATUS,C
005696 0012           00028                 RETURN
                      00029         ; Here to save data and exit the menu system
005698 6AFC           00030                 CLRF    STKPTR
00569A EC?? F???      00031                 CALL    SaveGeneral
00569E C??? FFE8      00032                 MOVFF   Aircraft,WREG   ; Load aircraft number
0056A2 EC?? F???      00033                 CALL    SaveAircraft
0056A6 EC?? F???      00034                 CALL    BackupAircraft
0056AA EF?? F???      00035                 GOTO    main
                      00036 
                      00037 ; This function tests the Preset button and returns its state
                      00038 ; in the carry flag. This fuction is used by the UI to exit 
                      00039 ; data entry. This is a shortcut to return to the "Press Option"
                      00040 ; mode.
                      00041 ;
                      00042 ;       C set if Preset button was pressed
0056AE                00043 Preset
0056AE 01??           00044                 MOVLR   HIGH PORTDimage
0056B0 B6??           00045                 BTFSC   PORTDimage,PRESET
0056B2 EF?? F???      00046                 GOTO    Preset1
                      00047                 ; Test if its been processed
0056B6 A6??           00048                 BTFSS   PORTDlatch,PRESET
0056B8 EF?? F???      00049                 GOTO    Preset1
                      00050                 ; Here if preset was pressed
0056BC 96??           00051                 BCF     PORTDlatch,PRESET
0056BE 80D8           00052                 BSF     ALUSTA,C,A
0056C0 0012           00053                 RETURN
0056C2                00054 Preset1
0056C2 90D8           00055                 BCF     ALUSTA,C,A
0056C4 0012           00056                 RETURN
                      00057 
                      00058 ; This function is called when in the CAL mode and the option button
                      00059 ; is pressed. This function allows the user to select the calibration
                      00060 ; option he wishes to use. The jump table located at CALoptions is used
                      00061 ; to call the selected routine.
                      00062 ; No parameters are expected when this routine is called.
0056C6                00063 Calibration
                      00064         ; Display the options...
0056C6 01??           00065                 MOVLB   HIGH AXreg
0056C8 0E??           00066                 MOVLW   HIGH CALMES1
0056CA 6E??           00067                 MOVWF   AXreg+1
0056CC 0E??           00068                 MOVLW   LOW CALMES1
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 298


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

0056CE 6E??           00069                 MOVWF   AXreg
0056D0 EC?? F???      00070                 CALL    SelectionFunction
0056D4 EC?? F???      00071                 CALL    LCDsendAX
                      00072         ; Goto the jump table and process
0056D8 01??           00073                 MOVLB   HIGH CXreg
0056DA 5000           00074                 MOVF    CXreg,WREG
0056DC EC?? F???      00075                 CALL    CALoptions
0056E0 0012           00076                 RETURN
                      00077 
                      00078 ; This function is called by the CalUI calibration user interface generic
                      00079 ; processing routine. This function will display the selected calibration
                      00080 ; option on the top line of the display.
                      00081 ; The variable CalOption holds a pointer to the selection option table 
                      00082 ; entry. This entry starts with the string that needs to be displayed.
0056E2                00083 DisplayCalibration
                      00084                 MOVE16  CalOption,AXreg
0056E2 C??? F???          M                 MOVFF   CalOption,AXreg
0056E6 C??? F???          M                 MOVFF   (CalOption+1),(AXreg+1)
                      00085                 CALLF   LCDsendAX
0056EA EC?? F???          M                 CALL    (LCDsendAX)
0056EE 0012           00086                 RETURN
                      00087                 
                      00088 ; This function is called by the adjust routines in the UI
                      00089 ; that need to allow the pilot to see the servo positions 
                      00090 ; update. For example, this is used by adjust percentage 
                      00091 ; for the sub trim functions.
                      00092 ; The flag CalServoUpdate must be set or this function will
                      00093 ; exit with no action.
0056F0                00094 CalModeProcess
0056F0 01??           00095                 MOVLB   HIGH CalServoUpdate
0056F2 50??           00096                 MOVF    CalServoUpdate,W
0056F4 B4D8           00097                 BTFSC   STATUS,Z
0056F6 0012           00098                 RETURN
                      00099         ; Save FSR1 regs
0056F8 CFE1 F???      00100                 MOVFF   FSR1L, SaveFSR1L
0056FC CFE2 F???      00101                 MOVFF   FSR1H, SaveFSR1H
                      00102                 
005700 EC?? F???      00103                 CALL    CalculateNormalizedPositions
                      00104                 MOVEC   0,Apos                          ; Zero the aileron and elevator
005704 01??               M                 MOVLR   HIGH (Apos)
005706 0E00               M                 MOVLW   LOW (0)
005708 6E??               M                 MOVWF   (Apos)
00570A 0E00               M                 MOVLW   HIGH (0)
00570C 6E??               M                 MOVWF   (Apos+1)
                      00105                 MOVEC   0,Epos
00570E 01??               M                 MOVLR   HIGH (Epos)
005710 0E00               M                 MOVLW   LOW (0)
005712 6E??               M                 MOVWF   (Epos)
005714 0E00               M                 MOVLW   HIGH (0)
005716 6E??               M                 MOVWF   (Epos+1)
005718 EC?? F???      00106                 CALL    ApplyDualRates
00571C EC?? F???      00107                 CALL    ApplyExpo
005720 EC?? F???      00108                 CALL    ApplySnap
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 299


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

005724 EC?? F???      00109                 CALL    AutoTrim
005728 EC?? F???      00110                 CALL    ApplyTrims
00572C EC?? F???      00111                 CALL    ApplyFixedMixersPrior
005730 EC?? F???      00112                 CALL    ApplyMixers
005734 EC?? F???      00113                 CALL    ApplyFixedMixers
005738 EC?? F???      00114                 CALL    ApplySubTrims
00573C EC?? F???      00115                 CALL    CalculateServoPositions
                      00116 
005740 EC?? F???      00117                 CALL    ProcessCommand
                      00118         ; Restore FSR1 regs
005744 C??? FFE1      00119                 MOVFF   SaveFSR1L, FSR1L
005748 C??? FFE2      00120                 MOVFF   SaveFSR1H, FSR1H
                      00121         
00574C 0012           00122                 RETURN
                      00123 
                      00124 ; This function is called to set the CalServoUpdate flag. This is a 
                      00125 ; function that is called by the user interface code using the pre call
                      00126 ; table functions.
00574E                00127 SetSUflag
00574E 01??           00128                 MOVLB   HIGH CalServoUpdate
005750 68??           00129                 SETF    CalServoUpdate
005752 0012           00130                 RETURN
                      00131 
                      00132 ; AXreg points to the start of the message table. This 
                      00133 ; function fills CXreg with the word at the end of the 
                      00134 ; message block. BXreg is then filled with the second
                      00135 ; optional word. DXreg is filled with the third optional
                      00136 ; word. AXreg points at the current message on exit.         
                      00137 ;
                      00138 ; On call:
                      00139 ;       AXreg points to start of message table
                      00140 ; On Exit:
                      00141 ;       AXreg = points to the current selection
                      00142 ;       CXreg = Opt:Type
                      00143 ;       Bxreg = ptr1, first optional word
                      00144 ;       DXreg = ptr2, second optional word
                      00145 ; If the opt bit 6 is set then the min and max parameters
                      00146 ; are read and the limit reg are set. MinValue and MaxValue.
                      00147 ;
005754                00148 SelectionFunction
005754 EC?? F???      00149                 CALL    CALexit
                      00150         ; Clear the EXIT flag
005758 01??           00151                 MOVLR   HIGH EXIT
00575A 6A??           00152                 CLRF    EXIT 
00575C 6A??           00153                 CLRF    YESNO  
00575E 6A??           00154                 CLRF    PostCall
005760 6A??           00155                 CLRF    PostCall+1
                      00156         ; Display the message
005762                00157 SelFun4 
                      00158                 CALLFL  LCDsendCMD,LINE2
005762 0EC0               M                 MOVLW   (LINE2)
005764 EC?? F???          M                 CALL    (LCDsendCMD)
005768 C??? FFF6      00159                 MOVFF   AXreg,TBLPTRL
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 300


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

00576C C??? FFF7      00160                 MOVFF   AXreg+1,TBLPTRH
005770 6AF8           00161                 CLRF    TBLPTRU
                      00162                 MOVE16  AXreg,BXreg             ; Save pointer to current message
005772 C??? F???          M                 MOVFF   AXreg,BXreg
005776 C??? F???          M                 MOVFF   (AXreg+1),(BXreg+1)
00577A EC?? F???      00163                 CALL    LCDsendMess
                      00164                 CALLFL  Delay1mS,D'250'
00577E 0EFA               M                 MOVLW   (D'250')
005780 EC?? F???          M                 CALL    (Delay1mS)
                      00165         ; Get the users selection
005784 EC?? F???      00166                 CALL    Aileron
005788 A4D8           00167                 BTFSS   ALUSTA,Z
00578A EF?? F???      00168                 GOTO    SelFun1
                      00169                 ; If here go to next selection
00578E 0E11           00170                 MOVLW   D'17'
005790 26??           00171                 ADDWF   AXreg,F
005792 B0D8           00172                 BTFSC   ALUSTA,C
005794 2A??           00173                 INCF    AXreg+1,F
005796 EF?? F???      00174                 GOTO    SelFun2
00579A                00175 SelFun1
00579A A0D8           00176                 BTFSS   ALUSTA,C
00579C EF?? F???      00177                 GOTO    SelFun3
                      00178                 ; If here go to last selection
0057A0 0E13           00179                 MOVLW   D'19'
0057A2 26??           00180                 ADDWF   AXreg
0057A4 B0D8           00181                 BTFSC   ALUSTA,C
0057A6 2A??           00182                 INCF    AXreg+1
0057A8                00183 SelFun2
                      00184                 ; Load AXreg into the table pointer
0057A8 C??? FFF6      00185                 MOVFF   AXreg,TBLPTRL
0057AC C??? FFF7      00186                 MOVFF   AXreg+1,TBLPTRH
0057B0 6AF8           00187                 CLRF    TBLPTRU
                      00188                 ; Load AXreg with the table pointer contents...
0057B2 0009           00189                 TBLRD*+
0057B4 CFF5 F???      00190                 MOVFF   TABLAT,AXreg
0057B8 0009           00191                 TBLRD*+
0057BA CFF5 F???      00192                 MOVFF   TABLAT,AXreg+1
0057BE EF?? F???      00193                 GOTO    SelFun4
                      00194         ; Check for Option button
0057C2                00195 SelFun3
0057C2 EC?? F???      00196                 CALL    CalSaveAndExit
0057C6 EC?? F???      00197                 CALL    Option
0057CA A0D8           00198                 BTFSS   ALUSTA,C
0057CC EF?? F???      00199                 GOTO    SelFun4
                      00200         ; The option button  has been pressed. Advance the table
                      00201         ; pointer to the parameters at the end of the record. Load
                      00202         ; the word into CXreg...
0057D0 0E15           00203                 MOVLW   D'21'
0057D2 26??           00204                 ADDWF   AXreg
0057D4 B0D8           00205                 BTFSC   ALUSTA,C
0057D6 2A??           00206                 INCF    AXreg+1
                      00207                 ; Load AXreg into the table pointer
0057D8 C??? FFF6      00208                 MOVFF   AXreg,TBLPTRL
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 301


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

0057DC C??? FFF7      00209                 MOVFF   AXreg+1,TBLPTRH
0057E0 6AF8           00210                 CLRF    TBLPTRU,A
                      00211                 ; Load CXreg with the table pointer contents...
0057E2 0009           00212                 TBLRD*+
0057E4 CFF5 F???      00213                 MOVFF   TABLAT,CXreg
0057E8 0009           00214                 TBLRD*+
0057EA CFF5 F???      00215                 MOVFF   TABLAT,CXreg+1
                      00216         ; Restore AXreg to point at current message
                      00217                 MOVE16  BXreg,AXreg
0057EE C??? F???          M                 MOVFF   BXreg,AXreg
0057F2 C??? F???          M                 MOVFF   (BXreg+1),(AXreg+1)
                      00218         ; Load the option second word into BXreg
0057F6 0009           00219                 TBLRD*+
0057F8 CFF5 F???      00220                 MOVFF   TABLAT,BXreg
0057FC 0009           00221                 TBLRD*+
0057FE CFF5 F???      00222                 MOVFF   TABLAT,BXreg+1
                      00223         ; Load the option third word into DXreg
005802 0009           00224                 TBLRD*+
005804 CFF5 F???      00225                 MOVFF   TABLAT,DXreg
005808 0009           00226                 TBLRD*+
00580A CFF5 F???      00227                 MOVFF   TABLAT,DXreg+1
                      00228         ; If Opt bit 6 is set then load min and max value, opt is in CXreg+1
                      00229                 ; Set default limits
00580E 01??           00230                 MOVLB   HIGH MinValue
005810 6A??           00231                 CLRF    MinValue
005812 6A??           00232                 CLRF    MinValue+1
005814 68??           00233                 SETF    MaxValue
005816 0E7F           00234                 MOVLW   07F
005818 CFE8 F???      00235                 MOVFF   WREG,MaxValue+1
                      00236                 ;
00581C AC??           00237                 BTFSS   CXreg+1,6
00581E EF?? F???      00238                 GOTO    SelFun4a
                      00239                 ; Load MinValue
005822 0009           00240                 TBLRD*+
005824 CFF5 F???      00241                 MOVFF   TABLAT,MinValue
005828 0009           00242                 TBLRD*+
00582A CFF5 F???      00243                 MOVFF   TABLAT,MinValue+1
                      00244                 ; Load MaxValue
00582E 0009           00245                 TBLRD*+
005830 CFF5 F???      00246                 MOVFF   TABLAT,MaxValue
005834 0009           00247                 TBLRD*+
005836 CFF5 F???      00248                 MOVFF   TABLAT,MaxValue+1 
00583A                00249 SelFun4a
                      00250         ; If Opt bit 2 is set then load the Post call variable
00583A A4??           00251                 BTFSS   CXreg+1,2
00583C EF?? F???      00252                 GOTO    SelFun5
                      00253                 ; Load PostCall vector
005840 0009           00254                 TBLRD*+
005842 CFF5 F???      00255                 MOVFF   TABLAT,PostCall
005846 0009           00256                 TBLRD*+
005848 CFF5 F???      00257                 MOVFF   TABLAT,PostCall+1
00584C                00258 SelFun5
                      00259         ; If Opt bit 1 is set then load the Pre call variable
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 302


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

00584C A2??           00260                 BTFSS   CXreg+1,1
00584E EF?? F???      00261                 GOTO    SelFun5a
                      00262                 ; Load PreCall vector
005852 0009           00263                 TBLRD*+   
005854 CFF5 F???      00264                 MOVFF   TABLAT,PreCall
005858 0009           00265                 TBLRD*+
00585A CFF5 F???      00266                 MOVFF   TABLAT,PreCall+1
00585E                00267 SelFun5a
                      00268         ; If Opt bit 7 is set then load AXreg message to line 1 of display
00585E AE??           00269                 BTFSS   CXreg+1,7
005860 EF?? F???      00270                 GOTO    SelFun6  
                      00271                 CALLF   LCDsendAX   
005864 EC?? F???          M                 CALL    (LCDsendAX)
                      00272         ; If Opt bit 3 it set then load DXreg message to line 2 of display
005868                00273 SelFun6
005868 A6??           00274                 BTFSS   CXreg+1,3
00586A EF?? F???      00275                 GOTO    SelFun7
                      00276                 CALLF   LCDsendDXLine2 
00586E EC?? F???          M                 CALL    (LCDsendDXLine2)
005872                00277 SelFun7           
                      00278         ; If Opt bit 1 is set then call the pre function
005872 A2??           00279                 BTFSS   CXreg+1,1
005874 0012           00280                 RETURN 
005876 01??           00281                 MOVLR   HIGH PreCall
005878 6AE8           00282                 CLRF    WREG
00587A CFE8 FFFB      00283                 MOVFF   WREG,PCLATU
00587E C??? FFE8      00284                 MOVFF   PreCall+1,WREG   
005882 CFE8 FFFA      00285                 MOVFF   WREG,PCLATH
005886 C??? FFE8      00286                 MOVFF   PreCall,WREG   
00588A 6EF9           00287                 MOVWF   PCL
                      00288 ;
                      00289 ; This function will look through the table for the value passed
                      00290 ; in reg WREG.
                      00291 ; Inputs:
                      00292 ;       BXreg = points to the start of the table
                      00293 ;       WREG  = Value we are looking for in the table
                      00294 ; Returns with BXreg pointing to the record that contains WREG's value
                      00295 ;
00588C                00296 FindSelection
00588C CFE8 F???      00297                 MOVFF   WREG,Areg
                      00298         ; Save BXreg
                      00299                 MOVE16  BXreg,EEXreg
005890 C??? F???          M                 MOVFF   BXreg,EEXreg
005894 C??? F???          M                 MOVFF   (BXreg+1),(EEXreg+1)
                      00300         ; Get this locations value
005898                00301 AdvanceRecord
005898 C??? FFF6      00302                 MOVFF   BXreg,TBLPTRL
00589C C??? FFF7      00303                 MOVFF   BXreg+1,TBLPTRH
0058A0 6AF8           00304                 CLRF    TBLPTRU,A
                      00305         ; Add offset to the variable
0058A2 0E15           00306                 MOVLW   D'21'
0058A4 26F6           00307                 ADDWF   TBLPTRL
0058A6 B0D8           00308                 BTFSC   ALUSTA,C
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 303


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

0058A8 2AF7           00309                 INCF    TBLPTRH
                      00310                 ; Load the variable...
0058AA 0009           00311                 TBLRD*+
0058AC CFF5 FFE8      00312                 MOVFF   TABLAT,WREG
                      00313                 ; If WREG = Areg then exit!
0058B0 62??           00314                 CPFSEQ  Areg
0058B2 EF?? F???      00315                 GOTO    NextRecord
0058B6 0012           00316                 RETURN
0058B8                00317 NextRecord
                      00318         ; Advance BXreg to next table entry
                      00319                 ; Load BXreg into the table pointer
0058B8 C??? FFF6      00320                 MOVFF   BXreg,TBLPTRL
0058BC C??? FFF7      00321                 MOVFF   BXreg+1,TBLPTRH
0058C0 0E11           00322                 MOVLW   D'17'
0058C2 26F6           00323                 ADDWF   TBLPTRL
0058C4 B0D8           00324                 BTFSC   ALUSTA,C
0058C6 2AF7           00325                 INCF    TBLPTRH
                      00326                 ; Load BXreg with the table pointer contents...
0058C8 0009           00327                 TBLRD*+
0058CA CFF5 F???      00328                 MOVFF   TABLAT,BXreg
0058CE 0009           00329                 TBLRD*+
0058D0 CFF5 F???      00330                 MOVFF   TABLAT,BXreg+1
                      00331         ; If BXreg = EEXreg then we have been all the way around the loop, so exit anyway!
0058D4 C??? FFE8      00332                 MOVFF   BXreg,WREG
0058D8 62??           00333                 CPFSEQ  EEXreg
0058DA EF?? F???      00334                 GOTO    AdvanceRecord
0058DE C??? FFE8      00335                 MOVFF   BXreg+1,WREG
0058E2 62??           00336                 CPFSEQ  EEXreg+1
0058E4 EF?? F???      00337                 GOTO    AdvanceRecord
0058E8 0012           00338                 RETURN     
                      00339                       
                      00340 ; This function calls the routine pointed to in BXreg and then
                      00341 ; returns to this routines caller.      
                      00342 ; If BXreg == 0 then this routine will exit
0058EA                00343 CallBXreg            
0058EA 01??           00344                 MOVLB   HIGH BXreg
0058EC 50??           00345                 MOVF    BXreg+1,W
0058EE 10??           00346                 IORWF   BXreg,W
0058F0 B4D8           00347                 BTFSC   ALUSTA,Z
0058F2 0012           00348                 RETURN
0058F4 6AE8           00349                 CLRF    WREG
0058F6 6EFB           00350                 MOVWF   PCLATU
0058F8 50??           00351                 MOVF    BXreg+1,W
0058FA CFE8 FFFA      00352                 MOVFF   WREG,PCLATH
0058FE 50??           00353                 MOVF    BXreg,W
005900 6EF9           00354                 MOVWF   PCL
                      00355                 
                      00356 
                      00357 ;
                      00358 ; This function accepts input from the user.
                      00359 ; LSB of CXreg is input type
                      00360 ;       0 = pointer to selection table
                      00361 ;       1 = percent input
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 304


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00362 ;       2 = u sec input
                      00363 ;       3 = yes/no input
                      00364 ;       4 = Channel, Ail - CH8
                      00365 ;       5 = Byte input
                      00366 ;       6 = Select Switch   
                      00367 ;       7 = function call, BXreg contails a 16 bit pointer to the function to be called 
                      00368 ;       8 = Milli volt edit function
                      00369 ;       9 =
                      00370 ;       A = yes/no input, bit flag, mask in LSB of DXreg
                      00371 ;       B = short signed int
                      00372 ;       C = signed int
                      00373 ; BXreg points to the variable location
                      00374 ;
                      00375 ;       CXreg = Opt:Type
                      00376 ;       BXreg = ptr1, first optional word
                      00377 ;       DXreg = ptr2, second optional word
005902                00378 Input   
                      00379         ; Save the variable pointer into Src for apply to all function
                      00380                 MOVE    BXreg,Src
005902 C??? F???          M                 MOVFF   BXreg,Src
005906 C??? F???          M                 MOVFF   (BXreg+1),(Src+1)
00590A 0E01           00381                 MOVLW   1               ; Set the count to 1, indicating byte
00590C CFE8 F???      00382                 MOVFF   WREG,Cnt
                      00383         ; Load the variable pointer into FSR1
005910 01??           00384                 MOVLB   HIGH BXreg
005912 50??           00385                 MOVF    BXreg,W
005914 6EE1           00386                 MOVWF   FSR1L
005916 50??           00387                 MOVF    BXreg+1,W
005918 6EE2           00388                 MOVWF   FSR1H
                      00389         ; Get the type and decode...
00591A 01??           00390                 MOVLB   HIGH CXreg
00591C 0E00           00391                 MOVLW   0
00591E 62??           00392                 CPFSEQ  CXreg
005920 EF?? F???      00393                 GOTO    Input1
                      00394                 ; Get the current variable from the selection table and load 
                      00395                 ; WREG with the current value
005924 C??? FFF6      00396                 MOVFF   BXreg,TBLPTRL
005928 C??? FFF7      00397                 MOVFF   BXreg+1,TBLPTRH
00592C 6AF8           00398                 CLRF    TBLPTRU,A
00592E 0E16           00399                 MOVLW   D'22'
005930 26F6           00400                 ADDWF   TBLPTRL,F,A
005932 B0D8           00401                 BTFSC   ALUSTA,C
005934 2AF7           00402                 INCF    TBLPTRH,F,A
                      00403                 ; Load WREG with the value pointed to by DXreg
005936 C??? FFE1      00404                 MOVFF   DXreg,FSR1L
00593A C??? FFE2      00405                 MOVFF   DXreg+1,FSR1H
00593E CFE7 FFE8      00406                 MOVFF   INDF1,WREG      
005942 EC?? F???      00407                 CALL    FindSelection
005946 EC?? F???      00408                 CALL    VerticalSelection
00594A 0012           00409                 RETURN
00594C                00410 Input1
00594C 0E01           00411                 MOVLW   1
00594E 62??           00412                 CPFSEQ  CXreg
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 305


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

005950 EF?? F???      00413                 GOTO    Input2
                      00414         ; Here for percent input
005954 0E25           00415                 MOVLW   '%'
005956 CFE8 F???      00416                 MOVFF   WREG,Units      ; Set the units character
00595A EC?? F???      00417                 CALL    ADJpercent
00595E 0012           00418                 RETURN
005960                00419 Input2
005960 0E02           00420                 MOVLW   2
005962 62??           00421                 CPFSEQ  CXreg
005964 EF?? F???      00422                 GOTO    Input3
                      00423         ; Here for uS input, do not change the 2 MS bits of the 
                      00424         ; variable, used for flags
                      00425                 ; If CXreg+1 LSB is set then DXreg contains the
                      00426                 ; DriveCh value.
005968 01??           00427                 MOVLB   HIGH CXreg
00596A A0??           00428                 BTFSS   CXreg+1,0
00596C EF?? F???      00429                 GOTO    NoDriveCh
005970 50??           00430                 MOVF    DXreg,W
005972 01??           00431                 MOVLB   HIGH DriveCh
005974 6E??           00432                 MOVWF   DriveCh
005976                00433 NoDriveCh
                      00434                 ; Put variable in CXreg
005976 CFE6 F???      00435                 MOVFF   POSTINC1,Areg
00597A CFE5 F???      00436                 MOVFF   POSTDEC1,Breg
00597E 01??           00437                 MOVLB   HIGH CXreg
005980 C??? F???      00438                 MOVFF   Areg,CXreg
005984 C??? F???      00439                 MOVFF   Breg,CXreg+1
005988 9E??           00440                 BCF     CXreg+1,7
00598A 9C??           00441                 BCF     CXreg+1,6
00598C EC?? F???      00442                 CALL    ADJuS
                      00443                 ; Write result back
005990 01??           00444                 MOVLB   HIGH BXreg
005992 C??? FFE1      00445                 MOVFF   BXreg,FSR1L
005996 C??? FFE2      00446                 MOVFF   BXreg+1,FSR1H
00599A C??? F???      00447                 MOVFF   CXreg,Areg
00599E C??? F???      00448                 MOVFF   CXreg+1,Breg
0059A2 C??? FFE6      00449                 MOVPF   Areg,POSTINC1
0059A6 CFE7 FFE8      00450                 MOVFF   INDF1,WREG
0059AA 0BC0           00451                 ANDLW   0C0
0059AC 12??           00452                 IORWF   Breg,F
0059AE C??? FFE5      00453                 MOVFF   Breg,POSTDEC1
0059B2 0012           00454                 RETURN
0059B4                00455 Input3
0059B4 0E03           00456                 MOVLW   3
0059B6 62??           00457                 CPFSEQ  CXreg
0059B8 EF?? F???      00458                 GOTO    Input4
                      00459         ; Here for Yes/No input using byte flag
0059BC CFE7 FFE8      00460                 MOVFF   INDF1,WREG
0059C0 36E8           00461                 RLCF    WREG
0059C2 EC?? F???      00462                 CALL    YesNo
0059C6 0E00           00463                 MOVLW   0
0059C8 B0D8           00464                 BTFSC   ALUSTA,C
0059CA 1EE8           00465                 COMF    WREG
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 306


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

0059CC 6E??           00466                 MOVWF   Areg
0059CE 01??           00467                 MOVLB   HIGH BXreg
0059D0 C??? FFE1      00468                 MOVFF   BXreg,FSR1L
0059D4 C??? FFE2      00469                 MOVFF   BXreg+1,FSR1H
0059D8 C??? FFE7      00470                 MOVPF   Areg,INDF1
0059DC 0012           00471                 RETURN
0059DE                00472 Input4
0059DE 0E04           00473                 MOVLW   4
0059E0 62??           00474                 CPFSEQ  CXreg
0059E2 EF?? F???      00475                 GOTO    Input5
                      00476         ; Here for channel selection input
0059E6 CFE7 FFE8      00477                 MOVFF   INDF1,WREG      ; Load the current value
0059EA EC?? F???      00478                 CALL    SelectChannel
0059EE 6E??           00479                 MOVWF   Areg
0059F0 01??           00480                 MOVLB   HIGH BXreg
0059F2 C??? FFE1      00481                 MOVFF   BXreg,FSR1L
0059F6 C??? FFE2      00482                 MOVFF   BXreg+1,FSR1H
0059FA C??? FFE7      00483                 MOVPF   Areg,INDF1
0059FE 0012           00484                 RETURN
005A00                00485 Input5
005A00 0E05           00486                 MOVLW   5
005A02 62??           00487                 CPFSEQ  CXreg
005A04 EF?? F???      00488                 GOTO    Input6
                      00489         ; Here for byte input
005A08 CFE7 FFE8      00490                 MOVFF   INDF1,WREG
005A0C EC?? F???      00491                 CALL    ADJbyte
005A10 CFE8 F???      00492                 MOVFF   WREG,Areg
005A14 01??           00493                 MOVLB   HIGH BXreg
005A16 C??? FFE1      00494                 MOVFF   BXreg,FSR1L
005A1A C??? FFE2      00495                 MOVFF   BXreg+1,FSR1H
005A1E C??? FFE7      00496                 MOVFF   Areg,INDF1              
005A22 0012           00497                 RETURN
005A24                00498 Input6
005A24 0E06           00499                 MOVLW   6
005A26 62??           00500                 CPFSEQ  CXreg
005A28 EF?? F???      00501                 GOTO    Input7
                      00502         ; Here for switch selection
005A2C CFE7 F???      00503                 MOVFF   INDF1,Areg              ; This is the current value
                      00504                 MOVE16  BXreg,DXreg             ; Save the pointer to selected variable
005A30 C??? F???          M                 MOVFF   BXreg,DXreg
005A34 C??? F???          M                 MOVFF   (BXreg+1),(DXreg+1)
                      00505                 MOVEC   SWMENU1,BXreg           ; Point to the switch table
005A38 01??               M                 MOVLR   HIGH (BXreg)
005A3A 0E??               M                 MOVLW   LOW (SWMENU1)
005A3C 6E??               M                 MOVWF   (BXreg)
005A3E 0E??               M                 MOVLW   HIGH (SWMENU1)
005A40 6E??               M                 MOVWF   (BXreg+1)
005A42 C??? FFE8      00506                 MOVFF   Areg,WREG
005A46 EC?? F???      00507                 CALL    FindSelection           ; This will adjust BXreg to point to
                      00508                                                 ; the current selection.
005A4A EC?? F???      00509                 CALL    VerticalSelection       ; Let the user make a selectoion,
                      00510                                                 ; The result is in SWselect.
005A4E 0012           00511                 RETURN
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 307


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

005A50                00512 Input7
005A50 0E07           00513                 MOVLW   7
005A52 62??           00514                 CPFSEQ  CXreg
005A54 EF?? F???      00515                 GOTO    Input8
                      00516         ; Here for function call, pointer in BXreg
005A58 EC?? F???      00517                 CALL    CallBXreg 
005A5C 0012           00518                 RETURN
005A5E                00519 Input8
005A5E 0E08           00520                 MOVLW   8
005A60 62??           00521                 CPFSEQ  CXreg
005A62 EF?? F???      00522                 GOTO    Input9
                      00523         ; Here for voltage input
005A66 CFE7 FFE8      00524                 MOVFF   INDF1,WREG
005A6A EC?? F???      00525                 CALL    ADJvolt
005A6E CFE8 F???      00526                 MOVFF   WREG,Areg
005A72 01??           00527                 MOVLB   HIGH BXreg
005A74 C??? FFE1      00528                 MOVFF   BXreg,FSR1L
005A78 C??? FFE2      00529                 MOVFF   BXreg+1,FSR1H
005A7C C??? FFE7      00530                 MOVFF   Areg,INDF1              
005A80                00531 Input9
005A80 0E0A           00532                 MOVLW   0A
005A82 62??           00533                 CPFSEQ  CXreg
005A84 EF?? F???      00534                 GOTO    InputB
                      00535         ; Here for Yes/No input using bit flag
005A88 CFE7 FFE8      00536                 MOVFF   INDF1,WREG
005A8C 01??           00537                 MOVLB   HIGH DXreg
005A8E 14??           00538                 ANDWF   DXreg,W
005A90 90D8           00539                 BCF     ALUSTA,C
005A92 B4D8           00540                 BTFSC   ALUSTA,Z
005A94 80D8           00541                 BSF     ALUSTA,C
005A96 EC?? F???      00542                 CALL    YesNo
005A9A 01??           00543                 MOVLB   HIGH DXreg
005A9C C??? F???      00544                 MOVFF   DXreg,Areg
005AA0 01??           00545                 MOVLB   HIGH BXreg
005AA2 C??? FFE1      00546                 MOVFF   BXreg,FSR1L
005AA6 C??? FFE2      00547                 MOVFF   BXreg+1,FSR1H
005AAA B0D8           00548                 BTFSC   ALUSTA,C
005AAC EF?? F???      00549                 GOTO    Input8a
005AB0 C??? FFE8      00550                 MOVFF   Areg,WREG
005AB4 12E7           00551                 IORWF   INDF1
005AB6 0012           00552                 RETURN
005AB8                00553 Input8a              
005AB8 C??? FFE8      00554                 MOVFF   Areg,WREG
005ABC 1EE8           00555                 COMF    WREG
005ABE 16E7           00556                 ANDWF   INDF1
005AC0 0012           00557                 RETURN        
005AC2                00558 InputB
005AC2 0E0B           00559                 MOVLW   0B
005AC4 62??           00560                 CPFSEQ  CXreg
005AC6 EF?? F???      00561                 GOTO    InputC
                      00562         ; Here for short int input, signed byte
005ACA 0E20           00563                 MOVLW   ' '
005ACC CFE8 F???      00564                 MOVFF   WREG,Units      ; Set the units character
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 308


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

005AD0 EC?? F???      00565                 CALL    ADJpercent
005AD4 0012           00566                 RETURN
005AD6                00567 InputC
005AD6 0E0C           00568                 MOVLW   0C
005AD8 62??           00569                 CPFSEQ  CXreg
005ADA EF?? F???      00570                 GOTO    InputD
                      00571         ; Here for int input, signed 16 bit value
                      00572                 ; Put variable in CXreg
005ADE CFE6 F???      00573                 MOVFF   POSTINC1,Areg
005AE2 CFE5 F???      00574                 MOVFF   POSTDEC1,Breg
005AE6 01??           00575                 MOVLB   HIGH CXreg
005AE8 C??? F???      00576                 MOVFF   Areg,CXreg
005AEC C??? F???      00577                 MOVFF   Breg,CXreg+1
005AF0 EC?? F???      00578                 CALL    ADJinteger
                      00579                 ; Write result back
005AF4 01??           00580                 MOVLB   HIGH BXreg
005AF6 C??? FFE1      00581                 MOVFF   BXreg,FSR1L
005AFA C??? FFE2      00582                 MOVFF   BXreg+1,FSR1H
005AFE C??? F???      00583                 MOVFF   CXreg,Areg
005B02 C??? F???      00584                 MOVFF   CXreg+1,Breg
005B06 C??? FFE6      00585                 MOVPF   Areg,POSTINC1
005B0A C??? FFE5      00586                 MOVFF   Breg,POSTDEC1
005B0E 0012           00587                 RETURN
005B10                00588 InputD
005B10 0012           00589                 RETURN
                      00590 ; This function displays Accept on the second line of the
                      00591 ; LCD display. The Aileron stick is used to change the selection
                      00592 ; from Yes to No. The default entry is set by the carry flag
                      00593 ; when the function is called. The carry flag also defines the
                      00594 ; users selection:
                      00595 ;       C set for Yes
                      00596 ;       C clear for No
005B12                00597 Accept
                      00598         ; Set the flag in Areg
005B12 6A??           00599                 CLRF    Breg
005B14 B0D8           00600                 BTFSC   ALUSTA,C
005B16 1E??           00601                 COMF    Breg
                      00602         ; Print the accept text...
                      00603                 CALLFL  LCDsendCMD,LINE2
005B18 0EC0               M                 MOVLW   (LINE2)
005B1A EC?? F???          M                 CALL    (LCDsendCMD)
                      00604                 PrintMess MES7
005B1E 0E??               M                 MOVLW   UPPER (MES7)
005B20 6EF8               M                 MOVWF   TBLPTRU,A
005B22 0E??               M                 MOVLW   HIGH (MES7)
005B24 6EF7               M                 MOVWF   TBLPTRH,A
005B26 0E??               M                 MOVLW   LOW (MES7)
005B28 6EF6               M                 MOVWF   TBLPTRL,A
005B2A EC?? F???          M                 CALL    LCDsendMess
005B2E                00605 AcceptLoop
005B2E A0??           00606                 BTFSS   Breg,0
005B30 EF?? F???      00607                 GOTO    Accept1
                      00608         ; Highlight Yes
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 309


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00609                 CALLFL  LCDsendCMD,LINE2+YPOS
005B34 0EC8               M                 MOVLW   (LINE2+YPOS)
005B36 EC?? F???          M                 CALL    (LCDsendCMD)
                      00610                 CALLFL  LCDsendData,'('
005B3A 0E28               M                 MOVLW   ('(')
005B3C EC?? F???          M                 CALL    (LCDsendData)
                      00611                 CALLFL  LCDsendCMD,LINE2+YNPOS
005B40 0ECC               M                 MOVLW   (LINE2+YNPOS)
005B42 EC?? F???          M                 CALL    (LCDsendCMD)
                      00612                 CALLFL  LCDsendData,')'
005B46 0E29               M                 MOVLW   (')')
005B48 EC?? F???          M                 CALL    (LCDsendData)
                      00613                 CALLFL  LCDsendCMD,LINE2+NPOS
005B4C 0ECF               M                 MOVLW   (LINE2+NPOS)
005B4E EC?? F???          M                 CALL    (LCDsendCMD)
                      00614                 CALLFL  LCDsendData,' '
005B52 0E20               M                 MOVLW   (' ')
005B54 EC?? F???          M                 CALL    (LCDsendData)
005B58 EF?? F???      00615                 GOTO    Accept2
005B5C                00616 Accept1
                      00617         ; Highlight No
                      00618                 CALLFL  LCDsendCMD,LINE2+YPOS
005B5C 0EC8               M                 MOVLW   (LINE2+YPOS)
005B5E EC?? F???          M                 CALL    (LCDsendCMD)
                      00619                 CALLFL  LCDsendData,' '
005B62 0E20               M                 MOVLW   (' ')
005B64 EC?? F???          M                 CALL    (LCDsendData)
                      00620                 CALLFL  LCDsendCMD,LINE2+YNPOS
005B68 0ECC               M                 MOVLW   (LINE2+YNPOS)
005B6A EC?? F???          M                 CALL    (LCDsendCMD)
                      00621                 CALLFL  LCDsendData,'('
005B6E 0E28               M                 MOVLW   ('(')
005B70 EC?? F???          M                 CALL    (LCDsendData)
                      00622                 CALLFL  LCDsendCMD,LINE2+NPOS
005B74 0ECF               M                 MOVLW   (LINE2+NPOS)
005B76 EC?? F???          M                 CALL    (LCDsendCMD)
                      00623                 CALLFL  LCDsendData,')'
005B7A 0E29               M                 MOVLW   (')')
005B7C EC?? F???          M                 CALL    (LCDsendData)
005B80                00624 Accept2
                      00625         ; Call Aileron position test....
                      00626         ;   Z flag set if Right
                      00627         ;   C flag set if Left
005B80 EC?? F???      00628                 CALL    Aileron
005B84 B4D8           00629                 BTFSC   ALUSTA,Z
005B86 6A??           00630                 CLRF    Breg
005B88 0EFF           00631                 MOVLW   0FF
005B8A B0D8           00632                 BTFSC   ALUSTA,C
005B8C 6E??           00633                 MOVWF   Breg
                      00634         ; Test if option button has been pressed
                      00635         ; Carry flag set if pressed
005B8E EC?? F???      00636                 CALL    CalSaveAndExit
005B92 EC?? F???      00637                 CALL    Option
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 310


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

005B96 A0D8           00638                 BTFSS   ALUSTA,C
005B98 EF?? F???      00639                 GOTO    AcceptLoop
                      00640         ; Set the carry flag on exit
005B9C 90D8           00641                 BCF     ALUSTA,C
005B9E B0??           00642                 BTFSC   Breg,0
005BA0 80D8           00643                 BSF     ALUSTA,C
005BA2 0012           00644                 RETURN
                      00645 
                      00646 ; This function displays Yes No on the second line of the
                      00647 ; LCD display, right justified. The Aileron stick is used to change from
                      00648 ; from Yes to No. The default entry is set by the carry flag
                      00649 ; when the function is called. The carry flag also defines the
                      00650 ; users selection:
                      00651 ;       C set for Yes
                      00652 ;       C clear for No
005BA4                00653 YesNo
                      00654         ; Set the flag in Areg
005BA4 6A00           00655                 CLRF    Breg,A
005BA6 B0D8           00656                 BTFSC   ALUSTA,C,A
005BA8 1E00           00657                 COMF    Breg,F,A
                      00658         ; Print the Yes No text...
                      00659                 CALLFL  LCDsendCMD,LINE2+YPOS
005BAA 0EC8               M                 MOVLW   (LINE2+YPOS)
005BAC EC?? F???          M                 CALL    (LCDsendCMD)
                      00660                 PrintMess MES11
005BB0 0E??               M                 MOVLW   UPPER (MES11)
005BB2 6EF8               M                 MOVWF   TBLPTRU,A
005BB4 0E??               M                 MOVLW   HIGH (MES11)
005BB6 6EF7               M                 MOVWF   TBLPTRH,A
005BB8 0E??               M                 MOVLW   LOW (MES11)
005BBA 6EF6               M                 MOVWF   TBLPTRL,A
005BBC EC?? F???          M                 CALL    LCDsendMess
005BC0                00661 YesNoLoop
005BC0 A000           00662                 BTFSS   Breg,0,A
005BC2 EF?? F???      00663                 GOTO    YesNo1
                      00664         ; Highlight Yes
                      00665                 CALLFL  LCDsendCMD,LINE2+YPOS
005BC6 0EC8               M                 MOVLW   (LINE2+YPOS)
005BC8 EC?? F???          M                 CALL    (LCDsendCMD)
                      00666                 CALLFL  LCDsendData,'('
005BCC 0E28               M                 MOVLW   ('(')
005BCE EC?? F???          M                 CALL    (LCDsendData)
                      00667                 CALLFL  LCDsendCMD,LINE2+YNPOS
005BD2 0ECC               M                 MOVLW   (LINE2+YNPOS)
005BD4 EC?? F???          M                 CALL    (LCDsendCMD)
                      00668                 CALLFL  LCDsendData,')'
005BD8 0E29               M                 MOVLW   (')')
005BDA EC?? F???          M                 CALL    (LCDsendData)
                      00669                 CALLFL  LCDsendCMD,LINE2+NPOS
005BDE 0ECF               M                 MOVLW   (LINE2+NPOS)
005BE0 EC?? F???          M                 CALL    (LCDsendCMD)
                      00670                 CALLFL  LCDsendData,' '
005BE4 0E20               M                 MOVLW   (' ')
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 311


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

005BE6 EC?? F???          M                 CALL    (LCDsendData)
005BEA EF?? F???      00671                 GOTO    YesNo2
005BEE                00672 YesNo1
                      00673         ; Highlight No
                      00674                 CALLFL  LCDsendCMD,LINE2+YPOS
005BEE 0EC8               M                 MOVLW   (LINE2+YPOS)
005BF0 EC?? F???          M                 CALL    (LCDsendCMD)
                      00675                 CALLFL  LCDsendData,' '
005BF4 0E20               M                 MOVLW   (' ')
005BF6 EC?? F???          M                 CALL    (LCDsendData)
                      00676                 CALLFL  LCDsendCMD,LINE2+YNPOS
005BFA 0ECC               M                 MOVLW   (LINE2+YNPOS)
005BFC EC?? F???          M                 CALL    (LCDsendCMD)
                      00677                 CALLFL  LCDsendData,'('
005C00 0E28               M                 MOVLW   ('(')
005C02 EC?? F???          M                 CALL    (LCDsendData)
                      00678                 CALLFL  LCDsendCMD,LINE2+NPOS
005C06 0ECF               M                 MOVLW   (LINE2+NPOS)
005C08 EC?? F???          M                 CALL    (LCDsendCMD)
                      00679                 CALLFL  LCDsendData,')'
005C0C 0E29               M                 MOVLW   (')')
005C0E EC?? F???          M                 CALL    (LCDsendData)
005C12                00680 YesNo2
                      00681         ; Call Aileron position test....
                      00682         ;   Z flag set if Right
                      00683         ;   C flag set if Left
005C12 EC?? F???      00684                 CALL    Aileron
005C16 B4D8           00685                 BTFSC   ALUSTA,Z,A
005C18 6A00           00686                 CLRF    Breg,A
005C1A 0EFF           00687                 MOVLW   0FF
005C1C B0D8           00688                 BTFSC   ALUSTA,C,A
005C1E 6E00           00689                 MOVWF   Breg,A
                      00690         ; Test if option button has been pressed
                      00691         ; Carry flag set if pressed
005C20 EC?? F???      00692                 CALL    CalSaveAndExit
005C24 EC?? F???      00693                 CALL    Option
005C28 A0D8           00694                 BTFSS   ALUSTA,C,A
005C2A EF?? F???      00695                 GOTO    YesNoLoop
                      00696         ; Set the carry flag on exit
005C2E 90D8           00697                 BCF     ALUSTA,C,A
005C30 B000           00698                 BTFSC   Breg,0,A
005C32 80D8           00699                 BSF     ALUSTA,C,A
005C34 0012           00700                 RETURN
                      00701 
                      00702 
                      00703 ; This function tests value in WREG against the limts in MaxByte and
                      00704 ; MinByte. If its outside of this range, the value is set to the nearest
                      00705 ; limit.
005C36                00706 Limit8
                      00707         ; Test the MaxByte limit
005C36 01??           00708                 MOVLB   HIGH MaxByte
005C38 64??           00709                 CPFSGT  MaxByte
005C3A 50??           00710                 MOVF    MaxByte,W
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 312


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

005C3C 60??           00711                 CPFSLT  MinByte
005C3E 50??           00712                 MOVF    MinByte,W
005C40 0012           00713                 RETURN
                      00714 
                      00715 
                      00716 ;==============================================================================
                      00717 ;
                      00718 ; Function: ADJbyte, ADJvolt
                      00719 ;
                      00720 ; Purpose:
                      00721 ;    This function allows the user to adjust the value of a byte variable.
                      00722 ;    The minimum and maximum values allowed are defined in MinByte and MaxByte.
                      00723 ;    The Byte that will be adjusted in in WREG, and is also returned in WREG.
                      00724 ;    The elevator stick is used to adjust the value, pressing the option
                      00725 ;    button will accept the new value and cause this routine to exit.
                      00726 ;
                      00727 ; Inputs:
                      00728 ;    Wreg    = value to adjust
                      00729 ;    MinByte = lower limit
                      00730 ;    MaxByte = upper limit
                      00731 ;
                      00732 ; Outputs:
                      00733 ;    Wreg = adjusted value
                      00734 ;
                      00735 ; Uses:
                      00736 ;    Ctemp
                      00737 ;    CEXreg
                      00738 ;
                      00739 ; Calls:
                      00740 ;    Int2Str
                      00741 ;    LCDsendCMD
                      00742 ;    LCDsendData
                      00743 ;    Elevator
                      00744 ;    Option
                      00745 ;
                      00746 ;==============================================================================
005C42                00747 ADJvolt
                      00748         ; This is a second entry point into ADJbyte. This will set a 
                      00749         ; decimal point in the displayed result. This entry point sets
                      00750         ; the DP flag.
005C42 01??           00751                 MOVLB   HIGH DPflag
005C44 68??           00752                 SETF    DPflag
                      00753         ; First save WREG in Ctemp
005C46 01??           00754                 MOVLB   HIGH Ctemp
005C48 6E??           00755                 MOVWF   Ctemp
005C4A EF?? F???      00756                 GOTO    ADJbyteloop
005C4E                00757 ADJbyte
                      00758         ; First save WREG in Ctemp
005C4E 01??           00759                 MOVLB   HIGH Ctemp
005C50 6E??           00760                 MOVWF   Ctemp
                      00761         ; Clear the decimal point flag
005C52 01??           00762                 MOVLB   HIGH DPflag
005C54 6A??           00763                 CLRF    DPflag
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 313


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00764         ; Convert Breg to string
005C56                00765 ADJbyteloop
                      00766                 CALLFL  Delay1mS,D'150'
005C56 0E96               M                 MOVLW   (D'150')
005C58 EC?? F???          M                 CALL    (Delay1mS)
005C5C C??? FFE8      00767                 MOVFF   Ctemp,WREG
                      00768                 ; Save in CEXreg
005C60 01??           00769                 MOVLB   HIGH CEXreg
005C62 6E??           00770                 MOVWF   CEXreg
005C64 6A??           00771                 CLRF    CEXreg+1
005C66 6A??           00772                 CLRF    CEXreg+2
005C68 6A??           00773                 CLRF    CEXreg+3
                      00774                 ; Make into a string...
005C6A EC?? F???      00775                 CALL    Int2Str
                      00776                 ; Test the DP flag and display results
005C6E 01??           00777                 MOVLB   HIGH DPflag
005C70 66??           00778                 TSTFSZ  DPflag
005C72 EF?? F???      00779                 GOTO    ShowDP
                      00780                 ; Position and print...
                      00781                 CALLFL  LCDsendCMD,LINE2+BYTEPOS
005C76 0ECD               M                 MOVLW   (LINE2+BYTEPOS)
005C78 EC?? F???          M                 CALL    (LCDsendCMD)
                      00782                 CALLFF  LCDsendData,Buffer+2
005C7C 5000               M                 MOVFP   (Buffer+2),WREG
005C7E EC?? F???          M                 CALL    (LCDsendData)
                      00783                 CALLFF  LCDsendData,Buffer+3
005C82 5000               M                 MOVFP   (Buffer+3),WREG
005C84 EC?? F???          M                 CALL    (LCDsendData)
                      00784                 CALLFF  LCDsendData,Buffer+4
005C88 5000               M                 MOVFP   (Buffer+4),WREG
005C8A EC?? F???          M                 CALL    (LCDsendData)
005C8E EF?? F???      00785                 GOTO    ADJbyte2
                      00786                 ; Here to display the decimal point
005C92                00787 ShowDP
                      00788                 CALLFL  LCDsendCMD,LINE2+BYTEPOS-1
005C92 0ECC               M                 MOVLW   (LINE2+BYTEPOS-1)
005C94 EC?? F???          M                 CALL    (LCDsendCMD)
                      00789                 CALLFF  LCDsendData,Buffer+2
005C98 5000               M                 MOVFP   (Buffer+2),WREG
005C9A EC?? F???          M                 CALL    (LCDsendData)
                      00790                 CALLFF  LCDsendData,Buffer+3
005C9E 5000               M                 MOVFP   (Buffer+3),WREG
005CA0 EC?? F???          M                 CALL    (LCDsendData)
                      00791                 CALLFL  LCDsendData,'.'         
005CA4 0E2E               M                 MOVLW   ('.')
005CA6 EC?? F???          M                 CALL    (LCDsendData)
                      00792                 CALLFF  LCDsendData,Buffer+4
005CAA 5000               M                 MOVFP   (Buffer+4),WREG
005CAC EC?? F???          M                 CALL    (LCDsendData)
                      00793         ; Test the elevator stick
005CB0                00794 ADJbyte2
005CB0 EC?? F???      00795                 CALL    Elevator
005CB4 01??           00796                 MOVLB   HIGH Ctemp
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 314


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

005CB6 A4D8           00797                 BTFSS   ALUSTA,Z
005CB8 EF?? F???      00798                 GOTO    ADJbyte1
005CBC 2A??           00799                 INCF    Ctemp
                      00800                 ; Test if its greater than MaxByte
005CBE C??? FFE8      00801                 MOVFF   MaxByte,WREG
005CC2 60??           00802                 CPFSLT  Ctemp
005CC4 6E??           00803                 MOVWF   Ctemp           
005CC6 66??           00804                 TSTFSZ  Ctemp
005CC8 EF?? F???      00805                 GOTO    ADJbyte3
005CCC 6E??           00806                 MOVWF   Ctemp           
005CCE EF?? F???      00807                 GOTO    ADJbyte3
                      00808 
005CD2                00809 ADJbyte1
005CD2 A0D8           00810                 BTFSS   ALUSTA,C
005CD4 EF?? F???      00811                 GOTO    ADJbyte3
005CD8 C??? FFE8      00812                 MOVFF   Ctemp,WREG
005CDC 60??           00813                 CPFSLT  MinByte
005CDE EF?? F???      00814                 GOTO    ADJbyte3
005CE2 06??           00815                 DECF    Ctemp
                      00816                 ; Test if its less that than MinByte
005CE4 C??? FFE8      00817                 MOVFF   MinByte,WREG
005CE8 64??           00818                 CPFSGT  Ctemp
005CEA 6E??           00819                 MOVWF   Ctemp           
                      00820         ; Test for the option button to indicate we exit
005CEC                00821 ADJbyte3
005CEC EC?? F???      00822                 CALL    CalSaveAndExit
005CF0 EC?? F???      00823                 CALL    Option
005CF4 A0D8           00824                 BTFSS   ALUSTA,C
005CF6 EF?? F???      00825                 GOTO    ADJbyteloop
005CFA 01??           00826                 MOVLB   HIGH Ctemp
005CFC C??? FFE8      00827                 MOVFF   Ctemp,WREG
005D00 0012           00828                 RETURN
                      00829                 
                      00830 ; This function will display the signed percentage in INDF1 and allow
                      00831 ; the pilot to adjust the value using the elevator stick. The result
                      00832 ; is returned in WREG
005D02                00833 ADJpercent
005D02 EC?? F???      00834                 CALL    CalModeProcess
005D06 C??? FFE8      00835                 MOVFF   IncTime,WREG
005D0A 087F           00836                 SUBLW   D'127'
005D0C BEE8           00837                 BTFSC   WREG,7,A
005D0E 6AE8           00838                 CLRF    WREG,A
005D10 46E8           00839                 RLNCF   WREG
005D12 66E8           00840                 TSTFSZ  WREG,A
005D14 EC?? F???      00841                 CALL    Delay1mS
                      00842 ;               CALLFL  Delay1mS,D'250'
005D18 CFE7 FFE8      00843                 MOVFF   INDF1,WREG
005D1C BEE7           00844                 BTFSC   INDF1,7
005D1E 1EE8           00845                 COMF    WREG
005D20 BEE7           00846                 BTFSC   INDF1,7
005D22 2AE8           00847                 INCF    WREG
                      00848                 ; Save in CEXreg
005D24 01??           00849                 MOVLB   HIGH CEXreg
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 315


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

005D26 6E??           00850                 MOVWF   CEXreg
005D28 6A??           00851                 CLRF    CEXreg+1
005D2A 6A??           00852                 CLRF    CEXreg+2
005D2C 6A??           00853                 CLRF    CEXreg+3
                      00854                 ; Make into a string...
005D2E EC?? F???      00855                 CALL    Int2Str
                      00856                 ; Position the print position and print...
                      00857                 CALLFL  LCDsendCMD,LINE2+PERCENTPOS
005D32 0ECB               M                 MOVLW   (LINE2+PERCENTPOS)
005D34 EC?? F???          M                 CALL    (LCDsendCMD)
005D38 0E20           00858                 MOVLW   ' '
005D3A BEE7           00859                 BTFSC   INDF1,7
005D3C 0E2D           00860                 MOVLW   '-'
                      00861                 CALLFW  LCDsendData
005D3E EC?? F???          M                 CALL    (LCDsendData)
                      00862                 CALLFF  LCDsendData,Buffer+2
005D42 5000               M                 MOVFP   (Buffer+2),WREG
005D44 EC?? F???          M                 CALL    (LCDsendData)
                      00863                 CALLFF  LCDsendData,Buffer+3
005D48 5000               M                 MOVFP   (Buffer+3),WREG
005D4A EC?? F???          M                 CALL    (LCDsendData)
                      00864                 CALLFF  LCDsendData,Buffer+4
005D4E 5000               M                 MOVFP   (Buffer+4),WREG
005D50 EC?? F???          M                 CALL    (LCDsendData)
005D54 C??? FFE8      00865                 MOVFF   Units,WREG
                      00866                 CALLFW  LCDsendData
005D58 EC?? F???          M                 CALL    (LCDsendData)
                      00867         ; Test the elevator stick
005D5C                00868 ADJ2
005D5C EC?? F???      00869                 CALL    Elevator
005D60 01??           00870                 MOVLB   HIGH Ctemp
005D62 A4D8           00871                 BTFSS   ALUSTA,Z
005D64 EF?? F???      00872                 GOTO    ADJ1
005D68 2AE7           00873                 INCF    INDF1           
005D6A EF?? F???      00874                 GOTO    ADJ3
005D6E                00875 ADJ1
005D6E A0D8           00876                 BTFSS   ALUSTA,C
005D70 EF?? F???      00877                 GOTO    ADJ3
005D74 06E7           00878                 DECF    INDF1
                      00879         ; Test for the option button to indicate we exit
005D76                00880 ADJ3
005D76 EC?? F???      00881                 CALL    CalSaveAndExit
005D7A EC?? F???      00882                 CALL    Option
005D7E A0D8           00883                 BTFSS   ALUSTA,C
005D80 EF?? F???      00884                 GOTO    ADJpercent
                      00885         ; Clear the update flag if set 
005D84 01??           00886                 MOVLB   HIGH CalServoUpdate
005D86 6A??           00887                 CLRF    CalServoUpdate
005D88 0012           00888                 RETURN
                      00889 
                      00890 ; This function tests the value in CXreg against the MinTime and
                      00891 ; MaxTime limites. If the value is outside of this range it will
                      00892 ; be set to the nearest limit.
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 316


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

005D8A                00893 Limit16
                      00894         ; Test the MaxTime Limit
005D8A 01??           00895                 MOVLB   HIGH CXreg
005D8C 50??           00896                 MOVF    CXreg,W
005D8E 5C??           00897                 SUBWF   MaxTime,W
005D90 50??           00898                 MOVF    CXreg+1,W
005D92 58??           00899                 SUBWFB  MaxTime+1,W
                      00900                 ; Test flag, set to max and exit if its over the limit
005D94 B0D8           00901                 BTFSC   ALUSTA,C
005D96 EF?? F???      00902                 GOTO    Limit16a
005D9A 50??           00903                 MOVF    MaxTime,W
005D9C 6E??           00904                 MOVWF   CXreg
005D9E 50??           00905                 MOVF    MaxTime+1,W
005DA0 6E??           00906                 MOVWF   CXreg+1
005DA2 0012           00907                 RETURN
005DA4                00908 Limit16a
                      00909         ; The the MinTime Limit
005DA4 50??           00910                 MOVF    MinTime,W
005DA6 5C??           00911                 SUBWF   CXreg,W
005DA8 50??           00912                 MOVF    MinTime+1,W
005DAA 58??           00913                 SUBWFB  CXreg+1,W
                      00914                 ; Test flag, set to min and exit if its under the limit
005DAC B0D8           00915                 BTFSC   ALUSTA,C
005DAE EF?? F???      00916                 GOTO    Limit16b
005DB2 50??           00917                 MOVF    MinTime,W
005DB4 6E??           00918                 MOVWF   CXreg
005DB6 50??           00919                 MOVF    MinTime+1,W
005DB8 6E??           00920                 MOVWF   CXreg+1
005DBA                00921 Limit16b                
005DBA 0012           00922                 RETURN
                      00923                 
                      00924 ; This function allows the pilot to adjust the millisec
                      00925 ; value saved in CXreg. This is an unsigned value and its
                      00926 ; limited to MinTime and MaxTime. The value is displayed in millisec.
                      00927 ; This function does not allow you to adjust outside of this
                      00928 ; range. The values is range tested and adjusted to
                      00929 ; a valid limit.
                      00930 ; The units are in .5 uS, so a time of 1 millisec = 2000
                      00931 ;
                      00932 ; CXreg contains the 16 bit time value.
005DBC                00933 ADJuS
005DBC EC?? F???      00934                 CALL    Limit16
005DC0 01??           00935                 MOVLB   HIGH SymSet
005DC2 6A??           00936                 CLRF    SymSet
005DC4                00937 ADJuSz  
                      00938         ; If the DriveCh flag is non zero, then it points
                      00939         ; to the channel times array point into witch to write
                      00940         ; this position. 
005DC4 01??           00941                 MOVLB   HIGH DriveCh
005DC6 50??           00942                 MOVF    DriveCh,W
005DC8 12E8           00943                 IORWF   WREG
005DCA B4D8           00944                 BTFSC   ALUSTA,Z
005DCC EF?? F???      00945                 GOTO    ADJuSa
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 317


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00946                 ; Here if we are going to send the values to the 
                      00947                 ; times array
005DD0 50??           00948                 MOVF    DriveCh,W
005DD2 6EE1           00949                 MOVWF   FSR1L
005DD4 0E??           00950                 MOVLW   HIGH DriveCh
005DD6 6EE2           00951                 MOVWF   FSR1H
005DD8 C??? FFE6      00952                 MOVFF   CXreg,POSTINC1
005DDC C??? FFE7      00953                 MOVFF   CXreg+1,INDF1
                      00954         ;
005DE0                00955 ADJuSa
005DE0 C??? FFE8      00956                 MOVFF   IncTime,WREG
005DE4 087F           00957                 SUBLW   D'127'
005DE6 BEE8           00958                 BTFSC   WREG,7,A
005DE8 6AE8           00959                 CLRF    WREG,A
005DEA 46E8           00960                 RLNCF   WREG
005DEC 66E8           00961                 TSTFSZ  WREG,A
005DEE EC?? F???      00962                 CALL    Delay1mS
                      00963         ; Convert the value in CXreg into a string
                      00964                 MOVE16  CXreg,CEXreg
005DF2 C??? F???          M                 MOVFF   CXreg,CEXreg
005DF6 C??? F???          M                 MOVFF   (CXreg+1),(CEXreg+1)
                      00965                 ; Divide by two before the display operation
005DFA 90D8           00966                 BCF     ALUSTA,C
005DFC 32??           00967                 RRCF    CEXreg+1
005DFE 32??           00968                 RRCF    CEXreg
005E00 6A??           00969                 CLRF    CEXreg+2
005E02 6A??           00970                 CLRF    CEXreg+3
005E04 EC?? F???      00971                 CALL    Int2Str
                      00972         ; Position the print position and print...
                      00973                 CALLFL  LCDsendCMD,LINE2+uSPOS
005E08 0EC9               M                 MOVLW   (LINE2+uSPOS)
005E0A EC?? F???          M                 CALL    (LCDsendCMD)
                      00974                 CALLFF  LCDsendData,Buffer+1
005E0E 5000               M                 MOVFP   (Buffer+1),WREG
005E10 EC?? F???          M                 CALL    (LCDsendData)
                      00975                 CALLFL  LCDsendData,'.'
005E14 0E2E               M                 MOVLW   ('.')
005E16 EC?? F???          M                 CALL    (LCDsendData)
                      00976                 CALLFF  LCDsendData,Buffer+2
005E1A 5000               M                 MOVFP   (Buffer+2),WREG
005E1C EC?? F???          M                 CALL    (LCDsendData)
                      00977                 CALLFF  LCDsendData,Buffer+3
005E20 5000               M                 MOVFP   (Buffer+3),WREG
005E22 EC?? F???          M                 CALL    (LCDsendData)
                      00978                 CALLFF  LCDsendData,Buffer+4
005E26 5000               M                 MOVFP   (Buffer+4),WREG
005E28 EC?? F???          M                 CALL    (LCDsendData)
                      00979                 CALLFL  LCDsendData,'m'
005E2C 0E6D               M                 MOVLW   ('m')
005E2E EC?? F???          M                 CALL    (LCDsendData)
                      00980                 CALLFL  LCDsendData,'S'
005E32 0E53               M                 MOVLW   ('S')
005E34 EC?? F???          M                 CALL    (LCDsendData)
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 318


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00981         ; Test the elevator stick
005E38                00982 ADJus2
005E38 EC?? F???      00983                 CALL    Elevator
005E3C 01??           00984                 MOVLB   HIGH CXreg
005E3E A4D8           00985                 BTFSS   ALUSTA,Z
005E40 EF?? F???      00986                 GOTO    ADJus1
005E44 2A??           00987                 INCF    CXreg
005E46 B4D8           00988                 BTFSC   ALUSTA,Z
005E48 2A??           00989                 INCF    CXreg+1
005E4A 2A??           00990                 INCF    CXreg
005E4C B4D8           00991                 BTFSC   ALUSTA,Z
005E4E 2A??           00992                 INCF    CXreg+1
                      00993                 ; Test the limits...
005E50 50??           00994                 MOVF    MaxTime+1,W
005E52 62??           00995                 CPFSEQ  CXreg+1
005E54 EF?? F???      00996                 GOTO    ADJuS
005E58 50??           00997                 MOVF    MaxTime,W
005E5A 60??           00998                 CPFSLT  CXreg
005E5C 6E??           00999                 MOVWF   CXreg
005E5E EF?? F???      01000                 GOTO    ADJuS
005E62                01001 ADJus1
005E62 A0D8           01002                 BTFSS   ALUSTA,C
005E64 EF?? F???      01003                 GOTO    ADJus3
005E68 06??           01004                 DECF    CXreg
005E6A A0D8           01005                 BTFSS   ALUSTA,C
005E6C 06??           01006                 DECF    CXreg+1
005E6E 06??           01007                 DECF    CXreg
005E70 A0D8           01008                 BTFSS   ALUSTA,C
005E72 06??           01009                 DECF    CXreg+1
                      01010                 ; Test limits
005E74 50??           01011                 MOVF    MinTime+1,W
005E76 62??           01012                 CPFSEQ  CXreg+1
005E78 EF?? F???      01013                 GOTO    ADJuS
005E7C 50??           01014                 MOVF    MinTime,W
005E7E 64??           01015                 CPFSGT  CXreg
005E80 6E??           01016                 MOVWF   CXreg
005E82 EF?? F???      01017                 GOTO    ADJuS
                      01018         ; Test if the AUTO trim button has been pressed...
005E86                01019 ADJus3
005E86 01??           01020                 MOVLB   HIGH SymSet
005E88 A2??           01021                 BTFSS   PORTEimage,AUTOT
005E8A 68??           01022                 SETF    SymSet
                      01023         ; If Snap Right button is pressed then set time to max
005E8C BC??           01024                 BTFSC   PORTEimage,SNAPR
005E8E EF?? F???      01025                 GOTO    ADJus3a
                      01026                 MOVEC   D'4000', CXreg
005E92 01??               M                 MOVLR   HIGH (CXreg)
005E94 0EA0               M                 MOVLW   LOW (D'4000')
005E96 6E??               M                 MOVWF   (CXreg)
005E98 0E0F               M                 MOVLW   HIGH (D'4000')
005E9A 6E??               M                 MOVWF   (CXreg+1)
005E9C                01027 ADJus3a
                      01028         ; If snap Left button is pressed then set time to min
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 319


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

005E9C 01??           01029                 MOVLB   HIGH PORTEimage
005E9E BE??           01030                 BTFSC   PORTEimage,SNAPL
005EA0 EF?? F???      01031                 GOTO    ADJus3b
                      01032                 MOVEC   D'2000', CXreg
005EA4 01??               M                 MOVLR   HIGH (CXreg)
005EA6 0ED0               M                 MOVLW   LOW (D'2000')
005EA8 6E??               M                 MOVWF   (CXreg)
005EAA 0E07               M                 MOVLW   HIGH (D'2000')
005EAC 6E??               M                 MOVWF   (CXreg+1)
005EAE                01033 ADJus3b 
                      01034         ; Test for the option button to indicate we exit
005EAE EC?? F???      01035                 CALL    CalSaveAndExit
005EB2 EC?? F???      01036                 CALL    Option
005EB6 A0D8           01037                 BTFSS   ALUSTA,C
005EB8 EF?? F???      01038                 GOTO    ADJuSz
005EBC 0012           01039                 RETURN
                      01040 
                      01041 ; This function allows the pilot to adjust the signed integer
                      01042 ; value saved in CXreg. ;
                      01043 ; CXreg contains the 16 bit signed integer value.
005EBE                01044 ADJinteger
                      01045         ; Adjust the delay time based on stick position
005EBE C??? FFE8      01046                 MOVFF   IncTime,WREG
005EC2 087F           01047                 SUBLW   D'127'
005EC4 BEE8           01048                 BTFSC   WREG,7,A
005EC6 6AE8           01049                 CLRF    WREG,A
005EC8 46E8           01050                 RLNCF   WREG
005ECA 66E8           01051                 TSTFSZ  WREG,A
005ECC EC?? F???      01052                 CALL    Delay1mS
                      01053         ; Convert the value in CXreg into a string
                      01054                 MOVE16  CXreg,CEXreg
005ED0 C??? F???          M                 MOVFF   CXreg,CEXreg
005ED4 C??? F???          M                 MOVFF   (CXreg+1),(CEXreg+1)
005ED8 6A??           01055                 CLRF    CEXreg+2
005EDA 6A??           01056                 CLRF    CEXreg+3
005EDC EC?? F???      01057                 CALL    Int2Str
                      01058         ; Position and print
                      01059                 CALLFL  LCDsendCMD,LINE2+INTPOS
005EE0 0ECB               M                 MOVLW   (LINE2+INTPOS)
005EE2 EC?? F???          M                 CALL    (LCDsendCMD)
                      01060                 CALLFF  LCDsendData,Buffer
005EE6 5000               M                 MOVFP   (Buffer),WREG
005EE8 EC?? F???          M                 CALL    (LCDsendData)
                      01061                 CALLFF  LCDsendData,Buffer+1
005EEC 5000               M                 MOVFP   (Buffer+1),WREG
005EEE EC?? F???          M                 CALL    (LCDsendData)
                      01062                 CALLFF  LCDsendData,Buffer+2
005EF2 5000               M                 MOVFP   (Buffer+2),WREG
005EF4 EC?? F???          M                 CALL    (LCDsendData)
                      01063                 CALLFF  LCDsendData,Buffer+3
005EF8 5000               M                 MOVFP   (Buffer+3),WREG
005EFA EC?? F???          M                 CALL    (LCDsendData)
                      01064                 CALLFF  LCDsendData,Buffer+4
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 320


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

005EFE 5000               M                 MOVFP   (Buffer+4),WREG
005F00 EC?? F???          M                 CALL    (LCDsendData)
                      01065         ; Test the elevator stick
005F04                01066 ADJint2
005F04 EC?? F???      01067                 CALL    Elevator
005F08 01??           01068                 MOVLB   HIGH CXreg
005F0A A4D8           01069                 BTFSS   ALUSTA,Z
005F0C EF?? F???      01070                 GOTO    ADJint1
005F10 2A??           01071                 INCF    CXreg
005F12 B4D8           01072                 BTFSC   ALUSTA,Z
005F14 2A??           01073                 INCF    CXreg+1
                      01074                 ; Test the limits...
005F16 50??           01075                 MOVF    MaxTime+1,W
005F18 62??           01076                 CPFSEQ  CXreg+1
005F1A EF?? F???      01077                 GOTO    ADJinteger
005F1E 50??           01078                 MOVF    MaxTime,W
005F20 60??           01079                 CPFSLT  CXreg
005F22 6E??           01080                 MOVWF   CXreg
005F24 EF?? F???      01081                 GOTO    ADJinteger
005F28                01082 ADJint1
005F28 A0D8           01083                 BTFSS   ALUSTA,C
005F2A EF?? F???      01084                 GOTO    ADJint3
005F2E 06??           01085                 DECF    CXreg
005F30 A0D8           01086                 BTFSS   ALUSTA,C
005F32 06??           01087                 DECF    CXreg+1
                      01088                 ; Test limits
005F34 50??           01089                 MOVF    MinTime+1,W
005F36 62??           01090                 CPFSEQ  CXreg+1
005F38 EF?? F???      01091                 GOTO    ADJinteger
005F3C 50??           01092                 MOVF    MinTime,W
005F3E 64??           01093                 CPFSGT  CXreg
005F40 6E??           01094                 MOVWF   CXreg
005F42 EF?? F???      01095                 GOTO    ADJinteger
                      01096         ; Test for the option button to indicate we exit
005F46                01097 ADJint3 
005F46 EC?? F???      01098                 CALL    CalSaveAndExit
005F4A EC?? F???      01099                 CALL    Option
005F4E A0D8           01100                 BTFSS   ALUSTA,C
005F50 EF?? F???      01101                 GOTO    ADJinteger
005F54 0012           01102                 RETURN
                      01103 
                      01104 
                      01105 ; This function uses the elevator stick to select an option
                      01106 ; from the table pointed to by the value in BXreg. When the
                      01107 ; Option key is pressed, the variable at the end of the selected
                      01108 ; table is placed in the pointer defined in the DXreg.
                      01109 ; The variable is one byte, 8 bits only.
                      01110 ;
                      01111 ; BXreg points to table 
                      01112 ; DXreg points to variable location
005F56                01113 VerticalSelection
                      01114         ; Display the message
005F56                01115 VerSel4 
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 321


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      01116                 CALLFL  LCDsendCMD,LINE2
005F56 0EC0               M                 MOVLW   (LINE2)
005F58 EC?? F???          M                 CALL    (LCDsendCMD)
005F5C C??? FFF6      01117                 MOVFF   BXreg,TBLPTRL
005F60 C??? FFF7      01118                 MOVFF   BXreg+1,TBLPTRH
005F64 EC?? F???      01119                 CALL    LCDsendMess
                      01120                 CALLFL  Delay1mS,D'250'
005F68 0EFA               M                 MOVLW   (D'250')
005F6A EC?? F???          M                 CALL    (Delay1mS)
                      01121         ; Get the users selection
005F6E EC?? F???      01122                 CALL    Elevator
005F72 A4D8           01123                 BTFSS   ALUSTA,Z
005F74 EF?? F???      01124                 GOTO    VerSel1
                      01125                 ; If here go to next selection
005F78 0E11           01126                 MOVLW   D'17'
005F7A 26??           01127                 ADDWF   BXreg,F
005F7C B0D8           01128                 BTFSC   ALUSTA,C
005F7E 2A??           01129                 INCF    BXreg+1,F
005F80 EF?? F???      01130                 GOTO    VerSel2
005F84                01131 VerSel1
005F84 A0D8           01132                 BTFSS   ALUSTA,C
005F86 EF?? F???      01133                 GOTO    VerSel3
                      01134                 ; If here go to last selection
005F8A 0E13           01135                 MOVLW   D'19'
005F8C 26??           01136                 ADDWF   BXreg
005F8E B0D8           01137                 BTFSC   ALUSTA,C
005F90 2A??           01138                 INCF    BXreg+1
005F92                01139 VerSel2
                      01140                 ; Load BXreg into the table pointer
005F92 C??? FFF6      01141                 MOVFF   BXreg,TBLPTRL
005F96 C??? FFF7      01142                 MOVFF   BXreg+1,TBLPTRH
005F9A 6AF8           01143                 CLRF    TBLPTRU
                      01144                 ; Load BXreg with the table pointer contents...
005F9C 0009           01145                 TBLRD*+
005F9E CFF5 F???      01146                 MOVFF   TABLAT,BXreg
005FA2 0009           01147                 TBLRD*+
005FA4 CFF5 F???      01148                 MOVFF   TABLAT,BXreg+1
005FA8 EF?? F???      01149                 GOTO    VerSel4
                      01150         ; Check for Option button
005FAC                01151 VerSel3
005FAC EC?? F???      01152                 CALL    CalSaveAndExit
005FB0 EC?? F???      01153                 CALL    Option
005FB4 A0D8           01154                 BTFSS   ALUSTA,C
005FB6 EF?? F???      01155                 GOTO    VerSel4
                      01156         ; The option button  has been pressed. Advance the table
                      01157         ; pointer to the parameters at the end of the record.
005FBA 0E15           01158                 MOVLW   D'21'
005FBC 26??           01159                 ADDWF   BXreg
005FBE B0D8           01160                 BTFSC   ALUSTA,C
005FC0 2A??           01161                 INCF    BXreg+1
                      01162                 ; Load BXreg into the table pointer
005FC2 C??? FFF6      01163                 MOVFF   BXreg,TBLPTRL
005FC6 C??? FFF7      01164                 MOVFF   BXreg+1,TBLPTRH
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 322


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

005FCA 6AF8           01165                 CLRF    TBLPTRU
                      01166                 ; Load the variable...
005FCC 0009           01167                 TBLRD*+
005FCE CFF5 F???      01168                 MOVFF   TABLAT,Areg
005FD2 0009           01169                 TBLRD*+
005FD4 50F5           01170                 MOVFP   TABLAT,WREG
                      01171         ; Load the variable into the address contained in DXreg
005FD6 C??? FFE1      01172                 MOVFF   DXreg,FSR1L
005FDA C??? FFE2      01173                 MOVFF   DXreg+1,FSR1H
005FDE C??? FFE7      01174                 MOVPF   Areg,INDF1  
005FE2 0012           01175                 RETURN
                      01176 ;
                      01177 ; This function uses the elevator stick to select a channel.
                      01178 ; The selected channel is returned in WREG when the option 
                      01179 ; key is pressed. On call WREG contains the current value.
                      01180 ;
005FE4                01181 SelectChannel
                      01182         ; Valid Range for WREG is 0 to 8, now enforce it...
005FE4 0B0F           01183                 ANDLW   0F
005FE6 B6E8           01184                 BTFSC   WREG,3
005FE8 0B08           01185                 ANDLW   08
                      01186         ; Set to current selection
005FEA 0D0C           01187                 MULLW   LOW (SERVOSEL2 - SERVOSEL1)
005FEC CFF3 F???      01188                 MOVFF   PRODL,CEXreg
005FF0 CFF4 F???      01189                 MOVFF   PRODH,CEXreg+1
                      01190         ; Use CEXreg to point to the message table
005FF4 01??           01191                 MOVLR   HIGH CEXreg
005FF6 0E??           01192                 MOVLW   LOW SERVOSEL1
005FF8 26??           01193                 ADDWF   CEXreg,F
005FFA 0E??           01194                 MOVLW   HIGH SERVOSEL1
005FFC 22??           01195                 ADDWFC  CEXreg+1,F
                      01196         ; Display the message
005FFE                01197 SelectChannel4  
                      01198                 CALLFL  LCDsendCMD,LINE2+SELCHPOS
005FFE 0ECC               M                 MOVLW   (LINE2+SELCHPOS)
006000 EC?? F???          M                 CALL    (LCDsendCMD)
006004 C??? FFF6      01199                 MOVFF   CEXreg,TBLPTRL
006008 C??? FFF7      01200                 MOVFF   CEXreg+1,TBLPTRH
00600C EC?? F???      01201                 CALL    LCDsendMess
                      01202                 CALLFL  Delay1mS,D'250'
006010 0EFA               M                 MOVLW   (D'250')
006012 EC?? F???          M                 CALL    (Delay1mS)
                      01203         ; Get the users selection
006016 EC?? F???      01204                 CALL    Elevator
00601A A4D8           01205                 BTFSS   ALUSTA,Z,A
00601C EF?? F???      01206                 GOTO    SelectChannel1
                      01207                 ; If here go to next selection
006020 0E05           01208                 MOVLW   D'5'
006022 26??           01209                 ADDWF   CEXreg,F
006024 B0D8           01210                 BTFSC   ALUSTA,C,A
006026 2A??           01211                 INCF    CEXreg+1,F
006028 EF?? F???      01212                 GOTO    SelectChannel2
00602C                01213 SelectChannel1
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 323


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

00602C A0D8           01214                 BTFSS   ALUSTA,C
00602E EF?? F???      01215                 GOTO    SelectChannel3
                      01216                 ; If here go to last selection
006032 0E07           01217                 MOVLW   D'7'
006034 26??           01218                 ADDWF   CEXreg
006036 B0D8           01219                 BTFSC   ALUSTA,C,A
006038 2A??           01220                 INCF    CEXreg+1
00603A                01221 SelectChannel2
                      01222                 ; Load CEXreg into the table pointer
00603A C??? FFF6      01223                 MOVFF   CEXreg,TBLPTRL
00603E C??? FFF7      01224                 MOVFF   CEXreg+1,TBLPTRH
006042 6AF8           01225                 CLRF    TBLPTRU
                      01226                 ; Load CEXreg with the table pointer contents...
006044 0009           01227                 TBLRD*+
006046 CFF5 F???      01228                 MOVFF   TABLAT,CEXreg
00604A 0009           01229                 TBLRD*+
00604C CFF5 F???      01230                 MOVFF   TABLAT,CEXreg+1
006050 EF?? F???      01231                 GOTO    SelectChannel4
                      01232         ; Check for Option button
006054                01233 SelectChannel3
006054 EC?? F???      01234                 CALL    CalSaveAndExit
                      01235                 CALLF   Option
006058 EC?? F???          M                 CALL    (Option)
00605C A0D8           01236                 BTFSS   ALUSTA,C
00605E EF?? F???      01237                 GOTO    SelectChannel4
                      01238         ; The option button  has been pressed. Advance the table
                      01239         ; pointer to the parameters at the end of the record.
006062 0E09           01240                 MOVLW   D'9'
006064 26??           01241                 ADDWF   CEXreg
006066 B0D8           01242                 BTFSC   ALUSTA,C
006068 2A??           01243                 INCF    CEXreg+1
                      01244                 ; Load CEXreg into the table pointer
00606A C??? FFF6      01245                 MOVFF   CEXreg,TBLPTRL
00606E C??? FFF7      01246                 MOVFF   CEXreg+1,TBLPTRH
006072 6AF8           01247                 CLRF    TBLPTRU
                      01248                 ; Load the variable...
006074 0009           01249                 TBLRD*+
006076 CFF5 FFE8      01250                 MOVFF   TABLAT,WREG     ; LSB
00607A 0012           01251                 RETURN
                      01252 
                      01253 ; This function tests the position of the Aileron stick. The aileron
                      01254 ; center position is read on powerup and saved in AilCenter, this value
                      01255 ; is used by this routine.
                      01256 ;
                      01257 ; The status is returned in the C and Z flags:
                      01258 ;    C set for Left
                      01259 ;    Z set for Right
00607C                01260 Aileron
                      01261         ; Read ADC channel 4
                      01262                 CALLFL  ADCread,ADCail
00607C 0E04               M                 MOVLW   (ADCail)
00607E EC?? F???          M                 CALL    (ADCread)
                      01263                 CALLFL  ADCread,ADCail
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 324


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

006082 0E04               M                 MOVLW   (ADCail)
006084 EC?? F???          M                 CALL    (ADCread)
                      01264         ; Subtract the center position, and save the result in the ADC regs
006088 C??? FFE8      01265                 MOVFF   AilCenter,WREG
00608C 5EC3           01266                 SUBWF   ADRESL,F,A
00608E C??? FFE8      01267                 MOVFF   AilCenter+1,WREG
006092 5AC4           01268                 SUBWFB  ADRESH,F,A
                      01269         ; If positive then Left...
006094 BEC4           01270                 BTFSC   ADRESH,7,A
006096 EF?? F???      01271                 GOTO    Aileron1
                      01272                 ; Now subtract the threshold value
00609A 0E90           01273                 MOVLW   LOW StickThres
00609C 5EC3           01274                 SUBWF   ADRESL,F,A
00609E 0E01           01275                 MOVLW   HIGH StickThres
0060A0 5AC4           01276                 SUBWFB  ADRESH,F,A
                      01277                 ; If its Positive then clear flags and exit
0060A2 BEC4           01278                 BTFSC   ADRESH,7,A
0060A4 EF?? F???      01279                 GOTO    Aileron2
0060A8 84D8           01280                 BSF     ALUSTA,Z,A
0060AA 90D8           01281                 BCF     ALUSTA,C,A
0060AC 0012           01282                 RETURN
0060AE                01283 Aileron1
                      01284         ; if negative then right
                      01285                 ; Now add the threshold value
0060AE 0E90           01286                 MOVLW   LOW StickThres
0060B0 26C3           01287                 ADDWF   ADRESL,F,A
0060B2 0E01           01288                 MOVLW   HIGH StickThres
0060B4 22C4           01289                 ADDWFC   ADRESH,F,A
                      01290                 ; If its negative then clear flags and exit
0060B6 AEC4           01291                 BTFSS   ADRESH,7,A
0060B8 EF?? F???      01292                 GOTO    Aileron2
0060BC 94D8           01293                 BCF     ALUSTA,Z,A
0060BE 80D8           01294                 BSF     ALUSTA,C,A
0060C0 0012           01295                 RETURN
0060C2                01296 Aileron2
0060C2 94D8           01297                 BCF     ALUSTA,Z,A
0060C4 90D8           01298                 BCF     ALUSTA,C,A
0060C6 0012           01299                 RETURN
                      01300 
                      01301 ; This function tests the position of the Elevator stick.
                      01302 ; The status is returned in the C and Z flags:
                      01303 ;    C set for DOWN
                      01304 ;    Z set for UP
0060C8                01305 Elevator
                      01306         ; Read ADC channel 5
                      01307                 CALLFL  ADCread,ADCele
0060C8 0E05               M                 MOVLW   (ADCele)
0060CA EC?? F???          M                 CALL    (ADCread)
                      01308                 CALLFL  ADCread,ADCele
0060CE 0E05               M                 MOVLW   (ADCele)
0060D0 EC?? F???          M                 CALL    (ADCread)
                      01309         ; Subtract the center position, and save the result in the ADC regs
0060D4 C??? FFE8      01310                 MOVFF   EleCenter,WREG
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 325


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

0060D8 5EC3           01311                 SUBWF   ADRESL,F,A
0060DA C??? FFE8      01312                 MOVFF   EleCenter+1,WREG
0060DE 5AC4           01313                 SUBWFB  ADRESH,F,A
                      01314         ; If positive then UP...
0060E0 BEC4           01315                 BTFSC   ADRESH,7,A
0060E2 EF?? F???      01316                 GOTO    Elevator1
                      01317                 ; Now subtract the threshold value
0060E6 0E90           01318                 MOVLW   LOW StickThres
0060E8 5EC3           01319                 SUBWF   ADRESL,F,A
0060EA 0E01           01320                 MOVLW   HIGH StickThres
0060EC 5AC4           01321                 SUBWFB  ADRESH,F,A
                      01322                 ; If its negative then clear flags and exit
0060EE BEC4           01323                 BTFSC   ADRESH,7,A
0060F0 EF?? F???      01324                 GOTO    Elevator2
                      01325                 ; Save the value over the threshold for use in the variable value increment speed
0060F4 90D8           01326                 BCF     ALUSTA,C,A      ; Divide by 2
0060F6 32C4           01327                 RRCF    ADRESH,F,A
0060F8 32C3           01328                 RRCF    ADRESL,F,A
0060FA 90D8           01329                 BCF     ALUSTA,C,A      ; Divide by 2
0060FC 32C4           01330                 RRCF    ADRESH,F,A
0060FE 32C3           01331                 RRCF    ADRESL,F,A
                      01332                 
006100 66C4           01333                 TSTFSZ  ADRESH,A
006102 68C3           01334                 SETF    ADRESL,A
006104 CFC3 F???      01335                 MOVFF   ADRESL,IncTime
006108 84D8           01336                 BSF     ALUSTA,Z,A
00610A 90D8           01337                 BCF     ALUSTA,C,A
00610C 0012           01338                 RETURN
00610E                01339 Elevator1
                      01340         ; if negative then DOWN
                      01341                 ; Now add the threshold value
00610E 0E90           01342                 MOVLW   LOW StickThres
006110 26C3           01343                 ADDWF   ADRESL,F,A
006112 0E01           01344                 MOVLW   HIGH StickThres
006114 22C4           01345                 ADDWFC  ADRESH,F,A
                      01346                 ; If its positive then clear flags and exit
006116 AEC4           01347                 BTFSS   ADRESH,7,A
006118 EF?? F???      01348                 GOTO    Elevator2
                      01349                 ; Save the value over the threshold for use in the variable value increment speed
00611C 80D8           01350                 BSF     ALUSTA,C,A      ; Divide by 2
00611E 32C4           01351                 RRCF    ADRESH,F,A
006120 32C3           01352                 RRCF    ADRESL,F,A
006122 80D8           01353                 BSF     ALUSTA,C,A      ; Divide by 2
006124 32C4           01354                 RRCF    ADRESH,F,A
006126 32C3           01355                 RRCF    ADRESL,F,A
                      01356 
006128 1EC3           01357                 COMF    ADRESL,F,A
00612A 1EC4           01358                 COMF    ADRESH,F,A
00612C 66C4           01359                 TSTFSZ  ADRESH,A
00612E 68C3           01360                 SETF    ADRESL,A
006130 CFC3 F???      01361                 MOVFF   ADRESL,IncTime
006134 94D8           01362                 BCF     ALUSTA,Z,A
006136 80D8           01363                 BSF     ALUSTA,C,A
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 326


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

006138 0012           01364                 RETURN
00613A                01365 Elevator2
00613A 94D8           01366                 BCF     ALUSTA,Z,A
00613C 90D8           01367                 BCF     ALUSTA,C,A
00613E 0012           01368                 RETURN
                      01369 
                      01370 ; 
                      01371 ; This function is used to ask the pilot if he/she would like to apply the edited parameter
                      01372 ; to all aircraft settings. This function will return with the carry flag indicating the
                      01373 ; pilots selection.
                      01374 ;
                      01375 ; Carry flag
                      01376 ;
                      01377 ;       Set = yes selected
                      01378 ;
006140                01379 ApplyToAll
                      01380         ; Display message on display
                      01381                 CALLFL  LCDsendCMD,LINE1
006140 0E80               M                 MOVLW   (LINE1)
006142 EC?? F???          M                 CALL    (LCDsendCMD)
                      01382                 PrintMess MES29
006146 0E??               M                 MOVLW   UPPER (MES29)
006148 6EF8               M                 MOVWF   TBLPTRU,A
00614A 0E??               M                 MOVLW   HIGH (MES29)
00614C 6EF7               M                 MOVWF   TBLPTRH,A
00614E 0E??               M                 MOVLW   LOW (MES29)
006150 6EF6               M                 MOVWF   TBLPTRL,A
006152 EC?? F???          M                 CALL    LCDsendMess
                      01383                 CALLFL  LCDsendCMD,LINE2
006156 0EC0               M                 MOVLW   (LINE2)
006158 EC?? F???          M                 CALL    (LCDsendCMD)
                      01384                 PrintMess MES7
00615C 0E??               M                 MOVLW   UPPER (MES7)
00615E 6EF8               M                 MOVWF   TBLPTRU,A
006160 0E??               M                 MOVLW   HIGH (MES7)
006162 6EF7               M                 MOVWF   TBLPTRH,A
006164 0E??               M                 MOVLW   LOW (MES7)
006166 6EF6               M                 MOVWF   TBLPTRL,A
006168 EC?? F???          M                 CALL    LCDsendMess
                      01385         ; Get user selection
00616C EC?? F???      01386                 CALL    YesNo
006170 0012           01387                 RETURN
                      01388 
                      01389 ; Generic apply to all aircraft function
006172                01390 ATLpost
                      01391         ; Ask user if he/she would like to apply to all
006172 EC?? F???      01392                 CALL    ApplyToAll
006176 A0D8           01393                 BTFSS   ALUSTA,C
006178 0012           01394                 RETURN
                      01395         ; Here to apply to all aircraft
                      01396                 CALLFL  LCDsendCMD,LINE2
00617A 0EC0               M                 MOVLW   (LINE2)
00617C EC?? F???          M                 CALL    (LCDsendCMD)
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 327


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      01397                 PrintMess MES30
006180 0E??               M                 MOVLW   UPPER (MES30)
006182 6EF8               M                 MOVWF   TBLPTRU,A
006184 0E??               M                 MOVLW   HIGH (MES30)
006186 6EF7               M                 MOVWF   TBLPTRH,A
006188 0E??               M                 MOVLW   LOW (MES30)
00618A 6EF6               M                 MOVWF   TBLPTRL,A
00618C EC?? F???          M                 CALL    LCDsendMess
006190 EC?? F???      01398                 CALL    FlashAllAircraft
006194 0012           01399                 RETURN                     
                      01400 
                      01401 ; This section contains the routines that support each of the calibration
                      01402 ; options. 
                      01403 
                      01404 ;***************
006196                01405 CalSelectAircraft
                      01406 ;***************
006196 EF?? F???      01407                 GOTO    SelectAircraft
                      01408 
                      01409 ;***************
00619A                01410 CalAircraftName
                      01411 ;***************
                      01412                 CALLFL  LCDsendCMD,LINE1
00619A 0E80               M                 MOVLW   (LINE1)
00619C EC?? F???          M                 CALL    (LCDsendCMD)
                      01413                 PrintMess CALMES2
0061A0 0E??               M                 MOVLW   UPPER (CALMES2)
0061A2 6EF8               M                 MOVWF   TBLPTRU,A
0061A4 0E??               M                 MOVLW   HIGH (CALMES2)
0061A6 6EF7               M                 MOVWF   TBLPTRH,A
0061A8 0E??               M                 MOVLW   LOW (CALMES2)
0061AA 6EF6               M                 MOVWF   TBLPTRL,A
0061AC EC?? F???          M                 CALL    LCDsendMess
0061B0 EF?? F???      01414                 GOTO    AircraftName
                      01415 
                      01416 ;***************
0061B4                01417 CalTimer
                      01418 ;***************
                      01419                 MOVEC   CALMES3,CalOption
0061B4 01??               M                 MOVLR   HIGH (CalOption)
0061B6 0E??               M                 MOVLW   LOW (CALMES3)
0061B8 6E??               M                 MOVWF   (CalOption)
0061BA 0E??               M                 MOVLW   HIGH (CALMES3)
0061BC 6E??               M                 MOVWF   (CalOption+1)
                      01420                 MOVEC   MTIMER1,CalMenu
0061BE 01??               M                 MOVLR   HIGH (CalMenu)
0061C0 0E??               M                 MOVLW   LOW (MTIMER1)
0061C2 6E??               M                 MOVWF   (CalMenu)
0061C4 0E??               M                 MOVLW   HIGH (MTIMER1)
0061C6 6E??               M                 MOVWF   (CalMenu+1)
0061C8 EC?? F???      01421                 CALL    CalUI
                      01422         ; Save the parameters and exit
0061CC                01423 CalSaveExit
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 328


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      01424                 CALLF   SaveGeneral
0061CC EC?? F???          M                 CALL    (SaveGeneral)
0061D0 C??? FFE8      01425                 MOVFF   Aircraft,WREG   ; Load aircraft number
0061D4 EC?? F???      01426                 CALL    SaveAircraft
0061D8 EC?? F???      01427                 CALL    BackupAircraft
0061DC 0012           01428                 RETURN
                      01429 
                      01430 ;***************
0061DE                01431 CalSnap
                      01432 ;***************
                      01433                 MOVEC   CALMES4,CalOption
0061DE 01??               M                 MOVLR   HIGH (CalOption)
0061E0 0E??               M                 MOVLW   LOW (CALMES4)
0061E2 6E??               M                 MOVWF   (CalOption)
0061E4 0E??               M                 MOVLW   HIGH (CALMES4)
0061E6 6E??               M                 MOVWF   (CalOption+1)
                      01434                 MOVEC   SNAP1,CalMenu
0061E8 01??               M                 MOVLR   HIGH (CalMenu)
0061EA 0E??               M                 MOVLW   LOW (SNAP1)
0061EC 6E??               M                 MOVWF   (CalMenu)
0061EE 0E??               M                 MOVLW   HIGH (SNAP1)
0061F0 6E??               M                 MOVWF   (CalMenu+1)
0061F2 EC?? F???      01435                 CALL    CalUI
0061F6 EF?? F???      01436                 GOTO    CalSaveExit
                      01437 
                      01438 ;***************
0061FA                01439 CalServos
                      01440 ;***************
                      01441                 MOVEC   CALMES5,CalOption
0061FA 01??               M                 MOVLR   HIGH (CalOption)
0061FC 0E??               M                 MOVLW   LOW (CALMES5)
0061FE 6E??               M                 MOVWF   (CalOption)
006200 0E??               M                 MOVLW   HIGH (CALMES5)
006202 6E??               M                 MOVWF   (CalOption+1)
                      01442                 MOVEC   SCHNMES1,CalMenu
006204 01??               M                 MOVLR   HIGH (CalMenu)
006206 0E??               M                 MOVLW   LOW (SCHNMES1)
006208 6E??               M                 MOVWF   (CalMenu)
00620A 0E??               M                 MOVLW   HIGH (SCHNMES1)
00620C 6E??               M                 MOVWF   (CalMenu+1)
00620E EC?? F???      01443                 CALL    CalUI
006212 EF?? F???      01444                 GOTO    CalSaveExit
                      01445                 
                      01446 ;***************
006216                01447 CalMixers
                      01448 ;***************
                      01449                 MOVEC   CALMES6,CalOption
006216 01??               M                 MOVLR   HIGH (CalOption)
006218 0E??               M                 MOVLW   LOW (CALMES6)
00621A 6E??               M                 MOVWF   (CalOption)
00621C 0E??               M                 MOVLW   HIGH (CALMES6)
00621E 6E??               M                 MOVWF   (CalOption+1)
                      01450                 MOVEC   FMIX1,CalMenu
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 329


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

006220 01??               M                 MOVLR   HIGH (CalMenu)
006222 0E??               M                 MOVLW   LOW (FMIX1)
006224 6E??               M                 MOVWF   (CalMenu)
006226 0E??               M                 MOVLW   HIGH (FMIX1)
006228 6E??               M                 MOVWF   (CalMenu+1)
00622A EC?? F???      01451                 CALL    CalUI
00622E EF?? F???      01452                 GOTO    CalSaveExit
                      01453                 
                      01454 ;***************
006232                01455 CalSwitch
                      01456 ;***************
                      01457                 MOVEC   CALMES7,CalOption
006232 01??               M                 MOVLR   HIGH (CalOption)
006234 0E??               M                 MOVLW   LOW (CALMES7)
006236 6E??               M                 MOVWF   (CalOption)
006238 0E??               M                 MOVLW   HIGH (CALMES7)
00623A 6E??               M                 MOVWF   (CalOption+1)
                      01458                 MOVEC   SWFUN1,CalMenu
00623C 01??               M                 MOVLR   HIGH (CalMenu)
00623E 0E??               M                 MOVLW   LOW (SWFUN1)
006240 6E??               M                 MOVWF   (CalMenu)
006242 0E??               M                 MOVLW   HIGH (SWFUN1)
006244 6E??               M                 MOVWF   (CalMenu+1)
006246 EC?? F???      01459                 CALL    CalUI
00624A EF?? F???      01460                 GOTO    CalSaveExit
                      01461                 
                      01462 ;***************
00624E                01463 CalOptions
                      01464 ;***************
00624E 01??           01465                 MOVLR   HIGH Mto
006250 6A??           01466                 CLRF    Mto
                      01467                 MOVEC   CALMES8,CalOption
006252 01??               M                 MOVLR   HIGH (CalOption)
006254 0E??               M                 MOVLW   LOW (CALMES8)
006256 6E??               M                 MOVWF   (CalOption)
006258 0E??               M                 MOVLW   HIGH (CALMES8)
00625A 6E??               M                 MOVWF   (CalOption+1)
                      01468                 MOVEC   COP1,CalMenu
00625C 01??               M                 MOVLR   HIGH (CalMenu)
00625E 0E??               M                 MOVLW   LOW (COP1)
006260 6E??               M                 MOVWF   (CalMenu)
006262 0E??               M                 MOVLW   HIGH (COP1)
006264 6E??               M                 MOVWF   (CalMenu+1)
006266 EC?? F???      01469                 CALL    CalUI
00626A EF?? F???      01470                 GOTO    CalSaveExit
                      01471                 
                      01472 ;***************
00626E                01473 CalSystemSetup
                      01474 ;***************
                      01475                 MOVEC   CALMES10,CalOption
00626E 01??               M                 MOVLR   HIGH (CalOption)
006270 0E??               M                 MOVLW   LOW (CALMES10)
006272 6E??               M                 MOVWF   (CalOption)
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 330


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

006274 0E??               M                 MOVLW   HIGH (CALMES10)
006276 6E??               M                 MOVWF   (CalOption+1)
                      01476                 MOVEC   SYS1,CalMenu
006278 01??               M                 MOVLR   HIGH (CalMenu)
00627A 0E??               M                 MOVLW   LOW (SYS1)
00627C 6E??               M                 MOVWF   (CalMenu)
00627E 0E??               M                 MOVLW   HIGH (SYS1)
006280 6E??               M                 MOVWF   (CalMenu+1)
006282 EC?? F???      01477                 CALL    CalUI
006286 EF?? F???      01478                 GOTO    CalSaveExit
                      01479                 
                      01480 ;***************
00628A                01481 CalSelectFrequency
                      01482 ;***************
00628A EF?? F???      01483                 GOTO    SelectFrequency
                      01484                 
                      01485 ;***************
00628E                01486 CalAdvanced
                      01487 ;***************
                      01488                 MOVEC   CALMES12,CalOption
00628E 01??               M                 MOVLR   HIGH (CalOption)
006290 0E??               M                 MOVLW   LOW (CALMES12)
006292 6E??               M                 MOVWF   (CalOption)
006294 0E??               M                 MOVLW   HIGH (CALMES12)
006296 6E??               M                 MOVWF   (CalOption+1)
                      01489                 MOVEC   ADV1,CalMenu
006298 01??               M                 MOVLR   HIGH (CalMenu)
00629A 0E??               M                 MOVLW   LOW (ADV1)
00629C 6E??               M                 MOVWF   (CalMenu)
00629E 0E??               M                 MOVLW   HIGH (ADV1)
0062A0 6E??               M                 MOVWF   (CalMenu+1)
0062A2 EC?? F???      01490                 CALL    CalUI
0062A6 EF?? F???      01491                 GOTO    CalSaveExit
                      01492 
                      01493 ;***************
0062AA                01494 CalHelicopter
                      01495 ;***************
                      01496         ; Move all the table pointers to the lower nibble for the UI routines
0062AA 01??           01497                 MOVLB   HIGH HTht
0062AC 3A??           01498                 SWAPF   HTht
0062AE 3A??           01499                 SWAPF   HPitch
0062B0 3A??           01500                 SWAPF   HthtPitch
0062B2 3A??           01501                 SWAPF   Hst1Tht
0062B4 3A??           01502                 SWAPF   Hst1Pitch
0062B6 3A??           01503                 SWAPF   Hst2Tht
0062B8 3A??           01504                 SWAPF   Hst2Pitch
                      01505         ; Call the UI routines
                      01506                 MOVEC   CALMES13,CalOption
0062BA 01??               M                 MOVLR   HIGH (CalOption)
0062BC 0E??               M                 MOVLW   LOW (CALMES13)
0062BE 6E??               M                 MOVWF   (CalOption)
0062C0 0E??               M                 MOVLW   HIGH (CALMES13)
0062C2 6E??               M                 MOVWF   (CalOption+1)
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 331


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      01507                 MOVEC   HELI1,CalMenu
0062C4 01??               M                 MOVLR   HIGH (CalMenu)
0062C6 0E??               M                 MOVLW   LOW (HELI1)
0062C8 6E??               M                 MOVWF   (CalMenu)
0062CA 0E??               M                 MOVLW   HIGH (HELI1)
0062CC 6E??               M                 MOVWF   (CalMenu+1)
0062CE EC?? F???      01508                 CALL    CalUI
                      01509         ; Move all the table pointers to the high nibble for the run time code
0062D2 01??           01510                 MOVLB   HIGH HTht
0062D4 3A??           01511                 SWAPF   HTht
0062D6 3A??           01512                 SWAPF   HPitch
0062D8 3A??           01513                 SWAPF   HthtPitch
0062DA 3A??           01514                 SWAPF   Hst1Tht
0062DC 3A??           01515                 SWAPF   Hst1Pitch
0062DE 3A??           01516                 SWAPF   Hst2Tht
0062E0 3A??           01517                 SWAPF   Hst2Pitch
                      01518         ; Done!
0062E2 EF?? F???      01519                 GOTO    CalSaveExit
                      01520                 
                      01521 
                      01522 
                      01523 ; This is the generic calibration user interface processing routine.
                      01524 ; This function will allow menu nesting up to three levels. This function
                      01525 ; is called after the user select the option he wishes to use. All of the
                      01526 ; selected option's parameters are processed by this code. 
0062E6                01527 CalUI               
                      01528         ; Clear the DriveCh in case its not needed
0062E6 0E00           01529                 MOVLW   0
0062E8 CFE8 F???      01530                 MOVFF   WREG,DriveCh
                      01531         ; Display the Calibration Selection
0062EC EC?? F???      01532                 CALL    DisplayCalibration
                      01533         ; Load menu pointer              
                      01534                 MOVE16  CalMenu,AXreg
0062F0 C??? F???          M                 MOVFF   CalMenu,AXreg
0062F4 C??? F???          M                 MOVFF   (CalMenu+1),(AXreg+1)
0062F8 EC?? F???      01535                 CALL    SelectionFunction
                      01536                 MOVE16  AXreg,CalMenu  
0062FC C??? F???          M                 MOVFF   AXreg,CalMenu
006300 C??? F???          M                 MOVFF   (AXreg+1),(CalMenu+1)
                      01537                 MOVE16  PostCall,PostCallLevel1
006304 C??? F???          M                 MOVFF   PostCall,PostCallLevel1
006308 C??? F???          M                 MOVFF   (PostCall+1),(PostCallLevel1+1)
                      01538                 ; If CXreg contains 9, then BXreg points to another selection table
00630C 01??           01539                 MOVLB   HIGH CXreg
00630E 5000           01540                 MOVF    CXreg,WREG
006310 0A09           01541                 XORLW   9
006312 A4D8           01542                 BTFSS   ALUSTA,Z,A
006314 EF?? F???      01543                 GOTO    CUI2
                      01544                 ; Here to process a selection table, nesting level of 2
                      01545                  MOVE16 BXreg,AXreg
006318 C??? F???          M                 MOVFF   BXreg,AXreg
00631C C??? F???          M                 MOVFF   (BXreg+1),(AXreg+1)
006320                01546 CUI3
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 332


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

006320 EC?? F???      01547                  CALL   SelectionFunction 
                      01548                  MOVE16 AXreg,CalMenu1 
006324 C??? F???          M                 MOVFF   AXreg,CalMenu1
006328 C??? F???          M                 MOVFF   (AXreg+1),(CalMenu1+1)
                      01549                  MOVE16 PostCall,PostCallLevel2
00632C C??? F???          M                 MOVFF   PostCall,PostCallLevel2
006330 C??? F???          M                 MOVFF   (PostCall+1),(PostCallLevel2+1)
                      01550                  ; If CXreg contains 9, then BXreg points to another selection table
006334 01??           01551                  MOVLB  HIGH CXreg
006336 5000           01552                  MOVF   CXreg,WREG
006338 0A09           01553                  XORLW  9
00633A A4D8           01554                  BTFSS  ALUSTA,Z,A
00633C EF?? F???      01555                  GOTO   CUI4
                      01556                  ; Here to process a selection table, nesting level of 3
                      01557                  MOVE16 BXreg,AXreg
006340 C??? F???          M                 MOVFF   BXreg,AXreg
006344 C??? F???          M                 MOVFF   (BXreg+1),(AXreg+1)
006348                01558 CUI5
006348 EC?? F???      01559                  CALL   SelectionFunction 
                      01560                  MOVE16 AXreg,CalMenu2 
00634C C??? F???          M                 MOVFF   AXreg,CalMenu2
006350 C??? F???          M                 MOVFF   (AXreg+1),(CalMenu2+1)
                      01561                  MOVE16 PostCall,PostCallLevel3
006354 C??? F???          M                 MOVFF   PostCall,PostCallLevel3
006358 C??? F???          M                 MOVFF   (PostCall+1),(PostCallLevel3+1)
00635C EC?? F???      01562                  CALL   Input 
                      01563                  ; If EXIT flag is exit, RETURN 
006360 01??           01564                  MOVLB  HIGH EXIT
006362 B0??           01565                  BTFSC  EXIT,0
006364 EF?? F???      01566                  GOTO   CUI4a 
                      01567                  MOVE16 PostCallLevel3,BXreg
006368 C??? F???          M                 MOVFF   PostCallLevel3,BXreg
00636C C??? F???          M                 MOVFF   (PostCallLevel3+1),(BXreg+1)
006370 EC?? F???      01568                  CALL   CallBXreg 
                      01569                  MOVE16 CalMenu2,AXreg    
006374 C??? F???          M                 MOVFF   CalMenu2,AXreg
006378 C??? F???          M                 MOVFF   (CalMenu2+1),(AXreg+1)
00637C EF?? F???      01570                  GOTO   CUI5            
006380                01571 CUI4            
006380 EC?? F???      01572                  CALL   Input 
                      01573                  ; If EXIT flag is exit, RETURN 
006384 01??           01574                  MOVLB  HIGH EXIT
006386 B0??           01575                  BTFSC  EXIT,0
006388 EF?? F???      01576                  GOTO   CUI2a 
00638C                01577 CUI4a 
                      01578                  MOVE16 PostCallLevel2,BXreg
00638C C??? F???          M                 MOVFF   PostCallLevel2,BXreg
006390 C??? F???          M                 MOVFF   (PostCallLevel2+1),(BXreg+1)
006394 EC?? F???      01579                  CALL   CallBXreg 
                      01580                  ; Restore the top line of the display from TrackMenu
                      01581                  MOVE16 CalMenu,AXreg 
006398 C??? F???          M                 MOVFF   CalMenu,AXreg
00639C C??? F???          M                 MOVFF   (CalMenu+1),(AXreg+1)
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 333


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      01582                  CALLF  LCDsendAX   
0063A0 EC?? F???          M                 CALL    (LCDsendAX)
                      01583                  MOVE16 CalMenu1,AXreg 
0063A4 C??? F???          M                 MOVFF   CalMenu1,AXreg
0063A8 C??? F???          M                 MOVFF   (CalMenu1+1),(AXreg+1)
0063AC EF?? F???      01584                  GOTO   CUI3
0063B0                01585 CUI2    
0063B0 EC?? F???      01586                 CALL    Input
                      01587                 ; If EXIT flag is exit, RETURN 
0063B4 01??           01588                 MOVLB   HIGH EXIT
0063B6 B0??           01589                 BTFSC   EXIT,0
0063B8 0012           01590                 RETURN
0063BA                01591 CUI2a
                      01592                 MOVE16  PostCallLevel1,BXreg
0063BA C??? F???          M                 MOVFF   PostCallLevel1,BXreg
0063BE C??? F???          M                 MOVFF   (PostCallLevel1+1),(BXreg+1)
0063C2 EC?? F???      01593                 CALL    CallBXreg 
0063C6 EF?? F???      01594                 GOTO    CalUI       
0063CA 0012           01595                 RETURN
                      01596 
                      01597 ; User interface include files....              
                      01598 
                      01599         Include <SelAft.asm>
                      00001 ;
                      00002 ; This function is called from the calibration mode after the user
                      00003 ; has selected the option to "Select Aircraft".
                      00004 ; The top line of the display will show the aircraft number and the
                      00005 ; second line will show the aircraft name.
                      00006 ; The elevator stick is used to scroll through all of the posible
                      00007 ; aircraft, when the option desired is displayed, press the option
                      00008 ; button to make your selection and exit this function.
                      00009 ;
0063CC                00010 SelectAircraft
                      00011         ; Move digital trims to the current aircraft and update
                      00012                 MOVE    DTail,DTailA
0063CC C??? F???          M                 MOVFF   DTail,DTailA
0063D0 C??? F???          M                 MOVFF   (DTail+1),(DTailA+1)
                      00013                 MOVE    DTele,DTeleA
0063D4 C??? F???          M                 MOVFF   DTele,DTeleA
0063D8 C??? F???          M                 MOVFF   (DTele+1),(DTeleA+1)
                      00014                 MOVE    DTrud,DTrudA
0063DC C??? F???          M                 MOVFF   DTrud,DTrudA
0063E0 C??? F???          M                 MOVFF   (DTrud+1),(DTrudA+1)
                      00015                 MOVE    DTtht,DTthtA
0063E4 C??? F???          M                 MOVFF   DTtht,DTthtA
0063E8 C??? F???          M                 MOVFF   (DTtht+1),(DTthtA+1)
0063EC C??? FFE8      00016                 MOVFF   Aircraft,WREG
0063F0 EC?? F???      00017                 CALL    SaveAircraft            
                      00018         ; Display the current aircraft number and name
0063F4                00019 SA4
0063F4 C??? FFE8      00020                 MOVFF   Aircraft,WREG
0063F8 EC?? F???      00021                 CALL    LoadAircraftName
                      00022                 CALLFL  LCDsendCMD,LINE1
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 334


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

0063FC 0E80               M                 MOVLW   (LINE1)
0063FE EC?? F???          M                 CALL    (LCDsendCMD)
                      00023                 PrintMess MES4
006402 0E??               M                 MOVLW   UPPER (MES4)
006404 6EF8               M                 MOVWF   TBLPTRU,A
006406 0E??               M                 MOVLW   HIGH (MES4)
006408 6EF7               M                 MOVWF   TBLPTRH,A
00640A 0E??               M                 MOVLW   LOW (MES4)
00640C 6EF6               M                 MOVWF   TBLPTRL,A
00640E EC?? F???          M                 CALL    LCDsendMess
                      00024                 CALLFL  LCDsendCMD,LINE1+ACFTPOS
006412 0E8D               M                 MOVLW   (LINE1+ACFTPOS)
006414 EC?? F???          M                 CALL    (LCDsendCMD)
006418 01??           00025                 MOVLB   HIGH Aircraft
00641A 50??           00026                 MOVF    Aircraft,W
00641C 01??           00027                 MOVLB   HIGH CEXreg
00641E 6E??           00028                 MOVWF   CEXreg
006420 6A??           00029                 CLRF    CEXreg+1
006422 6A??           00030                 CLRF    CEXreg+2
006424 6A??           00031                 CLRF    CEXreg+3
006426 EC?? F???      00032                 CALL    LCDint2
                      00033                 ; Now display the aircraft name on the second line
00642A EC?? F???      00034                 CALL    DisplayAircraftName
00642E C??? FFE8      00035                 MOVFF   IncTime,WREG
006432 087F           00036                 SUBLW   D'127'
006434 BEE8           00037                 BTFSC   WREG,7,A
006436 6AE8           00038                 CLRF    WREG,A
006438 46E8           00039                 RLNCF   WREG
00643A 66E8           00040                 TSTFSZ  WREG,A
00643C EC?? F???      00041                 CALL    Delay1mS
                      00042         ; Test elevator for a change request
006440                00043 SA3
006440 EC?? F???      00044                 CALL    Elevator
006444 A4D8           00045                 BTFSS   ALUSTA,Z,A
006446 EF?? F???      00046                 GOTO    SA1
                      00047                 ; Here to advance to next aircraft
00644A 0E61           00048                 MOVLW   (NumAircraft+1)
00644C 01??           00049                 MOVLB   HIGH Aircraft
00644E 2A??           00050                 INCF    Aircraft
006450 62??           00051                 CPFSEQ  Aircraft
006452 EF?? F???      00052                 GOTO    SA4
006456 0E01           00053                 MOVLW   1
006458 6E??           00054                 MOVWF   Aircraft
00645A EF?? F???      00055                 GOTO    SA4
00645E                00056 SA1
00645E A0D8           00057                 BTFSS   ALUSTA,C,A
006460 EF?? F???      00058                 GOTO    SA2
                      00059                 ; Here to return to last aircraft
006464 01??           00060                 MOVLR   HIGH Aircraft
006466 06??           00061                 DECF    Aircraft
006468 0E00           00062                 MOVLW   0
00646A 62??           00063                 CPFSEQ  Aircraft
00646C EF?? F???      00064                 GOTO    SA4
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 335


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

006470 0E60           00065                 MOVLW   NumAircraft
006472 01??           00066                 MOVLR   HIGH Aircraft
006474 6E??           00067                 MOVWF   Aircraft
006476 EF?? F???      00068                 GOTO    SA4
                      00069         ; Test for option button
00647A                00070 SA2
00647A EC?? F???      00071                 CALL    Option
00647E A0D8           00072                 BTFSS   ALUSTA,C,A
006480 EF?? F???      00073                 GOTO    SA3
                      00074         ; Now read the selected aircraft data and write the selection to Flash
006484 C??? FFE8      00075                 MOVFF   Aircraft,WREG
006488 EC?? F???      00076                 CALL    LoadAircraft
                      00077                 ; Move digital trims to EEPROM and save
                      00078                 MOVE    DTailA,DTail
00648C C??? F???          M                 MOVFF   DTailA,DTail
006490 C??? F???          M                 MOVFF   (DTailA+1),(DTail+1)
                      00079                 MOVE    DTeleA,DTele
006494 C??? F???          M                 MOVFF   DTeleA,DTele
006498 C??? F???          M                 MOVFF   (DTeleA+1),(DTele+1)
                      00080                 MOVE    DTrudA,DTrud
00649C C??? F???          M                 MOVFF   DTrudA,DTrud
0064A0 C??? F???          M                 MOVFF   (DTrudA+1),(DTrud+1)
                      00081                 MOVE    DTthtA,DTtht
0064A4 C??? F???          M                 MOVFF   DTthtA,DTtht
0064A8 C??? F???          M                 MOVFF   (DTthtA+1),(DTtht+1)
                      00082                 MOVEC   DTail,AXreg
0064AC 01??               M                 MOVLR   HIGH (AXreg)
0064AE 0E??               M                 MOVLW   LOW (DTail)
0064B0 6E??               M                 MOVWF   (AXreg)
0064B2 0E??               M                 MOVLW   HIGH (DTail)
0064B4 6E??               M                 MOVWF   (AXreg+1)
0064B6 0E08           00083                 MOVLW   8
0064B8 CFE8 F???      00084                 MOVFF   WREG,Areg
                      00085                 MOVEC   DTail,AXreg
0064BC 01??               M                 MOVLR   HIGH (AXreg)
0064BE 0E??               M                 MOVLW   LOW (DTail)
0064C0 6E??               M                 MOVWF   (AXreg)
0064C2 0E??               M                 MOVLW   HIGH (DTail)
0064C4 6E??               M                 MOVWF   (AXreg+1)
0064C6 EC?? F???      00086                 CALL    EEPROMwriteBlock
                      00087                 ; Save the aircraft number...
0064CA C??? FFE8      00088                 MOVFF   Aircraft,WREG
0064CE CFE8 F???      00089                 MOVFF   WREG,DefaultAircraft
0064D2 EC?? F???      00090                 CALL    SaveGeneral
0064D6 0012           00091                 RETURN
                      01600         Include <AftName.asm>
                      00001 ;
                      00002 ; This function is called from the calibration mode when the user 
                      00003 ; selects the edit aircraft name option.
                      00004 ; This function allows the pilot to change the Aircraft name using
                      00005 ; the Aielron stick to select the letter and the elevator stick to
                      00006 ; change the letter. The option key is pressed when the changes are
                      00007 ; complete.
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 336


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00008 ;
0064D8                00009 AircraftName
                      00010         ; Display the Name
                      00011                 CALLFL  LCDsendCMD,LINE2
0064D8 0EC0               M                 MOVLW   (LINE2)
0064DA EC?? F???          M                 CALL    (LCDsendCMD)
0064DE EC?? F???      00012                 CALL    DisplayAircraftName
                      00013         ; Init indirect register
0064E2 0E??           00014                 MOVLW   LOW Name
0064E4 6EE1           00015                 MOVWF   FSR1L,A
0064E6 0E??           00016                 MOVLW   HIGH Name
0064E8 6EE2           00017                 MOVWF   FSR1H,A
                      00018         ; Position the cursor and display the cursor char
0064EA                00019 CAN0
                      00020                 CALLFL  Delay1mS,D'150'
0064EA 0E96               M                 MOVLW   (D'150')
0064EC EC?? F???          M                 CALL    (Delay1mS)
0064F0 0E??           00021                 MOVLW   LOW Name
0064F2 08C0           00022                 SUBLW   LINE2
0064F4 24E1           00023                 ADDWF   FSR1L,W,A
0064F6 CFE8 F???      00024                 MOVFF   WREG,Areg
                      00025 ifdef           MicroProStar
                      00026         ; If the position is to the right of center then adjust the pointer
                      00027                 MOVLW   LINE2+7
                      00028                 CPFSGT  Areg,A
                      00029                 GOTO    ANok
                      00030                 ; Here is adjust address, add 38 hex to correct
                      00031                 MOVLW   38
                      00032                 ADDWF   Areg,W,A
                      00033                 MOVFF   WREG,Areg
                      00034 ANok
                      00035 endif
0064FA C??? FFE8      00036                 MOVFF   Areg,WREG
0064FE EC?? F???      00037                 CALL    LCDsendCMD                              ; Set the cursor position
006502 50E7           00038                 MOVF    INDF1,W,A                               
006504 EC?? F???      00039                 CALL    LCDsendData                             ; Write the char to the display
006508 C??? FFE8      00040                 MOVFF   Areg,WREG                               ; Reposition the cursor
00650C EC?? F???      00041                 CALL    LCDsendCMD
                      00042                 CALLFL  LCDsendCMD,CURSORON
006510 0E0E               M                 MOVLW   (CURSORON)
006512 EC?? F???          M                 CALL    (LCDsendCMD)
                      00043         ; Let the user make a selection
                      00044                 ; Aileron stick selects the character to edit
006516                00045 CANa
006516 EC?? F???      00046                 CALL    Aileron
00651A A4D8           00047                 BTFSS   ALUSTA,Z,A
00651C EF?? F???      00048                 GOTO    CAN1
006520 2AE1           00049                 INCF    FSR1L,F,A
006522 0E??           00050                 MOVLW   LOW (Name + D'15')
                      00051 ifdef ECMA1010display
                      00052                 MOVLW   LOW (Name + D'11')
                      00053 Endif
006524 64E1           00054                 CPFSGT  FSR1L,A
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 337


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

006526 EF?? F???      00055                 GOTO    CAN0
00652A 0E??           00056                 MOVLW   LOW Name                                ; Reset to start of line
00652C 6EE1           00057                 MOVWF   FSR1L,A
00652E EF?? F???      00058                 GOTO    CAN0
006532                00059 CAN1
006532 A0D8           00060                 BTFSS   ALUSTA,C,A
006534 EF?? F???      00061                 GOTO    CAN2
006538 06E1           00062                 DECF    FSR1L,F,A
00653A 0E??           00063                 MOVLW   LOW (Name - 1)
00653C 62E1           00064                 CPFSEQ  FSR1L,A
00653E EF?? F???      00065                 GOTO    CAN0
006542 0E??           00066                 MOVLW   LOW (Name + D'15')
                      00067 ifdef ECMA1010display
                      00068                 MOVLW   LOW (Name + D'11')
                      00069 Endif
006544 6EE1           00070                 MOVWF   FSR1L,A
006546 EF?? F???      00071                 GOTO    CAN0
                      00072 
00654A                00073 CAN2
                      00074                 ; Elevator stick changes the character value
00654A EC?? F???      00075                 CALL    Elevator
00654E A4D8           00076                 BTFSS   ALUSTA,Z,A
006550 EF?? F???      00077                 GOTO    CAN3
006554 2AE7           00078                 INCF    INDF1,F,A
006556 0E7A           00079                 MOVLW   'z'
006558 60E7           00080                 CPFSLT  INDF1,A
00655A 6EE7           00081                 MOVWF   INDF1,A
00655C EF?? F???      00082                 GOTO    CAN0
006560                00083 CAN3
006560 A0D8           00084                 BTFSS   ALUSTA,C,A
006562 EF?? F???      00085                 GOTO    CAN4
006566 06E7           00086                 DECF    INDF1,F,A
006568 0E20           00087                 MOVLW   ' '
00656A 64E7           00088                 CPFSGT  INDF1,A
00656C 6EE7           00089                 MOVWF   INDF1,A
00656E EF?? F???      00090                 GOTO    CAN0
                      00091 
006572                00092 CAN4
                      00093         ; Test for the option button
006572 EC?? F???      00094                 CALL    Option
006576 A0D8           00095                 BTFSS   ALUSTA,C
006578 EF?? F???      00096                 GOTO    CANa
                      00097         ; Save the name
                      00098                 CALLFL  LCDsendCMD,CURSOROFF
00657C 0E0C               M                 MOVLW   (CURSOROFF)
00657E EC?? F???          M                 CALL    (LCDsendCMD)
006582 C??? FFE8      00099                 MOVFF   Aircraft,WREG
006586 EC?? F???      00100                 CALL    SaveAircraft
00658A 0012           00101                 RETURN
                      01601         Include <Servo.asm>
                      00001 ; The following two functions are rounding functions used by the servo UI
                      00002 ; calibration routines. These routiens are called before the divide calls 
                      00003 ; in the Convert2Times and Convert2Gains functions. These routines add 1/2
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 338


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00004 ; the divisor to the dividend that is located in the CEXreg.
                      00005 ;
                      00006 ; Added Nov 29, 2009
00658C                00007 Round256
                      00008         ; Test the sign of CEXreg
00658C 01??           00009                 MOVLB   HIGH CEXreg
00658E BE??           00010                 BTFSC   CEXreg+3,7
006590 EF?? F???      00011                 GOTO    R256_1
                      00012         ; Here is CEX is positive
006594 0E80           00013                 MOVLW   LOW (D'128')
006596 26??           00014                 ADDWF   CEXreg,F
006598 0E00           00015                 MOVLW   0
00659A 22??           00016                 ADDWFC  CEXreg+1,F
00659C 22??           00017                 ADDWFC  CEXreg+2,F
00659E 22??           00018                 ADDWFC  CEXreg+3,F
0065A0 0012           00019                 RETURN
0065A2                00020 R256_1
                      00021         ; Here is CEX is negative                       
0065A2 0E80           00022                 MOVLW   LOW (D'128')
0065A4 5E??           00023                 SUBWF   CEXreg,F
0065A6 0E00           00024                 MOVLW   0
0065A8 5A??           00025                 SUBWFB  CEXreg+1,F
0065AA 5A??           00026                 SUBWFB  CEXreg+2,F
0065AC 5A??           00027                 SUBWFB  CEXreg+3,F
                      00028         ; Exit
0065AE 0012           00029                 RETURN
                      00030 
0065B0                00031 Round1000
                      00032         ; Test the sign of CEXreg
0065B0 01??           00033                 MOVLB   HIGH CEXreg
0065B2 BE??           00034                 BTFSC   CEXreg+3,7
0065B4 EF?? F???      00035                 GOTO    R1000_1
                      00036         ; Here is CEX is positive
0065B8 0EF4           00037                 MOVLW   LOW (D'500')
0065BA 26??           00038                 ADDWF   CEXreg,F
0065BC 0E01           00039                 MOVLW   HIGH (D'500')
0065BE 22??           00040                 ADDWFC  CEXreg+1,F
0065C0 0E00           00041                 MOVLW   0
0065C2 22??           00042                 ADDWFC  CEXreg+2,F
0065C4 22??           00043                 ADDWFC  CEXreg+3,F
0065C6 0012           00044                 RETURN
0065C8                00045 R1000_1
                      00046         ; Here is CEX is negative                       
0065C8 0E80           00047                 MOVLW   LOW (D'128')
0065CA 5E??           00048                 SUBWF   CEXreg,F
0065CC 0E00           00049                 MOVLW   0
0065CE 5A??           00050                 SUBWFB  CEXreg+1,F
0065D0 5A??           00051                 SUBWFB  CEXreg+2,F
0065D2 5A??           00052                 SUBWFB  CEXreg+3,F
                      00053         ; Exit
0065D4 0012           00054                 RETURN
                      00055 ; 
                      00056 ; This file contains the Servo User Interface Pre and Post functions. The 
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 339


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00057 ; Pre function is called before the selected user interface option is processed
                      00058 ; by the user interface routines and the Post function is called after the
                      00059 ; user interface routine returns. These funtions move the servo data into
                      00060 ; a generic area before the user adjust parameters and returns the data to
                      00061 ; the correct specific place when finished.
                      00062 ;
                      00063 ; This function is used to convert the normalized position data into time
                      00064 ; in units of .5 uSec. This is done using generic parameters. The caller
                      00065 ; fills the generic parameters with the channel specfic data.
                      00066 ;
                      00067 ; The following calculations are performed:
                      00068 ; CENTER = CENTER
                      00069 ; RTDWN = (1000 * G)/256 + CENTER
                      00070 ; LTUP = (-1000 * G)/256 + CENTER
                      00071 ;
0065D6                00072 Convert2Times
                      00073                 MOVE16  AXreg,AXregS
0065D6 C??? F???          M                 MOVFF   AXreg,AXregS
0065DA C??? F???          M                 MOVFF   (AXreg+1),(AXregS+1)
                      00074                 MOVE16  BXreg,BXregS
0065DE C??? F???          M                 MOVFF   BXreg,BXregS
0065E2 C??? F???          M                 MOVFF   (BXreg+1),(BXregS+1)
                      00075                 ; RT/DWN
                      00076                 MOVE16  RTDWN,AXreg
0065E6 C??? F???          M                 MOVFF   RTDWN,AXreg
0065EA C??? F???          M                 MOVFF   (RTDWN+1),(AXreg+1)
                      00077                 MOVEC   D'1000',BXreg
0065EE 01??               M                 MOVLR   HIGH (BXreg)
0065F0 0EE8               M                 MOVLW   LOW (D'1000')
0065F2 6E??               M                 MOVWF   (BXreg)
0065F4 0E03               M                 MOVLW   HIGH (D'1000')
0065F6 6E??               M                 MOVWF   (BXreg+1)
                      00078                 ; If the gain is negative, set the reverse servo flag
0065F8 6AE8           00079                 CLRF    WREG
0065FA BE??           00080                 BTFSC   AXreg+1,7
0065FC 68E8           00081                 SETF    WREG
0065FE CFE8 F???      00082                 MOVFF   WREG,ServoREV
006602 CFE8 F???      00083                 MOVFF   WREG,ServoREV+1         ; Need two copies to see if user makes a change
                      00084                 ; End of reverse flag code
006606 EC?? F???      00085                 CALL    Mult1616
00660A EC?? F???      00086                 CALL    Round256
                      00087                 MOVEC   D'256',DEXreg
00660E 01??               M                 MOVLR   HIGH (DEXreg)
006610 0E00               M                 MOVLW   LOW (D'256')
006612 6E??               M                 MOVWF   (DEXreg)
006614 0E01               M                 MOVLW   HIGH (D'256')
006616 6E??               M                 MOVWF   (DEXreg+1)
006618 EC?? F???      00088                 CALL    Divide2416
                      00089                 MOVE16  CEXreg,RTDWN
00661C C??? F???          M                 MOVFF   CEXreg,RTDWN
006620 C??? F???          M                 MOVFF   (CEXreg+1),(RTDWN+1)
006624 01??           00090                 MOVLB   HIGH RTDWN
006626 50??           00091                 MOVF    CENTER,W
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 340


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

006628 26??           00092                 ADDWF   RTDWN,F
00662A 50??           00093                 MOVF    CENTER+1,W
00662C 22??           00094                 ADDWFC  RTDWN+1,F
                      00095                 ; LF/UP
                      00096                 MOVE16  LTUP,AXreg
00662E C??? F???          M                 MOVFF   LTUP,AXreg
006632 C??? F???          M                 MOVFF   (LTUP+1),(AXreg+1)
                      00097                 MOVEC   D'1000',BXreg
006636 01??               M                 MOVLR   HIGH (BXreg)
006638 0EE8               M                 MOVLW   LOW (D'1000')
00663A 6E??               M                 MOVWF   (BXreg)
00663C 0E03               M                 MOVLW   HIGH (D'1000')
00663E 6E??               M                 MOVWF   (BXreg+1)
006640 EC?? F???      00098                 CALL    Mult1616
006644 EC?? F???      00099                 CALL    Round256
                      00100                 MOVEC   D'256',DEXreg
006648 01??               M                 MOVLR   HIGH (DEXreg)
00664A 0E00               M                 MOVLW   LOW (D'256')
00664C 6E??               M                 MOVWF   (DEXreg)
00664E 0E01               M                 MOVLW   HIGH (D'256')
006650 6E??               M                 MOVWF   (DEXreg+1)
006652 EC?? F???      00101                 CALL    Divide2416
                      00102                 MOVE16  CENTER,LTUP
006656 C??? F???          M                 MOVFF   CENTER,LTUP
00665A C??? F???          M                 MOVFF   (CENTER+1),(LTUP+1)
00665E 50??           00103                 MOVF    CEXreg,W
006660 5E??           00104                 SUBWF   LTUP,F
006662 50??           00105                 MOVF    CEXreg+1,W
006664 5A??           00106                 SUBWFB  LTUP+1,F
                      00107                 ; Limit test
                      00108                 MOVE16  RTDWN,AXreg
006666 C??? F???          M                 MOVFF   RTDWN,AXreg
00666A C??? F???          M                 MOVFF   (RTDWN+1),(AXreg+1)
00666E EC?? F???      00109                 CALL    ApplyLimit
                      00110                 MOVE16  AXreg,RTDWN
006672 C??? F???          M                 MOVFF   AXreg,RTDWN
006676 C??? F???          M                 MOVFF   (AXreg+1),(RTDWN+1)
                      00111                 MOVE16  CENTER,AXreg
00667A C??? F???          M                 MOVFF   CENTER,AXreg
00667E C??? F???          M                 MOVFF   (CENTER+1),(AXreg+1)
006682 EC?? F???      00112                 CALL    ApplyLimit
                      00113                 MOVE16  AXreg,CENTER
006686 C??? F???          M                 MOVFF   AXreg,CENTER
00668A C??? F???          M                 MOVFF   (AXreg+1),(CENTER+1)
                      00114                 MOVE16  LTUP,AXreg
00668E C??? F???          M                 MOVFF   LTUP,AXreg
006692 C??? F???          M                 MOVFF   (LTUP+1),(AXreg+1)
006696 EC?? F???      00115                 CALL    ApplyLimit
                      00116                 MOVE16  AXreg,LTUP
00669A C??? F???          M                 MOVFF   AXreg,LTUP
00669E C??? F???          M                 MOVFF   (AXreg+1),(LTUP+1)
                      00117                 ;
                      00118                 MOVE16  AXregS,AXreg
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 341


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

0066A2 C??? F???          M                 MOVFF   AXregS,AXreg
0066A6 C??? F???          M                 MOVFF   (AXregS+1),(AXreg+1)
                      00119                 MOVE16  BXregS,BXreg
0066AA C??? F???          M                 MOVFF   BXregS,BXreg
0066AE C??? F???          M                 MOVFF   (BXregS+1),(BXreg+1)
0066B2 0012           00120                 RETURN
                      00121 ; The following calculations are performed:
                      00122 ; RTDWN  = (1000 * RTDWN)/256 + CENTER
                      00123 ; CENTER = (-1000 * RTDWN)/256 + CENTER
0066B4                00124 Convert2TimesNC
                      00125                 MOVE16  AXreg,AXregS
0066B4 C??? F???          M                 MOVFF   AXreg,AXregS
0066B8 C??? F???          M                 MOVFF   (AXreg+1),(AXregS+1)
                      00126                 MOVE16  BXreg,BXregS
0066BC C??? F???          M                 MOVFF   BXreg,BXregS
0066C0 C??? F???          M                 MOVFF   (BXreg+1),(BXregS+1)
                      00127                 ; 
                      00128                 MOVE16  RTDWN,AXreg
0066C4 C??? F???          M                 MOVFF   RTDWN,AXreg
0066C8 C??? F???          M                 MOVFF   (RTDWN+1),(AXreg+1)
                      00129                 MOVEC   D'1000',BXreg
0066CC 01??               M                 MOVLR   HIGH (BXreg)
0066CE 0EE8               M                 MOVLW   LOW (D'1000')
0066D0 6E??               M                 MOVWF   (BXreg)
0066D2 0E03               M                 MOVLW   HIGH (D'1000')
0066D4 6E??               M                 MOVWF   (BXreg+1)
                      00130                 ; If the gain is negative, set the reverse servo flag
0066D6 6AE8           00131                 CLRF    WREG
0066D8 BE??           00132                 BTFSC   AXreg+1,7
0066DA 68E8           00133                 SETF    WREG
0066DC CFE8 F???      00134                 MOVFF   WREG,ServoREV
0066E0 CFE8 F???      00135                 MOVFF   WREG,ServoREV+1         ; Need two copies to see if user makes a change
                      00136                 ; End of reverse flag code
0066E4 EC?? F???      00137                 CALL    Mult1616
0066E8 EC?? F???      00138                 CALL    Round256
                      00139                 MOVEC   D'256',DEXreg
0066EC 01??               M                 MOVLR   HIGH (DEXreg)
0066EE 0E00               M                 MOVLW   LOW (D'256')
0066F0 6E??               M                 MOVWF   (DEXreg)
0066F2 0E01               M                 MOVLW   HIGH (D'256')
0066F4 6E??               M                 MOVWF   (DEXreg+1)
0066F6 EC?? F???      00140                 CALL    Divide2416
                      00141                 ; CEXreg = 1000*RTDWN/256
                      00142                 MOVE16  CENTER,RTDWN
0066FA C??? F???          M                 MOVFF   CENTER,RTDWN
0066FE C??? F???          M                 MOVFF   (CENTER+1),(RTDWN+1)
006702 01??           00143                 MOVLB   HIGH RTDWN
006704 50??           00144                 MOVF    CEXreg,W
006706 26??           00145                 ADDWF   RTDWN,F
006708 50??           00146                 MOVF    CEXreg+1,W
00670A 22??           00147                 ADDWFC  RTDWN+1,F
                      00148                 ;
00670C 50??           00149                 MOVF    CEXreg,W
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 342


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

00670E 5E??           00150                 SUBWF   CENTER,F
006710 50??           00151                 MOVF    CEXreg+1,W
006712 5A??           00152                 SUBWFB  CENTER+1,F
                      00153                 ; Limit test
                      00154                 MOVE16  RTDWN,AXreg
006714 C??? F???          M                 MOVFF   RTDWN,AXreg
006718 C??? F???          M                 MOVFF   (RTDWN+1),(AXreg+1)
00671C EC?? F???      00155                 CALL    ApplyLimit
                      00156                 MOVE16  AXreg,RTDWN
006720 C??? F???          M                 MOVFF   AXreg,RTDWN
006724 C??? F???          M                 MOVFF   (AXreg+1),(RTDWN+1)
                      00157                 MOVE16  CENTER,AXreg
006728 C??? F???          M                 MOVFF   CENTER,AXreg
00672C C??? F???          M                 MOVFF   (CENTER+1),(AXreg+1)
006730 EC?? F???      00158                 CALL    ApplyLimit
                      00159                 MOVE16  AXreg,CENTER
006734 C??? F???          M                 MOVFF   AXreg,CENTER
006738 C??? F???          M                 MOVFF   (AXreg+1),(CENTER+1)
                      00160                 ;
                      00161                 MOVE16  AXregS,AXreg
00673C C??? F???          M                 MOVFF   AXregS,AXreg
006740 C??? F???          M                 MOVFF   (AXregS+1),(AXreg+1)
                      00162                 MOVE16  BXregS,BXreg
006744 C??? F???          M                 MOVFF   BXregS,BXreg
006748 C??? F???          M                 MOVFF   (BXregS+1),(BXreg+1)
00674C 0012           00163                 RETURN
                      00164 
00674E                00165 Convert2Gains
                      00166         ; RTDWN = ((RTDWN - CENTER) * 256)/1000
                      00167         ; LTUP =  ((CENTER - LTUP) * 256)/1000
                      00168         ; CENTER = CENTER
                      00169                 ; RTDWN
                      00170                 MOVE16  AXreg,AXregS
00674E C??? F???          M                 MOVFF   AXreg,AXregS
006752 C??? F???          M                 MOVFF   (AXreg+1),(AXregS+1)
                      00171                 MOVE16  BXreg,BXregS
006756 C??? F???          M                 MOVFF   BXreg,BXregS
00675A C??? F???          M                 MOVFF   (BXreg+1),(BXregS+1)
                      00172                 MOVE16  RTDWN,AXreg
00675E C??? F???          M                 MOVFF   RTDWN,AXreg
006762 C??? F???          M                 MOVFF   (RTDWN+1),(AXreg+1)
006766 50??           00173                 MOVF    CENTER,W
006768 5E??           00174                 SUBWF   AXreg,F
00676A 50??           00175                 MOVF    CENTER+1,W
00676C 5A??           00176                 SUBWFB  AXreg+1,F
                      00177                 MOVEC   D'256',BXreg
00676E 01??               M                 MOVLR   HIGH (BXreg)
006770 0E00               M                 MOVLW   LOW (D'256')
006772 6E??               M                 MOVWF   (BXreg)
006774 0E01               M                 MOVLW   HIGH (D'256')
006776 6E??               M                 MOVWF   (BXreg+1)
006778 EC?? F???      00178                 CALL    Mult1616
00677C EC?? F???      00179                 CALL    Round1000
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 343


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00180                 MOVEC   D'1000',DEXreg
006780 01??               M                 MOVLR   HIGH (DEXreg)
006782 0EE8               M                 MOVLW   LOW (D'1000')
006784 6E??               M                 MOVWF   (DEXreg)
006786 0E03               M                 MOVLW   HIGH (D'1000')
006788 6E??               M                 MOVWF   (DEXreg+1)
00678A EC?? F???      00181                 CALL    Divide2416
                      00182                 MOVE16  CEXreg,RTDWN
00678E C??? F???          M                 MOVFF   CEXreg,RTDWN
006792 C??? F???          M                 MOVFF   (CEXreg+1),(RTDWN+1)
                      00183                 ; LTUP
                      00184                 MOVE16  CENTER,AXreg
006796 C??? F???          M                 MOVFF   CENTER,AXreg
00679A C??? F???          M                 MOVFF   (CENTER+1),(AXreg+1)
00679E 50??           00185                 MOVF    LTUP,W
0067A0 5E??           00186                 SUBWF   AXreg,F
0067A2 50??           00187                 MOVF    LTUP+1,W
0067A4 5A??           00188                 SUBWFB  AXreg+1,F
                      00189                 MOVEC   D'256',BXreg
0067A6 01??               M                 MOVLR   HIGH (BXreg)
0067A8 0E00               M                 MOVLW   LOW (D'256')
0067AA 6E??               M                 MOVWF   (BXreg)
0067AC 0E01               M                 MOVLW   HIGH (D'256')
0067AE 6E??               M                 MOVWF   (BXreg+1)
0067B0 EC?? F???      00190                 CALL    Mult1616
0067B4 EC?? F???      00191                 CALL    Round1000
                      00192                 MOVEC   D'1000',DEXreg
0067B8 01??               M                 MOVLR   HIGH (DEXreg)
0067BA 0EE8               M                 MOVLW   LOW (D'1000')
0067BC 6E??               M                 MOVWF   (DEXreg)
0067BE 0E03               M                 MOVLW   HIGH (D'1000')
0067C0 6E??               M                 MOVWF   (DEXreg+1)
0067C2 EC?? F???      00193                 CALL    Divide2416
                      00194                 MOVE16  CEXreg,LTUP
0067C6 C??? F???          M                 MOVFF   CEXreg,LTUP
0067CA C??? F???          M                 MOVFF   (CEXreg+1),(LTUP+1)
                      00195                 MOVE16  AXregS,AXreg
0067CE C??? F???          M                 MOVFF   AXregS,AXreg
0067D2 C??? F???          M                 MOVFF   (AXregS+1),(AXreg+1)
                      00196                 MOVE16  BXregS,BXreg
0067D6 C??? F???          M                 MOVFF   BXregS,BXreg
0067DA C??? F???          M                 MOVFF   (BXregS+1),(BXreg+1)
0067DE 0012           00197                 RETURN
0067E0                00198 Convert2GainsNC
                      00199         ; RTDWN = ((RTDWN - CENTER) * 256)/2000
                      00200         ; CENTER = CENTER + (1000*RTDWN)/256
                      00201                 MOVE16  AXreg,AXregS
0067E0 C??? F???          M                 MOVFF   AXreg,AXregS
0067E4 C??? F???          M                 MOVFF   (AXreg+1),(AXregS+1)
                      00202                 MOVE16  BXreg,BXregS
0067E8 C??? F???          M                 MOVFF   BXreg,BXregS
0067EC C??? F???          M                 MOVFF   (BXreg+1),(BXregS+1)
                      00203                 MOVE16  RTDWN,AXreg
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 344


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

0067F0 C??? F???          M                 MOVFF   RTDWN,AXreg
0067F4 C??? F???          M                 MOVFF   (RTDWN+1),(AXreg+1)
0067F8 01??           00204                 MOVLB   HIGH CENTER
0067FA 50??           00205                 MOVF    CENTER,W
0067FC 5E??           00206                 SUBWF   AXreg,F
0067FE 50??           00207                 MOVF    CENTER+1,W
006800 5A??           00208                 SUBWFB  AXreg+1,F
                      00209                 MOVEC   D'256',BXreg
006802 01??               M                 MOVLR   HIGH (BXreg)
006804 0E00               M                 MOVLW   LOW (D'256')
006806 6E??               M                 MOVWF   (BXreg)
006808 0E01               M                 MOVLW   HIGH (D'256')
00680A 6E??               M                 MOVWF   (BXreg+1)
00680C EC?? F???      00210                 CALL    Mult1616
006810 EC?? F???      00211                 CALL    Round1000
006814 EC?? F???      00212                 CALL    Round1000
                      00213                 MOVEC   D'2000',DEXreg
006818 01??               M                 MOVLR   HIGH (DEXreg)
00681A 0ED0               M                 MOVLW   LOW (D'2000')
00681C 6E??               M                 MOVWF   (DEXreg)
00681E 0E07               M                 MOVLW   HIGH (D'2000')
006820 6E??               M                 MOVWF   (DEXreg+1)
006822 EC?? F???      00214                 CALL    Divide2416
                      00215                 MOVE16  CEXreg,RTDWN
006826 C??? F???          M                 MOVFF   CEXreg,RTDWN
00682A C??? F???          M                 MOVFF   (CEXreg+1),(RTDWN+1)
                      00216                 ;
                      00217                 MOVE16  RTDWN,AXreg
00682E C??? F???          M                 MOVFF   RTDWN,AXreg
006832 C??? F???          M                 MOVFF   (RTDWN+1),(AXreg+1)
                      00218                 MOVEC   D'1000',BXreg
006836 01??               M                 MOVLR   HIGH (BXreg)
006838 0EE8               M                 MOVLW   LOW (D'1000')
00683A 6E??               M                 MOVWF   (BXreg)
00683C 0E03               M                 MOVLW   HIGH (D'1000')
00683E 6E??               M                 MOVWF   (BXreg+1)
006840 EC?? F???      00219                 CALL    Mult1616
006844 EC?? F???      00220                 CALL    Round256
                      00221                 MOVEC   D'256',DEXreg
006848 01??               M                 MOVLR   HIGH (DEXreg)
00684A 0E00               M                 MOVLW   LOW (D'256')
00684C 6E??               M                 MOVWF   (DEXreg)
00684E 0E01               M                 MOVLW   HIGH (D'256')
006850 6E??               M                 MOVWF   (DEXreg+1)
006852 EC?? F???      00222                 CALL    Divide2416
006856 01??           00223                 MOVLB   HIGH CENTER
006858 50??           00224                 MOVF    CEXreg,W
00685A 26??           00225                 ADDWF   CENTER,F
00685C 50??           00226                 MOVF    CEXreg+1,W
00685E 22??           00227                 ADDWFC  CENTER+1,F
                      00228                 ;
                      00229                 MOVE16  AXregS,AXreg
006860 C??? F???          M                 MOVFF   AXregS,AXreg
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 345


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

006864 C??? F???          M                 MOVFF   (AXregS+1),(AXreg+1)
                      00230                 MOVE16  BXregS,BXreg
006868 C??? F???          M                 MOVFF   BXregS,BXreg
00686C C??? F???          M                 MOVFF   (BXregS+1),(BXreg+1)
006870 0012           00231                 RETURN
                      00232 
                      00233 ; If Auto Trim button was pressed and we were adjusting 
                      00234 ; a servo limit, then apply it to the other limit, with
                      00235 ; equal extent...
006872                00236 ApplySymSet     
                      00237                 MOVE16  AXreg,AXregS
006872 C??? F???          M                 MOVFF   AXreg,AXregS
006876 C??? F???          M                 MOVFF   (AXreg+1),(AXregS+1)
                      00238                 MOVE16  BXreg,BXregS
00687A C??? F???          M                 MOVFF   BXreg,BXregS
00687E C??? F???          M                 MOVFF   (BXreg+1),(BXregS+1)
006882 01??           00239                 MOVLB   HIGH SymSet
006884 A0??           00240                 BTFSS   SymSet,0
006886 EF?? F???      00241                 GOTO    NoAT
                      00242                 ; Here if the Auto Trim button was set, BXreg points to the var
                      00243                 ; of intrest.
                      00244                 ; Does BXreg point to RTDWN, if so LTUP = 2*CENTER - RTDWN
00688A 0E??           00245                 MOVLW   HIGH RTDWN
00688C 01??           00246                 MOVLB   HIGH BXreg
00688E 18??           00247                 XORWF   BXreg,W
006890 B4D8           00248                 BTFSC   ALUSTA,Z,A
006892 EF?? F???      00249                 GOTO    NotRTDWN
                      00250                 ; Here if its RTDWN
                      00251                 MOVE16  CENTER,CEXreg
006896 C??? F???          M                 MOVFF   CENTER,CEXreg
00689A C??? F???          M                 MOVFF   (CENTER+1),(CEXreg+1)
00689E 90D8           00252                 BCF     ALUSTA,C,A
0068A0 36??           00253                 RLCF    CEXreg
0068A2 36??           00254                 RLCF    CEXreg+1
0068A4 50??           00255                 MOVF    RTDWN,W
0068A6 5E??           00256                 SUBWF   CEXreg
0068A8 50??           00257                 MOVF    RTDWN+1,W
0068AA 5A??           00258                 SUBWFB  CEXreg+1
                      00259                 MOVE16  CEXreg,LTUP
0068AC C??? F???          M                 MOVFF   CEXreg,LTUP
0068B0 C??? F???          M                 MOVFF   (CEXreg+1),(LTUP+1)
0068B4 EF?? F???      00260                 GOTO    NoAT
                      00261                 ; Does BXreg point to LTUP, if so RTDWN = 2*CENTER - LTUP
0068B8                00262 NotRTDWN
0068B8 0E??           00263                 MOVLW   HIGH LTUP
0068BA 01??           00264                 MOVLB   HIGH BXreg
0068BC 18??           00265                 XORWF   BXreg,W
0068BE B4D8           00266                 BTFSC   ALUSTA,Z,A
0068C0 EF?? F???      00267                 GOTO    NoAT
                      00268                 ; Here if its RTDWN
                      00269                 MOVE16  CENTER,CEXreg
0068C4 C??? F???          M                 MOVFF   CENTER,CEXreg
0068C8 C??? F???          M                 MOVFF   (CENTER+1),(CEXreg+1)
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 346


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

0068CC 90D8           00270                 BCF     ALUSTA,C,A
0068CE 36??           00271                 RLCF    CEXreg
0068D0 36??           00272                 RLCF    CEXreg+1
0068D2 50??           00273                 MOVF    LTUP,W
0068D4 5E??           00274                 SUBWF   CEXreg
0068D6 50??           00275                 MOVF    LTUP+1,W
0068D8 5A??           00276                 SUBWFB  CEXreg+1
                      00277                 MOVE16  CEXreg,RTDWN
0068DA C??? F???          M                 MOVFF   CEXreg,RTDWN
0068DE C??? F???          M                 MOVFF   (CEXreg+1),(RTDWN+1)
                      00278                 ; Test the exit flag
0068E2                00279 NoAT
                      00280                 MOVE16  AXregS,AXreg
0068E2 C??? F???          M                 MOVFF   AXregS,AXreg
0068E6 C??? F???          M                 MOVFF   (AXregS+1),(AXreg+1)
                      00281                 MOVE16  BXregS,BXreg
0068EA C??? F???          M                 MOVFF   BXregS,BXreg
0068EE C??? F???          M                 MOVFF   (BXregS+1),(BXreg+1)
0068F2 0012           00282                 RETURN
                      00283 
                      00284 
0068F4                00285 AilPre
                      00286         ; Move the Aileron servo parameters into the general area
                      00287         ; and convert gains into positions in uS
0068F4 0E??           00288                 MOVLW   chAIL
0068F6 01??           00289                 MOVLB   HIGH DriveCh
0068F8 6E??           00290                 MOVWF   DriveCh
                      00291                 MOVEC   AM1H,Src
0068FA 01??               M                 MOVLR   HIGH (Src)
0068FC 0E??               M                 MOVLW   LOW (AM1H)
0068FE 6E??               M                 MOVWF   (Src)
006900 0E??               M                 MOVLW   HIGH (AM1H)
006902 6E??               M                 MOVWF   (Src+1)
006904                00292 AERPre  ; This is a common entry point for the Aileron Elevetor and Rudder Pre
                      00293         ; routines
                      00294                 MOVEC   RTDWN,Dst
006904 01??               M                 MOVLR   HIGH (Dst)
006906 0E??               M                 MOVLW   LOW (RTDWN)
006908 6E??               M                 MOVWF   (Dst)
00690A 0E??               M                 MOVLW   HIGH (RTDWN)
00690C 6E??               M                 MOVWF   (Dst+1)
00690E 0E0B           00295                 MOVLW   D'11'
006910 6E??           00296                 MOVWF   Cnt
006912 EC?? F???      00297                 CALL    BlkMove
006916 6A??           00298                 CLRF    ATRST
                      00299         ; Convert into times
006918 EC?? F???      00300                 CALL    Convert2Times
00691C 0012           00301                 RETURN
00691E                00302 ElePre
00691E 0E??           00303                 MOVLW   chELE
006920 01??           00304                 MOVLB   HIGH DriveCh
006922 6E??           00305                 MOVWF   DriveCh
                      00306                 MOVEC   EM1H,Src
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 347


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

006924 01??               M                 MOVLR   HIGH (Src)
006926 0E??               M                 MOVLW   LOW (EM1H)
006928 6E??               M                 MOVWF   (Src)
00692A 0E??               M                 MOVLW   HIGH (EM1H)
00692C 6E??               M                 MOVWF   (Src+1)
00692E EF?? F???      00307                 GOTO    AERPre
006932                00308 RudPre
006932 0E??           00309                 MOVLW   chRUD
006934 01??           00310                 MOVLB   HIGH DriveCh
006936 6E??           00311                 MOVWF   DriveCh
                      00312                 MOVEC   RM1H,Src
006938 01??               M                 MOVLR   HIGH (Src)
00693A 0E??               M                 MOVLW   LOW (RM1H)
00693C 6E??               M                 MOVWF   (Src)
00693E 0E??               M                 MOVLW   HIGH (RM1H)
006940 6E??               M                 MOVWF   (Src+1)
006942 EF?? F???      00313                 GOTO    AERPre
                      00314 
006946                00315 AilPost
                      00316                 MOVEC   AM1H,Dst
006946 01??               M                 MOVLR   HIGH (Dst)
006948 0E??               M                 MOVLW   LOW (AM1H)
00694A 6E??               M                 MOVWF   (Dst)
00694C 0E??               M                 MOVLW   HIGH (AM1H)
00694E 6E??               M                 MOVWF   (Dst+1)
006950                00317 AERPost ; This is a common entry point for the Aileron Elevetor and Rudder Post
                      00318         ; routines
                      00319         ; Apply the Symertical set routine
006950 EC?? F???      00320                 CALL    ApplySymSet
                      00321         ; Test for autotrim reset
006954 B0??           00322                 BTFSC   ATRST,0
006956 6A??           00323                 CLRF    ATRM
                      00324         ; Now convert back to the radios units
006958 EC?? F???      00325                 CALL    Convert2Gains
                      00326         ; Move the results back
                      00327                 MOVEC   RTDWN,Src
00695C 01??               M                 MOVLR   HIGH (Src)
00695E 0E??               M                 MOVLW   LOW (RTDWN)
006960 6E??               M                 MOVWF   (Src)
006962 0E??               M                 MOVLW   HIGH (RTDWN)
006964 6E??               M                 MOVWF   (Src+1)
006966 0E0B           00328                 MOVLW   D'11'
006968 6E??           00329                 MOVWF   Cnt
00696A EC?? F???      00330                 CALL    BlkMove
                      00331         ; Clear the Drive Channel value
00696E 01??           00332                 MOVLB   HIGH DriveCh
006970 6A??           00333                 CLRF    DriveCh
006972 0012           00334                 RETURN
                      00335                 
006974                00336 ElePost
                      00337                 MOVEC   EM1H,Dst
006974 01??               M                 MOVLR   HIGH (Dst)
006976 0E??               M                 MOVLW   LOW (EM1H)
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 348


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

006978 6E??               M                 MOVWF   (Dst)
00697A 0E??               M                 MOVLW   HIGH (EM1H)
00697C 6E??               M                 MOVWF   (Dst+1)
00697E EF?? F???      00338                 GOTO    AERPost
                      00339 
006982                00340 RudPost
                      00341                 MOVEC   RM1H,Dst
006982 01??               M                 MOVLR   HIGH (Dst)
006984 0E??               M                 MOVLW   LOW (RM1H)
006986 6E??               M                 MOVWF   (Dst)
006988 0E??               M                 MOVLW   HIGH (RM1H)
00698A 6E??               M                 MOVWF   (Dst+1)
00698C EF?? F???      00342                 GOTO    AERPost
                      00343 
006990                00344 ThtPre
                      00345         ; Save registers
                      00346                 MOVE16  AXreg,AXregS
006990 C??? F???          M                 MOVFF   AXreg,AXregS
006994 C??? F???          M                 MOVFF   (AXreg+1),(AXregS+1)
                      00347                 MOVE16  BXreg,BXregS
006998 C??? F???          M                 MOVFF   BXreg,BXregS
00699C C??? F???          M                 MOVFF   (BXreg+1),(BXregS+1)
                      00348         ; Convert all of the throttle parameters into uS
0069A0 01??           00349                 MOVLB   HIGH TBH
                      00350                 ; High
                      00351                 MOVE16  TMH,AXreg
0069A2 C??? F???          M                 MOVFF   TMH,AXreg
0069A6 C??? F???          M                 MOVFF   (TMH+1),(AXreg+1)
                      00352                 MOVEC   D'1000',BXreg
0069AA 01??               M                 MOVLR   HIGH (BXreg)
0069AC 0EE8               M                 MOVLW   LOW (D'1000')
0069AE 6E??               M                 MOVWF   (BXreg)
0069B0 0E03               M                 MOVLW   HIGH (D'1000')
0069B2 6E??               M                 MOVWF   (BXreg+1)
                      00353                 ; If the gain is negative, set the reverse servo flag
0069B4 6AE8           00354                 CLRF    WREG
0069B6 BE??           00355                 BTFSC   AXreg+1,7
0069B8 68E8           00356                 SETF    WREG
0069BA CFE8 F???      00357                 MOVFF   WREG,ServoREV
0069BE CFE8 F???      00358                 MOVFF   WREG,ServoREV+1         ; Need two copies to see if user makes a change
                      00359                 ; End of reverse flag code
0069C2 EC?? F???      00360                 CALL    Mult1616
0069C6 EC?? F???      00361                 CALL    Round256
                      00362                 MOVEC   D'256',DEXreg
0069CA 01??               M                 MOVLR   HIGH (DEXreg)
0069CC 0E00               M                 MOVLW   LOW (D'256')
0069CE 6E??               M                 MOVWF   (DEXreg)
0069D0 0E01               M                 MOVLW   HIGH (D'256')
0069D2 6E??               M                 MOVWF   (DEXreg+1)
0069D4 EC?? F???      00363                 CALL    Divide2416
                      00364                 MOVE16  CEXreg,TMH
0069D8 C??? F???          M                 MOVFF   CEXreg,TMH
0069DC C??? F???          M                 MOVFF   (CEXreg+1),(TMH+1)
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 349


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

0069E0 01??           00365                 MOVLB   HIGH TBH
0069E2 50??           00366                 MOVF    TBH,W
0069E4 26??           00367                 ADDWF   TMH,F
0069E6 50??           00368                 MOVF    TBH+1,W
0069E8 22??           00369                 ADDWFC  TMH+1,F
                      00370         ; Restore registers
                      00371                 MOVE16  AXregS,AXreg
0069EA C??? F???          M                 MOVFF   AXregS,AXreg
0069EE C??? F???          M                 MOVFF   (AXregS+1),(AXreg+1)
                      00372                 MOVE16  BXregS,BXreg
0069F2 C??? F???          M                 MOVFF   BXregS,BXreg
0069F6 C??? F???          M                 MOVFF   (BXregS+1),(BXreg+1)
0069FA 0012           00373                 RETURN
                      00374 
0069FC                00375 ThtPost
                      00376         ; Save registers
                      00377                 MOVE16  AXreg,AXregS
0069FC C??? F???          M                 MOVFF   AXreg,AXregS
006A00 C??? F???          M                 MOVFF   (AXreg+1),(AXregS+1)
                      00378                 MOVE16  BXreg,BXregS
006A04 C??? F???          M                 MOVFF   BXreg,BXregS
006A08 C??? F???          M                 MOVFF   (BXreg+1),(BXregS+1)
                      00379         ; Restore the throttle parameters
                      00380                 ; High
                      00381                 MOVE16  TMH,AXreg
006A0C C??? F???          M                 MOVFF   TMH,AXreg
006A10 C??? F???          M                 MOVFF   (TMH+1),(AXreg+1)
006A14 01??           00382                 MOVLB   HIGH TMH
006A16 50??           00383                 MOVF    TBH,W
006A18 01??           00384                 MOVLB   HIGH AXreg
006A1A 5E??           00385                 SUBWF   AXreg,F
006A1C 01??           00386                 MOVLB   HIGH TMH
006A1E 50??           00387                 MOVF    TBH+1,W
006A20 01??           00388                 MOVLB   HIGH AXreg
006A22 5A??           00389                 SUBWFB  AXreg+1,F
                      00390                 MOVEC   D'256',BXreg
006A24 01??               M                 MOVLR   HIGH (BXreg)
006A26 0E00               M                 MOVLW   LOW (D'256')
006A28 6E??               M                 MOVWF   (BXreg)
006A2A 0E01               M                 MOVLW   HIGH (D'256')
006A2C 6E??               M                 MOVWF   (BXreg+1)
006A2E EC?? F???      00391                 CALL    Mult1616
006A32 EC?? F???      00392                 CALL    Round1000
                      00393                 MOVEC   D'1000',DEXreg
006A36 01??               M                 MOVLR   HIGH (DEXreg)
006A38 0EE8               M                 MOVLW   LOW (D'1000')
006A3A 6E??               M                 MOVWF   (DEXreg)
006A3C 0E03               M                 MOVLW   HIGH (D'1000')
006A3E 6E??               M                 MOVWF   (DEXreg+1)
006A40 EC?? F???      00394                 CALL    Divide2416
                      00395                 MOVE16  CEXreg,TMH
006A44 C??? F???          M                 MOVFF   CEXreg,TMH
006A48 C??? F???          M                 MOVFF   (CEXreg+1),(TMH+1)
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 350


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00396         ; Restore registers
                      00397                 MOVE16  AXregS,AXreg
006A4C C??? F???          M                 MOVFF   AXregS,AXreg
006A50 C??? F???          M                 MOVFF   (AXregS+1),(AXreg+1)
                      00398                 MOVE16  BXregS,BXreg
006A54 C??? F???          M                 MOVFF   BXregS,BXreg
006A58 C??? F???          M                 MOVFF   (BXregS+1),(BXreg+1)
                      00399         ; Clear the Drive Channel value
006A5C 01??           00400                 MOVLB   HIGH DriveCh
006A5E 6A??           00401                 CLRF    DriveCh
006A60 0012           00402                 RETURN
                      00403 
006A62                00404 CH5Pre
006A62 0E??           00405                 MOVLW   chCH5
006A64 01??           00406                 MOVLB   HIGH DriveCh
006A66 6E??           00407                 MOVWF   DriveCh
                      00408         ; Move the CH5 servo parameters into the general area
                      00409         ; and convert gains into positions in uS
                      00410                 MOVEC   CH5MH,Src
006A68 01??               M                 MOVLR   HIGH (Src)
006A6A 0E??               M                 MOVLW   LOW (CH5MH)
006A6C 6E??               M                 MOVWF   (Src)
006A6E 0E??               M                 MOVLW   HIGH (CH5MH)
006A70 6E??               M                 MOVWF   (Src+1)
006A72                00411 CH567Pre
                      00412                 MOVEC   RTDWN,Dst
006A72 01??               M                 MOVLR   HIGH (Dst)
006A74 0E??               M                 MOVLW   LOW (RTDWN)
006A76 6E??               M                 MOVWF   (Dst)
006A78 0E??               M                 MOVLW   HIGH (RTDWN)
006A7A 6E??               M                 MOVWF   (Dst+1)
006A7C 0E04           00413                 MOVLW   4
006A7E 6E??           00414                 MOVWF   Cnt
006A80 EC?? F???      00415                 CALL    BlkMove
                      00416         ; Convert into times, as follows
006A84 EC?? F???      00417                 CALL    Convert2TimesNC
006A88 0012           00418                 RETURN
006A8A                00419 CH6Pre
006A8A 0E??           00420                 MOVLW   chCH6
006A8C 01??           00421                 MOVLB   HIGH DriveCh
006A8E 6E??           00422                 MOVWF   DriveCh
                      00423                 MOVEC   CH6MH,Src
006A90 01??               M                 MOVLR   HIGH (Src)
006A92 0E??               M                 MOVLW   LOW (CH6MH)
006A94 6E??               M                 MOVWF   (Src)
006A96 0E??               M                 MOVLW   HIGH (CH6MH)
006A98 6E??               M                 MOVWF   (Src+1)
006A9A EF?? F???      00424                 GOTO    CH567Pre
006A9E                00425 CH7Pre
006A9E 0E??           00426                 MOVLW   chCH7
006AA0 01??           00427                 MOVLB   HIGH DriveCh
006AA2 6E??           00428                 MOVWF   DriveCh
                      00429                 MOVEC   CH7MH,Src
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 351


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

006AA4 01??               M                 MOVLR   HIGH (Src)
006AA6 0E??               M                 MOVLW   LOW (CH7MH)
006AA8 6E??               M                 MOVWF   (Src)
006AAA 0E??               M                 MOVLW   HIGH (CH7MH)
006AAC 6E??               M                 MOVWF   (Src+1)
006AAE EF?? F???      00430                 GOTO    CH567Pre
                      00431                 
006AB2                00432 CH5Post
                      00433                 MOVEC   CH5MH,Dst
006AB2 01??               M                 MOVLR   HIGH (Dst)
006AB4 0E??               M                 MOVLW   LOW (CH5MH)
006AB6 6E??               M                 MOVWF   (Dst)
006AB8 0E??               M                 MOVLW   HIGH (CH5MH)
006ABA 6E??               M                 MOVWF   (Dst+1)
006ABC                00434 CH567Post
                      00435         ; Convert back to the radios units
006ABC EC?? F???      00436                 CALL    Convert2GainsNC
                      00437         ; Move the results back
                      00438                 MOVEC   RTDWN,Src
006AC0 01??               M                 MOVLR   HIGH (Src)
006AC2 0E??               M                 MOVLW   LOW (RTDWN)
006AC4 6E??               M                 MOVWF   (Src)
006AC6 0E??               M                 MOVLW   HIGH (RTDWN)
006AC8 6E??               M                 MOVWF   (Src+1)
006ACA 0E04           00439                 MOVLW   4
006ACC 6E??           00440                 MOVWF   Cnt
006ACE EC?? F???      00441                 CALL    BlkMove
                      00442         ; Clear the Drive Channel value
006AD2 01??           00443                 MOVLB   HIGH DriveCh
006AD4 6A??           00444                 CLRF    DriveCh
006AD6 0012           00445                 RETURN
006AD8                00446 CH6Post
                      00447                 MOVEC   CH6MH,Dst
006AD8 01??               M                 MOVLR   HIGH (Dst)
006ADA 0E??               M                 MOVLW   LOW (CH6MH)
006ADC 6E??               M                 MOVWF   (Dst)
006ADE 0E??               M                 MOVLW   HIGH (CH6MH)
006AE0 6E??               M                 MOVWF   (Dst+1)
006AE2 EF?? F???      00448                 GOTO    CH567Post
006AE6                00449 CH7Post
                      00450                 MOVEC   CH7MH,Dst
006AE6 01??               M                 MOVLR   HIGH (Dst)
006AE8 0E??               M                 MOVLW   LOW (CH7MH)
006AEA 6E??               M                 MOVWF   (Dst)
006AEC 0E??               M                 MOVLW   HIGH (CH7MH)
006AEE 6E??               M                 MOVWF   (Dst+1)
006AF0 EF?? F???      00451                 GOTO    CH567Post
006AF4                00452 CH8Pre
                      00453         ; Move the selected servo parameters into the general area
                      00454         ; and convert gains into positions in uS
                      00455                 MOVEC   CH8_A,Src
006AF4 01??               M                 MOVLR   HIGH (Src)
006AF6 0E??               M                 MOVLW   LOW (CH8_A)
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 352


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

006AF8 6E??               M                 MOVWF   (Src)
006AFA 0E??               M                 MOVLW   HIGH (CH8_A)
006AFC 6E??               M                 MOVWF   (Src+1)
                      00456                 MOVEC   RTDWN,Dst
006AFE 01??               M                 MOVLR   HIGH (Dst)
006B00 0E??               M                 MOVLW   LOW (RTDWN)
006B02 6E??               M                 MOVWF   (Dst)
006B04 0E??               M                 MOVLW   HIGH (RTDWN)
006B06 6E??               M                 MOVWF   (Dst+1)
006B08 0E06           00457                 MOVLW   6
006B0A 6E??           00458                 MOVWF   Cnt
006B0C EC?? F???      00459                 CALL    BlkMove
                      00460         ; Convert into times, as follows
006B10 EC?? F???      00461                 CALL    Convert2Times
006B14 0012           00462                 RETURN
006B16                00463 CH8Post
                      00464         ; Now convert back to the radios units
006B16 EC?? F???      00465                 CALL    Convert2Gains
                      00466         ; Move the results back
                      00467                 MOVEC   RTDWN,Src
006B1A 01??               M                 MOVLR   HIGH (Src)
006B1C 0E??               M                 MOVLW   LOW (RTDWN)
006B1E 6E??               M                 MOVWF   (Src)
006B20 0E??               M                 MOVLW   HIGH (RTDWN)
006B22 6E??               M                 MOVWF   (Src+1)
                      00468                 MOVEC   CH8_A,Dst
006B24 01??               M                 MOVLR   HIGH (Dst)
006B26 0E??               M                 MOVLW   LOW (CH8_A)
006B28 6E??               M                 MOVWF   (Dst)
006B2A 0E??               M                 MOVLW   HIGH (CH8_A)
006B2C 6E??               M                 MOVWF   (Dst+1)
006B2E 0E06           00469                 MOVLW   6
006B30 6E??           00470                 MOVWF   Cnt
006B32 EC?? F???      00471                 CALL    BlkMove
                      00472         ; Clear the Drive Channel value
006B36 01??           00473                 MOVLB   HIGH DriveCh
006B38 6A??           00474                 CLRF    DriveCh
006B3A 0012           00475                 RETURN
                      00476 
                      00477 ; This function moves the servo limits to the min and max values
                      00478 ; used by the user interface input routines
006B3C                00479 SerLim
                      00480                 MOVE16  ServoMin,MinTime
006B3C C??? F???          M                 MOVFF   ServoMin,MinTime
006B40 C??? F???          M                 MOVFF   (ServoMin+1),(MinTime+1)
                      00481                 MOVE16  ServoMax,MaxTime
006B44 C??? F???          M                 MOVFF   ServoMax,MaxTime
006B48 C??? F???          M                 MOVFF   (ServoMax+1),(MaxTime+1)
006B4C 0012           00482                 RETURN
                      00483 
                      00484 
                      00485 ;
                      00486 ; The following routines are used for the servo direction reverse function.
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 353


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00487 ;
006B4E                00488 SrevCPost
                      00489                 MOVE16  AXreg,AXregS
006B4E C??? F???          M                 MOVFF   AXreg,AXregS
006B52 C??? F???          M                 MOVFF   (AXreg+1),(AXregS+1)
                      00490                 MOVE16  BXreg,BXregS
006B56 C??? F???          M                 MOVFF   BXreg,BXregS
006B5A C??? F???          M                 MOVFF   (BXreg+1),(BXregS+1)
                      00491                 ; If the ServoREV flags do not match then the user has made a change so
                      00492                 ; reverse the position limits before proceeding
006B5E 01??           00493                 MOVLB   HIGH ServoREV
006B60 C??? FFE8      00494                 MOVFF   ServoREV,WREG
006B64 1A??           00495                 XORWF   ServoREV+1
006B66 E0??           00496                 BZ      SCP_RevDone
                      00497                 MOVE16  RTDWN,AXreg
006B68 C??? F???          M                 MOVFF   RTDWN,AXreg
006B6C C??? F???          M                 MOVFF   (RTDWN+1),(AXreg+1)
                      00498                 MOVE16  LTUP,RTDWN
006B70 C??? F???          M                 MOVFF   LTUP,RTDWN
006B74 C??? F???          M                 MOVFF   (LTUP+1),(RTDWN+1)
                      00499                 MOVE16  AXreg,LTUP
006B78 C??? F???          M                 MOVFF   AXreg,LTUP
006B7C C??? F???          M                 MOVFF   (AXreg+1),(LTUP+1)
006B80                00500 SCP_RevDone     
006B80 C??? FFE8      00501                 MOVFF   ServoREV,WREG
006B84 CFE8 F???      00502                 MOVFF   WREG,ServoREV+1
                      00503                 ; End of servo reverse code
                      00504                 MOVE16  AXregS,AXreg
006B88 C??? F???          M                 MOVFF   AXregS,AXreg
006B8C C??? F???          M                 MOVFF   (AXregS+1),(AXreg+1)
                      00505                 MOVE16  BXregS,BXreg
006B90 C??? F???          M                 MOVFF   BXregS,BXreg
006B94 C??? F???          M                 MOVFF   (BXregS+1),(BXreg+1)
006B98 0012           00506                 RETURN
                      00507 
006B9A                00508 SrevNCPost
                      00509                 MOVE16  AXreg,AXregS
006B9A C??? F???          M                 MOVFF   AXreg,AXregS
006B9E C??? F???          M                 MOVFF   (AXreg+1),(AXregS+1)
                      00510                 MOVE16  BXreg,BXregS
006BA2 C??? F???          M                 MOVFF   BXreg,BXregS
006BA6 C??? F???          M                 MOVFF   (BXreg+1),(BXregS+1)
                      00511                 ; If the ServoREV flags do not match then the user has made a change so
                      00512                 ; reverse the position limits before proceeding
006BAA 01??           00513                 MOVLB   HIGH ServoREV
006BAC C??? FFE8      00514                 MOVFF   ServoREV,WREG
006BB0 1A??           00515                 XORWF   ServoREV+1
006BB2 E0??           00516                 BZ      SNCP_RevDone
                      00517                 MOVE16  RTDWN,AXreg
006BB4 C??? F???          M                 MOVFF   RTDWN,AXreg
006BB8 C??? F???          M                 MOVFF   (RTDWN+1),(AXreg+1)
                      00518                 MOVE16  CENTER,RTDWN
006BBC C??? F???          M                 MOVFF   CENTER,RTDWN
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 354


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

006BC0 C??? F???          M                 MOVFF   (CENTER+1),(RTDWN+1)
                      00519                 MOVE16  AXreg,CENTER
006BC4 C??? F???          M                 MOVFF   AXreg,CENTER
006BC8 C??? F???          M                 MOVFF   (AXreg+1),(CENTER+1)
006BCC                00520 SNCP_RevDone    
006BCC C??? FFE8      00521                 MOVFF   ServoREV,WREG
006BD0 CFE8 F???      00522                 MOVFF   WREG,ServoREV+1
                      00523                 ; End of servo reverse code
                      00524                 MOVE16  AXregS,AXreg
006BD4 C??? F???          M                 MOVFF   AXregS,AXreg
006BD8 C??? F???          M                 MOVFF   (AXregS+1),(AXreg+1)
                      00525                 MOVE16  BXregS,BXreg
006BDC C??? F???          M                 MOVFF   BXregS,BXreg
006BE0 C??? F???          M                 MOVFF   (BXregS+1),(BXreg+1)
006BE4 0012           00526                 RETURN
                      00527 
006BE6                00528 TrevPost
                      00529                 MOVE16  AXreg,AXregS
006BE6 C??? F???          M                 MOVFF   AXreg,AXregS
006BEA C??? F???          M                 MOVFF   (AXreg+1),(AXregS+1)
                      00530                 MOVE16  BXreg,BXregS
006BEE C??? F???          M                 MOVFF   BXreg,BXregS
006BF2 C??? F???          M                 MOVFF   (BXreg+1),(BXregS+1)
                      00531                 ; If the ServoREV flags do not match then the user has made a change so
                      00532                 ; reverse the position limits before proceeding
006BF6 01??           00533                 MOVLB   HIGH ServoREV
006BF8 C??? FFE8      00534                 MOVFF   ServoREV,WREG
006BFC 1A??           00535                 XORWF   ServoREV+1
006BFE E0??           00536                 BZ      TP_RevDone
                      00537                 MOVE16  TBH,AXreg
006C00 C??? F???          M                 MOVFF   TBH,AXreg
006C04 C??? F???          M                 MOVFF   (TBH+1),(AXreg+1)
                      00538                 MOVE16  TMH,TBH
006C08 C??? F???          M                 MOVFF   TMH,TBH
006C0C C??? F???          M                 MOVFF   (TMH+1),(TBH+1)
                      00539                 MOVE16  AXreg,TMH
006C10 C??? F???          M                 MOVFF   AXreg,TMH
006C14 C??? F???          M                 MOVFF   (AXreg+1),(TMH+1)
006C18                00540 TP_RevDone      
006C18 C??? FFE8      00541                 MOVFF   ServoREV,WREG
006C1C CFE8 F???      00542                 MOVFF   WREG,ServoREV+1
                      00543                 ; End of servo reverse code
                      00544                 MOVE16  AXregS,AXreg
006C20 C??? F???          M                 MOVFF   AXregS,AXreg
006C24 C??? F???          M                 MOVFF   (AXregS+1),(AXreg+1)
                      00545                 MOVE16  BXregS,BXreg
006C28 C??? F???          M                 MOVFF   BXregS,BXreg
006C2C C??? F???          M                 MOVFF   (BXregS+1),(BXreg+1)
006C30 0012           00546                 RETURN
                      00547 
                      00548 
                      00549 ; The following code is used for the slew rate controls on CH 5 and
                      00550 ; CH 8.
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 355


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00551 
                      00552 ; This function converts the step size into a servo transent time in
                      00553 ; .1 sec units.
006C32                00554 PostCH5
                      00555         ; If user set the time to 0 then set the step size to 2000 and exit
006C32 C??? FFE8      00556                 MOVFF   CH5stepSize,WREG
006C36 66E8           00557                 TSTFSZ  WREG,A
006C38 EF?? F???      00558                 GOTO    PreCH5
                      00559                 MOVEC   D'2000',CH5stepSize
006C3C 01??               M                 MOVLR   HIGH (CH5stepSize)
006C3E 0ED0               M                 MOVLW   LOW (D'2000')
006C40 6E??               M                 MOVWF   (CH5stepSize)
006C42 0E07               M                 MOVLW   HIGH (D'2000')
006C44 6E??               M                 MOVWF   (CH5stepSize+1)
006C46 0012           00560                 RETURN
006C48                00561 PreCH5
                      00562         ; t = 500 / step size
006C48 6AE8           00563                 CLRF    WREG
006C4A CFE8 F???      00564                 MOVFF   WREG,CEXreg+2
                      00565                 MOVEC   D'500',CEXreg
006C4E 01??               M                 MOVLR   HIGH (CEXreg)
006C50 0EF4               M                 MOVLW   LOW (D'500')
006C52 6E??               M                 MOVWF   (CEXreg)
006C54 0E01               M                 MOVLW   HIGH (D'500')
006C56 6E??               M                 MOVWF   (CEXreg+1)
                      00566                 MOVE    CH5stepSize,DEXreg
006C58 C??? F???          M                 MOVFF   CH5stepSize,DEXreg
006C5C C??? F???          M                 MOVFF   (CH5stepSize+1),(DEXreg+1)
006C60 EC?? F???      00567                 CALL    Divide2416
                      00568         ; Move results to step size
                      00569                 MOVE    CEXreg,CH5stepSize
006C64 C??? F???          M                 MOVFF   CEXreg,CH5stepSize
006C68 C??? F???          M                 MOVFF   (CEXreg+1),(CH5stepSize+1)
006C6C 6AE8           00570                 CLRF    WREG
006C6E CFE8 F???      00571                 MOVFF   WREG,CH5stepSize+1
006C72 C??? FFE8      00572                 MOVFF   CH5stepSize,WREG
006C76 0012           00573                 RETURN
                      00574 
006C78                00575 PostCH8
                      00576         ; If user set the time to 0 then set the step size to 2000 and exit
006C78 C??? FFE8      00577                 MOVFF   CH8stepSize,WREG
006C7C 66E8           00578                 TSTFSZ  WREG,A
006C7E EF?? F???      00579                 GOTO    PreCH8
                      00580                 MOVEC   D'2000',CH8stepSize
006C82 01??               M                 MOVLR   HIGH (CH8stepSize)
006C84 0ED0               M                 MOVLW   LOW (D'2000')
006C86 6E??               M                 MOVWF   (CH8stepSize)
006C88 0E07               M                 MOVLW   HIGH (D'2000')
006C8A 6E??               M                 MOVWF   (CH8stepSize+1)
006C8C 0012           00581                 RETURN
006C8E                00582 PreCH8
                      00583         ; t = 500 / step size
006C8E 6AE8           00584                 CLRF    WREG
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 356


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

006C90 CFE8 F???      00585                 MOVFF   WREG,CEXreg+2
                      00586                 MOVEC   D'500',CEXreg
006C94 01??               M                 MOVLR   HIGH (CEXreg)
006C96 0EF4               M                 MOVLW   LOW (D'500')
006C98 6E??               M                 MOVWF   (CEXreg)
006C9A 0E01               M                 MOVLW   HIGH (D'500')
006C9C 6E??               M                 MOVWF   (CEXreg+1)
                      00587                 MOVE    CH8stepSize,DEXreg
006C9E C??? F???          M                 MOVFF   CH8stepSize,DEXreg
006CA2 C??? F???          M                 MOVFF   (CH8stepSize+1),(DEXreg+1)
006CA6 EC?? F???      00588                 CALL    Divide2416
                      00589         ; Move results to step size
                      00590                 MOVE    CEXreg,CH8stepSize
006CAA C??? F???          M                 MOVFF   CEXreg,CH8stepSize
006CAE C??? F???          M                 MOVFF   (CEXreg+1),(CH8stepSize+1)
006CB2 6AE8           00591                 CLRF    WREG
006CB4 CFE8 F???      00592                 MOVFF   WREG,CH8stepSize+1
006CB8 C??? FFE8      00593                 MOVFF   CH8stepSize,WREG
006CBC 0012           00594                 RETURN
                      00595 
                      00596 ; This function will reset all the Sub Trim values to zero if the YESNO flag is
                      00597 ; set.
006CBE                00598 STreset
                      00599         ; Test the YESNO flag and exit if the flag is not set
006CBE 01??           00600                 MOVLB   HIGH YESNO
006CC0 AE??           00601                 BTFSS   YESNO,7
006CC2 0012           00602                 RETURN
                      00603         ; Here to clear the sub trim values
006CC4 6AE8           00604                 CLRF    WREG
006CC6 CFE8 F???      00605                 MOVFF   WREG,SubTrim
006CCA CFE8 F???      00606                 MOVFF   WREG,SubTrim+1
006CCE CFE8 F???      00607                 MOVFF   WREG,SubTrim+2
006CD2 CFE8 F???      00608                 MOVFF   WREG,SubTrim+3
006CD6 CFE8 F???      00609                 MOVFF   WREG,SubTrim+4
006CDA CFE8 F???      00610                 MOVFF   WREG,SubTrim+5
006CDE CFE8 F???      00611                 MOVFF   WREG,SubTrim+6
006CE2 CFE8 F???      00612                 MOVFF   WREG,SubTrim+7
006CE6 0012           00613                 RETURN
                      01602         Include <Mixers.asm>
                      00001 
                      00002 ;
                      00003 ; This file contains the Mixer User Interface Pre and Post functions. The 
                      00004 ; Pre function is called before the selected user interface option is processed
                      00005 ; by the user interface routines and the Post function is called after the
                      00006 ; user interface routine returns. These funtions move the mixer data into
                      00007 ; a generic area before the user adjusts parameters and returns the data to
                      00008 ; the correct specific place when finished.
                      00009 ;
                      00010 
                      00011 ; This function is called when the Move Mixer option is selected. This function
                      00012 ; will prompt the pilot to select the from and to mixer channels for the move
                      00013 ; and then provide an option to clear or reset the from channel.
006CE8                00014 MoveMixer
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 357


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00015         ; Ask the pilot to select the from channel
                      00016                 CALLFL  LCDsendCMD,LINE1
006CE8 0E80               M                 MOVLW   (LINE1)
006CEA EC?? F???          M                 CALL    (LCDsendCMD)
                      00017                 PrintMess MES25
006CEE 0E??               M                 MOVLW   UPPER (MES25)
006CF0 6EF8               M                 MOVWF   TBLPTRU,A
006CF2 0E??               M                 MOVLW   HIGH (MES25)
006CF4 6EF7               M                 MOVWF   TBLPTRH,A
006CF6 0E??               M                 MOVLW   LOW (MES25)
006CF8 6EF6               M                 MOVWF   TBLPTRL,A
006CFA EC?? F???          M                 CALL    LCDsendMess
                      00018                 MOVEC   MIXSEL1,BXreg
006CFE 01??               M                 MOVLR   HIGH (BXreg)
006D00 0E??               M                 MOVLW   LOW (MIXSEL1)
006D02 6E??               M                 MOVWF   (BXreg)
006D04 0E??               M                 MOVLW   HIGH (MIXSEL1)
006D06 6E??               M                 MOVWF   (BXreg+1)
                      00019                 MOVEC   Src,DXreg
006D08 01??               M                 MOVLR   HIGH (DXreg)
006D0A 0E??               M                 MOVLW   LOW (Src)
006D0C 6E??               M                 MOVWF   (DXreg)
006D0E 0E??               M                 MOVLW   HIGH (Src)
006D10 6E??               M                 MOVWF   (DXreg+1)
006D12 EC?? F???      00020                 CALL    VerticalSelection
                      00021         ; Ask the pilot to select the to channel
                      00022                 CALLFL  LCDsendCMD,LINE1
006D16 0E80               M                 MOVLW   (LINE1)
006D18 EC?? F???          M                 CALL    (LCDsendCMD)
                      00023                 PrintMess MES26
006D1C 0E??               M                 MOVLW   UPPER (MES26)
006D1E 6EF8               M                 MOVWF   TBLPTRU,A
006D20 0E??               M                 MOVLW   HIGH (MES26)
006D22 6EF7               M                 MOVWF   TBLPTRH,A
006D24 0E??               M                 MOVLW   LOW (MES26)
006D26 6EF6               M                 MOVWF   TBLPTRL,A
006D28 EC?? F???          M                 CALL    LCDsendMess
                      00024                 MOVEC   MIXSEL1,BXreg
006D2C 01??               M                 MOVLR   HIGH (BXreg)
006D2E 0E??               M                 MOVLW   LOW (MIXSEL1)
006D30 6E??               M                 MOVWF   (BXreg)
006D32 0E??               M                 MOVLW   HIGH (MIXSEL1)
006D34 6E??               M                 MOVWF   (BXreg+1)
                      00025                 MOVEC   Dst,DXreg
006D36 01??               M                 MOVLR   HIGH (DXreg)
006D38 0E??               M                 MOVLW   LOW (Dst)
006D3A 6E??               M                 MOVWF   (DXreg)
006D3C 0E??               M                 MOVLW   HIGH (Dst)
006D3E 6E??               M                 MOVWF   (DXreg+1)
006D40 EC?? F???      00026                 CALL    VerticalSelection
                      00027         ; Confirm the move
                      00028                 CALLFL  LCDsendCMD,LINE1
006D44 0E80               M                 MOVLW   (LINE1)
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 358


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

006D46 EC?? F???          M                 CALL    (LCDsendCMD)
                      00029                 PrintMess MES27
006D4A 0E??               M                 MOVLW   UPPER (MES27)
006D4C 6EF8               M                 MOVWF   TBLPTRU,A
006D4E 0E??               M                 MOVLW   HIGH (MES27)
006D50 6EF7               M                 MOVWF   TBLPTRH,A
006D52 0E??               M                 MOVLW   LOW (MES27)
006D54 6EF6               M                 MOVWF   TBLPTRL,A
006D56 EC?? F???          M                 CALL    LCDsendMess
                      00030                 CALLFL  LCDsendCMD,LINE2
006D5A 0EC0               M                 MOVLW   (LINE2)
006D5C EC?? F???          M                 CALL    (LCDsendCMD)
                      00031                 PrintMess MES7
006D60 0E??               M                 MOVLW   UPPER (MES7)
006D62 6EF8               M                 MOVWF   TBLPTRU,A
006D64 0E??               M                 MOVLW   HIGH (MES7)
006D66 6EF7               M                 MOVWF   TBLPTRH,A
006D68 0E??               M                 MOVLW   LOW (MES7)
006D6A 6EF6               M                 MOVWF   TBLPTRL,A
006D6C EC?? F???          M                 CALL    LCDsendMess
006D70 90D8           00032                 BCF     ALUSTA,C
006D72 EC?? F???      00033                 CALL    YesNo
006D76 A0D8           00034                 BTFSS   ALUSTA,C
006D78 0012           00035                 RETURN
                      00036                 ; Now do the move, first set the high bytes because VerticalSelection read one byte only
006D7A 0E??           00037                 MOVLW   HIGH M1Afrom
006D7C CFE8 F???      00038                 MOVFF   WREG,Src+1
006D80 CFE8 F???      00039                 MOVFF   WREG,Dst+1
006D84 0E05           00040                 MOVLW   5
006D86 CFE8 F???      00041                 MOVFF   WREG,Cnt
006D8A EC?? F???      00042                 CALL    BlkMove         
                      00043         ; Ask the pilot if he/she would like to clear or reset the from channel
                      00044                 CALLFL  LCDsendCMD,LINE1
006D8E 0E80               M                 MOVLW   (LINE1)
006D90 EC?? F???          M                 CALL    (LCDsendCMD)
                      00045                 PrintMess MES28
006D94 0E??               M                 MOVLW   UPPER (MES28)
006D96 6EF8               M                 MOVWF   TBLPTRU,A
006D98 0E??               M                 MOVLW   HIGH (MES28)
006D9A 6EF7               M                 MOVWF   TBLPTRH,A
006D9C 0E??               M                 MOVLW   LOW (MES28)
006D9E 6EF6               M                 MOVWF   TBLPTRL,A
006DA0 EC?? F???          M                 CALL    LCDsendMess
                      00046                 CALLFL  LCDsendCMD,LINE2
006DA4 0EC0               M                 MOVLW   (LINE2)
006DA6 EC?? F???          M                 CALL    (LCDsendCMD)
                      00047                 PrintMess MES7
006DAA 0E??               M                 MOVLW   UPPER (MES7)
006DAC 6EF8               M                 MOVWF   TBLPTRU,A
006DAE 0E??               M                 MOVLW   HIGH (MES7)
006DB0 6EF7               M                 MOVWF   TBLPTRH,A
006DB2 0E??               M                 MOVLW   LOW (MES7)
006DB4 6EF6               M                 MOVWF   TBLPTRL,A
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 359


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

006DB6 EC?? F???          M                 CALL    LCDsendMess
006DBA 90D8           00048                 BCF     ALUSTA,C
006DBC EC?? F???      00049                 CALL    YesNo
006DC0 A0D8           00050                 BTFSS   ALUSTA,C
006DC2 0012           00051                 RETURN
                      00052                 ; Clear the from mixer channel, enter 0,0,10,10,0
006DC4 01??           00053                 MOVLB   HIGH Src
006DC6 50??           00054                 MOVF    Src,W
006DC8 6EE1           00055                 MOVWF   FSR1L   
006DCA 50??           00056                 MOVF    Src+1,W
006DCC 6EE2           00057                 MOVWF   FSR1H   
006DCE 0E00           00058                 MOVLW   0
006DD0 CFE8 FFE6      00059                 MOVFF   WREG,POSTINC1
006DD4 CFE8 FFE6      00060                 MOVFF   WREG,POSTINC1
006DD8 0E0A           00061                 MOVLW   D'10'           
006DDA CFE8 FFE6      00062                 MOVFF   WREG,POSTINC1
006DDE CFE8 FFE6      00063                 MOVFF   WREG,POSTINC1
006DE2 0E00           00064                 MOVLW   0
006DE4 CFE8 FFE6      00065                 MOVFF   WREG,POSTINC1
006DE8 0012           00066                 RETURN
                      00067 
                      00068 ; This is the function called before the specific mixer user interface 
                      00069 ; function is called. This routine moves the selected mixer data into
                      00070 ; the generic area and unpacks some of the data to allow the user to
                      00071 ; adjust the parameters.
                      00072 ;
                      00073 ; DXreg = Pointer to selected mixer data
006DEA                00074 PreMix
                      00075         ; Clear the Servo Update flag
006DEA 01??           00076                 MOVLB   HIGH CalServoUpdate
006DEC 6A??           00077                 CLRF    CalServoUpdate
                      00078         ; Copy the selected mixer parameters to the working space
                      00079                 MOVE16  DXreg,Src
006DEE C??? F???          M                 MOVFF   DXreg,Src
006DF2 C??? F???          M                 MOVFF   (DXreg+1),(Src+1)
                      00080                 MOVEC   Mfrom,Dst
006DF6 01??               M                 MOVLR   HIGH (Dst)
006DF8 0E??               M                 MOVLW   LOW (Mfrom)
006DFA 6E??               M                 MOVWF   (Dst)
006DFC 0E??               M                 MOVLW   HIGH (Mfrom)
006DFE 6E??               M                 MOVWF   (Dst+1)
006E00 0E05           00081                 MOVLW   5
006E02 6E??           00082                 MOVWF   Cnt
006E04 EC?? F???      00083                 CALL    BlkMove
                      00084                 MOVE16  DXreg,Dst       ; Set the destination pointer for the post call
006E08 C??? F???          M                 MOVFF   DXreg,Dst
006E0C C??? F???          M                 MOVFF   (DXreg+1),(Dst+1)
                      00085         ; Calculate the necessary flags
006E10 01??           00086                 MOVLB   HIGH Mfrom
                      00087                 ; MS 4 bits of Mfrom channel define a table...
006E12 50??           00088                 MOVF    Mfrom,W
006E14 3AE8           00089                 SWAPF   WREG
006E16 0B0F           00090                 ANDLW   0F
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 360


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

006E18 6E??           00091                 MOVWF   Mtbl
                      00092                 ; Bit 7 of Mto set = replace, 0 = add
006E1A 6A??           00093                 CLRF    Mreplace
006E1C BE??           00094                 BTFSC   Mto,7
006E1E 1E??           00095                 COMF    Mreplace,F
                      00096                 ; Bit 6 of Mto set = indirect positive gain, channel in Mpg
006E20 6A??           00097                 CLRF    Mpi
006E22 50??           00098                 MOVF    Mpg,W
006E24 BC??           00099                 BTFSC   Mto,6
006E26 6E??           00100                 MOVWF   Mpi
                      00101                 ; Bit 5 of Mto set = indirect negative gain, channel in Mng
006E28 6A??           00102                 CLRF    Mni
006E2A 50??           00103                 MOVF    Mng,W
006E2C BA??           00104                 BTFSC   Mto,5
006E2E 6E??           00105                 MOVWF   Mni
                      00106                 ; Clear all flag bits...
006E30 0E0F           00107                 MOVLW   0F
006E32 16??           00108                 ANDWF   Mpi,F
006E34 16??           00109                 ANDWF   Mni,F
006E36 16??           00110                 ANDWF   Mto,F
006E38 16??           00111                 ANDWF   Mfrom,F
006E3A 0012           00112                 RETURN
                      00113                 
                      00114 ; After the user has finished editing the selected mixer and has accepted 
                      00115 ; his options then this routine is called. The data is repacked as needed
                      00116 ; by the mixer functions and the data is moved from the generic area to the
                      00117 ; specific mixer location.
006E3C                00118 PostMix
                      00119         ; Restore all flag bits..
006E3C 01??           00120                 MOVLB   HIGH Mfrom
                      00121                 ; MS 4 bits of Mfrom channel define a table...
006E3E 50??           00122                 MOVF    Mtbl,W
006E40 3AE8           00123                 SWAPF   WREG
006E42 0BF0           00124                 ANDLW   0F0
006E44 12??           00125                 IORWF   Mfrom,F
                      00126                 ; Bit 7 of Mto set = replace, 0 = add
006E46 BE??           00127                 BTFSC   Mreplace,7
006E48 8E??           00128                 BSF     Mto,7
                      00129                 ; Bit 6 of Mto set = indirect positive gain, channel in Mpg
006E4A 50??           00130                 MOVF    Mpi,W
006E4C 12E8           00131                 IORWF   WREG            ; Set flags
006E4E B4D8           00132                 BTFSC   ALUSTA,Z
006E50 EF?? F???      00133                 GOTO    CMA1
006E54 50??           00134                 MOVF    Mpi,W
006E56 6E??           00135                 MOVWF   Mpg
006E58 8C??           00136                 BSF     Mto,6
                      00137                 ; Bit 5 of Mto set = indirect negative gain, channel in Mng
006E5A                00138 CMA1
006E5A 50??           00139                 MOVF    Mni,W
006E5C 12E8           00140                 IORWF   WREG            ; Set flags
006E5E B4D8           00141                 BTFSC   ALUSTA,Z
006E60 EF?? F???      00142                 GOTO    CMA2
006E64 50??           00143                 MOVF    Mni,W
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 361


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

006E66 6E??           00144                 MOVWF   Mng
006E68 8A??           00145                 BSF     Mto,5
006E6A                00146 CMA2
                      00147         ; Write mixer data back to where it came
                      00148                 MOVEC   Mfrom,Src
006E6A 01??               M                 MOVLR   HIGH (Src)
006E6C 0E??               M                 MOVLW   LOW (Mfrom)
006E6E 6E??               M                 MOVWF   (Src)
006E70 0E??               M                 MOVLW   HIGH (Mfrom)
006E72 6E??               M                 MOVWF   (Src+1)
006E74 0E05           00149                 MOVLW   5
006E76 6E??           00150                 MOVWF   Cnt
006E78 EC?? F???      00151                 CALL    BlkMove
006E7C 0012           00152                 RETURN
                      00153                 
                      00154                 
006E7E                00155 PreA2R
006E7E C??? F???      00156                 MOVFF   AilRudPos,Mpg
006E82 C??? F???      00157                 MOVFF   AilRudNeg,Mng
006E86 0012           00158                 RETURN
                      00159                 
006E88                00160 PostA2R
006E88 C??? F???      00161                 MOVFF   Mpg,AilRudPos
006E8C C??? F???      00162                 MOVFF   Mng,AilRudNeg
006E90 0012           00163                 RETURN
                      00164 
006E92                00165 PreR2A
006E92 C??? F???      00166                 MOVFF   RudAilPos,Mpg
006E96 C??? F???      00167                 MOVFF   RudAilNeg,Mng
006E9A 0012           00168                 RETURN
                      00169                 
006E9C                00170 PostR2A
006E9C C??? F???      00171                 MOVFF   Mpg,RudAilPos
006EA0 C??? F???      00172                 MOVFF   Mng,RudAilNeg
006EA4 0012           00173                 RETURN
                      00174                 
006EA6                00175 PreR2E
006EA6 C??? F???      00176                 MOVFF   RudElePos,Mpg
006EAA C??? F???      00177                 MOVFF   RudEleNeg,Mng
006EAE 0012           00178                 RETURN
                      00179                 
006EB0                00180 PostR2E
006EB0 C??? F???      00181                 MOVFF   Mpg,RudElePos
006EB4 C??? F???      00182                 MOVFF   Mng,RudEleNeg
006EB8 0012           00183                 RETURN
                      01603         Include <Options.asm>
                      00001 ; This file contains the Options User Interface Pre and Post functions. The 
                      00002 ; Pre function is called before the selected user interface option is processed
                      00003 ; by the user interface routines and the Post function is called after the
                      00004 ; user interface routine returns. 
                      00005 
                      00006 ; This function will move the Temp table data (CalTable) to the 
                      00007 ; location pointed to by the DXreg.
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 362


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

006EBA                00008 Temp2Table
                      00009                 MOVEC   CalTable,Src
006EBA 01??               M                 MOVLR   HIGH (Src)
006EBC 0E??               M                 MOVLW   LOW (CalTable)
006EBE 6E??               M                 MOVWF   (Src)
006EC0 0E??               M                 MOVLW   HIGH (CalTable)
006EC2 6E??               M                 MOVWF   (Src+1)
                      00010                 MOVE16  DXregS,Dst
006EC4 C??? F???          M                 MOVFF   DXregS,Dst
006EC8 C??? F???          M                 MOVFF   (DXregS+1),(Dst+1)
006ECC 0E0B           00011                 MOVLW   D'11'
006ECE 6E??           00012                 MOVWF   Cnt
                      00013                 CALLF   BlkMove
006ED0 EC?? F???          M                 CALL    (BlkMove)
006ED4 0012           00014                 RETURN
                      00015                 
                      00016 ; This function will move the table data defined in DXreg to the
                      00017 ; Temp table (CalTable).
006ED6                00018 Table2Temp
                      00019                 MOVEC   CalTable,Dst
006ED6 01??               M                 MOVLR   HIGH (Dst)
006ED8 0E??               M                 MOVLW   LOW (CalTable)
006EDA 6E??               M                 MOVWF   (Dst)
006EDC 0E??               M                 MOVLW   HIGH (CalTable)
006EDE 6E??               M                 MOVWF   (Dst+1)
                      00020                 MOVE16  DXreg,Src
006EE0 C??? F???          M                 MOVFF   DXreg,Src
006EE4 C??? F???          M                 MOVFF   (DXreg+1),(Src+1)
                      00021                 MOVE16  DXreg,DXregS
006EE8 C??? F???          M                 MOVFF   DXreg,DXregS
006EEC C??? F???          M                 MOVFF   (DXreg+1),(DXregS+1)
006EF0 0E0B           00022                 MOVLW   D'11'
006EF2 6E??           00023                 MOVWF   Cnt
006EF4 EC?? F???      00024                 CALL    BlkMove  
006EF8 0012           00025                 RETURN
                      00026 
                      00027 ; This function will reset the Auto Trim values to zero if the YESNO flag is
                      00028 ; set.
006EFA                00029 ATreset
                      00030         ; Test the YESNO flag and exit if the flag is not set
006EFA 01??           00031                 MOVLB   HIGH YESNO
006EFC AE??           00032                 BTFSS   YESNO,7
006EFE 0012           00033                 RETURN
                      00034         ; Here to clear the reset values
006F00 01??           00035                 MOVLB   HIGH AAT
006F02 6A??           00036                 CLRF    AAT
006F04 6A??           00037                 CLRF    EAT
006F06 6A??           00038                 CLRF    RAT
006F08 0012           00039                 RETURN
                      00040 
                      00041 
                      00042 ; This function will copy the current trim positions to the trim zero  variables if
                      00043 ; the YESNO flag is set.
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 363


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

006F0A                00044 TrimZero
                      00045         ; Test the YESNO flag and exit if the flag is not set
006F0A 01??           00046                 MOVLB   HIGH YESNO
006F0C AE??           00047                 BTFSS   YESNO,7
006F0E 0012           00048                 RETURN
                      00049         ; Aileron
                      00050                 MOVE16  TrimZeroAil,CEXreg
006F10 C??? F???          M                 MOVFF   TrimZeroAil,CEXreg
006F14 C??? F???          M                 MOVFF   (TrimZeroAil+1),(CEXreg+1)
006F18 50??           00051                 MOVF    Atrim,W
006F1A 26??           00052                 ADDWF   CEXreg,F
006F1C 50??           00053                 MOVF    Atrim+1,W
006F1E 22??           00054                 ADDWFC  CEXreg+1,F
                      00055                 MOVE16  CEXreg,TrimZeroAil
006F20 C??? F???          M                 MOVFF   CEXreg,TrimZeroAil
006F24 C??? F???          M                 MOVFF   (CEXreg+1),(TrimZeroAil+1)
                      00056         ; Elevator
                      00057                 MOVE16  TrimZeroEle,CEXreg
006F28 C??? F???          M                 MOVFF   TrimZeroEle,CEXreg
006F2C C??? F???          M                 MOVFF   (TrimZeroEle+1),(CEXreg+1)
006F30 50??           00058                 MOVF    Etrim,W
006F32 26??           00059                 ADDWF   CEXreg,F
006F34 50??           00060                 MOVF    Etrim+1,W
006F36 22??           00061                 ADDWFC  CEXreg+1,F
                      00062                 MOVE16  CEXreg,TrimZeroEle
006F38 C??? F???          M                 MOVFF   CEXreg,TrimZeroEle
006F3C C??? F???          M                 MOVFF   (CEXreg+1),(TrimZeroEle+1)
                      00063         ; Rudder
                      00064                 MOVE16  TrimZeroRud,CEXreg
006F40 C??? F???          M                 MOVFF   TrimZeroRud,CEXreg
006F44 C??? F???          M                 MOVFF   (TrimZeroRud+1),(CEXreg+1)
006F48 50??           00065                 MOVF    Rtrim,W
006F4A 26??           00066                 ADDWF   CEXreg,F
006F4C 50??           00067                 MOVF    Rtrim+1,W
006F4E 22??           00068                 ADDWFC  CEXreg+1,F
                      00069                 MOVE16  CEXreg,TrimZeroRud
006F50 C??? F???          M                 MOVFF   CEXreg,TrimZeroRud
006F54 C??? F???          M                 MOVFF   (CEXreg+1),(TrimZeroRud+1)
006F58 0012           00070                 RETURN
                      00071 
                      00072                 
                      00073 ; This function will clear the Trim zero variables. This function is only performed 
                      00074 ; is the YESNO flag is set.
006F5A                00075 TrimZeroClear
                      00076         ; Test the YESNO flag and exit if the flag is not set
006F5A 01??           00077                 MOVLB   HIGH YESNO
006F5C AE??           00078                 BTFSS   YESNO,7
006F5E 0012           00079                 RETURN
                      00080         ; Clear the Trim Zero variables
006F60 01??           00081                 MOVLB   HIGH TrimZeroAil
006F62 6A??           00082                 CLRF    TrimZeroAil
006F64 6A??           00083                 CLRF    TrimZeroAil+1
006F66 6A??           00084                 CLRF    TrimZeroEle
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 364


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

006F68 6A??           00085                 CLRF    TrimZeroEle+1
006F6A 6A??           00086                 CLRF    TrimZeroRud
006F6C 6A??           00087                 CLRF    TrimZeroRud+1
006F6E 0012           00088                 RETURN
                      00089                 
                      00090 ; This function will set the variable limits for the alternate aircraft function. This 
                      00091 ; limit is NumAircraft.
006F70                00092 SetAftRange
006F70 01??           00093                 MOVLB   HIGH MinByte
006F72 6A??           00094                 CLRF    MinByte 
006F74 2A??           00095                 INCF    MinByte
006F76 0E60           00096                 MOVLW   NumAircraft
006F78 01??           00097                 MOVLB   HIGH MaxByte
006F7A 6E??           00098                 MOVWF   MaxByte 
006F7C 0012           00099                 RETURN
                      00100 
                      00101 ; This function will copy the current aircraft data into the select aircraft number. The
                      00102 ; selected aircraft number is saved in mto. If mto is set to zero then nothing is done.
006F7E                00103 CopyAFT
                      00104         ; Do the copy operation if Mto is > 0
006F7E 01??           00105                 MOVLB   HIGH Mto
006F80 50??           00106                 MOVF    Mto,W
006F82 66??           00107                 TSTFSZ  Mto
006F84 EF?? F???      00108                 GOTO    CopyAFTgo  
006F88 0012           00109                 RETURN
                      00110         ; Copy the aircraft number to a temp variable then move Mto 
                      00111         ; to aircraft number and call SaveAircraft...
006F8A                00112 CopyAFTgo
006F8A 01??           00113                 MOVLB   HIGH Aircraft
006F8C C??? F???      00114                 MOVFF   Aircraft,Areg
006F90 6E??           00115                 MOVWF   Aircraft
006F92 01??           00116                 MOVLB   HIGH Mto
006F94 C??? F???      00117                 MOVFF   Areg,Mto
006F98 EC?? F???      00118                 CALL    SaveAircraft
006F9C 01??           00119                 MOVLB   HIGH Mto
006F9E C??? F???      00120                 MOVFF   Mto,Areg
006FA2 01??           00121                 MOVLB   HIGH Aircraft
006FA4 C??? F???      00122                 MOVFF   Areg,Aircraft
006FA8 0012           00123                 RETURN
                      00124                 
                      00125 ; This function will copy the Auto Trim values to the Trim Zero variables and then
                      00126 ; clear the Auto Trim values. This function is only performed is the YESNO flag is
                      00127 ; set.
006FAA                00128 AutoTrim2Zero
                      00129         ; Test the YESNO flag and exit if the flag is not set
006FAA 01??           00130                 MOVLB   HIGH YESNO
006FAC AE??           00131                 BTFSS   YESNO,7
006FAE 0012           00132                 RETURN
                      00133         ; Aileron channel
006FB0 01??           00134                 MOVLB   HIGH AAT
006FB2 50??           00135                 MOVF    AAT,W
006FB4 6A??           00136                 CLRF    AAT
006FB6 C??? F???      00137                 MOVFF   APT,Areg
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 365


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

006FBA 01??           00138                 MOVLB   HIGH AXreg
006FBC 6E??           00139                 MOVWF   AXreg
006FBE 6A??           00140                 CLRF    AXreg+1
006FC0 BEE8           00141                 BTFSC   WREG,7
006FC2 68??           00142                 SETF    AXreg+1
006FC4 36??           00143                 RLCF    AXreg                   ; Multiply by 2
006FC6 36??           00144                 RLCF    AXreg+1         
                      00145                 MOVEC   D'100',BXreg
006FC8 01??               M                 MOVLR   HIGH (BXreg)
006FCA 0E64               M                 MOVLW   LOW (D'100')
006FCC 6E??               M                 MOVWF   (BXreg)
006FCE 0E00               M                 MOVLW   HIGH (D'100')
006FD0 6E??               M                 MOVWF   (BXreg+1)
006FD2 EC?? F???      00146                 CALL    Mult1616
006FD6 C??? F???      00147                 MOVFF   Areg,DEXreg
006FDA 6A??           00148                 CLRF    DEXreg+1
006FDC EC?? F???      00149                 CALL    Divide2416
006FE0 50??           00150                 MOVF    CEXreg,W
006FE2 01??           00151                 MOVLB   HIGH TrimZeroAil
006FE4 26??           00152                 ADDWF   TrimZeroAil,F
006FE6 01??           00153                 MOVLB   HIGH CEXreg
006FE8 50??           00154                 MOVF    CEXreg+1,W
006FEA 01??           00155                 MOVLB   HIGH TrimZeroAil
006FEC 22??           00156                 ADDWFC  TrimZeroAil+1,F
                      00157         ; Elevator channel
006FEE 01??           00158                 MOVLB   HIGH EAT
006FF0 50??           00159                 MOVF    EAT,W
006FF2 6A??           00160                 CLRF    EAT
006FF4 C??? F???      00161                 MOVFF   EPT,Areg
006FF8 01??           00162                 MOVLB   HIGH AXreg
006FFA 6E??           00163                 MOVWF   AXreg
006FFC 6A??           00164                 CLRF    AXreg+1
006FFE BEE8           00165                 BTFSC   WREG,7
007000 68??           00166                 SETF    AXreg+1
007002 36??           00167                 RLCF    AXreg                   ; Multiply by 2
007004 36??           00168                 RLCF    AXreg+1
                      00169                 MOVEC   D'100',BXreg
007006 01??               M                 MOVLR   HIGH (BXreg)
007008 0E64               M                 MOVLW   LOW (D'100')
00700A 6E??               M                 MOVWF   (BXreg)
00700C 0E00               M                 MOVLW   HIGH (D'100')
00700E 6E??               M                 MOVWF   (BXreg+1)
                      00170                 CALLF   Mult1616
007010 EC?? F???          M                 CALL    (Mult1616)
007014 C??? F???      00171                 MOVFF   Areg,DEXreg
007018 6A??           00172                 CLRF    DEXreg+1
00701A EC?? F???      00173                 CALL    Divide2416
00701E 50??           00174                 MOVF    CEXreg,W
007020 01??           00175                 MOVLB   HIGH TrimZeroEle
007022 26??           00176                 ADDWF   TrimZeroEle,F
007024 01??           00177                 MOVLB   HIGH CEXreg
007026 50??           00178                 MOVF    CEXreg+1,W
007028 01??           00179                 MOVLB   HIGH TrimZeroEle
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 366


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

00702A 22??           00180                 ADDWFC  TrimZeroEle+1,F
                      00181         ; Rudder channel
00702C 01??           00182                 MOVLB   HIGH RAT
00702E 50??           00183                 MOVF    RAT,W
007030 6A??           00184                 CLRF    RAT
007032 C??? F???      00185                 MOVFF   RPT,Areg
007036 01??           00186                 MOVLB   HIGH AXreg
007038 6E??           00187                 MOVWF   AXreg
00703A 6A??           00188                 CLRF    AXreg+1
00703C BEE8           00189                 BTFSC   WREG,7
00703E 68??           00190                 SETF    AXreg+1
007040 36??           00191                 RLCF    AXreg                   ; Multiply by 2
007042 36??           00192                 RLCF    AXreg+1
                      00193                 MOVEC   D'100',BXreg
007044 01??               M                 MOVLR   HIGH (BXreg)
007046 0E64               M                 MOVLW   LOW (D'100')
007048 6E??               M                 MOVWF   (BXreg)
00704A 0E00               M                 MOVLW   HIGH (D'100')
00704C 6E??               M                 MOVWF   (BXreg+1)
00704E EC?? F???      00194                 CALL    Mult1616
007052 C??? F???      00195                 MOVFF   Areg,DEXreg
007056 6A??           00196                 CLRF    DEXreg+1
007058 EC?? F???      00197                 CALL    Divide2416
00705C 50??           00198                 MOVF    CEXreg,W
00705E 01??           00199                 MOVLB   HIGH TrimZeroRud
007060 26??           00200                 ADDWF   TrimZeroRud,F
007062 01??           00201                 MOVLB   HIGH CEXreg
007064 50??           00202                 MOVF    CEXreg+1,W
007066 01??           00203                 MOVLB   HIGH TrimZeroRud
007068 22??           00204                 ADDWFC  TrimZeroRud+1,F
00706A 0012           00205                 RETURN
                      00206 
                      00207 ; This function will copy the default aircraft paraameters into memory. This function 
                      00208 ; is only performed is the YESNO flag is set.
00706C                00209 SetDefault
                      00210         ; Test the YESNO flag and exit if the flag is not set
00706C 01??           00211                 MOVLB   HIGH YESNO
00706E AE??           00212                 BTFSS   YESNO,7
007070 0012           00213                 RETURN
                      00214         ; Set the aircraft defaults
007072 EC?? F???      00215                 CALL    LoadAircraftDefaults
007076 0012           00216                 RETURN
                      00217                 
                      01604         Include <System.asm>
                      00001 ; This file contains the System Options User Interface Pre and Post functions. The 
                      00002 ; Pre function is called before the selected user interface option is processed
                      00003 ; by the user interface routines and the Post function is called after the
                      00004 ; user interface routine returns. 
                      00005 
007078                00006 postConfig
                      00007         ; Allow application to all aircraft
                      00008                 MOVEC   ChannelOrder,Src
007078 01??               M                 MOVLR   HIGH (Src)
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 367


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

00707A 0E??               M                 MOVLW   LOW (ChannelOrder)
00707C 6E??               M                 MOVWF   (Src)
00707E 0E??               M                 MOVLW   HIGH (ChannelOrder)
007080 6E??               M                 MOVWF   (Src+1)
007082 0E08           00009                 MOVLW   8
007084 CFE8 F???      00010                 MOVFF   WREG,Cnt
007088 EC?? F???      00011                 CALL    ATLpost
00708C 0012           00012                 RETURN
                      00013                 
00708E                00014 PostChan
00708E 01??           00015                 MOVLB   HIGH MaxChannels
007090 90D8           00016                 BCF     ALUSTA,C,A
007092 36??           00017                 RLCF    MaxChannels
                      00018         ; Allow application to all aircraft
                      00019                 MOVEC   MaxChannels,Src
007094 01??               M                 MOVLR   HIGH (Src)
007096 0E??               M                 MOVLW   LOW (MaxChannels)
007098 6E??               M                 MOVWF   (Src)
00709A 0E??               M                 MOVLW   HIGH (MaxChannels)
00709C 6E??               M                 MOVWF   (Src+1)
00709E 0E01           00020                 MOVLW   1
0070A0 CFE8 F???      00021                 MOVFF   WREG,Cnt
0070A4 EC?? F???      00022                 CALL    ATLpost
0070A8 0012           00023                 RETURN
                      00024                 
0070AA                00025 PreChan
0070AA 01??           00026                 MOVLB   HIGH MaxChannels
0070AC 90D8           00027                 BCF     ALUSTA,C,A
0070AE 32??           00028                 RRCF    MaxChannels
0070B0 0012           00029                 RETURN
                      00030 
                      00031 ; This function will enable the FMS flight simulator mode if the FMSflag flag is set
0070B2                00032 FMSenable
                      00033         ; Test the FMS flags and exit if all the flags is not set
0070B2 01??           00034                 MOVLB   HIGH FMSflag
0070B4 BE??           00035                 BTFSC   FMSflag,7
0070B6 EF?? F???      00036                 GOTO    FMSenable1
0070BA 01??           00037                 MOVLB   HIGH FMSflagU1
0070BC AE??           00038                 BTFSS   FMSflagU1,7
0070BE 0012           00039                 RETURN
                      00040         ; Init the FMS mode uart
0070C0                00041 FMSenable1
0070C0 EC?? F???      00042                 CALL    FMSinit
0070C4 0012           00043                 RETURN
                      00044 
                      00045 
                      00046 ; This function is used to calibrate the transmitter voltage monitoring function.
0070C6                00047 TXvoltSet
                      00048         ; First place the ADC channel in Ftemp and the gain
                      00049         ; value, VmonG, in BXreg
                      00050                 MOVE    VmonG,BXreg
0070C6 C??? F???          M                 MOVFF   VmonG,BXreg
0070CA C??? F???          M                 MOVFF   (VmonG+1),(BXreg+1)
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 368


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

0070CE 0E03           00051                 MOVLW   ADCref      
0070D0 01??           00052                 MOVLB   HIGH Ftemp
0070D2 6E??           00053                 MOVWF   Ftemp
0070D4 EC?? F???      00054                 CALL    CalVoltMeter
                      00055                 MOVE    BXreg,VmonG
0070D8 C??? F???          M                 MOVFF   BXreg,VmonG
0070DC C??? F???          M                 MOVFF   (BXreg+1),(VmonG+1)
0070E0 0012           00056                 RETURN
                      00057 
                      00058 ; This function is used to calibrate the receiver voltage monitoring function.
0070E2                00059 RXvoltSet             
                      00060         ; First place the ADC channel in Ftemp and the gain
                      00061         ; value, VRmonG, in BXreg
                      00062                 MOVE    VRmonG,BXreg
0070E2 C??? F???          M                 MOVFF   VRmonG,BXreg
0070E6 C??? F???          M                 MOVFF   (VRmonG+1),(BXreg+1)
0070EA 0E0D           00063                 MOVLW   D'13'         
0070EC 01??           00064                 MOVLB   HIGH Ftemp
0070EE 6E??           00065                 MOVWF   Ftemp
0070F0 EC?? F???      00066                 CALL    CalVoltMeter
                      00067                 MOVE    BXreg,VRmonG
0070F4 C??? F???          M                 MOVFF   BXreg,VRmonG
0070F8 C??? F???          M                 MOVFF   (BXreg+1),(VRmonG+1)
0070FC 0012           00068                 RETURN
                      00069 
                      00070 ; This function is used to reset the battery timer value. This value is only
                      00071 ; cleared if the YESNO flag is set.
0070FE                00072 ResetBatTimer
                      00073         ; Test the YESNO flag and exit if the flag is not set
0070FE 01??           00074                 MOVLB   HIGH YESNO
007100 AE??           00075                 BTFSS   YESNO,7
007102 0012           00076                 RETURN
                      00077         ; Clear the battery timer value
007104 01??           00078                 MOVLB   HIGH BatteryTimer
007106 6A??           00079                 CLRF    BatteryTimer
007108 6A??           00080                 CLRF    BatteryTimer+1
                      00081         ; Set flag to store the timer to EEPROM
00710A 01??           00082                 MOVLR   HIGH BTflag
00710C 68??           00083                 SETF    BTflag
00710E 0012           00084                 RETURN
                      00085 
                      00086 ; Format primary SPROM
007110                00087 FmtFlsh
007110 EC?? F???      00088                 CALL    FormatFlash
                      00089                 ShowLine2
007114 0012           00090                 RETURN
                      00091 
                      00092 ; Define a channels gain parameters to convert raw ADC counts to normalized units
                      00093 ; for a trim channel. Trim channels go from -1000 to 1000
                      00094 ; Steps:
                      00095 ;       1.) Read RT/DWN position
                      00096 ;       2.) Read LT/UP position
                      00097 ;       Ct = (LT/UP + RT/DWN)/2
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 369


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00098 ;       GH = 1000 * 256/(LT/UP - RT/DWN)/2)
                      00099 ; Results placed in the following reg during the calculations then moved to
                      00100 ; final location:
                      00101 ;       Gh,Ct
                      00102 ; On call the parameters needed are packed in the DXreg. The MSB contains
                      00103 ; the ADC channel number and the LSB contains the low 8 bit of the location
                      00104 ; address for the results. Its assumed that are destinations are in the
                      00105 ; same page.
                      00106 ; DXreg = (ADC channel):(low byte address of Destination)
007116                00107 JStrimsChan
                      00108         ; Load the Dst register and the ADC channel
007116 01??           00109                 MOVLB   HIGH DXreg
007118 50??           00110                 MOVF    DXreg,W
00711A 6E??           00111                 MOVWF   Dst
00711C 0E??           00112                 MOVLW   HIGH (AHG)
00711E 6E??           00113                 MOVWF   Dst+1
007120 50??           00114                 MOVF    DXreg+1,W
                      00115         ; Save channel in Areg
007122 01??           00116                 MOVLB   HIGH Atemp
007124 6E??           00117                 MOVWF   Atemp
                      00118         ; Read Vbat
007126 0E03           00119                 MOVLW   ADCref
                      00120                 CALLFW  ReadADC256
007128 EC?? F???          M                 CALL    (ReadADC256)
00712C C??? F???      00121                 MOVFF   ADCsum+1,Vbat
007130 C??? F???      00122                 MOVFF   ADCsum+2,Vbat+1
                      00123         ; Get the RT/DWN position
                      00124                 CALLFL  LCDsendCMD,LINE2
007134 0EC0               M                 MOVLW   (LINE2)
007136 EC?? F???          M                 CALL    (LCDsendCMD)
                      00125                 PrintMess JCALMES15
00713A 0E??               M                 MOVLW   UPPER (JCALMES15)
00713C 6EF8               M                 MOVWF   TBLPTRU,A
00713E 0E??               M                 MOVLW   HIGH (JCALMES15)
007140 6EF7               M                 MOVWF   TBLPTRH,A
007142 0E??               M                 MOVLW   LOW (JCALMES15)
007144 6EF6               M                 MOVWF   TBLPTRL,A
007146 EC?? F???          M                 CALL    LCDsendMess
00714A EC?? F???      00126                 CALL    Option
00714E A0D8           00127                 BTFSS   ALUSTA,C,A
007150 EF?? F???      00128                 GOTO    $-6
007154 01??           00129                 MOVLB   HIGH Atemp
007156 50??           00130                 MOVF    Atemp,W
                      00131                 CALLFW  ReadADC256
007158 EC?? F???          M                 CALL    (ReadADC256)
00715C C??? F???      00132                 MOVFF   ADCsum+1,Ct
007160 C??? F???      00133                 MOVFF   ADCsum+2,Ct+1
007164 C??? F???      00134                 MOVFF   ADCsum+1,Gl
007168 C??? F???      00135                 MOVFF   ADCsum+2,Gl+1
00716C 0EFA           00136                 MOVLW   D'250'
                      00137                 CALLFW  Delay1mS
00716E EC?? F???          M                 CALL    (Delay1mS)
                      00138         ; Get the LT/UP position
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 370


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00139                 CALLFL  LCDsendCMD,LINE2
007172 0EC0               M                 MOVLW   (LINE2)
007174 EC?? F???          M                 CALL    (LCDsendCMD)
                      00140                 PrintMess JCALMES16
007178 0E??               M                 MOVLW   UPPER (JCALMES16)
00717A 6EF8               M                 MOVWF   TBLPTRU,A
00717C 0E??               M                 MOVLW   HIGH (JCALMES16)
00717E 6EF7               M                 MOVWF   TBLPTRH,A
007180 0E??               M                 MOVLW   LOW (JCALMES16)
007182 6EF6               M                 MOVWF   TBLPTRL,A
007184 EC?? F???          M                 CALL    LCDsendMess
007188 EC?? F???      00141                 CALL    Option
00718C A0D8           00142                 BTFSS   ALUSTA,C,A
00718E EF?? F???      00143                 GOTO    $-6
007192 01??           00144                 MOVLB   HIGH Atemp
007194 50??           00145                 MOVF    Atemp,W
                      00146                 CALLFW  ReadADC256
007196 EC?? F???          M                 CALL    (ReadADC256)
00719A C??? F???      00147                 MOVFF   ADCsum+1,Gh
00719E C??? F???      00148                 MOVFF   ADCsum+2,Gh+1
0071A2 0EFA           00149                 MOVLW   D'250'
                      00150                 CALLFW  Delay1mS
0071A4 EC?? F???          M                 CALL    (Delay1mS)
                      00151         ; Now calcuate the gain
                      00152         ; Ct = (LT/UP + RT/DWN)/2
0071A8 01??           00153                 MOVLB   HIGH Ct
0071AA 50??           00154                 MOVF    Gh,W
0071AC 26??           00155                 ADDWF   Ct
0071AE 50??           00156                 MOVF    Gh+1,W
0071B0 22??           00157                 ADDWFC  Ct+1
0071B2 32??           00158                 RRCF    Ct+1
0071B4 32??           00159                 RRCF    Ct
0071B6 9E??           00160                 BCF     Ct+1,7
                      00161         ; Gh = 1000 * 256/(LT/UP - RT/DWN)/2)
                      00162                 MOVE    Gl,DEXreg
0071B8 C??? F???          M                 MOVFF   Gl,DEXreg
0071BC C??? F???          M                 MOVFF   (Gl+1),(DEXreg+1)
                      00163                 ; Set the 32 bit CEXreg to 1000 time 256
0071C0 01??           00164                 MOVLB   HIGH CEXreg
0071C2 0EE8           00165                 MOVLW   LOW (D'1000')
0071C4 6E??           00166                 MOVWF   CEXreg+1
0071C6 0E03           00167                 MOVLW   HIGH (D'1000')
0071C8 6E??           00168                 MOVWF   CEXreg+2
0071CA 0E00           00169                 MOVLW   0
0071CC 6A??           00170                 CLRF    CEXreg
0071CE 6A??           00171                 CLRF    CEXreg+3
                      00172                 ;
0071D0 50??           00173                 MOVF    Gh,W
0071D2 5E??           00174                 SUBWF   DEXreg
0071D4 50??           00175                 MOVF    Gh+1,W
0071D6 5A??           00176                 SUBWFB  DEXreg+1
0071D8 32??           00177                 RRCF    DEXreg+1
0071DA 32??           00178                 RRCF    DEXreg
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 371


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

0071DC 7E??           00179                 BTG     DEXreg+1,7
0071DE 6A??           00180                 CLRF    DEXreg+2
0071E0 6A??           00181                 CLRF    DEXreg+3
0071E2 EC?? F???      00182                 CALL    Divide2416
                      00183                 MOVE    CEXreg,Gh
0071E6 C??? F???          M                 MOVFF   CEXreg,Gh
0071EA C??? F???          M                 MOVFF   (CEXreg+1),(Gh+1)
                      00184         ; Move the results
                      00185                 MOVEC   Gh,Src
0071EE 01??               M                 MOVLR   HIGH (Src)
0071F0 0E??               M                 MOVLW   LOW (Gh)
0071F2 6E??               M                 MOVWF   (Src)
0071F4 0E??               M                 MOVLW   HIGH (Gh)
0071F6 6E??               M                 MOVWF   (Src+1)
0071F8 0E04           00186                 MOVLW   4
0071FA 01??           00187                 MOVLB   HIGH Cnt
0071FC 6E??           00188                 MOVWF   Cnt
0071FE EC?? F???      00189                 CALL    BlkMove
007202 0012           00190                 RETURN
                      00191 
                      00192 
                      00193 ; Define a channels gain parameters to convert raw ADC counts to normalized units
                      00194 ; for a non-centering channel.
                      00195 ; Steps:
                      00196 ;       1.) Read RT/DWN position
                      00197 ;       2.) Read LT/UP position
                      00198 ;       Ct = LT/UP
                      00199 ;       GH = 1000 * 256/(RT/DWN-Ct)
                      00200 ; Results placed in the following reg during the calculations then moved to
                      00201 ; final location:
                      00202 ;       Gh,Ct
                      00203 ; On call the parameters needed are packed in the DXreg. The MSB contains
                      00204 ; the ADC channel number and the LSB contains the low 8 bit of the location
                      00205 ; address for the results. Its assumed that are destinations are in the
                      00206 ; same page.
                      00207 ; DXreg = (ADC channel):(low byte address of Destination)
007204                00208 JSncChan
                      00209         ; Load the Dst register and the ADC channel
007204 01??           00210                 MOVLB   HIGH DXreg
007206 50??           00211                 MOVF    DXreg,W
007208 6E??           00212                 MOVWF   Dst
00720A 0E??           00213                 MOVLW   HIGH (AHG)
00720C 6E??           00214                 MOVWF   Dst+1
00720E 50??           00215                 MOVF    DXreg+1,W
                      00216         ; Save channel in Areg
007210 01??           00217                 MOVLB   HIGH Atemp
007212 6E??           00218                 MOVWF   Atemp
                      00219         ; Get the RT/DWN position
                      00220                 CALLFL  LCDsendCMD,LINE2
007214 0EC0               M                 MOVLW   (LINE2)
007216 EC?? F???          M                 CALL    (LCDsendCMD)
                      00221                 PrintMess JCALMES15
00721A 0E??               M                 MOVLW   UPPER (JCALMES15)
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 372


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

00721C 6EF8               M                 MOVWF   TBLPTRU,A
00721E 0E??               M                 MOVLW   HIGH (JCALMES15)
007220 6EF7               M                 MOVWF   TBLPTRH,A
007222 0E??               M                 MOVLW   LOW (JCALMES15)
007224 6EF6               M                 MOVWF   TBLPTRL,A
007226 EC?? F???          M                 CALL    LCDsendMess
                      00222                 CALLF   Option
00722A EC?? F???          M                 CALL    (Option)
00722E A0D8           00223                 BTFSS   ALUSTA,C,A
007230 EF?? F???      00224                 GOTO    $-6
007234 01??           00225                 MOVLB   HIGH Atemp
007236 50??           00226                 MOVF    Atemp,W
                      00227                 CALLFW  ReadADC256
007238 EC?? F???          M                 CALL    (ReadADC256)
00723C C??? F???      00228                 MOVFF   ADCsum+1,Gh
007240 C??? F???      00229                 MOVFF   ADCsum+2,Gh+1
007244 0EFA           00230                 MOVLW   D'250'
                      00231                 CALLFW  Delay1mS
007246 EC?? F???          M                 CALL    (Delay1mS)
                      00232         ; Get the LT/UP position
                      00233                 CALLFL  LCDsendCMD,LINE2
00724A 0EC0               M                 MOVLW   (LINE2)
00724C EC?? F???          M                 CALL    (LCDsendCMD)
                      00234                 PrintMess JCALMES16
007250 0E??               M                 MOVLW   UPPER (JCALMES16)
007252 6EF8               M                 MOVWF   TBLPTRU,A
007254 0E??               M                 MOVLW   HIGH (JCALMES16)
007256 6EF7               M                 MOVWF   TBLPTRH,A
007258 0E??               M                 MOVLW   LOW (JCALMES16)
00725A 6EF6               M                 MOVWF   TBLPTRL,A
00725C EC?? F???          M                 CALL    LCDsendMess
007260 EC?? F???      00235                 CALL    Option
007264 A0D8           00236                 BTFSS   ALUSTA,C,A
007266 EF?? F???      00237                 GOTO    $-6
00726A 01??           00238                 MOVLB   HIGH Atemp
00726C 50??           00239                 MOVF    Atemp,W
                      00240                 CALLFW  ReadADC256
00726E EC?? F???          M                 CALL    (ReadADC256)
007272 C??? F???      00241                 MOVFF   ADCsum+1,Ct
007276 C??? F???      00242                 MOVFF   ADCsum+2,Ct+1
00727A 0EFA           00243                 MOVLW   D'250'
                      00244                 CALLFW  Delay1mS
00727C EC?? F???          M                 CALL    (Delay1mS)
                      00245         ; Now calcuate the gain
                      00246         ; Calculate the gain values.
                      00247         ; Gh = (1000 * 256)/(Gh-Ct)
                      00248                 ; Set the 32 bit CEXreg to 1000 time 256
007280 01??           00249                 MOVLB   HIGH CEXreg
007282 0EE8           00250                 MOVLW   LOW (D'1000')
007284 6E??           00251                 MOVWF   CEXreg+1
007286 0E03           00252                 MOVLW   HIGH (D'1000')
007288 6E??           00253                 MOVWF   CEXreg+2
00728A 0E00           00254                 MOVLW   0
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 373


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

00728C 6A??           00255                 CLRF    CEXreg
00728E 6A??           00256                 CLRF    CEXreg+3
                      00257                 ;
                      00258                 MOVE    Gh,DEXreg
007290 C??? F???          M                 MOVFF   Gh,DEXreg
007294 C??? F???          M                 MOVFF   (Gh+1),(DEXreg+1)
007298 6A??           00259                 CLRF    DEXreg+2
00729A 6A??           00260                 CLRF    DEXreg+3
00729C 01??           00261                 MOVLB   HIGH Ct
00729E 50??           00262                 MOVF    Ct,W
0072A0 5E??           00263                 SUBWF   DEXreg
0072A2 50??           00264                 MOVF    Ct+1,W
0072A4 5A??           00265                 SUBWFB  DEXreg+1
0072A6 AE??           00266                 BTFSS   DEXreg+1,7
0072A8 EF?? F???      00267                 GOTO    $+6
0072AC 0EFF           00268                 MOVLW   0FF
0072AE 6E??           00269                 MOVWF   DEXreg+2
0072B0 6E??           00270                 MOVWF   DEXreg+3
                      00271                 CALLF   Divide2416
0072B2 EC?? F???          M                 CALL    (Divide2416)
                      00272                 MOVE    CEXreg,Gh
0072B6 C??? F???          M                 MOVFF   CEXreg,Gh
0072BA C??? F???          M                 MOVFF   (CEXreg+1),(Gh+1)
                      00273         ; Move the results
                      00274                 MOVEC   Gh,Src
0072BE 01??               M                 MOVLR   HIGH (Src)
0072C0 0E??               M                 MOVLW   LOW (Gh)
0072C2 6E??               M                 MOVWF   (Src)
0072C4 0E??               M                 MOVLW   HIGH (Gh)
0072C6 6E??               M                 MOVWF   (Src+1)
0072C8 0E04           00275                 MOVLW   4
0072CA 01??           00276                 MOVLB   HIGH Cnt
0072CC 6E??           00277                 MOVWF   Cnt
0072CE EC?? F???      00278                 CALL    BlkMove
0072D2 0012           00279                 RETURN
                      00280 
                      00281 ; Define a channels gain parameters to convert raw ADC counts to normalized units
                      00282 ; for a centering channel.
                      00283 ; Steps:
                      00284 ;       1.) Read center position
                      00285 ;       2.) Read RT/DWN position
                      00286 ;       3.) Read LT/UP position
                      00287 ;       Ct = center value
                      00288 ;       GH = 1000 * 256/(RT/DWN-Ct)
                      00289 ;       GL = 1000 * 256/(Ct-LT/UP)
                      00290 ; Results placed in the following reg during the calculations then moved to
                      00291 ; final location:
                      00292 ;       Gh,Ct,Gl
                      00293 ; On call the parameters needed are packed in the DXreg. The MSB contains
                      00294 ; the ADC channel number and the LSB contains the low 8 bit of the location
                      00295 ; address for the results. Its assumed that are destinations are in the
                      00296 ; same page.
                      00297 ; DXreg = (ADC channel):(low byte address of Destination)
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 374


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

0072D4                00298 JScChan
                      00299         ; Load the Dst register and the ADC channel
0072D4 01??           00300                 MOVLB   HIGH DXreg
0072D6 50??           00301                 MOVF    DXreg,W
0072D8 6E??           00302                 MOVWF   Dst
0072DA 0E??           00303                 MOVLW   HIGH (AHG)
0072DC 6E??           00304                 MOVWF   Dst+1
0072DE 50??           00305                 MOVF    DXreg+1,W
                      00306         ; Save channel in Areg
0072E0 01??           00307                 MOVLB   HIGH Atemp
0072E2 6E??           00308                 MOVWF   Atemp
                      00309         ; Get the center position
                      00310                 CALLFL  LCDsendCMD,LINE2
0072E4 0EC0               M                 MOVLW   (LINE2)
0072E6 EC?? F???          M                 CALL    (LCDsendCMD)
                      00311                 PrintMess JCALMES14
0072EA 0E??               M                 MOVLW   UPPER (JCALMES14)
0072EC 6EF8               M                 MOVWF   TBLPTRU,A
0072EE 0E??               M                 MOVLW   HIGH (JCALMES14)
0072F0 6EF7               M                 MOVWF   TBLPTRH,A
0072F2 0E??               M                 MOVLW   LOW (JCALMES14)
0072F4 6EF6               M                 MOVWF   TBLPTRL,A
0072F6 EC?? F???          M                 CALL    LCDsendMess
0072FA EC?? F???      00312                 CALL    Option
0072FE A0D8           00313                 BTFSS   ALUSTA,C,A
007300 EF?? F???      00314                 GOTO    $-6
007304 01??           00315                 MOVLB   HIGH Atemp
007306 50??           00316                 MOVF    Atemp,W
                      00317                 CALLFW  ReadADC256
007308 EC?? F???          M                 CALL    (ReadADC256)
00730C C??? F???      00318                 MOVFF   ADCsum+1,Ct
007310 C??? F???      00319                 MOVFF   ADCsum+2,Ct+1
007314 0EFA           00320                 MOVLW   D'250'
                      00321                 CALLFW  Delay1mS
007316 EC?? F???          M                 CALL    (Delay1mS)
                      00322         ; Get the RT/DWN position
                      00323                 CALLFL  LCDsendCMD,LINE2
00731A 0EC0               M                 MOVLW   (LINE2)
00731C EC?? F???          M                 CALL    (LCDsendCMD)
                      00324                 PrintMess JCALMES15
007320 0E??               M                 MOVLW   UPPER (JCALMES15)
007322 6EF8               M                 MOVWF   TBLPTRU,A
007324 0E??               M                 MOVLW   HIGH (JCALMES15)
007326 6EF7               M                 MOVWF   TBLPTRH,A
007328 0E??               M                 MOVLW   LOW (JCALMES15)
00732A 6EF6               M                 MOVWF   TBLPTRL,A
00732C EC?? F???          M                 CALL    LCDsendMess
007330 EC?? F???      00325                 CALL    Option
007334 A0D8           00326                 BTFSS   ALUSTA,C,A
007336 EF?? F???      00327                 GOTO    $-6
00733A 01??           00328                 MOVLB   HIGH Atemp
00733C 50??           00329                 MOVF    Atemp,W
                      00330                 CALLFW  ReadADC256
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 375


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

00733E EC?? F???          M                 CALL    (ReadADC256)
007342 C??? F???      00331                 MOVFF   ADCsum+1,Gh
007346 C??? F???      00332                 MOVFF   ADCsum+2,Gh+1
00734A 0EFA           00333                 MOVLW   D'250'
                      00334                 CALLFW  Delay1mS
00734C EC?? F???          M                 CALL    (Delay1mS)
                      00335         ; Get the LT/UP position
                      00336                 CALLFL  LCDsendCMD,LINE2
007350 0EC0               M                 MOVLW   (LINE2)
007352 EC?? F???          M                 CALL    (LCDsendCMD)
                      00337                 PrintMess JCALMES16
007356 0E??               M                 MOVLW   UPPER (JCALMES16)
007358 6EF8               M                 MOVWF   TBLPTRU,A
00735A 0E??               M                 MOVLW   HIGH (JCALMES16)
00735C 6EF7               M                 MOVWF   TBLPTRH,A
00735E 0E??               M                 MOVLW   LOW (JCALMES16)
007360 6EF6               M                 MOVWF   TBLPTRL,A
007362 EC?? F???          M                 CALL    LCDsendMess
007366 EC?? F???      00338                 CALL    Option
00736A A0D8           00339                 BTFSS   ALUSTA,C,A
00736C EF?? F???      00340                 GOTO    $-6
007370 01??           00341                 MOVLB   HIGH Atemp
007372 50??           00342                 MOVF    Atemp,W
                      00343                 CALLFW  ReadADC256
007374 EC?? F???          M                 CALL    (ReadADC256)
007378 C??? F???      00344                 MOVFF   ADCsum+1,Gl
00737C C??? F???      00345                 MOVFF   ADCsum+2,Gl+1
007380 0EFA           00346                 MOVLW   D'250'
                      00347                 CALLFW  Delay1mS
007382 EC?? F???          M                 CALL    (Delay1mS)
                      00348         ; Calculate the gain values.
                      00349         ; Gh = (1000 * 256)/(Gh-Ct)
                      00350                 ; Set the 32 bit CEXreg to 1000 time 256
007386 01??           00351                 MOVLB   HIGH CEXreg
007388 0EE8           00352                 MOVLW   LOW (D'1000')
00738A 6E??           00353                 MOVWF   CEXreg+1
00738C 0E03           00354                 MOVLW   HIGH (D'1000')
00738E 6E??           00355                 MOVWF   CEXreg+2
007390 0E00           00356                 MOVLW   0
007392 6A??           00357                 CLRF    CEXreg
007394 6A??           00358                 CLRF    CEXreg+3
                      00359                 ;
                      00360                 MOVE    Gh,DEXreg
007396 C??? F???          M                 MOVFF   Gh,DEXreg
00739A C??? F???          M                 MOVFF   (Gh+1),(DEXreg+1)
00739E 6A??           00361                 CLRF    DEXreg+2
0073A0 6A??           00362                 CLRF    DEXreg+3
0073A2 01??           00363                 MOVLB   HIGH Ct
0073A4 50??           00364                 MOVF    Ct,W
0073A6 5E??           00365                 SUBWF   DEXreg
0073A8 50??           00366                 MOVF    Ct+1,W
0073AA 5A??           00367                 SUBWFB  DEXreg+1
0073AC AE??           00368                 BTFSS   DEXreg+1,7
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 376


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

0073AE EF?? F???      00369                 GOTO    $+6
0073B2 0EFF           00370                 MOVLW   0FF
0073B4 6E??           00371                 MOVWF   DEXreg+2
0073B6 6E??           00372                 MOVWF   DEXreg+3
0073B8 EC?? F???      00373                 CALL    Divide2416
                      00374                 MOVE    CEXreg,Gh
0073BC C??? F???          M                 MOVFF   CEXreg,Gh
0073C0 C??? F???          M                 MOVFF   (CEXreg+1),(Gh+1)
                      00375         ; Gl = (1000 * 256)/(Ct-Gl)
                      00376                 ; Set the 32 bit CEXreg to 1000 time 256
0073C4 01??           00377                 MOVLB   HIGH CEXreg
0073C6 0EE8           00378                 MOVLW   LOW (D'1000')
0073C8 6E??           00379                 MOVWF   CEXreg+1
0073CA 0E03           00380                 MOVLW   HIGH (D'1000')
0073CC 6E??           00381                 MOVWF   CEXreg+2
0073CE 0E00           00382                 MOVLW   0
0073D0 6A??           00383                 CLRF    CEXreg
0073D2 6A??           00384                 CLRF    CEXreg+3
                      00385                 ;
                      00386                 MOVE    Ct,DEXreg
0073D4 C??? F???          M                 MOVFF   Ct,DEXreg
0073D8 C??? F???          M                 MOVFF   (Ct+1),(DEXreg+1)
0073DC 6A??           00387                 CLRF    DEXreg+2
0073DE 6A??           00388                 CLRF    DEXreg+3
0073E0 01??           00389                 MOVLB   HIGH Gl
0073E2 50??           00390                 MOVF    Gl,W
0073E4 5E??           00391                 SUBWF   DEXreg
0073E6 50??           00392                 MOVF    Gl+1,W
0073E8 5A??           00393                 SUBWFB  DEXreg+1
0073EA AE??           00394                 BTFSS   DEXreg+1,7
0073EC EF?? F???      00395                 GOTO    $+6
0073F0 0EFF           00396                 MOVLW   0FF
0073F2 6E??           00397                 MOVWF   DEXreg+2
0073F4 6E??           00398                 MOVWF   DEXreg+3
0073F6 EC?? F???      00399                 CALL    Divide2416
                      00400                 MOVE    CEXreg,Gl
0073FA C??? F???          M                 MOVFF   CEXreg,Gl
0073FE C??? F???          M                 MOVFF   (CEXreg+1),(Gl+1)
                      00401         ; Move the results
                      00402                 MOVEC   Gh,Src
007402 01??               M                 MOVLR   HIGH (Src)
007404 0E??               M                 MOVLW   LOW (Gh)
007406 6E??               M                 MOVWF   (Src)
007408 0E??               M                 MOVLW   HIGH (Gh)
00740A 6E??               M                 MOVWF   (Src+1)
00740C 0E06           00403                 MOVLW   6
00740E 01??           00404                 MOVLB   HIGH Cnt
007410 6E??           00405                 MOVWF   Cnt
007412 EC?? F???      00406                 CALL    BlkMove
007416 0012           00407                 RETURN
                      00408                 
                      00409 ; This function is used to calibrate the voltmeter used for
                      00410 ; both the transmitter voltage monitor and the receiver voltmeter.
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 377


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00411 ; On call:
                      00412 ;             Ftemp = ADC channel number
                      00413 ;             BXreg = Voltmeter gain control, this value is
                      00414 ;                     adjusted by this function and contains the
                      00415 ;                     result when this function exits.          
007418                00416 CalVoltMeter
                      00417                 CALLFL  Delay1mS,D'20'
007418 0E14               M                 MOVLW   (D'20')
00741A EC?? F???          M                 CALL    (Delay1mS)
                      00418         ; Read the ADC and calculate the voltage
00741E 01??           00419                 MOVLB   HIGH Ftemp
007420 50??           00420                 MOVF    Ftemp,W
                      00421                 CALLFW  ADCread
007422 EC?? F???          M                 CALL    (ADCread)
                      00422         ; Display the voltage
                      00423                 CALLFL  LCDsendCMD,LINE2
007426 0EC0               M                 MOVLW   (LINE2)
007428 EC?? F???          M                 CALL    (LCDsendCMD)
                      00424                 PrintMess MVOLTS
00742C 0E??               M                 MOVLW   UPPER (MVOLTS)
00742E 6EF8               M                 MOVWF   TBLPTRU,A
007430 0E??               M                 MOVLW   HIGH (MVOLTS)
007432 6EF7               M                 MOVWF   TBLPTRH,A
007434 0E??               M                 MOVLW   LOW (MVOLTS)
007436 6EF6               M                 MOVWF   TBLPTRL,A
007438 EC?? F???          M                 CALL    LCDsendMess
                      00425                 CALLFL  LCDsendCMD,LINE2+CVMPOS
00743C 0ECB               M                 MOVLW   (LINE2+CVMPOS)
00743E EC?? F???          M                 CALL    (LCDsendCMD)
                      00426                 MOVE    Pos,AXreg
007442 C??? F???          M                 MOVFF   Pos,AXreg
007446 C??? F???          M                 MOVFF   (Pos+1),(AXreg+1)
00744A EC?? F???      00427                 CALL    Mult1616
00744E 50??           00428                 MOVF    CEXreg+1,W
007450 6E??           00429                 MOVWF   CEXreg
007452 50??           00430                 MOVF    CEXreg+2,W
007454 6E??           00431                 MOVWF   CEXreg+1
007456 6A??           00432                 CLRF    CEXreg+2
007458 EC?? F???      00433                 CALL    Int2Str
00745C 0E20           00434                 MOVLW   ' '
00745E 6E??           00435                 MOVWF   Areg
007460 0E30           00436                 MOVLW   '0'
007462 64??           00437                 CPFSGT  Buffer
007464 C??? F???      00438                 MOVFF   Areg,Buffer
                      00439                 CALLFF  LCDsendData,Buffer
007468 5000               M                 MOVFP   (Buffer),WREG
00746A EC?? F???          M                 CALL    (LCDsendData)
                      00440                 CALLFF  LCDsendData,Buffer+1
00746E 5000               M                 MOVFP   (Buffer+1),WREG
007470 EC?? F???          M                 CALL    (LCDsendData)
                      00441                 CALLFL  LCDsendData,'.'
007474 0E2E               M                 MOVLW   ('.')
007476 EC?? F???          M                 CALL    (LCDsendData)
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 378


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00442                 CALLFF  LCDsendData,Buffer+2
00747A 5000               M                 MOVFP   (Buffer+2),WREG
00747C EC?? F???          M                 CALL    (LCDsendData)
                      00443                 CALLFF  LCDsendData,Buffer+3
007480 5000               M                 MOVFP   (Buffer+3),WREG
007482 EC?? F???          M                 CALL    (LCDsendData)
                      00444         ; Test the elevator stick and adjust the gain
007486 EC?? F???      00445                 CALL    Elevator
00748A A4D8           00446                 BTFSS   ALUSTA,Z,A
00748C EF?? F???      00447                 GOTO    CalVolt1
007490 01??           00448                 MOVLB   HIGH BXreg
007492 2A??           00449                 INCF    BXreg
007494 B4D8           00450                 BTFSC   ALUSTA,Z,A
007496 2A??           00451                 INCF    BXreg+1
007498 EF?? F???      00452                 GOTO    CalVoltMeter
00749C                00453 CalVolt1
00749C A0D8           00454                 BTFSS   ALUSTA,C,A
00749E EF?? F???      00455                 GOTO    CalVolt2
0074A2 01??           00456                 MOVLB   HIGH BXreg
0074A4 06??           00457                 DECF    BXreg
0074A6 0EFF           00458                 MOVLW   0FF
0074A8 60??           00459                 CPFSLT  BXreg
0074AA 06??           00460                 DECF    BXreg+1
0074AC EF?? F???      00461                 GOTO    CalVoltMeter
                      00462         ; Exit if the Option button is pressed
0074B0                00463 CalVolt2
0074B0 EC?? F???      00464                 CALL    Option
0074B4 A0D8           00465                 BTFSS   ALUSTA,C,A
0074B6 EF?? F???      00466                 GOTO    CalVoltMeter            
0074BA 0012           00467                 RETURN
                      00468 
                      00469 
                      00470 ; This function is called after the frequence band is changed
                      00471 
0074BC                00472 PostBand
0074BC 0EFF           00473                 MOVLW   0FF
0074BE CFE8 F???      00474                 MOVFF   WREG,ModelChannel
0074C2 EC?? F???      00475                 CALL    PLLinit
0074C6 0012           00476                 RETURN
                      00477                 
                      00478 ; This function is called after the pilot has selected the desired channel order.
                      00479 ; This function uses the value in Atemp to define the order:
                      00480 ; 1 = ACE,EART5678
                      00481 ; 2 = Futaba, AETR5678
                      00482 ; 3 = Airtronics, EATR5678
                      00483 ; 4 = JR, TAER5678
0074C8                00484 PostSetOrder
                      00485         ; Set channels 5,6,7, and 8. These are the same for all configurations
0074C8 01??           00486                 MOVLB   HIGH ChannelOrder
0074CA 0E05           00487                 MOVLW   5
0074CC 6E??           00488                 MOVWF   ChannelOrder+4
0074CE 0E06           00489                 MOVLW   6
0074D0 6E??           00490                 MOVWF   ChannelOrder+5
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 379


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

0074D2 0E07           00491                 MOVLW   7
0074D4 6E??           00492                 MOVWF   ChannelOrder+6
0074D6 0E08           00493                 MOVLW   8
0074D8 6E??           00494                 MOVWF   ChannelOrder+7          
                      00495         ; Test the selected order and set A,E,R,T depending on option selected.
0074DA 01??           00496                 MOVLB   HIGH Atemp
0074DC 0E01           00497                 MOVLW   1
0074DE 62??           00498                 CPFSEQ  Atemp
0074E0 EF?? F???      00499                 GOTO    PSO1
                      00500         ; Here if ACE order
0074E4 01??           00501                 MOVLB   HIGH ChannelOrder
0074E6 0E02           00502                 MOVLW   2
0074E8 6E??           00503                 MOVWF   ChannelOrder
0074EA 0E01           00504                 MOVLW   1
0074EC 6E??           00505                 MOVWF   ChannelOrder+1
0074EE 0E03           00506                 MOVLW   3
0074F0 6E??           00507                 MOVWF   ChannelOrder+2
0074F2 0E04           00508                 MOVLW   4
0074F4 6E??           00509                 MOVWF   ChannelOrder+3          
0074F6 0012           00510                 RETURN
                      00511         ; Test if Futaba
0074F8                00512 PSO1
0074F8 01??           00513                 MOVLB   HIGH Atemp
0074FA 0E02           00514                 MOVLW   2
0074FC 62??           00515                 CPFSEQ  Atemp
0074FE EF?? F???      00516                 GOTO    PSO2
                      00517         ; Here if Futaba order
007502 01??           00518                 MOVLB   HIGH ChannelOrder
007504 0E01           00519                 MOVLW   1
007506 6E??           00520                 MOVWF   ChannelOrder
007508 0E02           00521                 MOVLW   2
00750A 6E??           00522                 MOVWF   ChannelOrder+1
00750C 0E04           00523                 MOVLW   4
00750E 6E??           00524                 MOVWF   ChannelOrder+2
007510 0E03           00525                 MOVLW   3
007512 6E??           00526                 MOVWF   ChannelOrder+3          
007514 0012           00527                 RETURN
                      00528         ; Test if Airtronics
007516                00529 PSO2
007516 01??           00530                 MOVLB   HIGH Atemp
007518 0E03           00531                 MOVLW   3
00751A 62??           00532                 CPFSEQ  Atemp
00751C EF?? F???      00533                 GOTO    PSO3
                      00534         ; Here if Airtronics order
007520 01??           00535                 MOVLB   HIGH ChannelOrder
007522 0E02           00536                 MOVLW   2
007524 6E??           00537                 MOVWF   ChannelOrder
007526 0E01           00538                 MOVLW   1
007528 6E??           00539                 MOVWF   ChannelOrder+1
00752A 0E04           00540                 MOVLW   4
00752C 6E??           00541                 MOVWF   ChannelOrder+2
00752E 0E03           00542                 MOVLW   3
007530 6E??           00543                 MOVWF   ChannelOrder+3          
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 380


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

007532 0012           00544                 RETURN
                      00545         ; Test if JR
007534                00546 PSO3
007534 01??           00547                 MOVLB   HIGH Atemp
007536 0E04           00548                 MOVLW   4
007538 62??           00549                 CPFSEQ  Atemp
00753A 0012           00550                 RETURN
                      00551         ; Here if JR order
00753C 01??           00552                 MOVLB   HIGH ChannelOrder
00753E 0E04           00553                 MOVLW   4
007540 6E??           00554                 MOVWF   ChannelOrder
007542 0E01           00555                 MOVLW   1
007544 6E??           00556                 MOVWF   ChannelOrder+1
007546 0E02           00557                 MOVLW   2
007548 6E??           00558                 MOVWF   ChannelOrder+2
00754A 0E03           00559                 MOVLW   3
00754C 6E??           00560                 MOVWF   ChannelOrder+3          
00754E 0012           00561                 RETURN
                      00562 
                      00563 ;
                      00564 ; The following routines are the Apply to All options supported in the system menu
                      00565 ;
                      00566                 
                      00567                 
                      00568                 
                      00569                 
                      00570                 
                      01605         Include <SelFreq.asm>
                      00001 ;
                      00002 ; This function will display the selected frequency on the display line pointed
                      00003 ; to by the number in Ctemp. The Fband flag is used to define the 
                      00004 ; frequency band.
                      00005 ;
                      00006 ; Fband:
                      00007 ;     1 = 50 MHz
                      00008 ;     2 = 53 MHz
                      00009 ;     3 = 72 MHz
                      00010 ;
007550                00011 DisplayFrequency
                      00012         ; If the OFF flag is set, display OFF and exit...
007550 01??           00013                 MOVLB   HIGH SelFreq
007552 0EFF           00014                 MOVLW   0FF
007554 62??           00015                 CPFSEQ  SelFreq
007556 EF?? F???      00016                 GOTO    DF0
00755A 01??           00017                 MOVLR   HIGH Ctemp
00755C 50??           00018                 MOVF    Ctemp,W
                      00019                 CALLFW  LCDsendCMD
00755E EC?? F???          M                 CALL    (LCDsendCMD)
                      00020                 PrintMess MES6
007562 0E??               M                 MOVLW   UPPER (MES6)
007564 6EF8               M                 MOVWF   TBLPTRU,A
007566 0E??               M                 MOVLW   HIGH (MES6)
007568 6EF7               M                 MOVWF   TBLPTRH,A
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 381


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

00756A 0E??               M                 MOVLW   LOW (MES6)
00756C 6EF6               M                 MOVWF   TBLPTRL,A
00756E EC?? F???          M                 CALL    LCDsendMess
007572 0012           00021                 RETURN
                      00022         ; Display the selected freq...
007574                00023 DF0
                      00024         ; Test if its 53MHz
007574 01??           00025                 MOVLB   HIGH Fband
007576 B0??           00026                 BTFSC   Fband,0
007578 EF?? F???      00027                 GOTO    DF50MHz
00757C A2??           00028                 BTFSS   Fband,1
00757E EF?? F???      00029                 GOTO    DF50MHz
                      00030         ; Here if 53MHz
007582 01??           00031                 MOVLB   HIGH Ctemp
007584 50??           00032                 MOVF    Ctemp,W
                      00033                 CALLFW  LCDsendCMD
007586 EC?? F???          M                 CALL    (LCDsendCMD)
                      00034                 PrintMess MES5
00758A 0E??               M                 MOVLW   UPPER (MES5)
00758C 6EF8               M                 MOVWF   TBLPTRU,A
00758E 0E??               M                 MOVLW   HIGH (MES5)
007590 6EF7               M                 MOVWF   TBLPTRH,A
007592 0E??               M                 MOVLW   LOW (MES5)
007594 6EF6               M                 MOVWF   TBLPTRL,A
007596 EC?? F???          M                 CALL    LCDsendMess
00759A 01??           00035                 MOVLB   HIGH Ctemp
00759C 50??           00036                 MOVF    Ctemp,W
00759E 0F08           00037                 ADDLW   CH53POS
                      00038                 CALLFW  LCDsendCMD
0075A0 EC?? F???          M                 CALL    (LCDsendCMD)
0075A4 01??           00039                 MOVLB   HIGH SelFreq
0075A6 0E31           00040                 MOVLW   031
0075A8 2400           00041                 ADDWF   SelFreq,0
                      00042                 CALLFW  LCDsendData
0075AA EC?? F???          M                 CALL    (LCDsendData)
0075AE 0012           00043                 RETURN
0075B0                00044 DF50MHz
                      00045         ; Test if its 50MHz
0075B0 01??           00046                 MOVLB   HIGH Fband
0075B2 A0??           00047                 BTFSS   Fband,0
0075B4 EF?? F???      00048                 GOTO    DF72MHz
0075B8 B2??           00049                 BTFSC   Fband,1
0075BA EF?? F???      00050                 GOTO    DF72MHz
                      00051         ; Here if its 50MHz     
0075BE 01??           00052                 MOVLB   HIGH Ctemp
0075C0 50??           00053                 MOVF    Ctemp,W
                      00054                 CALLFW  LCDsendCMD
0075C2 EC?? F???          M                 CALL    (LCDsendCMD)
                      00055                 PrintMess MES14
0075C6 0E??               M                 MOVLW   UPPER (MES14)
0075C8 6EF8               M                 MOVWF   TBLPTRU,A
0075CA 0E??               M                 MOVLW   HIGH (MES14)
0075CC 6EF7               M                 MOVWF   TBLPTRH,A
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 382


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

0075CE 0E??               M                 MOVLW   LOW (MES14)
0075D0 6EF6               M                 MOVWF   TBLPTRL,A
0075D2 EC?? F???          M                 CALL    LCDsendMess
0075D6 01??           00056                 MOVLB   HIGH Ctemp
0075D8 50??           00057                 MOVF    Ctemp,W
0075DA 0F0E           00058                 ADDLW   CH50POS
                      00059                 CALLFW  LCDsendCMD
0075DC EC?? F???          M                 CALL    (LCDsendCMD)
0075E0 01??           00060                 MOVLB   HIGH SelFreq
0075E2 0E30           00061                 MOVLW   030
0075E4 24??           00062                 ADDWF   SelFreq,W
                      00063                 CALLFW  LCDsendData
0075E6 EC?? F???          M                 CALL    (LCDsendData)
                      00064                 ; Now do the frequency part...
0075EA 01??           00065                 MOVLB   HIGH SelFreq
0075EC 50??           00066                 MOVF    SelFreq,W
0075EE 90D8           00067                 BCF     ALUSTA,C
0075F0 36E8           00068                 RLCF    WREG
0075F2 0F50           00069                 ADDLW   D'80'
                      00070                 ; WREG now holds the variable part of the freq,
                      00071                 ; convert it to a string
0075F4 01??           00072                 MOVLB   HIGH CEXreg
0075F6 6E??           00073                 MOVWF   CEXreg
0075F8 6A??           00074                 CLRF    CEXreg+1
0075FA 6A??           00075                 CLRF    CEXreg+2
0075FC 6A??           00076                 CLRF    CEXreg+3
0075FE EC?? F???      00077                 CALL    Int2Str
                      00078                 ; Now Print the number...
007602 01??           00079                 MOVLB   HIGH Ctemp
007604 50??           00080                 MOVF    Ctemp,W
007606 0F04           00081                 ADDLW   CH50MHZPOS
                      00082                 CALLFW  LCDsendCMD
007608 EC?? F???          M                 CALL    (LCDsendCMD)
00760C 50??           00083                 MOVF    Buffer+3,W
                      00084                 CALLFW  LCDsendData
00760E EC?? F???          M                 CALL    (LCDsendData)
007612 50??           00085                 MOVF    Buffer+4,W
                      00086                 CALLFW  LCDsendData
007614 EC?? F???          M                 CALL    (LCDsendData)
007618 0012           00087                 RETURN
00761A                00088 DF72MHz
                      00089         ; Test if its 72MHz
00761A 01??           00090                 MOVLB   HIGH Fband
00761C A0??           00091                 BTFSS   Fband,0
00761E 0012           00092                 RETURN
007620 A2??           00093                 BTFSS   Fband,1
007622 0012           00094                 RETURN
                      00095         ; Here if its 72MHz     
007624 01??           00096                 MOVLB   HIGH Ctemp
007626 50??           00097                 MOVF    Ctemp,W
                      00098                 CALLFW  LCDsendCMD
007628 EC?? F???          M                 CALL    (LCDsendCMD)
                      00099                 PrintMess MES22
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 383


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

00762C 0E??               M                 MOVLW   UPPER (MES22)
00762E 6EF8               M                 MOVWF   TBLPTRU,A
007630 0E??               M                 MOVLW   HIGH (MES22)
007632 6EF7               M                 MOVWF   TBLPTRH,A
007634 0E??               M                 MOVLW   LOW (MES22)
007636 6EF6               M                 MOVWF   TBLPTRL,A
007638 EC?? F???          M                 CALL    LCDsendMess
00763C 01??           00100                 MOVLB   HIGH Ctemp
00763E 50??           00101                 MOVF    Ctemp,W
007640 0F0D           00102                 ADDLW   CH72POS
                      00103                 CALLFW  LCDsendCMD
007642 EC?? F???          M                 CALL    (LCDsendCMD)
007646 01??           00104                 MOVLB   HIGH SelFreq
007648 50??           00105                 MOVF    SelFreq,W
00764A 01??           00106                 MOVLB   HIGH FCN
00764C 2400           00107                 ADDWF   FCN,WREG
00764E 01??           00108                 MOVLB   HIGH CEXreg
007650 6E??           00109                 MOVWF   CEXreg
007652 6A??           00110                 CLRF    CEXreg+1 
007654 6A??           00111                 CLRF    CEXreg+2
007656 6A??           00112                 CLRF    CEXreg+3
                      00113                 CALLF   LCDint2
007658 EC?? F???          M                 CALL    (LCDint2)
                      00114                 ; Now do the frequency part...
00765C 01??           00115                 MOVLB   HIGH SelFreq
00765E 50??           00116                 MOVF    SelFreq,W
007660 90D8           00117                 BCF     ALUSTA,C
007662 36E8           00118                 RLCF    WREG
007664 0F01           00119                 ADDLW   D'01'
                      00120                 ; WREG now holds the variable part of the freq,
                      00121                 ; convert it to a string
007666 01??           00122                 MOVLB   HIGH CEXreg
007668 6E??           00123                 MOVWF   CEXreg
00766A 6A??           00124                 CLRF    CEXreg+1
00766C 6A??           00125                 CLRF    CEXreg+2
00766E 6A??           00126                 CLRF    CEXreg+3
007670 EC?? F???      00127                 CALL    Int2Str
                      00128                 ; Now Print the number...
007674 01??           00129                 MOVLB   HIGH Ctemp
007676 50??           00130                 MOVF    Ctemp,W
007678 0F04           00131                 ADDLW   CH72MHZPOS
                      00132                 CALLFW  LCDsendCMD
00767A EC?? F???          M                 CALL    (LCDsendCMD)
00767E 50??           00133                 MOVF    Buffer+3,W
                      00134                 CALLFW  LCDsendData
007680 EC?? F???          M                 CALL    (LCDsendData)
007684 50??           00135                 MOVF    Buffer+4,W
                      00136                 CALLFW  LCDsendData
007686 EC?? F???          M                 CALL    (LCDsendData)
00768A 0012           00137                 RETURN
                      00138 
                      00139 ;
                      00140 ; This function allows the pilot to select the frequency using the
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 384


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00141 ; elevator stick...
                      00142 ;
00768C                00143 SelectFrequency
                      00144         ; Display current selection
00768C                00145 SF4
00768C 01??           00146                 MOVLB   HIGH ModelChannel
00768E 0EFF           00147                 MOVLW   0FF
007690 62??           00148                 CPFSEQ  ModelChannel
007692 EF?? F???      00149                 GOTO    SF0
                      00150                 CALLFL  LCDsendCMD,LINE2
007696 0EC0               M                 MOVLW   (LINE2)
007698 EC?? F???          M                 CALL    (LCDsendCMD)
                      00151                 PrintMess MES6
00769C 0E??               M                 MOVLW   UPPER (MES6)
00769E 6EF8               M                 MOVWF   TBLPTRU,A
0076A0 0E??               M                 MOVLW   HIGH (MES6)
0076A2 6EF7               M                 MOVWF   TBLPTRH,A
0076A4 0E??               M                 MOVLW   LOW (MES6)
0076A6 6EF6               M                 MOVWF   TBLPTRL,A
0076A8 EC?? F???          M                 CALL    LCDsendMess
                      00152                 CALLFL  Delay1mS,D'250'
0076AC 0EFA               M                 MOVLW   (D'250')
0076AE EC?? F???          M                 CALL    (Delay1mS)
0076B2 EF?? F???      00153                 GOTO    SF1
                      00154         ; Display the current freq...
0076B6                00155 SF0
0076B6 01??           00156                 MOVLB   HIGH ModelChannel
0076B8 50??           00157                 MOVF    ModelChannel,W
0076BA 01??           00158                 MOVLB   HIGH SelFreq
0076BC 6E??           00159                 MOVWF   SelFreq
0076BE 0EC0           00160                 MOVLW   LINE2
0076C0 01??           00161                 MOVLB   HIGH Ctemp
0076C2 6E??           00162                 MOVWF   Ctemp
0076C4 EC?? F???      00163                 CALL    DisplayFrequency
                      00164                 CALLFL  Delay1mS,D'250'
0076C8 0EFA               M                 MOVLW   (D'250')
0076CA EC?? F???          M                 CALL    (Delay1mS)
                      00165         ; Wait for confirm or advance...
                      00166         ; Elevator = change...
                      00167         ; Option = accept
0076CE                00168 SF1
                      00169         ; Test for change
0076CE EC?? F???      00170                 CALL    Elevator
0076D2 A4D8           00171                 BTFSS   ALUSTA,Z
0076D4 EF?? F???      00172                 GOTO    SF2
                      00173                 ; Here to advance to next selection
0076D8 01??           00174                 MOVLB   HIGH NUMFREQ
0076DA 50??           00175                 MOVF    NUMFREQ,W
0076DC 01??           00176                 MOVLB   HIGH ModelChannel
0076DE 2A??           00177                 INCF    ModelChannel
0076E0 62??           00178                 CPFSEQ  ModelChannel
0076E2 EF?? F???      00179                 GOTO    SF4
0076E6 0EFF           00180                 MOVLW   0FF             ; 0FF to enable OFF option
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 385


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

0076E8 6E??           00181                 MOVWF   ModelChannel
0076EA EF?? F???      00182                 GOTO    SF4
0076EE                00183 SF2
0076EE A0D8           00184                 BTFSS   ALUSTA,C
0076F0 EF?? F???      00185                 GOTO    SF3
                      00186                 ; Here to return to last selection
0076F4 01??           00187                 MOVLB   HIGH ModelChannel
0076F6 06??           00188                 DECF    ModelChannel
0076F8 0EFE           00189                 MOVLW   0FE             ; 0FF to enable OFF option
0076FA 62??           00190                 CPFSEQ  ModelChannel
0076FC EF?? F???      00191                 GOTO    SF4
007700 01??           00192                 MOVLB   HIGH NUMFREQ
007702 50??           00193                 MOVF    NUMFREQ,W
007704 06E8           00194                 DECF    WREG
007706 01??           00195         MOVLB   HIGH ModelChannel
007708 6E??           00196                 MOVWF   ModelChannel
00770A EF?? F???      00197                 GOTO    SF4
00770E                00198 SF3
                      00199                 ; Test if the option button has been pressed
00770E EC?? F???      00200                 CALL    Option
007712 A0D8           00201                 BTFSS   ALUSTA,C
007714 EF?? F???      00202                 GOTO    SF1
                      00203                 ; Save the new frequency to Sprom
007718 C??? FFE8      00204                 MOVFF   Aircraft,WREG   ; Load aircraft number
00771C EC?? F???      00205                 CALL    SaveAircraft
007720 0012           00206                 RETURN
                      01606         Include <Advanced.asm>
                      00001 ;
                      00002 ; This file contins the processing routine specific to the Advanced menu selections.
                      00003 ;
                      00004 
                      00005 ; convert Rreg50 to frequency in KHz units.
007722                00006 PreRef
                      00007    ; Save registers
                      00008         MOVE    AXreg,AXregS
007722 C??? F???          M                 MOVFF   AXreg,AXregS
007726 C??? F???          M                 MOVFF   (AXreg+1),(AXregS+1)
                      00009         MOVE    BXreg,BXregS
00772A C??? F???          M                 MOVFF   BXreg,BXregS
00772E C??? F???          M                 MOVFF   (BXreg+1),(BXregS+1)
                      00010    ; Save the current value
                      00011         MOVE24  Rreg50,Rreg53
007732 C??? F???          M                 MOVFF   Rreg50,Rreg53
007736 C??? F???          M                 MOVFF   (Rreg50+1),(Rreg53+1)
00773A C??? F???          M                 MOVFF   (Rreg50+2),(Rreg53+2)
                      00012    ; Convert the value into the reference freq in KHz
00773E 01??           00013         MOVLR   HIGH Rreg50
007740 32??           00014         RRCF    Rreg50+2
007742 32??           00015         RRCF    Rreg50+1
007744 32??           00016         RRCF    Rreg50
007746 32??           00017         RRCF    Rreg50+2
007748 32??           00018         RRCF    Rreg50+1
00774A 32??           00019         RRCF    Rreg50
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 386


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

00774C 6A??           00020         CLRF    Rreg50+2
00774E 0E3F           00021         MOVLW   0x3F
007750 16??           00022         ANDWF   Rreg50+1,F
                      00023    ; The ref for the 50MHz band is assumed to be 20KHz so
                      00024    ; now multiply by 20 to get in KHz units
                      00025         MOVE    Rreg50,AXreg
007752 C??? F???          M                 MOVFF   Rreg50,AXreg
007756 C??? F???          M                 MOVFF   (Rreg50+1),(AXreg+1)
                      00026         MOVEC   D'20',BXreg
00775A 01??               M                 MOVLR   HIGH (BXreg)
00775C 0E14               M                 MOVLW   LOW (D'20')
00775E 6E??               M                 MOVWF   (BXreg)
007760 0E00               M                 MOVLW   HIGH (D'20')
007762 6E??               M                 MOVWF   (BXreg+1)
007764 EC?? F???      00027         CALL    Mult1616
                      00028         MOVE    CEXreg,Rreg50
007768 C??? F???          M                 MOVFF   CEXreg,Rreg50
00776C C??? F???          M                 MOVFF   (CEXreg+1),(Rreg50+1)
                      00029    ; Now we are ready for the pilot to select the ref freq!
                      00030    ; Restore registers
                      00031         MOVE    AXregS,AXreg
007770 C??? F???          M                 MOVFF   AXregS,AXreg
007774 C??? F???          M                 MOVFF   (AXregS+1),(AXreg+1)
                      00032         MOVE    BXregS,BXreg
007778 C??? F???          M                 MOVFF   BXregS,BXreg
00777C C??? F???          M                 MOVFF   (BXregS+1),(BXreg+1)
007780 0012           00033         RETURN
                      00034         
                      00035 ; convert the frequency back to Rreg50 value
007782                00036 PostRef
                      00037    ; Save registers
                      00038         MOVE    AXreg,AXregS
007782 C??? F???          M                 MOVFF   AXreg,AXregS
007786 C??? F???          M                 MOVFF   (AXreg+1),(AXregS+1)
                      00039         MOVE    BXreg,BXregS
00778A C??? F???          M                 MOVFF   BXreg,BXregS
00778E C??? F???          M                 MOVFF   (BXreg+1),(BXregS+1)
                      00040    ; first divide by 5 to get Rreg units
                      00041         MOVE    Rreg50,CEXreg
007792 C??? F???          M                 MOVFF   Rreg50,CEXreg
007796 C??? F???          M                 MOVFF   (Rreg50+1),(CEXreg+1)
00779A 01??           00042         MOVLR   HIGH CEXreg
00779C 6A??           00043         CLRF    CEXreg+2
                      00044         MOVEC   D'5',DEXreg
00779E 01??               M                 MOVLR   HIGH (DEXreg)
0077A0 0E05               M                 MOVLW   LOW (D'5')
0077A2 6E??               M                 MOVWF   (DEXreg)
0077A4 0E00               M                 MOVLW   HIGH (D'5')
0077A6 6E??               M                 MOVWF   (DEXreg+1)
0077A8 EC?? F???      00045         CALL    Divide2416
                      00046    ; Now clear all but the 14 counter bits in all three Rreg sets, 50, 53, and 72MHz
0077AC 01??           00047         MOVLR   HIGH Rreg53
0077AE 0E03           00048         MOVLW   0x03
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 387


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

0077B0 16??           00049         ANDWF   Rreg53,F
0077B2 0E00           00050         MOVLW   0x00
0077B4 16??           00051         ANDWF   Rreg53+1,F
                      00052         MOVE24  Rreg53,Rreg50
0077B6 C??? F???          M                 MOVFF   Rreg53,Rreg50
0077BA C??? F???          M                 MOVFF   (Rreg53+1),(Rreg50+1)
0077BE C??? F???          M                 MOVFF   (Rreg53+2),(Rreg50+2)
                      00053         MOVE24  Rreg53,Rreg72
0077C2 C??? F???          M                 MOVFF   Rreg53,Rreg72
0077C6 C??? F???          M                 MOVFF   (Rreg53+1),(Rreg72+1)
0077CA C??? F???          M                 MOVFF   (Rreg53+2),(Rreg72+2)
                      00054    ; Make sure the 2 LSB are zero
0077CE 01??           00055         MOVLR   HIGH CEXreg
0077D0 0EFC           00056         MOVLW   0xFC
0077D2 16??           00057         ANDWF   CEXreg,F
                      00058    ; Move the counter data into the regs
0077D4 C??? FFE8      00059         MOVFF   CEXreg,WREG
0077D8 01??           00060     MOVLB       HIGH Rreg50
0077DA 12??           00061         IORWF   Rreg50
0077DC 12??           00062         IORWF   Rreg53
0077DE C??? FFE8      00063         MOVFF   CEXreg+1,WREG
0077E2 12??           00064         IORWF   Rreg50+1
0077E4 12??           00065         IORWF   Rreg53+1
                      00066    ; Multiply count by two and then apply to the 72MHz reg
0077E6 90D8           00067         BCF     ALUSTA,C
0077E8 01??           00068         MOVLR   HIGH CEXreg
0077EA 36??           00069         RLCF    CEXreg
0077EC 36??           00070         RLCF    CEXreg+1
0077EE 01??           00071         MOVLR   HIGH Rreg72
0077F0 C??? FFE8      00072         MOVFF   CEXreg,WREG
0077F4 12??           00073         IORWF   Rreg72
0077F6 C??? FFE8      00074         MOVFF   CEXreg+1,WREG
0077FA 12??           00075         IORWF   Rreg72+1
                      00076    ; Done       
                      00077    ; Restore registers
                      00078         MOVE    AXregS,AXreg
0077FC C??? F???          M                 MOVFF   AXregS,AXreg
007800 C??? F???          M                 MOVFF   (AXregS+1),(AXreg+1)
                      00079         MOVE    BXregS,BXreg
007804 C??? F???          M                 MOVFF   BXregS,BXreg
007808 C??? F???          M                 MOVFF   (BXregS+1),(BXreg+1)
00780C 0012           00080         RETURN
                      00081         
                      00082         
                      06186 
                      06187 ;
                      06188 ; This function is called at startup to load a set of default parameters
                      06189 ; into bank 2, bank 3 and bank 4.
                      06190 ;
00780E                06191 LoadDefaults
                      06192         ; Bank2
                      06193         ; Set table pointer
00780E 0E??           06194                 MOVLW   UPPER DFTgeneral
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 388


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

007810 6EF8           06195                 MOVWF   TBLPTRU,A
007812 0E??           06196                 MOVLW   HIGH DFTgeneral
007814 6EF7           06197                 MOVWF   TBLPTRH,A
007816 0E??           06198                 MOVLW   LOW DFTgeneral
007818 6EF6           06199                 MOVWF   TBLPTRL,A
                      06200         ; Load counter
00781A 0E00           06201                 MOVLW   00
00781C 6E00           06202                 MOVWF   Areg,A
                      06203         ; Setup indirection regs
00781E 0E02           06204                 MOVLW   HIGH BNK2
007820 6EE2           06205                 MOVWF   FSR1H,A
007822 0E00           06206                 MOVLW   LOW BNK2
007824 6EE1           06207                 MOVWF   FSR1L,A
007826                06208 LoadDefaults1
007826 0009           06209                 TBLRD*+
007828 50F5           06210                 MOVF    TABLAT,W,A
00782A 6EE6           06211                 MOVWF   POSTINC1,A
00782C 0600           06212                 DECF    Areg,F,A
00782E 0009           06213                 TBLRD*+
007830 50F5           06214                 MOVF    TABLAT,W,A
007832 6EE6           06215                 MOVWF   POSTINC1,A
007834 2E00           06216                 DECFSZ  Areg,F,A
007836 EF?? F???      06217                 GOTO    LoadDefaults1
00783A                06218 LoadAircraftDefaults
                      06219         ; Bank3 
                      06220         ; Set table pointer
00783A 0E??           06221                 MOVLW   UPPER DFTaircraft
00783C 6EF8           06222                 MOVWF   TBLPTRU,A
00783E 0E??           06223                 MOVLW   HIGH DFTaircraft
007840 6EF7           06224                 MOVWF   TBLPTRH,A
007842 0E??           06225                 MOVLW   LOW DFTaircraft
007844 6EF6           06226                 MOVWF   TBLPTRL,A
                      06227         ; Setup counter
007846 0E00           06228                 MOVLW   00
007848 6E00           06229                 MOVWF   Areg,A
                      06230         ; Setup indirection
00784A 0E03           06231                 MOVLW   HIGH BNK3
00784C 6EE2           06232                 MOVWF   FSR1H,A
00784E 0E00           06233                 MOVLW   LOW BNK3
007850 6EE1           06234                 MOVWF   FSR1L,A
007852                06235 LoadDefaults2
007852 0009           06236                 TBLRD*+
007854 50F5           06237                 MOVF    TABLAT,W,A
007856 6EE6           06238                 MOVWF   POSTINC1,A
007858 0600           06239                 DECF    Areg,F,A
00785A 0009           06240                 TBLRD*+
00785C 50F5           06241                 MOVF    TABLAT,W,A
00785E 6EE6           06242                 MOVWF   POSTINC1,A
007860 2E00           06243                 DECFSZ  Areg,F,A
007862 EF?? F???      06244                 GOTO    LoadDefaults2
                      06245         ; Bank4 
                      06246         ; Set table pointer
007866 0E??           06247                 MOVLW   UPPER DFTaircraft2
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 389


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

007868 6EF8           06248                 MOVWF   TBLPTRU,A
00786A 0E??           06249                 MOVLW   HIGH DFTaircraft2
00786C 6EF7           06250                 MOVWF   TBLPTRH,A
00786E 0E??           06251                 MOVLW   LOW DFTaircraft2
007870 6EF6           06252                 MOVWF   TBLPTRL,A
                      06253         ; Setup counter
007872 0E00           06254                 MOVLW   00
007874 6E00           06255                 MOVWF   Areg,A
                      06256         ; Setup indirection
007876 0E04           06257                 MOVLW   HIGH BNK4
007878 6EE2           06258                 MOVWF   FSR1H,A
00787A 0E00           06259                 MOVLW   LOW BNK4
00787C 6EE1           06260                 MOVWF   FSR1L,A
00787E                06261 LoadDefaults3
00787E 0009           06262                 TBLRD*+
007880 50F5           06263                 MOVF    TABLAT,W,A
007882 6EE6           06264                 MOVWF   POSTINC1,A
007884 0600           06265                 DECF    Areg,F,A
007886 0009           06266                 TBLRD*+
007888 50F5           06267                 MOVF    TABLAT,W,A
00788A 6EE6           06268                 MOVWF   POSTINC1,A
00788C 2E00           06269                 DECFSZ  Areg,F,A
00788E EF?? F???      06270                 GOTO    LoadDefaults3
007892 0012           06271                 RETURN
                      06272 
                      06273 Include         <DigitalTrims.asm>
                      00001 ; DigitalTrims.asm
                      00002 ;
                      00003 ; This file contains the routines used to support Digital Trims on the MicroStar.
                      00004 ; The second line of the display shows the trim position the top line shows the
                      00005 ; trim function being displayed.
                      00006 
                      00007 ; This function is called at powerup to initalize the digital trim
                      00008 ; variables.
007894                00009 DigitalTrimInit
                      00010         MOVEC   0,DTdataAil
007894 01??               M                 MOVLR   HIGH (DTdataAil)
007896 0E00               M                 MOVLW   LOW (0)
007898 6E??               M                 MOVWF   (DTdataAil)
00789A 0E00               M                 MOVLW   HIGH (0)
00789C 6E??               M                 MOVWF   (DTdataAil+1)
                      00011         MOVEC   0,DTdataEle
00789E 01??               M                 MOVLR   HIGH (DTdataEle)
0078A0 0E00               M                 MOVLW   LOW (0)
0078A2 6E??               M                 MOVWF   (DTdataEle)
0078A4 0E00               M                 MOVLW   HIGH (0)
0078A6 6E??               M                 MOVWF   (DTdataEle+1)
                      00012         MOVEC   0,DTdataRud
0078A8 01??               M                 MOVLR   HIGH (DTdataRud)
0078AA 0E00               M                 MOVLW   LOW (0)
0078AC 6E??               M                 MOVWF   (DTdataRud)
0078AE 0E00               M                 MOVLW   HIGH (0)
0078B0 6E??               M                 MOVWF   (DTdataRud+1)
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 390


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00013         MOVEC   0,DTdataTht
0078B2 01??               M                 MOVLR   HIGH (DTdataTht)
0078B4 0E00               M                 MOVLW   LOW (0)
0078B6 6E??               M                 MOVWF   (DTdataTht)
0078B8 0E00               M                 MOVLW   HIGH (0)
0078BA 6E??               M                 MOVWF   (DTdataTht+1)
0078BC 0E00           00014         MOVLW   0
0078BE CFE8 F???      00015         MOVFF   WREG,DTdisplay
0078C2 0012           00016         RETURN
                      00017 
                      00018 ; This is the digital trim processing code that is called in the main run
                      00019 ; loop of the microstar application. This routine processes the digital
                      00020 ; trim requests from all channels.
0078C4                00021 ProcessDtrims
                      00022    ; Test the selected aileron trim, if not digital move to elevator test
0078C4 C??? FFE8      00023         MOVFF   AilTrimCh,WREG
0078C8 0BF0           00024         ANDLW   0xF0
0078CA E0??           00025         BZ      PDele
                      00026    ; Here if its a digital trim
0078CC 3AE8           00027         SWAPF   WREG                    ; Analog trim number to use
                      00028    ; Process aileron ditital trim, read the trim switch
0078CE EC?? F???      00029         CALL    TestTrim                ; Read the trim switch position using analog
                      00030                                         ; trim number in WREG
0078D2 01??           00031         MOVLR   HIGH DTdataAil
0078D4 3A??           00032         SWAPF   DTdataAil
0078D6 90??           00033         BCF     DTdataAil,0
0078D8 92??           00034         BCF     DTdataAil,1
0078DA B0D8           00035         BTFSC   ALUSTA,C
0078DC 80??           00036         BSF     DTdataAil,0
0078DE B4D8           00037         BTFSC   ALUSTA,Z
0078E0 82??           00038         BSF     DTdataAil,1
                      00039         ; Process this trim with the generic routine
                      00040         MOVE    DTdataAil,AXreg
0078E2 C??? F???          M                 MOVFF   DTdataAil,AXreg
0078E6 C??? F???          M                 MOVFF   (DTdataAil+1),(AXreg+1)
                      00041         MOVE    DTail,BXreg
0078EA C??? F???          M                 MOVFF   DTail,BXreg
0078EE C??? F???          M                 MOVFF   (DTail+1),(BXreg+1)
0078F2 EC?? F???      00042         CALL    DigitalTrim
                      00043         MOVE    BXreg,DTail
0078F6 C??? F???          M                 MOVFF   BXreg,DTail
0078FA C??? F???          M                 MOVFF   (BXreg+1),(DTail+1)
                      00044         MOVE    AXreg,DTdataAil
0078FE C??? F???          M                 MOVFF   AXreg,DTdataAil
007902 C??? F???          M                 MOVFF   (AXreg+1),(DTdataAil+1)
                      00045         ; If carry flag is set then update the trim value
007906 A0D8           00046         BTFSS   ALUSTA,C
007908 EF?? F???      00047         GOTO    PD0
                      00048         MOVE    DTail,BXreg
00790C C??? F???          M                 MOVFF   DTail,BXreg
007910 C??? F???          M                 MOVFF   (DTail+1),(BXreg+1)
007914 0E??           00049         MOVLW   LOW DTail
007916 CFE8 F???      00050         MOVFF   WREG,AXreg
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 391


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

00791A 6AE8           00051         CLRF    WREG
00791C CFE8 F???      00052         MOVFF   WREG,AXreg+1
007920 EC?? F???      00053         CALL    EEPROMwriteWord
007924                00054 PD0
                      00055         ; If timer is non zero then set the display flag and exit
007924 C??? FFE8      00056         MOVFF   DTdataAil+1,WREG
007928 12E8           00057         IORWF   WREG
00792A A4D8           00058         BTFSS   ALUSTA,Z
00792C 0E01           00059         MOVLW   1
00792E CFE8 F???      00060         MOVFF   WREG,DTdisplay
007932 66E8           00061         TSTFSZ  WREG
007934 0012           00062         RETURN
007936                00063 PDele
                      00064    ; Test the selected elevator trim, if not digital move to rudder test
007936 C??? FFE8      00065         MOVFF   EleTrimCh,WREG
00793A 0BF0           00066         ANDLW   0xF0
00793C E0??           00067         BZ      PDrud
                      00068    ; Here if its a digital trim
00793E 3AE8           00069         SWAPF   WREG                    ; Analog trim number to use
                      00070    ; Process elevator ditital trim, read the trim switch
007940 EC?? F???      00071         CALL    TestTrim                ; Read the trim switch position using analog
                      00072                                         ; trim number in WREG
007944 01??           00073         MOVLR   HIGH DTdataEle
007946 3A??           00074         SWAPF   DTdataEle
007948 90??           00075         BCF     DTdataEle,0
00794A 92??           00076         BCF     DTdataEle,1
00794C B0D8           00077         BTFSC   ALUSTA,C
00794E 80??           00078         BSF     DTdataEle,0
007950 B4D8           00079         BTFSC   ALUSTA,Z
007952 82??           00080         BSF     DTdataEle,1
                      00081         ; Process this trim with the generic routine
                      00082         MOVE    DTdataEle,AXreg
007954 C??? F???          M                 MOVFF   DTdataEle,AXreg
007958 C??? F???          M                 MOVFF   (DTdataEle+1),(AXreg+1)
                      00083         MOVE    DTele,BXreg
00795C C??? F???          M                 MOVFF   DTele,BXreg
007960 C??? F???          M                 MOVFF   (DTele+1),(BXreg+1)
007964 EC?? F???      00084         CALL    DigitalTrim
                      00085         MOVE    BXreg,DTele
007968 C??? F???          M                 MOVFF   BXreg,DTele
00796C C??? F???          M                 MOVFF   (BXreg+1),(DTele+1)
                      00086         MOVE    AXreg,DTdataEle
007970 C??? F???          M                 MOVFF   AXreg,DTdataEle
007974 C??? F???          M                 MOVFF   (AXreg+1),(DTdataEle+1)
                      00087         ; If carry flag is set then update the trim value
007978 A0D8           00088         BTFSS   ALUSTA,C
00797A EF?? F???      00089         GOTO    PD1
                      00090         MOVE    DTele,BXreg
00797E C??? F???          M                 MOVFF   DTele,BXreg
007982 C??? F???          M                 MOVFF   (DTele+1),(BXreg+1)
007986 0E??           00091         MOVLW   LOW DTele
007988 CFE8 F???      00092         MOVFF   WREG,AXreg
00798C 6AE8           00093         CLRF    WREG
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 392


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

00798E CFE8 F???      00094         MOVFF   WREG,AXreg+1
007992 EC?? F???      00095         CALL    EEPROMwriteWord
007996                00096 PD1
                      00097         ; If timer is non zero then set the display flag and exit
007996 C??? FFE8      00098         MOVFF   DTdataEle+1,WREG
00799A 12E8           00099         IORWF   WREG
00799C A4D8           00100         BTFSS   ALUSTA,Z
00799E 0E02           00101         MOVLW   2
0079A0 CFE8 F???      00102         MOVFF   WREG,DTdisplay
0079A4 66E8           00103         TSTFSZ  WREG
0079A6 0012           00104         RETURN
0079A8                00105 PDrud
                      00106    ; Test the selected rudder trim, if not digital move to throttle test
0079A8 C??? FFE8      00107         MOVFF   RudTrimCh,WREG
0079AC 0BF0           00108         ANDLW   0xF0
0079AE E0??           00109         BZ      PDtht
                      00110    ; Here if its a digital trim
0079B0 3AE8           00111         SWAPF   WREG                    ; Analog trim number to use
                      00112    ; Process rudder ditital trim, read the trim switch
0079B2 EC?? F???      00113         CALL    TestTrim                ; Read the trim switch position using analog
                      00114                                         ; trim number in WREG
0079B6 01??           00115         MOVLR   HIGH DTdataRud
0079B8 3A??           00116         SWAPF   DTdataRud
0079BA 90??           00117         BCF     DTdataRud,0
0079BC 92??           00118         BCF     DTdataRud,1
0079BE B0D8           00119         BTFSC   ALUSTA,C
0079C0 80??           00120         BSF     DTdataRud,0
0079C2 B4D8           00121         BTFSC   ALUSTA,Z
0079C4 82??           00122         BSF     DTdataRud,1
                      00123         ; Process this trim with the generic routine
                      00124         MOVE    DTdataRud,AXreg
0079C6 C??? F???          M                 MOVFF   DTdataRud,AXreg
0079CA C??? F???          M                 MOVFF   (DTdataRud+1),(AXreg+1)
                      00125         MOVE    DTrud,BXreg
0079CE C??? F???          M                 MOVFF   DTrud,BXreg
0079D2 C??? F???          M                 MOVFF   (DTrud+1),(BXreg+1)
0079D6 EC?? F???      00126         CALL    DigitalTrim
                      00127         MOVE    BXreg,DTrud
0079DA C??? F???          M                 MOVFF   BXreg,DTrud
0079DE C??? F???          M                 MOVFF   (BXreg+1),(DTrud+1)
                      00128         MOVE    AXreg,DTdataRud
0079E2 C??? F???          M                 MOVFF   AXreg,DTdataRud
0079E6 C??? F???          M                 MOVFF   (AXreg+1),(DTdataRud+1)
                      00129         ; If carry flag is set then update the trim value
0079EA A0D8           00130         BTFSS   ALUSTA,C
0079EC EF?? F???      00131         GOTO    PD2
                      00132         MOVE    DTrud,BXreg
0079F0 C??? F???          M                 MOVFF   DTrud,BXreg
0079F4 C??? F???          M                 MOVFF   (DTrud+1),(BXreg+1)
0079F8 0E??           00133         MOVLW   LOW DTrud
0079FA CFE8 F???      00134         MOVFF   WREG,AXreg
0079FE 6AE8           00135         CLRF    WREG
007A00 CFE8 F???      00136         MOVFF   WREG,AXreg+1
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 393


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

007A04 EC?? F???      00137         CALL    EEPROMwriteWord
007A08                00138 PD2
                      00139         ; If timer is non zero then set the display flag and exit
007A08 C??? FFE8      00140         MOVFF   DTdataRud+1,WREG
007A0C 12E8           00141         IORWF   WREG
007A0E A4D8           00142         BTFSS   ALUSTA,Z
007A10 0E03           00143         MOVLW   3
007A12 CFE8 F???      00144         MOVFF   WREG,DTdisplay
007A16 66E8           00145         TSTFSZ  WREG
007A18 0012           00146         RETURN
007A1A                00147 PDtht
                      00148    ; Test the selected throttle trim, if not digital exit
007A1A C??? FFE8      00149         MOVFF   ThtTrimCh,WREG
007A1E 0BF0           00150         ANDLW   0xF0
007A20 E0??           00151         BZ      PDexit
                      00152    ; Here if its a digital trim
007A22 3AE8           00153         SWAPF   WREG                    ; Analog trim number to use
                      00154    ; Process throttle ditital trim, read the trim switch
007A24 EC?? F???      00155         CALL    TestTrim                ; Read the trim switch position using analog
                      00156                                         ; trim number in WREG
007A28 01??           00157         MOVLR   HIGH DTdataTht
007A2A 3A??           00158         SWAPF   DTdataTht
007A2C 90??           00159         BCF     DTdataTht,0
007A2E 92??           00160         BCF     DTdataTht,1
007A30 B0D8           00161         BTFSC   ALUSTA,C
007A32 80??           00162         BSF     DTdataTht,0
007A34 B4D8           00163         BTFSC   ALUSTA,Z
007A36 82??           00164         BSF     DTdataTht,1
                      00165         ; Process this trim with the generic routine
                      00166         MOVE    DTdataTht,AXreg
007A38 C??? F???          M                 MOVFF   DTdataTht,AXreg
007A3C C??? F???          M                 MOVFF   (DTdataTht+1),(AXreg+1)
                      00167         MOVE    DTtht,BXreg
007A40 C??? F???          M                 MOVFF   DTtht,BXreg
007A44 C??? F???          M                 MOVFF   (DTtht+1),(BXreg+1)
007A48 EC?? F???      00168         CALL    DigitalTrim
                      00169         MOVE    BXreg,DTtht
007A4C C??? F???          M                 MOVFF   BXreg,DTtht
007A50 C??? F???          M                 MOVFF   (BXreg+1),(DTtht+1)
                      00170         MOVE    AXreg,DTdataTht
007A54 C??? F???          M                 MOVFF   AXreg,DTdataTht
007A58 C??? F???          M                 MOVFF   (AXreg+1),(DTdataTht+1)
                      00171         ; If carry flag is set then update the trim value
007A5C A0D8           00172         BTFSS   ALUSTA,C
007A5E EF?? F???      00173         GOTO    PD3
                      00174         MOVE    DTtht,BXreg
007A62 C??? F???          M                 MOVFF   DTtht,BXreg
007A66 C??? F???          M                 MOVFF   (DTtht+1),(BXreg+1)
007A6A 0E??           00175         MOVLW   LOW DTtht
007A6C CFE8 F???      00176         MOVFF   WREG,AXreg
007A70 6AE8           00177         CLRF    WREG
007A72 CFE8 F???      00178         MOVFF   WREG,AXreg+1
007A76 EC?? F???      00179         CALL    EEPROMwriteWord
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 394


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

007A7A                00180 PD3
                      00181         ; If timer is non zero then set the display flag and exit
007A7A C??? FFE8      00182         MOVFF   DTdataTht+1,WREG
007A7E 12E8           00183         IORWF   WREG
007A80 A4D8           00184         BTFSS   ALUSTA,Z
007A82 0E04           00185         MOVLW   4
007A84 CFE8 F???      00186         MOVFF   WREG,DTdisplay
                      00187    ; Exit!
007A88                00188 PDexit
007A88 0012           00189         RETURN
                      00190 
                      00191 
                      00192 ; This function tests the trim value defined in reg WREG. The BXreg contains the analog
                      00193 ; trim channel's normalized value. This value is used as the digital trim input by
                      00194 ; setting the value to the two analog trim extreams with a center off switch.
                      00195 ;
                      00196 ; On call
                      00197 ;       WREG = Analog trim control used for this digital trim channel
                      00198 ; On return
                      00199 ;       C flag set for right/down
                      00200 ;       Z flag set for left/up
007A8A                00201 TestTrim
                      00202    ; Load BXreg with the referenced analog trim channel
007A8A 6EE1           00203         MOVWF   FSR1L           ; Build pointer to analog trim location
007A8C 06E1           00204         DECF    FSR1L,F,A
007A8E 90D8           00205         BCF     ALUSTA,C
007A90 36E1           00206         RLCF    FSR1L,F,A
007A92 0E??           00207         MOVLW   HIGH Atrim
007A94 6EE2           00208         MOVWF   FSR1H,A
007A96 0E??           00209         MOVLW   LOW Atrim
007A98 26E1           00210         ADDWF   FSR1L,F,A
007A9A 50E6           00211         MOVF    POSTINC1,W      ; Load value into BXreg
007A9C CFE8 F???      00212         MOVFF   WREG,BXreg
007AA0 50E6           00213         MOVF    POSTINC1,W
007AA2 CFE8 F???      00214         MOVFF   WREG,BXreg+1
                      00215    ; Test BXreg sign
007AA6 01??           00216         MOVLR   HIGH BXreg
007AA8 BE??           00217         BTFSC   BXreg+1,7
007AAA EF?? F???      00218         GOTO    TT0
                      00219    ; Here if positive, sub 512, if still pos set Carry flag and exit
007AAE 0E02           00220         MOVLW   2
007AB0 5E??           00221         SUBWF   BXreg+1
007AB2 94D8           00222         BCF     ALUSTA,Z
007AB4 0012           00223         RETURN   
                      00224    ; Here if negative, add 512, if still neg set z flag and exit
007AB6                00225 TT0
007AB6 0E02           00226         MOVLW   2
007AB8 26??           00227         ADDWF   BXreg+1
007ABA 94D8           00228         BCF     ALUSTA,Z
007ABC A0D8           00229         BTFSS   ALUSTA,C
007ABE 84D8           00230         BSF     ALUSTA,Z
007AC0 90D8           00231         BCF     ALUSTA,C
007AC2 0012           00232         RETURN
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 395


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00233 
                      00234 ; This is a generic routine that process a digitial trim. This function is
                      00235 ; called at the the transmitters framming rate. It is assumed this routine 
                      00236 ; is called from the main run loop of the encoder.
                      00237 ;
                      00238 ; On call:
                      00239 ;               AXreg = flag byte, bit 0 = right/down
                      00240 ;                                  bit 1 = left/up
                      00241 ;                                  bit 4 = right/down, last value
                      00242 ;                                  bit 5 = left/up, last value
                      00243 ;               AXreg+1 = tick counter
                      00244 ;               BXreg = Digital trim value 
                      00245 ;
                      00246 ; On return:
                      00247 ;               BXreg = updated trim position
                      00248 ;               C flag set if trim value was changed
                      00249 ; 
007AC4                00250 DigitalTrim
                      00251    ; Determine if there has been a state change on the trim inputs
007AC4 C??? FFE8      00252         MOVFF   AXreg,WREG
007AC8 3AE8           00253         SWAPF   WREG
007ACA 01??           00254         MOVLB   HIGH AXreg
007ACC 18??           00255         XORWF   AXreg,W
007ACE A4D8           00256         BTFSS   ALUSTA,Z
007AD0 EF?? F???      00257         GOTO    DTrim0
                      00258    ;
                      00259    ; Here if there has been no change
                      00260    ;
                      00261      ; If counter is not zero then dec and exit
007AD4 66??           00262         TSTFSZ  AXreg+1
007AD6 EF?? F???      00263         GOTO    DTrim1
                      00264      ; Here if counter is zero
007ADA                00265 DTrim2
007ADA 6AE8           00266         CLRF    WREG
007ADC B0??           00267         BTFSC   AXreg,0
007ADE 0E19           00268         MOVLW   D'25'
007AE0 B2??           00269         BTFSC   AXreg,1
007AE2 0EE7           00270         MOVLW   -D'25'
007AE4 12E8           00271         IORWF   WREG
007AE6 90D8           00272         BCF     ALUSTA,C
007AE8 B4D8           00273         BTFSC   ALUSTA,Z
007AEA 0012           00274         RETURN                  ; Exit if nothing to do
                      00275      ; Update the trim position
007AEC 26??           00276         ADDWF   BXreg,F
007AEE 6AE8           00277         CLRF    WREG
007AF0 B2??           00278         BTFSC   AXreg,1
007AF2 1EE8           00279         COMF    WREG
007AF4 22??           00280         ADDWFC  BXreg+1,F
                      00281      ; Apply limits and beep
007AF6 0E01           00282         MOVLW   D'1'  
007AF8 CFE8 F???      00283         MOVFF   WREG,BeepCyl            ; Set bit time
007AFC EC?? F???      00284         CALL    DigitalTrimLimit        ; C flag set if at limit
007B00 0E01           00285         MOVLW   D'1'
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 396


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

007B02 B0D8           00286         BTFSC   ALUSTA,C
007B04 0E05           00287         MOVLW   D'5'
007B06 EC?? F???      00288         CALL    Beep                    ; Beep
                      00289      ; Set the delay time and exit
007B0A C??? F???      00290         MOVFF   DTrimAdjustDelay,AXreg+1
007B0E 80D8           00291         BSF     ALUSTA,C
007B10 0012           00292         RETURN
                      00293      ; Here if counter is not zero so dec and exit
007B12                00294 DTrim1
007B12 06??           00295         DECF    AXreg+1
007B14 E0??           00296         BZ      DTrim2
007B16 90D8           00297         BCF     ALUSTA,C
007B18 0012           00298         RETURN 
                      00299    ;
                      00300    ; Here if there has been a trim switch change
                      00301    ;
007B1A                00302 DTrim0
                      00303      ; If the switch is in the center position then set a long
                      00304      ; delay time and exit
007B1A C??? FFE8      00305         MOVFF   AXreg,WREG
007B1E 0B03           00306         ANDLW   03
007B20 E1??           00307         BNZ     DTrim2     ; Bypass the delay and jump into the "no change" code
007B22 0E50           00308         MOVLW   D'80'
007B24 CFE8 F???      00309         MOVFF   WREG,AXreg+1
007B28 90D8           00310         BCF     ALUSTA,C
007B2A 0012           00311         RETURN
                      00312 ;
                      00313 ; This function tests the digital trim value saved in the BXreg and makes sure
                      00314 ; it is between -1000 and 1000. If its out of this range it will be set to
                      00315 ; the proper limit.
                      00316 ; Carry flag is set if the limit is reached
                      00317 ;
007B2C                00318 DigitalTrimLimit
                      00319    ; Test the trim to see if its positive or negative
007B2C 01??           00320         MOVLR   HIGH BXreg
007B2E BE??           00321         BTFSC   BXreg+1,7
007B30 EF?? F???      00322         GOTO    DTL0            
                      00323    ; Here if the trim value is positive
007B34 0EE8           00324         MOVLW   LOW D'1000'
007B36 5C??           00325         SUBWF   BXreg,W
007B38 0E03           00326         MOVLW   HIGH D'1000'
007B3A 58??           00327         SUBWFB  BXreg+1,W
007B3C A0D8           00328         BTFSS   ALUSTA,C
007B3E 0012           00329         RETURN
                      00330         ; Over 1000 so set to 1000 and exit
                      00331         MOVEC   D'1000',BXreg
007B40 01??               M                 MOVLR   HIGH (BXreg)
007B42 0EE8               M                 MOVLW   LOW (D'1000')
007B44 6E??               M                 MOVWF   (BXreg)
007B46 0E03               M                 MOVLW   HIGH (D'1000')
007B48 6E??               M                 MOVWF   (BXreg+1)
007B4A 80D8           00332         BSF     ALUSTA,C
007B4C 0012           00333         RETURN
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 397


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00334    ; Here if the trim value is negative         
007B4E                00335 DTL0
007B4E 0EE8           00336         MOVLW   LOW D'1000'
007B50 24??           00337         ADDWF   BXreg,W
007B52 0E03           00338         MOVLW   HIGH D'1000'
007B54 20??           00339         ADDWFC  BXreg+1,W
007B56 70D8           00340         BTG     ALUSTA,C
007B58 A0D8           00341         BTFSS   ALUSTA,C
007B5A 0012           00342         RETURN
                      00343         ; Over 1000 so set to 1000 and exit
                      00344         MOVEC   -D'1000',BXreg
007B5C 01??               M                 MOVLR   HIGH (BXreg)
007B5E 0E18               M                 MOVLW   LOW (-D'1000')
007B60 6E??               M                 MOVWF   (BXreg)
007B62 0EFC               M                 MOVLW   HIGH (-D'1000')
007B64 6E??               M                 MOVWF   (BXreg+1)
007B66 80D8           00345         BSF     ALUSTA,C
007B68 0012           00346         RETURN
                      00347 
                      00348 
                      00349 ; Line 1 text messages for the trims
007B6A                00350 DTmess
007B6A 204C 6941 656C 00351         DB      "L Aileron Trim R"
       6F72 206E 7254 
       6D69 5220 
007B7A 2055 6C45 7665 00352         DB      "U ElevatorTrim D"
       7461 726F 7254 
       6D69 4420 
007B8A 204C 7552 6464 00353         DB      "L Rudder  Trim R"
       7265 2020 7254 
       6D69 5220 
007B9A 204C 6854 6F72 00354         DB      "L ThrottleTrim H"
       7474 656C 7254 
       6D69 4820 
                      00355         
                      00356 ; This function will display the trim position on a 2 line by 16 character display.
                      00357 ; The first line defines the trim being displayed and the second line shows the
                      00358 ; trim position. On call the following registers are assumed to contain valid
                      00359 ; data:
                      00360 ;       WREG = Trim channel; 1=ALI,2=ELE,3=RUD,4=THT
                      00361 ;       DTail = 16 bit digital trim value for aileron
                      00362 ;       DTele = 16 bit digital trim value for elevator
                      00363 ;       DTrud = 16 bit digital trim value for rudder
                      00364 ;       DTtht = 16 bit digital trim value for throttle
007BAA                00365 DisplayTrim
                      00366    ; Display the description text on line 1
007BAA CFE8 F???      00367         MOVFF   WREG,Atemp      ; save for later
                      00368         ; Build pointer to message
                      00369         MOVEC   DTmess,AXreg
007BAE 01??               M                 MOVLR   HIGH (AXreg)
007BB0 0E??               M                 MOVLW   LOW (DTmess)
007BB2 6E??               M                 MOVWF   (AXreg)
007BB4 0E??               M                 MOVLW   HIGH (DTmess)
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 398


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

007BB6 6E??               M                 MOVWF   (AXreg+1)
007BB8 C??? FFE8      00370         MOVFF   Atemp,WREG
007BBC 06E8           00371         DECF    WREG
007BBE 3AE8           00372         SWAPF   WREG            ; This will multiply by 16 and make index into an offset
007BC0 01??           00373         MOVLB   HIGH AXreg
007BC2 26??           00374         ADDWF   AXreg,F
007BC4 B0D8           00375         BTFSC   ALUSTA,C
007BC6 2A??           00376         INCF    AXreg+1
                      00377         ; Now print the first line of the display
007BC8 EC?? F???      00378         CALL    LCDsendAX
                      00379    ; Load the selected trim into AXreg
007BCC C??? FFE8      00380         MOVFF   Atemp,WREG
007BD0 6EE1           00381         MOVWF   FSR1L           ; Build pointer to digital trim location
007BD2 06E1           00382         DECF    FSR1L,F,A
007BD4 90D8           00383         BCF     ALUSTA,C
007BD6 36E1           00384         RLCF    FSR1L,F,A
007BD8 0E??           00385         MOVLW   HIGH DTail
007BDA 6EE2           00386         MOVWF   FSR1H,A
007BDC 0E??           00387         MOVLW   LOW DTail
007BDE 26E1           00388         ADDWF   FSR1L,F,A
007BE0 50E6           00389         MOVF    POSTINC1,W      ; Load value into AXreg
007BE2 CFE8 F???      00390         MOVFF   WREG,AXreg
007BE6 50E6           00391         MOVF    POSTINC1,W
007BE8 CFE8 F???      00392         MOVFF   WREG,AXreg+1
                      00393    ; Paint the trim position on second line
007BEC EC?? F???      00394         CALL    PaintRightBar
007BF0 EC?? F???      00395         CALL    PaintLeftBar
007BF4 0012           00396         RETURN
                      00397 
                      00398 ifndef           SED1230display
                      00399 ; The trim position is in AXreg when this function is called. The trim position
                      00400 ; vaires from -1000 to 1000. Right bar values are positive and each pixel position
                      00401 ; indicates a trim change of 25 units. This function will update the right side
                      00402 ; of the display on the second line.
007BF6                00403 PaintRightBar
                      00404    ; If the trim value is negative, clear the right side of the display and exit
007BF6 01??           00405         MOVLB   HIGH AXreg
007BF8 AE??           00406         BTFSS   AXreg+1,7
007BFA EF?? F???      00407         GOTO    PRB3
                      00408    ; Clear the right side of the display
007BFE 0EC8           00409         MOVLW   LINE2+LCDRIGHT          ; Cursor to center
007C00 EC?? F???      00410         CALL    LCDsendCMD      
007C04 6AE8           00411         CLRF    WREG            ; The zero mark
007C06 EC?? F???      00412         CALL    LCDsendData   
                      00413         ; Send 7 spaces
                      00414         PrintMess MES9
007C0A 0E??               M                 MOVLW   UPPER (MES9)
007C0C 6EF8               M                 MOVWF   TBLPTRU,A
007C0E 0E??               M                 MOVLW   HIGH (MES9)
007C10 6EF7               M                 MOVWF   TBLPTRH,A
007C12 0E??               M                 MOVLW   LOW (MES9)
007C14 6EF6               M                 MOVWF   TBLPTRL,A
007C16 EC?? F???          M                 CALL    LCDsendMess
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 399


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

007C1A 0012           00415         RETURN
007C1C                00416 PRB3
                      00417    ; Set up the character generator for this direction
                      00418         NoAddCorrection
007C1C 0E78           00419         MOVLW   40 + 7 * 8
007C1E EC?? F???      00420         CALL    LCDsendCMD
007C22 0E08           00421         MOVLW   D'8'
                      00422         PrintMessN      HCGtbl + 8 * 8
007C24 CFE8 F???          M                 MOVFF   WREG,Areg
007C28 0E??               M                 MOVLW   UPPER (HCGtbl + 8 * 8)
007C2A 6EF8               M                 MOVWF   TBLPTRU,A
007C2C 0E??               M                 MOVLW   HIGH (HCGtbl + 8 * 8)
007C2E 6EF7               M                 MOVWF   TBLPTRH,A
007C30 0E??               M                 MOVLW   LOW (HCGtbl + 8 * 8)
007C32 6EF6               M                 MOVWF   TBLPTRL,A
007C34 C??? FFE8          M                 MOVFF   Areg,WREG
007C38 EC?? F???          M                 CALL    LCDsendMessN
007C3C 0E58           00423         MOVLW   40 + 3 * 8
007C3E EC?? F???      00424         CALL    LCDsendCMD
007C42 0E08           00425         MOVLW   D'8'
                      00426         PrintMessN      HCGtbl + 3 * 8
007C44 CFE8 F???          M                 MOVFF   WREG,Areg
007C48 0E??               M                 MOVLW   UPPER (HCGtbl + 3 * 8)
007C4A 6EF8               M                 MOVWF   TBLPTRU,A
007C4C 0E??               M                 MOVLW   HIGH (HCGtbl + 3 * 8)
007C4E 6EF7               M                 MOVWF   TBLPTRH,A
007C50 0E??               M                 MOVLW   LOW (HCGtbl + 3 * 8)
007C52 6EF6               M                 MOVWF   TBLPTRL,A
007C54 C??? FFE8          M                 MOVFF   Areg,WREG
007C58 EC?? F???          M                 CALL    LCDsendMessN
                      00427    ; Determine the number of bars to light.
                      00428         MOVE    AXreg,CEXreg
007C5C C??? F???          M                 MOVFF   AXreg,CEXreg
007C60 C??? F???          M                 MOVFF   (AXreg+1),(CEXreg+1)
007C64 0E7D           00429         MOVLW   D'125'
007C66 CFE8 F???      00430         MOVFF   WREG,DEXreg
007C6A EC?? F???      00431         CALL    Divide168       ; Divide trim value by 125, one full character position
007C6E C??? F???      00432         MOVFF   CEXreg,BXreg    ; This is the number of character position to "light up"
007C72 C??? F???      00433         MOVFF   EEXreg,CEXreg   ; Now divide the remainder by 25 to get the number of
                      00434                                 ; bars to "light up" in the last character position
007C76 01??           00435         MOVLB   HIGH CEXreg
007C78 6A??           00436         CLRF    CEXreg+1
007C7A 0E19           00437         MOVLW   D'25'
007C7C CFE8 F???      00438         MOVFF   WREG,DEXreg
007C80 EC?? F???      00439         CALL    Divide168
007C84 C??? F???      00440         MOVFF   CEXreg,BXreg+1  ; Number of bars
                      00441    ; "Light up" the display.
                      00442         ; Center the display cursor
007C88 0EC8           00443         MOVLW   LINE2+LCDRIGHT
007C8A EC?? F???      00444         CALL    LCDsendCMD      
                      00445         ; Loop through all 8 character positions
007C8E 0E08           00446         MOVLW   8
007C90 CFE8 F???      00447         MOVFF   WREG,Areg
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 400


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

007C94 01??           00448         MOVLB   HIGH BXreg
007C96 2A??           00449         INCF    BXreg           ; Advance the character counter
007C98                00450 PRB0
007C98 94D8           00451         BCF     STATUS,Z        ; Clear the zero flag
007C9A 66??           00452         TSTFSZ  BXreg
007C9C 06??           00453         DECF    BXreg           ; Dec BXreg if its not 0
007C9E E1??           00454         BNZ     PRB1
                      00455         ; Here if the char count went to zero
007CA0 C??? FFE8      00456         MOVFF   BXreg+1,WREG
007CA4 06E8           00457         DECF    WREG
007CA6 E3??           00458         BNC     PRB1
007CA8 EC?? F???      00459         CALL    LCDsendData
007CAC EF?? F???      00460         GOTO    PRB2
007CB0                00461 PRB1
                      00462         ; Here to clear or fill a character position
007CB0 0E20           00463         MOVLW   ' '             ; Assume this position is clear
007CB2 66??           00464         TSTFSZ  BXreg
007CB4 0E07           00465         MOVLW   07              ; Lite up the position
007CB6 EC?? F???      00466         CALL    LCDsendData     ; Set the value
007CBA                00467 PRB2
007CBA 0600           00468         DECF    Areg,F,A
007CBC E1??           00469         BNZ     PRB0
                      00470    ; Exit, done!
                      00471         AddCorrection
007CBE 0012           00472         RETURN
                      00473         
                      00474 
                      00475 
                      00476 ; The trim position is in AXreg when this function is called. The trim position
                      00477 ; vaires from -1000 to 1000. Left bar values are negative and each pixel position
                      00478 ; indicates a trim change of 25 units. This function will update the left side
                      00479 ; of the display on the second line.
007CC0                00480 PaintLeftBar
                      00481         NoAddCorrection
                      00482    ; Set the display cursor advance to the left
007CC0 0E04           00483         MOVLW   04
007CC2 EC?? F???      00484         CALL    LCDsendCMD   
                      00485    ; If the trim value is positive, clear the left side of the display and exit
007CC6 01??           00486         MOVLB   HIGH AXreg
007CC8 C??? FFE8      00487         MOVFF   AXreg,WREG
007CCC 10??           00488         IORWF   AXreg+1,W
007CCE E0??           00489         BZ      PLB4            ; If trim is zero then clear the left side of display
007CD0 BE??           00490         BTFSC   AXreg+1,7
007CD2 EF?? F???      00491         GOTO    PLB3
                      00492    ; Clear the left side of the display
007CD6                00493 PLB4
007CD6 0EC7           00494         MOVLW   LINE2+7         ; Cursor to center
007CD8 EC?? F???      00495         CALL    LCDsendCMD      
007CDC 0E04           00496         MOVLW   4               ; The zero mark
007CDE EC?? F???      00497         CALL    LCDsendData   
                      00498         ; Send 7 spaces
                      00499         PrintMess MES9
007CE2 0E??               M                 MOVLW   UPPER (MES9)
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 401


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

007CE4 6EF8               M                 MOVWF   TBLPTRU,A
007CE6 0E??               M                 MOVLW   HIGH (MES9)
007CE8 6EF7               M                 MOVWF   TBLPTRH,A
007CEA 0E??               M                 MOVLW   LOW (MES9)
007CEC 6EF6               M                 MOVWF   TBLPTRL,A
007CEE EC?? F???          M                 CALL    LCDsendMess
                      00500    ; reset the display cursor advance to the right
007CF2 0E06           00501         MOVLW   06
007CF4 EC?? F???      00502         CALL    LCDsendCMD   
                      00503         AddCorrection
007CF8 0012           00504         RETURN
007CFA                00505 PLB3
                      00506    ; Set the display cursor advance to the right
007CFA 0E06           00507         MOVLW   06
007CFC EC?? F???      00508         CALL    LCDsendCMD   
                      00509    ; Set up the character generator for this direction
007D00 0E58           00510         MOVLW   40 + 3 * 8
007D02 EC?? F???      00511         CALL    LCDsendCMD
007D06 0E08           00512         MOVLW   D'8'
                      00513         PrintMessN      HCGtbl + 8 * 8
007D08 CFE8 F???          M                 MOVFF   WREG,Areg
007D0C 0E??               M                 MOVLW   UPPER (HCGtbl + 8 * 8)
007D0E 6EF8               M                 MOVWF   TBLPTRU,A
007D10 0E??               M                 MOVLW   HIGH (HCGtbl + 8 * 8)
007D12 6EF7               M                 MOVWF   TBLPTRH,A
007D14 0E??               M                 MOVLW   LOW (HCGtbl + 8 * 8)
007D16 6EF6               M                 MOVWF   TBLPTRL,A
007D18 C??? FFE8          M                 MOVFF   Areg,WREG
007D1C EC?? F???          M                 CALL    LCDsendMessN
007D20 0E78           00514         MOVLW   40 + 7 * 8
007D22 EC?? F???      00515         CALL    LCDsendCMD
007D26 0E08           00516         MOVLW   D'8'
                      00517         PrintMessN      HCGtbl + 7 * 8
007D28 CFE8 F???          M                 MOVFF   WREG,Areg
007D2C 0E??               M                 MOVLW   UPPER (HCGtbl + 7 * 8)
007D2E 6EF8               M                 MOVWF   TBLPTRU,A
007D30 0E??               M                 MOVLW   HIGH (HCGtbl + 7 * 8)
007D32 6EF7               M                 MOVWF   TBLPTRH,A
007D34 0E??               M                 MOVLW   LOW (HCGtbl + 7 * 8)
007D36 6EF6               M                 MOVWF   TBLPTRL,A
007D38 C??? FFE8          M                 MOVFF   Areg,WREG
007D3C EC?? F???          M                 CALL    LCDsendMessN
                      00518    ; Set the display cursor advance to the left
007D40 0E04           00519         MOVLW   04
007D42 EC?? F???      00520         CALL    LCDsendCMD   
                      00521    ; Determine the number of bars to light.
                      00522         MOVE    AXreg,CEXreg
007D46 C??? F???          M                 MOVFF   AXreg,CEXreg
007D4A C??? F???          M                 MOVFF   (AXreg+1),(CEXreg+1)
007D4E 0E83           00523         MOVLW   -D'125'
007D50 CFE8 F???      00524         MOVFF   WREG,DEXreg
007D54 EC?? F???      00525         CALL    Divide168       ; Divide trim value by 125, one full character position
007D58 C??? F???      00526         MOVFF   CEXreg,BXreg    ; This is the number of character position to "light up"
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 402


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

007D5C C??? F???      00527         MOVFF   EEXreg,CEXreg   ; Now divide the remainder by 25 to get the number of
                      00528                                 ; bars to "light up" in the last character position
007D60 01??           00529         MOVLB   HIGH CEXreg
007D62 6A??           00530         CLRF    CEXreg+1
007D64 0E19           00531         MOVLW   D'25'
007D66 CFE8 F???      00532         MOVFF   WREG,DEXreg
007D6A EC?? F???      00533         CALL    Divide168
007D6E C??? F???      00534         MOVFF   CEXreg,BXreg+1  ; Number of bars
                      00535    ; "Light up" the display.
                      00536         ; Center the display cursor
007D72 0EC7           00537         MOVLW   LINE2+7
007D74 EC?? F???      00538         CALL    LCDsendCMD      
                      00539         ; Loop through all 8 character positions
007D78 0E08           00540         MOVLW   8
007D7A CFE8 F???      00541         MOVFF   WREG,Areg
007D7E 01??           00542         MOVLB   HIGH BXreg
007D80 2A??           00543         INCF    BXreg           ; Advance the character counter
007D82                00544 PLB0
007D82 94D8           00545         BCF     STATUS,Z        ; Clear the zero flag
007D84 66??           00546         TSTFSZ  BXreg
007D86 06??           00547         DECF    BXreg           ; Dec BXreg if its not 0
007D88 E1??           00548         BNZ     PLB1
                      00549         ; Here if the char count went to zero
007D8A C??? FFE8      00550         MOVFF   BXreg+1,WREG
007D8E 06E8           00551         DECF    WREG
007D90 E3??           00552         BNC     PLB1
007D92 0F04           00553         ADDLW   4
007D94 EC?? F???      00554         CALL    LCDsendData
007D98 EF?? F???      00555         GOTO    PLB2
007D9C                00556 PLB1
                      00557         ; Here to clear or fill a character position
007D9C 0E20           00558         MOVLW   ' '             ; Assume this position is clear
007D9E 66??           00559         TSTFSZ  BXreg
007DA0 0E03           00560         MOVLW   03              ; Lite up the position
007DA2 EC?? F???      00561         CALL    LCDsendData     ; Set the value
007DA6                00562 PLB2
007DA6 0600           00563         DECF    Areg,F,A
007DA8 E1??           00564         BNZ     PLB0
                      00565    ; Exit, done!
                      00566    ; reset the display cursor advance to the right
007DAA 0E06           00567         MOVLW   06
007DAC EC?? F???      00568         CALL    LCDsendCMD   
                      00569         AddCorrection
007DB0 0012           00570         RETURN
                      00571 
                      00572 ; The position is in AXreg when this function is called. The position
                      00573 ; vaires from 0 to 1000. Right bar values are positive and each pixel position
                      00574 ; indicates a position change in 12.5 units. This function will use the full range
                      00575 ; of the display on the second line.
007DB2                00576 PaintBar
                      00577    ; If the trim value is negative, clear the display and exit
007DB2 01??           00578         MOVLB   HIGH AXreg
007DB4 AE??           00579         BTFSS   AXreg+1,7
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 403


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

007DB6 EF?? F???      00580         GOTO    PB3
                      00581    ; Clear the display
007DBA 0EC0           00582         MOVLW   LINE2           ; Cursor to center
007DBC EC?? F???      00583         CALL    LCDsendCMD      
007DC0 6AE8           00584         CLRF    WREG            ; The zero mark
007DC2 EC?? F???      00585         CALL    LCDsendData   
                      00586         ; Send 16 spaces
                      00587         PrintMess MES0
007DC6 0E??               M                 MOVLW   UPPER (MES0)
007DC8 6EF8               M                 MOVWF   TBLPTRU,A
007DCA 0E??               M                 MOVLW   HIGH (MES0)
007DCC 6EF7               M                 MOVWF   TBLPTRH,A
007DCE 0E??               M                 MOVLW   LOW (MES0)
007DD0 6EF6               M                 MOVWF   TBLPTRL,A
007DD2 EC?? F???          M                 CALL    LCDsendMess
007DD6 0012           00588         RETURN
007DD8                00589 PB3
                      00590    ; Set up the character generator for this direction
                      00591         NoAddCorrection
007DD8 0E78           00592         MOVLW   40 + 7 * 8
007DDA EC?? F???      00593         CALL    LCDsendCMD
007DDE 0E08           00594         MOVLW   D'8'
                      00595         PrintMessN      HCGtbl + 8 * 8
007DE0 CFE8 F???          M                 MOVFF   WREG,Areg
007DE4 0E??               M                 MOVLW   UPPER (HCGtbl + 8 * 8)
007DE6 6EF8               M                 MOVWF   TBLPTRU,A
007DE8 0E??               M                 MOVLW   HIGH (HCGtbl + 8 * 8)
007DEA 6EF7               M                 MOVWF   TBLPTRH,A
007DEC 0E??               M                 MOVLW   LOW (HCGtbl + 8 * 8)
007DEE 6EF6               M                 MOVWF   TBLPTRL,A
007DF0 C??? FFE8          M                 MOVFF   Areg,WREG
007DF4 EC?? F???          M                 CALL    LCDsendMessN
007DF8 0E58           00596         MOVLW   40 + 3 * 8
007DFA EC?? F???      00597         CALL    LCDsendCMD
007DFE 0E08           00598         MOVLW   D'8'
                      00599         PrintMessN      HCGtbl + 3 * 8
007E00 CFE8 F???          M                 MOVFF   WREG,Areg
007E04 0E??               M                 MOVLW   UPPER (HCGtbl + 3 * 8)
007E06 6EF8               M                 MOVWF   TBLPTRU,A
007E08 0E??               M                 MOVLW   HIGH (HCGtbl + 3 * 8)
007E0A 6EF7               M                 MOVWF   TBLPTRH,A
007E0C 0E??               M                 MOVLW   LOW (HCGtbl + 3 * 8)
007E0E 6EF6               M                 MOVWF   TBLPTRL,A
007E10 C??? FFE8          M                 MOVFF   Areg,WREG
007E14 EC?? F???          M                 CALL    LCDsendMessN
                      00600         AddCorrection
                      00601    ; Determine the number of bars to light.
                      00602         MOVE    AXreg,CEXreg
007E18 C??? F???          M                 MOVFF   AXreg,CEXreg
007E1C C??? F???          M                 MOVFF   (AXreg+1),(CEXreg+1)
007E20 0E3F           00603         MOVLW   D'63'
007E22 CFE8 F???      00604         MOVFF   WREG,DEXreg
007E26 EC?? F???      00605         CALL    Divide168       ; Divide pos value by 63, one full character position
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 404


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

007E2A C??? F???      00606         MOVFF   CEXreg,BXreg    ; This is the number of character position to "light up"
007E2E C??? F???      00607         MOVFF   EEXreg,CEXreg   ; Now divide the remainder by 13 to get the number of
                      00608                                 ; bars to "light up" in the last character position
007E32 01??           00609         MOVLB   HIGH CEXreg
007E34 6A??           00610         CLRF    CEXreg+1
007E36 0E0D           00611         MOVLW   D'13'
007E38 CFE8 F???      00612         MOVFF   WREG,DEXreg
007E3C EC?? F???      00613         CALL    Divide168
007E40 C??? F???      00614         MOVFF   CEXreg,BXreg+1  ; Number of bars
                      00615    ; "Light up" the display.
                      00616         ; Center the display cursor
007E44 0EC0           00617         MOVLW   LINE2
007E46 EC?? F???      00618         CALL    LCDsendCMD      
                      00619         ; Loop through all 16 character positions
007E4A 0E16           00620         MOVLW   16
007E4C CFE8 F???      00621         MOVFF   WREG,Areg
007E50 01??           00622         MOVLB   HIGH BXreg
007E52 2A??           00623         INCF    BXreg           ; Advance the character counter
007E54                00624 PB0
007E54 94D8           00625         BCF     STATUS,Z        ; Clear the zero flag
007E56 66??           00626         TSTFSZ  BXreg
007E58 06??           00627         DECF    BXreg           ; Dec BXreg if its not 0
007E5A E1??           00628         BNZ     PB1
                      00629         ; Here if the char count went to zero
007E5C C??? FFE8      00630         MOVFF   BXreg+1,WREG
007E60 06E8           00631         DECF    WREG
007E62 E3??           00632         BNC     PB1
007E64 EC?? F???      00633         CALL    LCDsendData
007E68 EF?? F???      00634         GOTO    PB2
007E6C                00635 PB1
                      00636         ; Here to clear or fill a character position
007E6C 0E20           00637         MOVLW   ' '             ; Assume this position is clear
007E6E 66??           00638         TSTFSZ  BXreg
007E70 0E07           00639         MOVLW   07              ; Lite up the position
007E72 EC?? F???      00640         CALL    LCDsendData     ; Set the value
007E76                00641 PB2
007E76 0600           00642         DECF    Areg,F,A
007E78 E1??           00643         BNZ     PB0
                      00644    ; Exit, done!
007E7A 0012           00645         RETURN
                      00646 endif
                      00647         
                      00648 ifdef           SED1230display
                      00649 ; The trim position is in AXreg when this function is called. The trim position
                      00650 ; vaires from -1000 to 1000. Right bar values are positive and each pixel position
                      00651 ; indicates a trim change of 25 units. This function will update the right side
                      00652 ; of the display on the second line.
                      00653 PaintRightBar
                      00654    ; If the trim value is negative, clear the right side of the display and exit
                      00655         MOVLB   HIGH AXreg
                      00656         BTFSS   AXreg+1,7
                      00657         GOTO    PRB3
                      00658    ; Clear the right side of the display
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 405


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00659         MOVLW   LINE2+LCDRIGHT          ; Cursor to center
                      00660         CALL    LCDsendCMD      
                      00661         MOVLW   0               ; The zero mark
                      00662         CALL    LCDsendData   
                      00663         ; Send 7 spaces
                      00664         PrintMess MES9
                      00665         RETURN
                      00666 PRB3
                      00667    ; Determine the number of bars to light.
                      00668         MOVE    AXreg,CEXreg
                      00669         MOVLW   D'125'
                      00670         MOVFF   WREG,DEXreg
                      00671         CALL    Divide168       ; Divide trim value by 125, one full character position
                      00672         MOVFF   CEXreg,BXreg    ; This is the number of character position to "light up"
                      00673         MOVFF   EEXreg,CEXreg   ; Now divide the remainder by 25 to get the number of
                      00674                                 ; bars to "light up" in the last character position
                      00675         MOVLB   HIGH CEXreg
                      00676         CLRF    CEXreg+1
                      00677         MOVLW   D'25'
                      00678         MOVFF   WREG,DEXreg
                      00679         CALL    Divide168
                      00680         MOVFF   CEXreg,BXreg+1  ; Number of bars
                      00681    ; "Light up" the display.
                      00682         ; Center the display cursor
                      00683         MOVLW   LINE2+LCDRIGHT
                      00684         CALL    LCDsendCMD      
                      00685         ; Loop through all 8 character positions
                      00686         MOVLW   8
                      00687         MOVFF   WREG,Areg
                      00688         MOVLB   HIGH BXreg
                      00689         INCF    BXreg           ; Advance the character counter
                      00690 PRB0
                      00691         BCF     STATUS,Z        ; Clear the zero flag
                      00692         TSTFSZ  BXreg
                      00693         DECF    BXreg           ; Dec BXreg if its not 0
                      00694         BNZ     PRB1
                      00695         ; Here if the char count went to zero
                      00696         MOVFF   BXreg+1,WREG
                      00697         DECF    WREG
                      00698         BNC     PRB1
                      00699         ADDLW   081
                      00700         CALL    LCDsendData
                      00701         GOTO    PRB2
                      00702 PRB1
                      00703         ; Here to clear or fill a character position
                      00704         MOVLW   ' '             ; Assume this position is clear
                      00705         TSTFSZ  BXreg
                      00706         MOVLW   0FF             ; Lite up the position
                      00707         CALL    LCDsendData     ; Set the value
                      00708 PRB2
                      00709         DECF    Areg,F,A
                      00710         BNZ     PRB0
                      00711    ; Exit, done!
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 406


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00712         RETURN
                      00713         
                      00714 
                      00715 
                      00716 ; The trim position is in AXreg when this function is called. The trim position
                      00717 ; vaires from -1000 to 1000. Left bar values are negative and each pixel position
                      00718 ; indicates a trim change of 25 units. This function will update the left side
                      00719 ; of the display on the second line.
                      00720 PaintLeftBar
                      00721    ; If the trim value is positive, clear the left side of the display and exit
                      00722         MOVLB   HIGH AXreg
                      00723         MOVFF   AXreg,WREG
                      00724         IORWF   AXreg+1,W
                      00725         BZ      PLB4            ; If trim is zero then clear the left side of display
                      00726         BTFSC   AXreg+1,7
                      00727         GOTO    PLB3
                      00728    ; Clear the left side of the display
                      00729 PLB4
                      00730         MOVLW   LINE2           ; Cursor to left
                      00731         CALL    LCDsendCMD      
                      00732         ; Send 7 spaces
                      00733         PrintMess MES9
                      00734         MOVLW   1               ; The zero mark
                      00735         CALL    LCDsendData   
                      00736         RETURN
                      00737 PLB3
                      00738    ; Determine the number of bars to light.
                      00739         MOVE    AXreg,CEXreg
                      00740         MOVLW   -D'125'
                      00741         MOVFF   WREG,DEXreg
                      00742         CALL    Divide168       ; Divide trim value by 125, one full character position
                      00743         MOVFF   CEXreg,WREG     ; This is the number of character position to "light up"
                      00744         SUBLW   8
                      00745         BTFSS   ALUSTA,C
                      00746         MOVLW   0               ; Set to zero if it went negative
                      00747         MOVFF   WREG,BXreg
                      00748         MOVFF   EEXreg,CEXreg   ; Now divide the remainder by 25 to get the number of
                      00749                                 ; bars to "light up" in the last character position
                      00750         MOVLB   HIGH CEXreg
                      00751         CLRF    CEXreg+1
                      00752         MOVLW   D'25'
                      00753         MOVFF   WREG,DEXreg
                      00754         CALL    Divide168
                      00755         MOVFF   CEXreg,BXreg+1  ; Number of bars
                      00756    ; "Light up" the display.
                      00757         ; Start at the far left, the first character
                      00758         MOVLW   LINE2
                      00759         CALL    LCDsendCMD      
                      00760         ; Loop through all 8 character positions
                      00761         MOVLW   8
                      00762         MOVFF   WREG,Areg
                      00763         MOVLB   HIGH BXreg
                      00764 ;       DECF    BXreg           ; Advance the character counter
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 407


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00765 PLB0
                      00766         BCF     STATUS,Z        ; Clear the zero flag
                      00767         TSTFSZ  BXreg
                      00768         DECF    BXreg           ; Dec BXreg if its not 0
                      00769         BNZ     PLB1
                      00770         ; Here if the char count went to zero
                      00771         MOVFF   BXreg+1,WREG
                      00772         DECF    WREG
                      00773         BNC     PLB1a
                      00774         ADDLW   081
                      00775         CALL    LCDsendData
                      00776         GOTO    PLB2
                      00777 PLB1
                      00778         ; Here to clear or fill a character position
                      00779         MOVLW   0FF             ; Light up this position
                      00780         TSTFSZ  BXreg
                      00781 PLB1a   MOVLW   ' '             ; Clear the position
                      00782         CALL    LCDsendData     ; Set the value
                      00783 PLB2
                      00784         DECF    Areg,F,A
                      00785         BNZ     PLB0
                      00786    ; Exit, done!
                      00787    ; reset the display cursor advance to the right
                      00788         MOVLW   06
                      00789         CALL    LCDsendCMD   
                      00790         RETURN
                      00791 
                      00792 ; The position is in AXreg when this function is called. The position
                      00793 ; vaires from 0 to 1000. Right bar values are positive and each pixel position
                      00794 ; indicates a position change in 12.5 units. This function will use the full range
                      00795 ; of the display on the second line.
                      00796 PaintBar
                      00797    ; If the trim value is negative, clear the display and exit
                      00798         MOVLB   HIGH AXreg
                      00799         BTFSS   AXreg+1,7
                      00800         GOTO    PB3
                      00801    ; Clear the display
                      00802         MOVLW   LINE2           ; Cursor to center
                      00803         CALL    LCDsendCMD      
                      00804         CLRF    WREG            ; The zero mark
                      00805         CALL    LCDsendData   
                      00806         ; Send 16 spaces
                      00807         PrintMess MES0
                      00808         RETURN
                      00809 PB3
                      00810    ; Determine the number of bars to light.
                      00811         MOVE    AXreg,CEXreg
                      00812         MOVLW   D'63'
                      00813         MOVFF   WREG,DEXreg
                      00814         CALL    Divide168       ; Divide pos value by 63, one full character position
                      00815         MOVFF   CEXreg,BXreg    ; This is the number of character position to "light up"
                      00816         MOVFF   EEXreg,CEXreg   ; Now divide the remainder by 13 to get the number of
                      00817                                 ; bars to "light up" in the last character position
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 408


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00818         MOVLB   HIGH CEXreg
                      00819         CLRF    CEXreg+1
                      00820         MOVLW   D'13'
                      00821         MOVFF   WREG,DEXreg
                      00822         CALL    Divide168
                      00823         MOVFF   CEXreg,BXreg+1  ; Number of bars
                      00824    ; "Light up" the display.
                      00825         ; Center the display cursor
                      00826         MOVLW   LINE2
                      00827         CALL    LCDsendCMD      
                      00828         ; Loop through all 16 character positions
                      00829         MOVLW   16
                      00830         MOVFF   WREG,Areg
                      00831         MOVLB   HIGH BXreg
                      00832         INCF    BXreg           ; Advance the character counter
                      00833 PB0
                      00834         BCF     STATUS,Z        ; Clear the zero flag
                      00835         TSTFSZ  BXreg
                      00836         DECF    BXreg           ; Dec BXreg if its not 0
                      00837         BNZ     PB1
                      00838         ; Here if the char count went to zero
                      00839         MOVFF   BXreg+1,WREG
                      00840         DECF    WREG
                      00841         BNC     PB1
                      00842         ADDLW   081
                      00843         CALL    LCDsendData
                      00844         GOTO    PB2
                      00845 PB1
                      00846         ; Here to clear or fill a character position
                      00847         MOVLW   ' '             ; Assume this position is clear
                      00848         TSTFSZ  BXreg
                      00849         MOVLW   0FF             ; Lite up the position
                      00850         CALL    LCDsendData     ; Set the value
                      00851 PB2
                      00852         DECF    Areg,F,A
                      00853         BNZ     PB0
                      00854    ; Exit, done!
                      00855         RETURN
                      00856 endif   
                      00857 
                      00858 
                      06274 ifdef           ECMA1010display
                      06275 Include         <DataS.asm>
                      06276 else
                      06277 ifdef           MicroProStar
                      06278 Include         <dataMPS.asm>
                      06279 else
                      06280 ifdef           Catalan
                      06281 Include         <data_ct.asm>
                      06282 else
                      06283 Include         <data.asm>
                      00001 ;================================================================================
                      00002 ;
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 409


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00003 ; Messages and User Interface data tables
                      00004 ;
                      00005 ;================================================================================
007E7C 2020 2020 2020 00006 MES0            DB      "                ",0
       2020 2020 2020 
       2020 2020 0000 
007E8E 4D20 6369 6F72 00007 MES1            DB      " MicroStar 2000 ",0
       7453 7261 3220 
       3030 2030 0000 
007EA0 2020 6556 7372 00008 MES2            DB      "  Version 2.0s  ",0
       6F69 206E 2E32 
       7330 2020 0000 
007EB2 4441 2043 4843 00009 MES3            DB      "ADC CH    = XXXX",0
       2020 2020 203D 
       5858 5858 0000 
007EC4 2020 4120 7269 00010 MES4            DB      "   Aircraft #   ",0
       7263 6661 2074 
       2023 2020 0000 
007ED6 2020 2020 3520 00011 MES5            DB      "     53.X MHz   ",0
       2E33 2058 484D 
       207A 2020 0000 
007EE8 2020 2020 2020 00012 MES6            DB      "       OFF      ",0
       4F20 4646 2020 
       2020 2020 0000 
007EFA 4120 6363 7065 00013 MES7            DB      " Accept? Yes No ",0
       3F74 5920 7365 
       4E20 206F 0000 
007F0C 5020 6572 7373 00014 MES8            DB      " Press   Option ",0
       2020 4F20 7470 
       6F69 206E 0000 
007F1E 2020 2020 2020 00015 MES9            DB      "       ",0
       0020 
007F26 2020 2020 7453 00016 MES10           DB      "    Student     ",0
       6475 6E65 2074 
       2020 2020 0000 
007F38 5920 7365 4E20 00017 MES11           DB      " Yes No ",0
       206F 0000 
007F42 7453 6E64 0074 00018 MES12           DB      "Stdnt",0
007F48 3520 2E30 5858 00019 MES14           DB      " 50.XX MHz  CHX ",0
       4D20 7A48 2020 
       4843 2058 0000 
007F5A 4278 646C 5220 00020 MES15           DB      "xBld RPM = xxxxx",0
       4D50 3D20 7820 
       7878 7878 0000 
007F6C 6552 7274 6361 00021 MES16           DB      "Retracts are UP!",0
       7374 6120 6572 
       5520 2150 0000 
007F7E 2020 6F46 6D72 00022 MES17           DB      "  Format Flash  ",0
       7461 4620 616C 
       6873 2020 0000 
007F90 2020 6F46 6D72 00023 MES19           DB      "  Formatting... ",0
       7461 6974 676E 
       2E2E 202E 0000 
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 410


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

007FA2 2020 4320 706F 00024 MES20           DB      "   Copying...   ",0
       6979 676E 2E2E 
       202E 2020 0000 
007FB4 3720 2E32 5858 00025 MES22           DB      " 72.XX MHz CHXX ",0
       4D20 7A48 4320 
       5848 2058 0000 
007FC6 4552 2043 6F56 00026 MES23           DB      "REC Volts= XX.XX",0
       746C 3D73 5820 
       2E58 5858 0000 
007FD8 6854 6F72 7474 00027 MES24           DB      "Throttle  Adjust",0
       656C 2020 6441 
       756A 7473 0000 
007FEA 694D 6578 2072 00028 MES25           DB      "Mixer  Move From",0
       4D20 766F 2065 
       7246 6D6F 0000 
007FFC 4D20 7869 7265 00029 MES26           DB      " Mixer  Move To ",0
       2020 6F4D 6576 
       5420 206F 0000 
00800E 2020 4D20 766F 00030 MES27           DB      "   Move Mixer   ",0
       2065 694D 6578 
       2072 2020 0000 
008020 6C43 6165 2072 00031 MES28           DB      "Clear  From Chan",0
       4620 6F72 206D 
       6843 6E61 0000 
008032 6553 2074 6C61 00032 MES29           DB      "Set all Aircraft",0
       206C 6941 6372 
       6172 7466 0000 
008044 7055 6164 6974 00033 MES30           DB      "Updating flash..",0
       676E 6620 616C 
       6873 2E2E 0000 
                      00034 
                      00035 ; The following messages are used for the Button ID function. This is the function
                      00036 ; that will display the name of the buttopn pressed on the second line of the display
                      00037 ; for 2 seconds.
008056 2020 4941 204C 00038 IDAILHI         DB      "  AIL D/R HIGH  ",0
       2F44 2052 4948 
       4847 2020 0000 
008068 2020 4941 204C 00039 IDAILLOW        DB      "  AIL D/R  LOW  ",0
       2F44 2052 4C20 
       574F 2020 0000 
00807A 2020 4C45 2045 00040 IDELEHI         DB      "  ELE D/R HIGH  ",0
       2F44 2052 4948 
       4847 2020 0000 
00808C 2020 4C45 2045 00041 IDELELOW        DB      "  ELE D/R  LOW  ",0
       2F44 2052 4C20 
       574F 2020 0000 
00809E 2020 5552 2044 00042 IDRUDHI         DB      "  RUD D/R HIGH  ",0
       2F44 2052 4948 
       4847 2020 0000 
0080B0 2020 5552 2044 00043 IDRUDLOW        DB      "  RUD D/R  LOW  ",0
       2F44 2052 4C20 
       574F 2020 0000 
0080C2 2020 5320 414E 00044 IDSNAPR         DB      "   SNAP RIGHT   ",0
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 411


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

       2050 4952 4847 
       2054 2020 0000 
0080D4 2020 5320 414E 00045 IDSNAPL         DB      "   SNAP  LEFT   ",0
       2050 4C20 4645 
       2054 2020 0000 
0080E6 2020 4120 5455 00046 IDAUTOT         DB      "   AUTO  TRIM   ",0
       204F 5420 4952 
       204D 2020 0000 
0080F8 2020 2020 5020 00047 IDPRESET        DB      "     PRESET     ",0
       4552 4553 2054 
       2020 2020 0000 
                      00048 
                      00049 ; This is the main calibration message displayed on the top line of the display
                      00050 ; after the calibration mode is entered. 
00810A 2020 4320 4C41 00051 CALMES0         DB      "   CALIBRATE    ",0
       4249 4152 4554 
       2020 2020 0000 
                      00052 
                      00053 ; Calibration options table. This table is used to allow the user to
                      00054 ; select the option he wishes to edit. The parameter at the end of each entry
                      00055 ; is an offset used in the jump table.
00811C 6553 656C 7463 00056 CALMES1         DB      "Select  Aircraft",0,LOW CALMES2, HIGH CALMES2 ,LOW CALMES14,HIGH CALMES14,0,0
       2020 6941 6372 
       6172 7466 ??00 
       ???? 00?? 0000 
008134 4120 7269 7263 00057 CALMES2         DB      " Aircraft  name ",0,LOW CALMES3, HIGH CALMES3 ,LOW CALMES1, HIGH CALMES1 ,4,0
       6661 2074 6E20 
       6D61 2065 ??00 
       ???? 04?? 0000 
00814C 2020 2020 2020 00058 CALMES3         DB      "      Timer     ",0,LOW CALMES4 ,HIGH CALMES4 ,LOW CALMES2, HIGH CALMES2 ,8,0
       6954 656D 2072 
       2020 2020 ??00 
       ???? 08?? 0000 
008164 2020 2020 2020 00059 CALMES4         DB      "      Snap      ",0,LOW CALMES5 ,HIGH CALMES5 ,LOW CALMES3, HIGH CALMES3 ,D'12'
                            ,0
       6E53 7061 2020 
       2020 2020 ??00 
       ???? 0C?? 0000 
00817C 2020 2020 5320 00060 CALMES5         DB      "     Servos     ",0,LOW CALMES6 ,HIGH CALMES6 ,LOW CALMES4 ,HIGH CALMES4 ,D'16'
                            ,0
       7265 6F76 2073 
       2020 2020 ??00 
       ???? 10?? 0000 
008194 2020 2020 4D20 00061 CALMES6         DB      "     Mixers     ",0,LOW CALMES7 ,HIGH CALMES7 ,LOW CALMES5 ,HIGH CALMES5 ,D'20'
                            ,0
       7869 7265 2073 
       2020 2020 ??00 
       ???? 14?? 0000 
0081AC 2020 2020 5320 00062 CALMES7         DB      "     Switch     ",0,LOW CALMES8 ,HIGH CALMES8 ,LOW CALMES6 ,HIGH CALMES6 ,D'24'
                            ,0
       6977 6374 2068 
       2020 2020 ??00 
       ???? 18?? 0000 
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 412


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

0081C4 2020 2020 704F 00063 CALMES8         DB      "    Options     ",0,LOW CALMES10,HIGH CALMES10,LOW CALMES7 ,HIGH CALMES7 ,D'28'
                            ,0
       6974 6E6F 2073 
       2020 2020 ??00 
       ???? 1C?? 0000 
0081DC 2020 7953 7473 00064 CALMES10        DB      "  System Setup  ",0,LOW CALMES11,HIGH CALMES11,LOW CALMES8 ,HIGH CALMES8 ,D'32'
                            ,0
       6D65 5320 7465 
       7075 2020 ??00 
       ???? 20?? 0000 
0081F4 6553 656C 7463 00065 CALMES11        DB      "Select Frequency",0,LOW CALMES12,HIGH CALMES12,LOW CALMES10,HIGH CALMES10,D'36'
                            ,0
       4620 6572 7571 
       6E65 7963 ??00 
       ???? 24?? 0000 
00820C 2020 2020 6441 00066 CALMES12        DB      "    Advanced    ",0,LOW CALMES13,HIGH CALMES13,LOW CALMES11,HIGH CALMES11,D'40'
                            ,0
       6176 636E 6465 
       2020 2020 ??00 
       ???? 28?? 0000 
008224 2020 4820 6C65 00067 CALMES13        DB      "   Helicopter   ",0,LOW CALMES14,HIGH CALMES14,LOW CALMES12,HIGH CALMES12,D'44'
                            ,0
       6369 706F 6574 
       2072 2020 ??00 
       ???? 2C?? 0000 
00823C 2020 2020 2020 00068 CALMES14        DB      "      EXIT      ",0,LOW CALMES1, HIGH CALMES1 ,LOW CALMES13,HIGH CALMES13,D'48'
                            ,0
       5845 5449 2020 
       2020 2020 ??00 
       ???? 30?? 0000 
                      00069 
                      00070 ; The following list of messages are display 2nd line prompts used by a number of
                      00071 ; menu functions.
008254 6E45 6261 656C 00072 MENA            DB      "Enable          ",0
       2020 2020 2020 
       2020 2020 0000 
008266 6552 6573 2074 00073 MRST            DB      "Reset ?         ",0
       203F 2020 2020 
       2020 2020 0000 
008278 655A 6F72 2020 00074 MZERO           DB      "Zero  ?         ",0
       203F 2020 2020 
       2020 2020 0000 
00828A 6C43 6165 2072 00075 MCLEAR          DB      "Clear ?         ",0
       203F 2020 2020 
       2020 2020 0000 
00829C 6941 6372 6172 00076 MAFTN           DB      "Aircraft #      ",0
       7466 2320 2020 
       2020 2020 0000 
0082AE 6F54 4120 5446 00077 MCAN            DB      "To AFT #        ",0
       2320 2020 2020 
       2020 2020 0000 
0082C0 6C42 6461 7365 00078 MBLADES         DB      "Blades =        ",0
       3D20 2020 2020 
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 413


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

       2020 2020 0000 
0082D2 7846 2064 7246 00079 MIXORD          DB      "Fxd Frst        ",0
       7473 2020 2020 
       2020 2020 0000 
0082E4 6F56 746C 2073 00080 MVOLTS          DB      "Volts           ",0
       2020 2020 2020 
       2020 2020 0000 
0082F6 6957 7464 2068 00081 MSYNC           DB      "Width           ",0
       2020 2020 2020 
       2020 2020 0000 
008308 6843 6E61 656E 00082 MNUMCH          DB      "Channels        ",0
       736C 2020 2020 
       2020 2020 0000 
00831A 6F43 746E 6172 00083 MCONT           DB      "Contrast        ",0
       7473 2020 2020 
       2020 2020 0000 
00832C 654E 5367 6968 00084 MSHFINV         DB      "NegShift?       ",0
       7466 203F 2020 
       2020 2020 0000 
00833E 6F50 2073 203D 00085 MPOS            DB      "Pos =           ",0
       2020 2020 2020 
       2020 2020 0000 
008350 6147 6E69 2020 00086 MGAIN           DB      "Gain            ",0
       2020 2020 2020 
       2020 2020 0000 
008362 6E49 6576 7472 00087 MINVERT         DB      "Invert?         ",0
       203F 2020 2020 
       2020 2020 0000 
008374 6954 656D 2820 00088 MTSEC           DB      "Time (sec)      ",0
       6573 2963 2020 
       2020 2020 0000 
008386 7246 7165 202C 00089 MHZ             DB      "Freq, Hz        ",0
       7A48 2020 2020 
       2020 2020 0000 
008398 6544 6566 7463 00090 MDEFECT         DB      "Defect          ",0
       2020 2020 2020 
       2020 2020 0000 
0083AA 7246 7165 202C 00091 MKHZ            DB      "Freq, KHz       ",0
       484B 207A 2020 
       2020 2020 0000 
0083BC 6544 616C 2079 00092 MDELAY          DB      "Delay           ",0
       2020 2020 2020 
       2020 2020 0000 
                      00093 
                      00094 ;
                      00095 ; The following data structures are used by the user interface. The format is:
                      00096 ; "message",0,Next,Last,Type,Opt,ptr1,ptr2,max,min,postcall,precall
                      00097 ;
                      00098 ; Next and Last are 16 bit pointers to the next entries in the menu list.
                      00099 ; Type is the variable type:
                      00100 ;       0 = Pointer to selection table, vertical selection
                      00101 ;       1 = percent input
                      00102 ;       2 = u sec input
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 414


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00103 ;       3 = yes/no input, uses a flag byte
                      00104 ;       4 = Channel, Ail - CH8
                      00105 ;       5 = Byte input
                      00106 ;       6 = Select switch
                      00107 ;       7 = function call, ptr1 is pointer to function 
                      00108 ;       8 = voltage input (byte, .1 volt units)
                      00109 ;       9 = Menu selection table
                      00110 ;       A = yes/no input, uses a flag bit. bit mask in LSB of ptr2
                      00111 ;       B = short signed int
                      00112 ;       C = signed int
                      00113 ; Opt is a set of bit flags:
                      00114 ;       0 = prt2 defines the DriveCh for the u sec input option
                      00115 ;       1 = Pre call flag, Calls this vector before exit
                      00116 ;       2 = Post call flag, fills PostCall variable
                      00117 ;       3 = Load message pointed to by ptr2 on 2nd display line
                      00118 ;       4 = Auto select, exit after select
                      00119 ;       5 = Variable is pointer
                      00120 ;       6 = Load Min, Max
                      00121 ;       7 = Load message to top line
                      00122 ; ptr1 and ptr2 are 16 bit variables
                      00123 ; min max are loaded into input range regs if the opt flag is set
                      00124 ;
                      00125 
                      00126 ; The following tables support the timer calibration options.
                      00127 
0083CE 2020 2020 2020 00128 MTIMER1         DB      "      Mode      ",0,LOW MTIMER2, HIGH MTIMER2,LOW MTIMER6, HIGH MTIMER6,0,80,LO
                            W TMODES1, HIGH TMODES1,LOW CNTmode, HIGH CNTmode
       6F4D 6564 2020 
       2020 2020 ??00 
       ???? 00?? ??80 
       ???? 00?? 
0083EA 694D 756E 6574 00129 MTIMER2         DB      "Minutes         ",0,LOW MTIMER3, HIGH MTIMER3,LOW MTIMER1, HIGH MTIMER1,5,40,LO
                            W DWNMins, HIGH DWNMins,0,0,0,0,D'255',0
       2073 2020 2020 
       2020 2020 ??00 
       ???? 05?? ??40 
       00?? 0000 FF00 
       0000 
00840A 6553 6F63 646E 00130 MTIMER3         DB      "Seconds         ",0,LOW MTIMER4, HIGH MTIMER4,LOW MTIMER2, HIGH MTIMER2,5,40,LO
                            W DWNSecs, HIGH DWNSecs,0,0,0,0,D'255',0
       2073 2020 2020 
       2020 2020 ??00 
       ???? 05?? ??40 
       00?? 0000 FF00 
       0000 
00842A 4520 616E 6C62 00131 MTIMER4         DB      " Enable  Switch ",0,LOW MTIMER5, HIGH MTIMER5,LOW MTIMER3, HIGH MTIMER3,6,80,LO
                            W TEnaSW, HIGH TEnaSW
       2065 5320 6977 
       6374 2068 ??00 
       ???? 06?? ??80 
       00?? 
008444 6854 6F72 7474 00132 MTIMER5         DB      "Throttle        ",0,LOW MTIMER6, HIGH MTIMER6,LOW MTIMER4, HIGH MTIMER4,1,0, LO
                            W Tthres, HIGH Tthres
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 415


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

       656C 2020 2020 
       2020 2020 ??00 
       ???? 01?? ??00 
       00?? 
00845E 5845 5449 2020 00133 MTIMER6         DB      "EXIT            ",0,LOW MTIMER1, HIGH MTIMER1,LOW MTIMER5, HIGH MTIMER5,3,0,LOW
                             EXIT,0
       2020 2020 2020 
       2020 2020 ??00 
       ???? 03?? ??00 
       0000 
                      00134  
008478 2020 2020 5055 00135 TMODES1         DB      "    UP Timer    ",0,LOW TMODES2, HIGH TMODES2, LOW TMODES3, HIGH TMODES3,0,0
       5420 6D69 7265 
       2020 2020 ??00 
       ???? 00?? 0000 
008490 2020 4420 776F 00136 TMODES2         DB      "   Down Timer   ",0,LOW TMODES3, HIGH TMODES3, LOW TMODES1, HIGH TMODES1,1,0
       206E 6954 656D 
       2072 2020 ??00 
       ???? 01?? 0000 
0084A8 6F44 6E77 2020 00137 TMODES3         DB      "Down  Stop Timer",0,LOW TMODES1, HIGH TMODES1, LOW TMODES2, HIGH TMODES2,2,0
       7453 706F 5420 
       6D69 7265 ??00 
       ???? 02?? 0000 
                      00138 
                      00139 ; The following tables support the snap calibration options.
                      00140 
0084C0 5253 4120 4C49 00141 SNAP1           DB      "SR AIL          ",0,LOW SNAP2 , HIGH SNAP2 ,LOW SNAP17, HIGH SNAP17,1,40,LOW SR
                            _A, HIGH SR_A,0,0,0FF,0,07E,0
       2020 2020 2020 
       2020 2020 ??00 
       ???? 01?? ??40 
       00?? FF00 7E00 
       0000 
0084E0 5253 4520 454C 00142 SNAP2           DB      "SR ELE          ",0,LOW SNAP3 , HIGH SNAP3 ,LOW SNAP1 , HIGH SNAP1 ,1,40,LOW SR
                            _E, HIGH SR_E,0,0,0FF,0,07E,0
       2020 2020 2020 
       2020 2020 ??00 
       ???? 01?? ??40 
       00?? FF00 7E00 
       0000 
008500 5253 5220 4455 00143 SNAP3           DB      "SR RUD          ",0,LOW SNAP4 , HIGH SNAP4 ,LOW SNAP2 , HIGH SNAP2 ,1,40,LOW SR
                            _R, HIGH SR_R,0,0,0FF,0,07E,0
       2020 2020 2020 
       2020 2020 ??00 
       ???? 01?? ??40 
       00?? FF00 7E00 
       0000 
008520 5253 5420 5448 00144 SNAP4           DB      "SR THT          ",0,LOW SNAP5 , HIGH SNAP5 ,LOW SNAP3 , HIGH SNAP3 ,1,40,LOW SR
                            _T, HIGH SR_T,0,0,0FF,0,07E,0
       2020 2020 2020 
       2020 2020 ??00 
       ???? 01?? ??40 
       00?? FF00 7E00 
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 416


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

       0000 
008540 5253 4120 4C49 00145 SNAP5           DB      "SR AIL ?        ",0,LOW SNAP6 , HIGH SNAP6 ,LOW SNAP4 , HIGH SNAP4 ,3,0,LOW (SR
                            _A+1),HIGH SR_A
       3F20 2020 2020 
       2020 2020 ??00 
       ???? 03?? ??00 
       00?? 
00855A 5253 4520 454C 00146 SNAP6           DB      "SR ELE ?        ",0,LOW SNAP7 , HIGH SNAP7 ,LOW SNAP5 , HIGH SNAP5 ,3,0,LOW (SR
                            _E+1),HIGH SR_E
       3F20 2020 2020 
       2020 2020 ??00 
       ???? 03?? ??00 
       00?? 
008574 5253 5220 4455 00147 SNAP7           DB      "SR RUD ?        ",0,LOW SNAP8 , HIGH SNAP8 ,LOW SNAP6 , HIGH SNAP6 ,3,0,LOW (SR
                            _R+1),HIGH SR_R
       3F20 2020 2020 
       2020 2020 ??00 
       ???? 03?? ??00 
       00?? 
00858E 5253 5420 5448 00148 SNAP8           DB      "SR THT ?        ",0,LOW SNAP9 , HIGH SNAP9 ,LOW SNAP7 , HIGH SNAP7 ,3,0,LOW (SR
                            _T+1),HIGH SR_T
       3F20 2020 2020 
       2020 2020 ??00 
       ???? 03?? ??00 
       00?? 
0085A8 4C53 4120 4C49 00149 SNAP9           DB      "SL AIL          ",0,LOW SNAP10, HIGH SNAP10,LOW SNAP8 , HIGH SNAP8 ,1,40,LOW SL
                            _A, HIGH SL_A,0,0,0FF,0,07E,0
       2020 2020 2020 
       2020 2020 ??00 
       ???? 01?? ??40 
       00?? FF00 7E00 
       0000 
0085C8 4C53 4520 454C 00150 SNAP10          DB      "SL ELE          ",0,LOW SNAP11, HIGH SNAP11,LOW SNAP9 , HIGH SNAP9 ,1,40,LOW SL
                            _E, HIGH SL_E,0,0,0FF,0,07E,0
       2020 2020 2020 
       2020 2020 ??00 
       ???? 01?? ??40 
       00?? FF00 7E00 
       0000 
0085E8 4C53 5220 4455 00151 SNAP11          DB      "SL RUD          ",0,LOW SNAP12, HIGH SNAP12,LOW SNAP10, HIGH SNAP10,1,40,LOW SL
                            _R, HIGH SL_R,0,0,0FF,0,07E,0
       2020 2020 2020 
       2020 2020 ??00 
       ???? 01?? ??40 
       00?? FF00 7E00 
       0000 
008608 4C53 5420 5448 00152 SNAP12          DB      "SL THT          ",0,LOW SNAP13, HIGH SNAP13,LOW SNAP11, HIGH SNAP11,1,40,LOW SL
                            _T, HIGH SL_T,0,0,0FF,0,07E,0
       2020 2020 2020 
       2020 2020 ??00 
       ???? 01?? ??40 
       00?? FF00 7E00 
       0000 
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 417


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

008628 4C53 4120 4C49 00153 SNAP13          DB      "SL AIL ?        ",0,LOW SNAP14, HIGH SNAP14,LOW SNAP12, HIGH SNAP12,3,0,LOW (SL
                            _A+1),HIGH SL_A
       3F20 2020 2020 
       2020 2020 ??00 
       ???? 03?? ??00 
       00?? 
008642 4C53 4520 454C 00154 SNAP14          DB      "SL ELE ?        ",0,LOW SNAP15, HIGH SNAP15,LOW SNAP13, HIGH SNAP13,3,0,LOW (SL
                            _E+1),HIGH SL_E
       3F20 2020 2020 
       2020 2020 ??00 
       ???? 03?? ??00 
       00?? 
00865C 4C53 5220 4455 00155 SNAP15          DB      "SL RUD ?        ",0,LOW SNAP16, HIGH SNAP16,LOW SNAP14, HIGH SNAP14,3,0,LOW (SL
                            _R+1),HIGH SL_R
       3F20 2020 2020 
       2020 2020 ??00 
       ???? 03?? ??00 
       00?? 
008676 4C53 5420 5448 00156 SNAP16          DB      "SL THT ?        ",0,LOW SNAP17, HIGH SNAP17,LOW SNAP15, HIGH SNAP15,3,0,LOW (SL
                            _T+1),HIGH SL_T
       3F20 2020 2020 
       2020 2020 ??00 
       ???? 03?? ??00 
       00?? 
008690 5845 5449 2020 00157 SNAP17          DB      "EXIT            ",0,LOW SNAP1 , HIGH SNAP1 ,LOW SNAP16, HIGH SNAP16,3,0,LOW EXI
                            T, HIGH EXIT
       2020 2020 2020 
       2020 2020 ??00 
       ???? 03?? ??00 
       00?? 
                      00158 
                      00159 ; The following tables support the servo calibration options.
                      00160 
0086AA 2020 2020 6941 00161 SCHNMES1        DB      "    Aileron     ",0,LOW SCHNMES2,HIGH SCHNMES2,LOW SCHNMES10,HIGH SCHNMES10,9,0
                            86,LOW SCALMES1,HIGH SCALMES1,0,0,LOW AilPost,HIGH AilPost,LOW AilPre,HIGH AilPre
       656C 6F72 206E 
       2020 2020 ??00 
       ???? 09?? ??86 
       00?? ??00 ???? 
       00?? 
0086CA 2020 2020 6C45 00162 SCHNMES2        DB      "    Elevator    ",0,LOW SCHNMES3,HIGH SCHNMES3,LOW SCHNMES1,HIGH SCHNMES1,9,086
                            ,LOW SCALMES1,HIGH SCALMES1,0,0,LOW ElePost,HIGH ElePost,LOW ElePre,HIGH ElePre
       7665 7461 726F 
       2020 2020 ??00 
       ???? 09?? ??86 
       00?? ??00 ???? 
       00?? 
0086EA 2020 2020 5220 00163 SCHNMES3        DB      "     Rudder     ",0,LOW SCHNMES4,HIGH SCHNMES4,LOW SCHNMES2,HIGH SCHNMES2,9,086
                            ,LOW SCALMES1,HIGH SCALMES1,0,0,LOW RudPost,HIGH RudPost,LOW RudPre,HIGH RudPre
       6475 6564 2072 
       2020 2020 ??00 
       ???? 09?? ??86 
       00?? ??00 ???? 
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 418


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

       00?? 
00870A 2020 2020 6854 00164 SCHNMES4        DB      "    Throttle    ",0,LOW SCHNMES5,HIGH SCHNMES5,LOW SCHNMES3,HIGH SCHNMES3,9,086
                            ,LOW SCALT1,HIGH SCALT1,0,0,LOW ThtPost,HIGH ThtPost,LOW ThtPre,HIGH ThtPre
       6F72 7474 656C 
       2020 2020 ??00 
       ???? 09?? ??86 
       00?? ??00 ???? 
       00?? 
00872A 2020 2020 2020 00165 SCHNMES5        DB      "      CH5       ",0,LOW SCHNMES6,HIGH SCHNMES6,LOW SCHNMES4,HIGH SCHNMES4,9,086
                            ,LOW SCH51,HIGH SCH51,0,0,LOW CH5Post,HIGH CH5Post,LOW CH5Pre,HIGH CH5Pre
       4843 2035 2020 
       2020 2020 ??00 
       ???? 09?? ??86 
       00?? ??00 ???? 
       00?? 
00874A 2020 2020 2020 00166 SCHNMES6        DB      "      CH6       ",0,LOW SCHNMES7,HIGH SCHNMES7,LOW SCHNMES5,HIGH SCHNMES5,9,086
                            ,LOW SCH671,HIGH SCH671,0,0,LOW CH6Post,HIGH CH6Post,LOW CH6Pre,HIGH CH6Pre
       4843 2036 2020 
       2020 2020 ??00 
       ???? 09?? ??86 
       00?? ??00 ???? 
       00?? 
00876A 2020 2020 2020 00167 SCHNMES7        DB      "      CH7       ",0,LOW SCHNMES8,HIGH SCHNMES8,LOW SCHNMES6,HIGH SCHNMES6,9,086
                            ,LOW SCH671,HIGH SCH671,0,0,LOW CH7Post,HIGH CH7Post,LOW CH7Pre,HIGH CH7Pre
       4843 2037 2020 
       2020 2020 ??00 
       ???? 09?? ??86 
       00?? ??00 ???? 
       00?? 
00878A 2020 2020 2020 00168 SCHNMES8        DB      "      CH8       ",0,LOW SCHNMES9,HIGH SCHNMES9,LOW SCHNMES7,HIGH SCHNMES7,9,086
                            ,LOW SCH81,HIGH SCH81,0,0,LOW CH8Post,HIGH CH8Post,LOW CH8Pre,HIGH CH8Pre
       4843 2038 2020 
       2020 2020 ??00 
       ???? 09?? ??86 
       00?? ??00 ???? 
       00?? 
0087AA 2020 2020 7553 00169 SCHNMES9        DB      "    Sub Trims   ",0,LOW SCHNMES10,HIGH SCHNMES10,LOW SCHNMES8,HIGH SCHNMES8,9,0
                            80,LOW STMENU1, HIGH STMENU1
       2062 7254 6D69 
       2073 2020 ??00 
       ???? 09?? ??80 
       00?? 
0087C4 5845 5449 2020 00170 SCHNMES10       DB      "EXIT            ",0,LOW SCHNMES1,HIGH SCHNMES1,LOW SCHNMES9,HIGH SCHNMES9,3,0,L
                            OW EXIT, HIGH EXIT
       2020 2020 2020 
       2020 2020 ??00 
       ???? 03?? ??00 
       00?? 
                      00171 
                      00172 ; This table is used for ail, ele, and rud calibration
0087DE 6552 6576 7372 00173 SCALMES1        DB      "Reverse         ",0,LOW SCALMES2,  HIGH SCALMES2, LOW SCALMES10,HIGH SCALMES10,
                            3,4,LOW ServoREV,0,0,0,LOW SrevCPost,HIGH SrevCPost
       2065 2020 2020 
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 419


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

       2020 2020 ??00 
       ???? 03?? ??04 
       0000 ??00 00?? 
0087FC 5452 442F 4E57 00174 SCALMES2        DB      "RT/DWN          ",0,LOW SCALMES3,  HIGH SCALMES3, LOW SCALMES1, HIGH SCALMES1 ,
                            2,2,LOW RTDWN,0,0,0,LOW SerLim, HIGH SerLim
       2020 2020 2020 
       2020 2020 ??00 
       ???? 02?? ??02 
       0000 ??00 00?? 
00881A 6543 746E 7265 00175 SCALMES3        DB      "Center          ",0,LOW SCALMES4,  HIGH SCALMES4, LOW SCALMES2, HIGH SCALMES2 ,
                            2,2,LOW CENTER,0,0,0,LOW SerLim, HIGH SerLim
       2020 2020 2020 
       2020 2020 ??00 
       ???? 02?? ??02 
       0000 ??00 00?? 
008838 544C 552F 2050 00176 SCALMES4        DB      "LT/UP           ",0,LOW SCALMES5,  HIGH SCALMES5, LOW SCALMES3, HIGH SCALMES3 ,
                            2,2,LOW LTUP,0,0,0,LOW SerLim, HIGH SerLim
       2020 2020 2020 
       2020 2020 ??00 
       ???? 02?? ??02 
       0000 ??00 00?? 
008856 7544 6C61 5220 00177 SCALMES5        DB      "Dual Rate       ",0,LOW SCALMES6,  HIGH SCALMES6, LOW SCALMES4, HIGH SCALMES4 ,
                            1,0,LOW DRP,0
       7461 2065 2020 
       2020 2020 ??00 
       ???? 01?? ??00 
       0000 
008870 7254 6D69 2020 00178 SCALMES6        DB      "Trim            ",0,LOW SCALMES7,  HIGH SCALMES7, LOW SCALMES5, HIGH SCALMES5 ,
                            1,0,LOW TRIMP,0
       2020 2020 2020 
       2020 2020 ??00 
       ???? 01?? ??00 
       0000 
00888A 5441 5220 5453 00179 SCALMES7        DB      "AT RST          ",0,LOW SCALMES8,  HIGH SCALMES8, LOW SCALMES6, HIGH SCALMES6 ,
                            3,0,LOW ATRST,0
       2020 2020 2020 
       2020 2020 ??00 
       ???? 03?? ??00 
       0000 
0088A4 7845 6F70 4820 00180 SCALMES8        DB      "Expo HI         ",0,LOW SCALMES9,  HIGH SCALMES9, LOW SCALMES7, HIGH SCALMES7 ,
                            1,0,LOW EXPOHI,0
       2049 2020 2020 
       2020 2020 ??00 
       ???? 01?? ??00 
       0000 
0088BE 7845 6F70 4C20 00181 SCALMES9        DB      "Expo LOW        ",0,LOW SCALMES10, HIGH SCALMES10,LOW SCALMES8, HIGH SCALMES8 ,
                            1,0,LOW EXPOLOW,0
       574F 2020 2020 
       2020 2020 ??00 
       ???? 01?? ??00 
       0000 
0088D8 5845 5449 2020 00182 SCALMES10       DB      "EXIT            ",0,LOW SCALMES1,  HIGH SCALMES1, LOW SCALMES9, HIGH SCALMES9 ,
                            3,0,LOW EXIT,0
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 420


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

       2020 2020 2020 
       2020 2020 ??00 
       ???? 03?? ??00 
       0000 
                      00183           
                      00184 ; Throttle calibration table
0088F2 6552 6576 7372 00185 SCALT1          DB      "Reverse         ",0,LOW SCALT2,  HIGH SCALT2, LOW SCALT7, HIGH SCALT7,3,4,LOW S
                            ervoREV,0,0,0,LOW TrevPost,HIGH TrevPost
       2065 2020 2020 
       2020 2020 ??00 
       ???? 03?? ??04 
       0000 ??00 00?? 
008910 6948 6867 2020 00186 SCALT2          DB      "High            ",0,LOW SCALT3,  HIGH SCALT3, LOW SCALT1, HIGH SCALT1,2,3,LOW T
                            MH,3,chTHT,0,LOW SerLim, HIGH SerLim
       2020 2020 2020 
       2020 2020 ??00 
       ???? 02?? ??03 
       ??03 ??00 00?? 
00892E 6F4C 2077 2020 00187 SCALT3          DB      "Low             ",0,LOW SCALT4,  HIGH SCALT4, LOW SCALT2, HIGH SCALT2,2,3,LOW T
                            BH,3,chTHT,0,LOW SerLim, HIGH SerLim
       2020 2020 2020 
       2020 2020 ??00 
       ???? 02?? ??03 
       ??03 ??00 00?? 
00894C 7254 6D69 2020 00188 SCALT4          DB      "Trim            ",0,LOW SCALT5,  HIGH SCALT5, LOW SCALT3, HIGH SCALT3,1,0,LOW T
                            PT,3
       2020 2020 2020 
       2020 2020 ??00 
       ???? 01?? ??00 
       0003 
008966 7254 6D69 4D20 00189 SCALT5          DB      "Trim Mode       ",0,LOW SCALT6,  HIGH SCALT6, LOW SCALT4, HIGH SCALT4,0,0,LOW S
                            CALTMODE1, HIGH SCALTMODE1,LOW TMODE, 3
       646F 2065 2020 
       2020 2020 ??00 
       ???? 00?? ??00 
       ???? 0003 
008982 7250 7365 7465 00190 SCALT6          DB      "Preset          ",0,LOW SCALT7,  HIGH SCALT7, LOW SCALT5, HIGH SCALT5,2,3,LOW T
                            preset,3,chTHT,0,LOW SerLim, HIGH SerLim
       2020 2020 2020 
       2020 2020 ??00 
       ???? 02?? ??03 
       ??03 ??00 00?? 
0089A0 5845 5449 2020 00191 SCALT7          DB      "EXIT            ",0,LOW SCALT1,  HIGH SCALT1, LOW SCALT6, HIGH SCALT6,3,0,LOW E
                            XIT,0
       2020 2020 2020 
       2020 2020 ??00 
       ???? 03?? ??00 
       0000 
                      00192 
                      00193 ; Throttle mode options 
0089BA 7254 6D69 4D20 00194 SCALTMODE1      DB      "Trim Mode NORMAL",0,LOW SCALTMODE2,  HIGH SCALTMODE2, LOW SCALTMODE3, HIGH SCAL
                            TMODE3,0,0
       646F 2065 4F4E 
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 421


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

       4D52 4C41 ??00 
       ???? 00?? 0000 
0089D2 7254 6D69 4D20 00195 SCALTMODE2      DB      "Trim Mode    LOW",0,LOW SCALTMODE3,  HIGH SCALTMODE3, LOW SCALTMODE1, HIGH SCAL
                            TMODE1,1,0
       646F 2065 2020 
       4C20 574F ??00 
       ???? 01?? 0000 
0089EA 7254 6D69 4D20 00196 SCALTMODE3      DB      "Trim Mode   HIGH",0,LOW SCALTMODE1,  HIGH SCALTMODE1, LOW SCALTMODE2, HIGH SCAL
                            TMODE2,2,0
       646F 2065 2020 
       4948 4847 ??00 
       ???? 02?? 0000 
                      00197 
                      00198 ; CH5
008A02 6552 6576 7372 00199 SCH51           DB      "Reverse         ",0,LOW SCH52,HIGH SCH52,LOW SCH55,HIGH SCH55,3,4,LOW ServoREV,
                            0,0,0,LOW SrevNCPost,HIGH SrevNCPost
       2065 2020 2020 
       2020 2020 ??00 
       ???? 03?? ??04 
       0000 ??00 00?? 
008A20 6948 6867 552F 00200 SCH52           DB      "High/Up         ",0,LOW SCH53,HIGH SCH53,LOW SCH51,HIGH SCH51,2,2,LOW RTDWN,0,0
                            ,0,LOW SerLim, HIGH SerLim
       2070 2020 2020 
       2020 2020 ??00 
       ???? 02?? ??02 
       0000 ??00 00?? 
008A3E 6F4C 2F77 5744 00201 SCH53           DB      "Low/DWN         ",0,LOW SCH54,HIGH SCH54,LOW SCH52,HIGH SCH52,2,2,LOW CENTER,0,
                            0,0,LOW SerLim, HIGH SerLim
       204E 2020 2020 
       2020 2020 ??00 
       ???? 02?? ??02 
       0000 ??00 00?? 
008A5C 4320 3548 2020 00202 SCH54           DB      " CH5  Slew Rate ",0,LOW SCH55,HIGH SCH55,LOW SCH53,HIGH SCH53,8,8E ,LOW CH5step
                            Size,HIGH CH5stepSize,LOW MTSEC,HIGH MTSEC,LOW PostCH5, HIGH PostCH5, LOW PreCH5, HIGH PreCH5
       6C53 7765 5220 
       7461 2065 ??00 
       ???? 08?? ??8E 
       ???? ???? ???? 
       00?? 
008A7C 5845 5449 2020 00203 SCH55           DB      "EXIT            ",0,LOW SCH51,HIGH SCH51,LOW SCH54,HIGH SCH54,3,0,LOW EXIT,0
       2020 2020 2020 
       2020 2020 ??00 
       ???? 03?? ??00 
       0000 
                      00204 
                      00205 ; CH6, and CH7
008A96 6552 6576 7372 00206 SCH671          DB      "Reverse         ",0,LOW SCH672,  HIGH SCH672, LOW SCH674, HIGH SCH674,3,4,LOW S
                            ervoREV,0,0,0,LOW SrevNCPost,HIGH SrevNCPost
       2065 2020 2020 
       2020 2020 ??00 
       ???? 03?? ??04 
       0000 ??00 00?? 
008AB4 6948 6867 552F 00207 SCH672          DB      "High/Up         ",0,LOW SCH673,  HIGH SCH673, LOW SCH671, HIGH SCH671,2,2,LOW R
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 422


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                            TDWN,0,0,0,LOW SerLim, HIGH SerLim
       2070 2020 2020 
       2020 2020 ??00 
       ???? 02?? ??02 
       0000 ??00 00?? 
008AD2 6F4C 2F77 5744 00208 SCH673          DB      "Low/DWN         ",0,LOW SCH674,  HIGH SCH674, LOW SCH672, HIGH SCH672,2,2,LOW C
                            ENTER,0,0,0,LOW SerLim, HIGH SerLim
       204E 2020 2020 
       2020 2020 ??00 
       ???? 02?? ??02 
       0000 ??00 00?? 
008AF0 5845 5449 2020 00209 SCH674          DB      "EXIT            ",0,LOW SCH671,  HIGH SCH671, LOW SCH673, HIGH SCH673,3,0,LOW E
                            XIT,0
       2020 2020 2020 
       2020 2020 ??00 
       ???? 03?? ??00 
       0000 
                      00210 
                      00211 ; CH8
008B0A 6552 6576 7372 00212 SCH81           DB      "Reverse         ",0,LOW SCH82,HIGH SCH82,LOW SCH86,HIGH SCH86,3,4,LOW ServoREV,
                            0,0,0,LOW SrevCPost,HIGH SrevCPost
       2065 2020 2020 
       2020 2020 ??00 
       ???? 03?? ??04 
       0000 ??00 00?? 
008B28 2041 2020 2020 00213 SCH82           DB      "A               ",0,LOW SCH83,HIGH SCH83,LOW SCH81,HIGH SCH81,2,3,LOW RTDWN,0,c
                            hCH8,0,LOW SerLim, HIGH SerLim
       2020 2020 2020 
       2020 2020 ??00 
       ???? 02?? ??03 
       ??00 ??00 00?? 
008B46 2042 2020 2020 00214 SCH83           DB      "B               ",0,LOW SCH84,HIGH SCH84,LOW SCH82,HIGH SCH82,2,3,LOW CENTER,0,
                            chCH8,0,LOW SerLim, HIGH SerLim
       2020 2020 2020 
       2020 2020 ??00 
       ???? 02?? ??03 
       ??00 ??00 00?? 
008B64 2043 2020 2020 00215 SCH84           DB      "C               ",0,LOW SCH85,HIGH SCH85,LOW SCH83,HIGH SCH83,2,3,LOW LTUP,0,ch
                            CH8,0,LOW SerLim, HIGH SerLim
       2020 2020 2020 
       2020 2020 ??00 
       ???? 02?? ??03 
       ??00 ??00 00?? 
008B82 4320 3848 2020 00216 SCH85           DB      " CH8  Slew Rate ",0,LOW SCH86,HIGH SCH86,LOW SCH84,HIGH SCH84,8,8E ,LOW CH8step
                            Size,HIGH CH8stepSize,LOW MTSEC,HIGH MTSEC,LOW PostCH8, HIGH PostCH8, LOW PreCH8, HIGH PreCH8
       6C53 7765 5220 
       7461 2065 ??00 
       ???? 08?? ??8E 
       ???? ???? ???? 
       00?? 
008BA2 5845 5449 2020 00217 SCH86           DB      "EXIT            ",0,LOW SCH81,HIGH SCH81,LOW SCH85,HIGH SCH85,3,0,LOW EXIT,0
       2020 2020 2020 
       2020 2020 ??00 
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 423


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

       ???? 03?? ??00 
       0000 
                      00218 
                      00219 ; Sub Trim adjustment menu
008BBC 6552 6573 4174 00220 STMENU1         DB      "ResetAllSubTrims",0,LOW STMENU2 ,HIGH STMENU2 ,LOW STMENU10,HIGH STMENU10,3,08C
                            ,LOW YESNO,HIGH YESNO,LOW MRST,HIGH MRST,LOW STreset,HIGH STreset
       6C6C 7553 5462 
       6972 736D ??00 
       ???? 03?? ??8C 
       ???? ???? 00?? 
008BDA 6941 656C 6F72 00221 STMENU2         DB      "Aileron         ",0,LOW STMENU3 ,HIGH STMENU3 ,LOW STMENU1 ,HIGH STMENU1 ,1,2,L
                            OW SubTrim,HIGH SubTrim,0,0,LOW SetSUflag, HIGH SetSUflag
       206E 2020 2020 
       2020 2020 ??00 
       ???? 01?? ??02 
       00?? ??00 00?? 
008BF8 6C45 7665 7461 00222 STMENU3         DB      "Elevator        ",0,LOW STMENU4 ,HIGH STMENU4 ,LOW STMENU2 ,HIGH STMENU2 ,1,2,L
                            OW (SubTrim+1),HIGH SubTrim,0,0,LOW SetSUflag, HIGH SetSUflag
       726F 2020 2020 
       2020 2020 ??00 
       ???? 01?? ??02 
       00?? ??00 00?? 
008C16 7552 6464 7265 00223 STMENU4         DB      "Rudder          ",0,LOW STMENU5 ,HIGH STMENU5 ,LOW STMENU3 ,HIGH STMENU3 ,1,2,L
                            OW (SubTrim+2),HIGH SubTrim,0,0,LOW SetSUflag, HIGH SetSUflag
       2020 2020 2020 
       2020 2020 ??00 
       ???? 01?? ??02 
       00?? ??00 00?? 
008C34 6854 6F72 7474 00224 STMENU5         DB      "Throttle        ",0,LOW STMENU6 ,HIGH STMENU6 ,LOW STMENU4 ,HIGH STMENU4 ,1,2,L
                            OW (SubTrim+3),HIGH SubTrim,0,0,LOW SetSUflag, HIGH SetSUflag
       656C 2020 2020 
       2020 2020 ??00 
       ???? 01?? ??02 
       00?? ??00 00?? 
008C52 4843 2035 2020 00225 STMENU6         DB      "CH5             ",0,LOW STMENU7 ,HIGH STMENU7 ,LOW STMENU5 ,HIGH STMENU5 ,1,2,L
                            OW (SubTrim+4),HIGH SubTrim,0,0,LOW SetSUflag, HIGH SetSUflag
       2020 2020 2020 
       2020 2020 ??00 
       ???? 01?? ??02 
       00?? ??00 00?? 
008C70 4843 2036 2020 00226 STMENU7         DB      "CH6             ",0,LOW STMENU8 ,HIGH STMENU8 ,LOW STMENU6 ,HIGH STMENU6 ,1,2,L
                            OW (SubTrim+5),HIGH SubTrim,0,0,LOW SetSUflag, HIGH SetSUflag
       2020 2020 2020 
       2020 2020 ??00 
       ???? 01?? ??02 
       00?? ??00 00?? 
008C8E 4843 2037 2020 00227 STMENU8         DB      "CH7             ",0,LOW STMENU9 ,HIGH STMENU9 ,LOW STMENU7 ,HIGH STMENU7 ,1,2,L
                            OW (SubTrim+6),HIGH SubTrim,0,0,LOW SetSUflag, HIGH SetSUflag
       2020 2020 2020 
       2020 2020 ??00 
       ???? 01?? ??02 
       00?? ??00 00?? 
008CAC 4843 2038 2020 00228 STMENU9         DB      "CH8             ",0,LOW STMENU10,HIGH STMENU10,LOW STMENU8 ,HIGH STMENU8 ,1,2,L
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 424


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                            OW (SubTrim+7),HIGH SubTrim,0,0,LOW SetSUflag, HIGH SetSUflag
       2020 2020 2020 
       2020 2020 ??00 
       ???? 01?? ??02 
       00?? ??00 00?? 
008CCA 7845 7469 2020 00229 STMENU10        DB      "Exit            ",0,LOW STMENU1 ,HIGH STMENU1 ,LOW STMENU9 ,HIGH STMENU9 ,3,0,L
                            OW EXIT,0
       2020 2020 2020 
       2020 2020 ??00 
       ???? 03?? ??00 
       0000 
                      00230 
                      00231 
008CE4 6F4E 656E ??00 00232 SERVOSEL1       DB      "None",0,LOW SERVOSEL2, HIGH SERVOSEL2,LOW SERVOSEL9, HIGH SERVOSEL9,0,0
       ???? 00?? 0000 
008CF0 4120 4C49 ??00 00233 SERVOSEL2       DB      " AIL",0,LOW SERVOSEL3, HIGH SERVOSEL3,LOW SERVOSEL1, HIGH SERVOSEL1,1,0
       ???? 01?? 0000 
008CFC 4520 454C ??00 00234 SERVOSEL3       DB      " ELE",0,LOW SERVOSEL4, HIGH SERVOSEL4,LOW SERVOSEL2, HIGH SERVOSEL2,2,0
       ???? 02?? 0000 
008D08 5220 4455 ??00 00235 SERVOSEL4       DB      " RUD",0,LOW SERVOSEL5, HIGH SERVOSEL5,LOW SERVOSEL3, HIGH SERVOSEL3,3,0
       ???? 03?? 0000 
008D14 5420 5448 ??00 00236 SERVOSEL5       DB      " THT",0,LOW SERVOSEL6, HIGH SERVOSEL6,LOW SERVOSEL4, HIGH SERVOSEL4,4,0
       ???? 04?? 0000 
008D20 4320 3548 ??00 00237 SERVOSEL6       DB      " CH5",0,LOW SERVOSEL7, HIGH SERVOSEL7,LOW SERVOSEL5, HIGH SERVOSEL5,5,0
       ???? 05?? 0000 
008D2C 4320 3648 ??00 00238 SERVOSEL7       DB      " CH6",0,LOW SERVOSEL8, HIGH SERVOSEL8,LOW SERVOSEL6, HIGH SERVOSEL6,6,0
       ???? 06?? 0000 
008D38 4320 3748 ??00 00239 SERVOSEL8       DB      " CH7",0,LOW SERVOSEL9, HIGH SERVOSEL9,LOW SERVOSEL7, HIGH SERVOSEL7,7,0
       ???? 07?? 0000 
008D44 4320 3848 ??00 00240 SERVOSEL9       DB      " CH8",0,LOW SERVOSEL1, HIGH SERVOSEL1,LOW SERVOSEL8, HIGH SERVOSEL8,8,0
       ???? 08?? 0000 
                      00241 
                      00242 ; The following tables support the mixer calibration options.
                      00243 
008D50 2020 2020 494D 00244 FMIX1           DB      "    MIXER 1A    ",0,LOW FMIX2,  HIGH FMIX2, LOW FMIX24,HIGH FMIX24,9,86,LOW FMI
                            XOP1,HIGH FMIXOP1,LOW M1Afrom,HIGH M1Afrom,LOW PostMix,HIGH PostMix,LOW PreMix,HIGH PreMix 
       4558 2052 4131 
       2020 2020 ??00 
       ???? 09?? ??86 
       ???? ???? ???? 
       00?? 
008D70 2020 2020 494D 00245 FMIX2           DB      "    MIXER 1B    ",0,LOW FMIX3,  HIGH FMIX3, LOW FMIX1, HIGH FMIX1 ,9,86,LOW FMI
                            XOP1,HIGH FMIXOP1,LOW M1Bfrom,HIGH M1Bfrom,LOW PostMix,HIGH PostMix,LOW PreMix,HIGH PreMix
       4558 2052 4231 
       2020 2020 ??00 
       ???? 09?? ??86 
       ???? ???? ???? 
       00?? 
008D90 2020 2020 494D 00246 FMIX3           DB      "    MIXER 1C    ",0,LOW FMIX4,  HIGH FMIX4, LOW FMIX2, HIGH FMIX2 ,9,86,LOW FMI
                            XOP1,HIGH FMIXOP1,LOW M1Cfrom,HIGH M1Cfrom,LOW PostMix,HIGH PostMix,LOW PreMix,HIGH PreMix
       4558 2052 4331 
       2020 2020 ??00 
       ???? 09?? ??86 
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 425


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

       ???? ???? ???? 
       00?? 
008DB0 2020 2020 494D 00247 FMIX4           DB      "    MIXER 1D    ",0,LOW FMIX5,  HIGH FMIX5, LOW FMIX3, HIGH FMIX3 ,9,86,LOW FMI
                            XOP1,HIGH FMIXOP1,LOW M1Dfrom,HIGH M1Dfrom,LOW PostMix,HIGH PostMix,LOW PreMix,HIGH PreMix
       4558 2052 4431 
       2020 2020 ??00 
       ???? 09?? ??86 
       ???? ???? ???? 
       00?? 
008DD0 2020 2020 494D 00248 FMIX5           DB      "    MIXER 2A    ",0,LOW FMIX6,  HIGH FMIX6, LOW FMIX4, HIGH FMIX4 ,9,86,LOW FMI
                            XOP1,HIGH FMIXOP1,LOW M2Afrom,HIGH M2Afrom,LOW PostMix,HIGH PostMix,LOW PreMix,HIGH PreMix
       4558 2052 4132 
       2020 2020 ??00 
       ???? 09?? ??86 
       ???? ???? ???? 
       00?? 
008DF0 2020 2020 494D 00249 FMIX6           DB      "    MIXER 2B    ",0,LOW FMIX7,  HIGH FMIX7, LOW FMIX5, HIGH FMIX5 ,9,86,LOW FMI
                            XOP1,HIGH FMIXOP1,LOW M2Bfrom,HIGH M2Bfrom,LOW PostMix,HIGH PostMix,LOW PreMix,HIGH PreMix
       4558 2052 4232 
       2020 2020 ??00 
       ???? 09?? ??86 
       ???? ???? ???? 
       00?? 
008E10 2020 2020 494D 00250 FMIX7           DB      "    MIXER 2C    ",0,LOW FMIX8,  HIGH FMIX8, LOW FMIX6, HIGH FMIX6 ,9,86,LOW FMI
                            XOP1,HIGH FMIXOP1,LOW M2Cfrom,HIGH M2Cfrom,LOW PostMix,HIGH PostMix,LOW PreMix,HIGH PreMix
       4558 2052 4332 
       2020 2020 ??00 
       ???? 09?? ??86 
       ???? ???? ???? 
       00?? 
008E30 2020 2020 494D 00251 FMIX8           DB      "    MIXER 2D    ",0,LOW FMIX9,  HIGH FMIX9, LOW FMIX7, HIGH FMIX7 ,9,86,LOW FMI
                            XOP1,HIGH FMIXOP1,LOW M2Dfrom,HIGH M2Dfrom,LOW PostMix,HIGH PostMix,LOW PreMix,HIGH PreMix
       4558 2052 4432 
       2020 2020 ??00 
       ???? 09?? ??86 
       ???? ???? ???? 
       00?? 
008E50 2020 2020 494D 00252 FMIX9           DB      "    MIXER 3A    ",0,LOW FMIX10, HIGH FMIX10,LOW FMIX8, HIGH FMIX8 ,9,86,LOW FMI
                            XOP1,HIGH FMIXOP1,LOW M3Afrom,HIGH M3Afrom,LOW PostMix,HIGH PostMix,LOW PreMix,HIGH PreMix
       4558 2052 4133 
       2020 2020 ??00 
       ???? 09?? ??86 
       ???? ???? ???? 
       00?? 
008E70 2020 2020 494D 00253 FMIX10          DB      "    MIXER 3B    ",0,LOW FMIX11, HIGH FMIX11,LOW FMIX9, HIGH FMIX9 ,9,86,LOW FMI
                            XOP1,HIGH FMIXOP1,LOW M3Bfrom,HIGH M3Bfrom,LOW PostMix,HIGH PostMix,LOW PreMix,HIGH PreMix
       4558 2052 4233 
       2020 2020 ??00 
       ???? 09?? ??86 
       ???? ???? ???? 
       00?? 
008E90 2020 2020 494D 00254 FMIX11          DB      "    MIXER 3C    ",0,LOW FMIX12, HIGH FMIX12,LOW FMIX10,HIGH FMIX10,9,86,LOW FMI
                            XOP1,HIGH FMIXOP1,LOW M3Cfrom,HIGH M3Cfrom,LOW PostMix,HIGH PostMix,LOW PreMix,HIGH PreMix
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 426


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

       4558 2052 4333 
       2020 2020 ??00 
       ???? 09?? ??86 
       ???? ???? ???? 
       00?? 
008EB0 2020 2020 494D 00255 FMIX12          DB      "    MIXER 3D    ",0,LOW FMIX13, HIGH FMIX13,LOW FMIX11,HIGH FMIX11,9,86,LOW FMI
                            XOP1,HIGH FMIXOP1,LOW M3Dfrom,HIGH M3Dfrom,LOW PostMix,HIGH PostMix,LOW PreMix,HIGH PreMix
       4558 2052 4433 
       2020 2020 ??00 
       ???? 09?? ??86 
       ???? ???? ???? 
       00?? 
008ED0 2020 4D20 766F 00256 FMIX13          DB      "   Move Mixer   ",0,LOW FMIX14, HIGH FMIX14,LOW FMIX12,HIGH FMIX12,7, 0,LOW Mov
                            eMixer,HIGH MoveMixer
       2065 694D 6578 
       2072 2020 ??00 
       ???? 07?? ??00 
       00?? 
008EEA 2020 4120 4C49 00257 FMIX14          DB      "   AIL to RUD   ",0,LOW FMIX15, HIGH FMIX15,LOW FMIX13,HIGH FMIX13,9,86,LOW FMI
                            XST1,HIGH FMIXST1,LOW M3Dfrom,HIGH M3Dfrom,LOW PostA2R,HIGH PostA2R,LOW PreA2R,HIGH PreA2R
       7420 206F 5552 
       2044 2020 ??00 
       ???? 09?? ??86 
       ???? ???? ???? 
       00?? 
008F0A 2020 5220 4455 00258 FMIX15          DB      "   RUD to AIL   ",0,LOW FMIX16, HIGH FMIX16,LOW FMIX14,HIGH FMIX14,9,86,LOW FMI
                            XST1,HIGH FMIXST1,LOW M3Dfrom,HIGH M3Dfrom,LOW PostR2A,HIGH PostR2A,LOW PreR2A,HIGH PreR2A
       7420 206F 4941 
       204C 2020 ??00 
       ???? 09?? ??86 
       ???? ???? ???? 
       00?? 
008F2A 2020 5220 4455 00259 FMIX16          DB      "   RUD to ELE   ",0,LOW FMIX17, HIGH FMIX17,LOW FMIX15,HIGH FMIX15,9,86,LOW FMI
                            XST1,HIGH FMIXST1,LOW M3Dfrom,HIGH M3Dfrom,LOW PostR2E,HIGH PostR2E,LOW PreR2E,HIGH PreR2E
       7420 206F 4C45 
       2045 2020 ??00 
       ???? 09?? ??86 
       ???? ???? ???? 
       00?? 
008F4A 2020 5420 5448 00260 FMIX17          DB      "   THT to ELE   ",0,LOW FMIX18, HIGH FMIX18,LOW FMIX16,HIGH FMIX16,1,88,LOW Tht
                            Ele,HIGH ThtEle,LOW MGAIN,HIGH MGAIN
       7420 206F 4C45 
       2045 2020 ??00 
       ???? 01?? ??88 
       ???? 00?? 
008F66 2020 2020 5620 00261 FMIX18          DB      "     VTAIL      ",0,LOW FMIX19, HIGH FMIX19,LOW FMIX17,HIGH FMIX17,3,88,LOW VTA
                            IL, HIGH VTAIL,LOW MENA,HIGH MENA
       4154 4C49 2020 
       2020 2020 ??00 
       ???? 03?? ??88 
       ???? 00?? 
008F82 2020 2020 4520 00262 FMIX19          DB      "     ELEVON     ",0,LOW FMIX20, HIGH FMIX20,LOW FMIX18,HIGH FMIX18,3,88,LOW ELE
                            VON, HIGH ELEVON,LOW MENA,HIGH MENA
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 427


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

       454C 4F56 204E 
       2020 2020 ??00 
       ???? 03?? ??88 
       ???? 00?? 
008F9E 2020 2020 5544 00263 FMIX20          DB      "    DUAL AIL    ",0,LOW FMIX21, HIGH FMIX21,LOW FMIX19,HIGH FMIX19,9,80,LOW DUA
                            LAILM1, HIGH DUALAILM1
       4C41 4120 4C49 
       2020 2020 ??00 
       ???? 09?? ??80 
       00?? 
008FB8 2020 2020 5544 00264 FMIX21          DB      "    DUAL ELE    ",0,LOW FMIX22, HIGH FMIX22,LOW FMIX20,HIGH FMIX20,3,88,LOW Dua
                            lE, HIGH DualE,LOW MENA,HIGH MENA
       4C41 4520 454C 
       2020 2020 ??00 
       ???? 03?? ??88 
       ???? 00?? 
008FD4 2020 2020 4449 00265 FMIX22          DB      "    IDLE  UP    ",0,LOW FMIX23, HIGH FMIX23,LOW FMIX21,HIGH FMIX21,9,80,LOW IDL
                            EUP1, HIGH IDLEUP1
       454C 2020 5055 
       2020 2020 ??00 
       ???? 09?? ??80 
       00?? 
008FEE 2020 694D 6578 00266 FMIX23          DB      "  Mixer  order  ",0,LOW FMIX24, HIGH FMIX24,LOW FMIX22,HIGH FMIX22,3,88,LOW Fix
                            edFirst, HIGH FixedFirst,LOW MIXORD, HIGH MIXORD
       2072 6F20 6472 
       7265 2020 ??00 
       ???? 03?? ??88 
       ???? 00?? 
00900A 5845 5449 2020 00267 FMIX24          DB      "EXIT            ",0,LOW FMIX1,  HIGH FMIX1, LOW FMIX23,HIGH FMIX23,3,0,LOW EXIT
                            ,0
       2020 2020 2020 
       2020 2020 ??00 
       ???? 03?? ??00 
       0000 
                      00268 
009024 2020 2020 494D 00269 MIXSEL1         DB      "    MIXER 1A    ",0,LOW MIXSEL2, HIGH MIXSEL2 ,LOW MIXSEL12,HIGH MIXSEL12,LOW M
                            1Afrom,HIGH M1Afrom
       4558 2052 4131 
       2020 2020 ??00 
       ???? ???? 00?? 
00903C 2020 2020 494D 00270 MIXSEL2         DB      "    MIXER 1B    ",0,LOW MIXSEL3, HIGH MIXSEL3 ,LOW MIXSEL1, HIGH MIXSEL1 ,LOW M
                            1Bfrom,HIGH M1Bfrom
       4558 2052 4231 
       2020 2020 ??00 
       ???? ???? 00?? 
009054 2020 2020 494D 00271 MIXSEL3         DB      "    MIXER 1C    ",0,LOW MIXSEL4, HIGH MIXSEL4 ,LOW MIXSEL2, HIGH MIXSEL2 ,LOW M
                            1Cfrom,HIGH M1Cfrom
       4558 2052 4331 
       2020 2020 ??00 
       ???? ???? 00?? 
00906C 2020 2020 494D 00272 MIXSEL4         DB      "    MIXER 1D    ",0,LOW MIXSEL5, HIGH MIXSEL5 ,LOW MIXSEL3, HIGH MIXSEL3 ,LOW M
                            1Dfrom,HIGH M1Dfrom
       4558 2052 4431 
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 428


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

       2020 2020 ??00 
       ???? ???? 00?? 
009084 2020 2020 494D 00273 MIXSEL5         DB      "    MIXER 2A    ",0,LOW MIXSEL6, HIGH MIXSEL6 ,LOW MIXSEL4, HIGH MIXSEL4 ,LOW M
                            2Afrom,HIGH M2Afrom
       4558 2052 4132 
       2020 2020 ??00 
       ???? ???? 00?? 
00909C 2020 2020 494D 00274 MIXSEL6         DB      "    MIXER 2B    ",0,LOW MIXSEL7, HIGH MIXSEL7 ,LOW MIXSEL5, HIGH MIXSEL5 ,LOW M
                            2Bfrom,HIGH M2Bfrom
       4558 2052 4232 
       2020 2020 ??00 
       ???? ???? 00?? 
0090B4 2020 2020 494D 00275 MIXSEL7         DB      "    MIXER 2C    ",0,LOW MIXSEL8, HIGH MIXSEL8 ,LOW MIXSEL6, HIGH MIXSEL6 ,LOW M
                            2Cfrom,HIGH M2Cfrom
       4558 2052 4332 
       2020 2020 ??00 
       ???? ???? 00?? 
0090CC 2020 2020 494D 00276 MIXSEL8         DB      "    MIXER 2D    ",0,LOW MIXSEL9, HIGH MIXSEL9 ,LOW MIXSEL7, HIGH MIXSEL7 ,LOW M
                            2Dfrom,HIGH M2Dfrom
       4558 2052 4432 
       2020 2020 ??00 
       ???? ???? 00?? 
0090E4 2020 2020 494D 00277 MIXSEL9         DB      "    MIXER 3A    ",0,LOW MIXSEL10,HIGH MIXSEL10,LOW MIXSEL8, HIGH MIXSEL8 ,LOW M
                            3Afrom,HIGH M3Afrom
       4558 2052 4133 
       2020 2020 ??00 
       ???? ???? 00?? 
0090FC 2020 2020 494D 00278 MIXSEL10        DB      "    MIXER 3B    ",0,LOW MIXSEL11,HIGH MIXSEL11,LOW MIXSEL9, HIGH MIXSEL9 ,LOW M
                            3Bfrom,HIGH M3Bfrom
       4558 2052 4233 
       2020 2020 ??00 
       ???? ???? 00?? 
009114 2020 2020 494D 00279 MIXSEL11        DB      "    MIXER 3C    ",0,LOW MIXSEL12,HIGH MIXSEL12,LOW MIXSEL10,HIGH MIXSEL10,LOW M
                            3Cfrom,HIGH M3Cfrom
       4558 2052 4333 
       2020 2020 ??00 
       ???? ???? 00?? 
00912C 2020 2020 494D 00280 MIXSEL12        DB      "    MIXER 3D    ",0,LOW MIXSEL1, HIGH MIXSEL1 ,LOW MIXSEL11,HIGH MIXSEL11,LOW M
                            3Dfrom,HIGH M3Afrom
       4558 2052 4433 
       2020 2020 ??00 
       ???? ???? 00?? 
                      00281 
009144 6F50 2073 6167 00282 FMIXST1         DB      "Pos gain        ",0,LOW FMIXST2,HIGH FMIXST2,LOW FMIXST3,HIGH FMIXST3,1,0,LOW M
                            pg,0
       6E69 2020 2020 
       2020 2020 ??00 
       ???? 01?? ??00 
       0000 
00915E 654E 2067 6167 00283 FMIXST2         DB      "Neg gain        ",0,LOW FMIXST3,HIGH FMIXST3,LOW FMIXST1,HIGH FMIXST1,1,0,LOW M
                            ng,0
       6E69 2020 2020 
       2020 2020 ??00 
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 429


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

       ???? 01?? ??00 
       0000 
009178 5845 5449 2020 00284 FMIXST3         DB      "EXIT            ",0,LOW FMIXST1,HIGH FMIXST1,LOW FMIXST2,HIGH FMIXST2,3,0,LOW E
                            XIT,0
       2020 2020 2020 
       2020 2020 ??00 
       ???? 03?? ??00 
       0000 
                      00285 
009192 7246 6D6F 2020 00286 FMIXOP1         DB      "From            ",0,LOW FMIXOP2,  HIGH FMIXOP2, LOW FMIXOP10,HIGH FMIXOP10,4,0,
                            LOW Mfrom,0
       2020 2020 2020 
       2020 2020 ??00 
       ???? 04?? ??00 
       0000 
0091AC 6154 6C62 2065 00287 FMIXOP2         DB      "Table           ",0,LOW FMIXOP3,  HIGH FMIXOP3, LOW FMIXOP1 ,HIGH FMIXOP1 ,0,0,
                            LOW MTBL1,HIGH MTBL1,Low Mtbl,0
       2020 2020 2020 
       2020 2020 ??00 
       ???? 00?? ??00 
       ???? 0000 
0091C8 6F54 2020 2020 00288 FMIXOP3         DB      "To              ",0,LOW FMIXOP4,  HIGH FMIXOP4, LOW FMIXOP2 ,HIGH FMIXOP2 ,4,0,
                            LOW Mto,0
       2020 2020 2020 
       2020 2020 ??00 
       ???? 04?? ??00 
       0000 
0091E2 6552 6C70 6361 00289 FMIXOP4         DB      "Replace         ",0,LOW FMIXOP5,  HIGH FMIXOP5, LOW FMIXOP3 ,HIGH FMIXOP3 ,3,0,
                            LOW Mreplace,0
       2065 2020 2020 
       2020 2020 ??00 
       ???? 03?? ??00 
       0000 
0091FC 505A 2020 2020 00290 FMIXOP5         DB      "ZP              ",0,LOW FMIXOP6,  HIGH FMIXOP6, LOW FMIXOP4 ,HIGH FMIXOP4 ,1,0,
                            LOW Mzp,0
       2020 2020 2020 
       2020 2020 ??00 
       ???? 01?? ??00 
       0000 
009216 6F50 2073 6167 00291 FMIXOP6         DB      "Pos gain        ",0,LOW FMIXOP7,  HIGH FMIXOP7, LOW FMIXOP5 ,HIGH FMIXOP5 ,1,0,
                            LOW Mpg,0
       6E69 2020 2020 
       2020 2020 ??00 
       ???? 01?? ??00 
       0000 
009230 6F50 2073 6E49 00292 FMIXOP7         DB      "Pos Ind         ",0,LOW FMIXOP8,  HIGH FMIXOP8, LOW FMIXOP6 ,HIGH FMIXOP6 ,4,0,
                            LOW Mpi,0
       2064 2020 2020 
       2020 2020 ??00 
       ???? 04?? ??00 
       0000 
00924A 654E 2067 6167 00293 FMIXOP8         DB      "Neg gain        ",0,LOW FMIXOP9,  HIGH FMIXOP9, LOW FMIXOP7 ,HIGH FMIXOP7 ,1,0,
                            LOW Mng,0
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 430


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

       6E69 2020 2020 
       2020 2020 ??00 
       ???? 01?? ??00 
       0000 
009264 654E 2067 6E49 00294 FMIXOP9         DB      "Neg Ind         ",0,LOW FMIXOP10, HIGH FMIXOP10,LOW FMIXOP8 ,HIGH FMIXOP8 ,4,0,
                            LOW Mni,0
       2064 2020 2020 
       2020 2020 ??00 
       ???? 04?? ??00 
       0000 
00927E 5845 5449 2020 00295 FMIXOP10        DB      "EXIT            ",0,LOW FMIXOP1,  HIGH FMIXOP1, LOW FMIXOP9 ,HIGH FMIXOP9 ,3,0,
                            LOW EXIT,0
       2020 2020 2020 
       2020 2020 ??00 
       ???? 03?? ??00 
       0000 
                      00296 
009298 6E45 6261 656C 00297 DUALAILM1       DB      "Enable          ",0,LOW DUALAILM2, HIGH DUALAILM2,LOW DUALAILM6, HIGH DUALAILM6
                            ,3,0,LOW DUALA, HIGH DUALA
       2020 2020 2020 
       2020 2020 ??00 
       ???? 03?? ??00 
       00?? 
0092B2 4944 4646 2020 00298 DUALAILM2       DB      "DIFF            ",0,LOW DUALAILM3, HIGH DUALAILM3,LOW DUALAILM1, HIGH DUALAILM1
                            ,1,0,LOW DIFFA, HIGH DIFFA
       2020 2020 2020 
       2020 2020 ??00 
       ???? 01?? ??00 
       00?? 
0092CC 6C46 7061 5020 00299 DUALAILM3       DB      "Flap Pgain      ",0,LOW DUALAILM4, HIGH DUALAILM4,LOW DUALAILM2, HIGH DUALAILM2
                            ,1,0,LOW FPgain, HIGH FPgain
       6167 6E69 2020 
       2020 2020 ??00 
       ???? 01?? ??00 
       00?? 
0092E6 6C46 7061 4E20 00300 DUALAILM4       DB      "Flap Ngain      ",0,LOW DUALAILM5, HIGH DUALAILM5,LOW DUALAILM3, HIGH DUALAILM3
                            ,1,0,LOW FPgainN, HIGH FPgainN
       6167 6E69 2020 
       2020 2020 ??00 
       ???? 01?? ??00 
       00?? 
009300 5243 574F 2020 00301 DUALAILM5       DB      "CROW            ",0,LOW DUALAILM6, HIGH DUALAILM6,LOW DUALAILM4, HIGH DUALAILM4
                            ,3,0,LOW CROWENA, HIGH CROWENA
       2020 2020 2020 
       2020 2020 ??00 
       ???? 03?? ??00 
       00?? 
00931A 5845 5449 2020 00302 DUALAILM6       DB      "EXIT            ",0,LOW DUALAILM1, HIGH DUALAILM1,LOW DUALAILM5, HIGH DUALAILM5
                            ,3,0,LOW EXIT, 0
       2020 2020 2020 
       2020 2020 ??00 
       ???? 03?? ??00 
       0000 
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 431


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00303 
009334 6E45 6261 656C 00304 IDLEUP1         DB      "Enable          ",0,LOW IDLEUP2, HIGH IDLEUP2,LOW IDLEUP4, HIGH IDLEUP4,3,0,LOW
                             IDLEUP, HIGH IDLEUP
       2020 2020 2020 
       2020 2020 ??00 
       ???? 03?? ??00 
       00?? 
00934E 6F50 6973 6974 00305 IDLEUP2         DB      "Position A      ",0,LOW IDLEUP3, HIGH IDLEUP3,LOW IDLEUP1, HIGH IDLEUP1,1,0,LOW
                             IDLEUPpA, HIGH IDLEUPpA
       6E6F 4120 2020 
       2020 2020 ??00 
       ???? 01?? ??00 
       00?? 
009368 6F50 6973 6974 00306 IDLEUP3         DB      "Position B      ",0,LOW IDLEUP4, HIGH IDLEUP4,LOW IDLEUP2, HIGH IDLEUP2,1,0,LOW
                             IDLEUPpB, HIGH IDLEUPpB
       6E6F 4220 2020 
       2020 2020 ??00 
       ???? 01?? ??00 
       00?? 
009382 5845 5449 2020 00307 IDLEUP4         DB      "EXIT            ",0,LOW IDLEUP1, HIGH IDLEUP1,LOW IDLEUP3, HIGH IDLEUP3,3,0,LOW
                             EXIT, 0
       2020 2020 2020 
       2020 2020 ??00 
       ???? 03?? ??00 
       0000 
                      00308 
00939C 6154 6C62 2065 00309 MTBL1           DB      "Table       None",0,LOW MTBL2,  HIGH MTBL2, LOW MTBL11,HIGH MTBL11,0,0
       2020 2020 2020 
       6F4E 656E ??00 
       ???? 00?? 0000 
0093B4 6941 6372 6172 00310 MTBL2           DB      "Aircraft Table 1",0,LOW MTBL3,  HIGH MTBL3, LOW MTBL1,HIGH MTBL1,09,0
       7466 5420 6261 
       656C 3120 ??00 
       ???? 09?? 0000 
0093CC 6941 6372 6172 00311 MTBL3           DB      "Aircraft Table 2",0,LOW MTBL4,  HIGH MTBL4, LOW MTBL2,HIGH MTBL2,0A,0
       7466 5420 6261 
       656C 3220 ??00 
       ???? 0A?? 0000 
0093E4 6C47 616F 6162 00312 MTBL4           DB      "Gloabal Table  1",0,LOW MTBL5,  HIGH MTBL5, LOW MTBL3,HIGH MTBL3,1,0
       206C 6154 6C62 
       2065 3120 ??00 
       ???? 01?? 0000 
0093FC 6C47 616F 6162 00313 MTBL5           DB      "Gloabal Table  2",0,LOW MTBL6,  HIGH MTBL6, LOW MTBL4,HIGH MTBL4,2,0
       206C 6154 6C62 
       2065 3220 ??00 
       ???? 02?? 0000 
009414 6C47 616F 6162 00314 MTBL6           DB      "Gloabal Table  3",0,LOW MTBL7,  HIGH MTBL7, LOW MTBL5,HIGH MTBL5,3,0
       206C 6154 6C62 
       2065 3320 ??00 
       ???? 03?? 0000 
00942C 6C47 616F 6162 00315 MTBL7           DB      "Gloabal Table  4",0,LOW MTBL8,  HIGH MTBL8, LOW MTBL6,HIGH MTBL6,4,0
       206C 6154 6C62 
       2065 3420 ??00 
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 432


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

       ???? 04?? 0000 
009444 6C47 616F 6162 00316 MTBL8           DB      "Gloabal Table  5",0,LOW MTBL9,  HIGH MTBL9, LOW MTBL7,HIGH MTBL7,5,0
       206C 6154 6C62 
       2065 3520 ??00 
       ???? 05?? 0000 
00945C 6C47 616F 6162 00317 MTBL9           DB      "Gloabal Table  6",0,LOW MTBL10, HIGH MTBL10,LOW MTBL8,HIGH MTBL8,6,0
       206C 6154 6C62 
       2065 3620 ??00 
       ???? 06?? 0000 
009474 6C47 616F 6162 00318 MTBL10          DB      "Gloabal Table  7",0,LOW MTBL11, HIGH MTBL11,LOW MTBL9,HIGH MTBL9,7,0
       206C 6154 6C62 
       2065 3720 ??00 
       ???? 07?? 0000 
00948C 6C47 616F 6162 00319 MTBL11          DB      "Gloabal Table  8",0,LOW MTBL1,  HIGH MTBL1, LOW MTBL10,HIGH MTBL10,8,0
       206C 6154 6C62 
       2065 3820 ??00 
       ???? 08?? 0000 
                      00320 
                      00321 ; The following tables support the switch selection calibration options.
                      00322 
0094A4 2020 2020 4120 00323 SWFUN1          DB      "     AIL DR     ",0,LOW SWFUN2 ,HIGH SWFUN2 ,LOW SWFUN25,HIGH SWFUN25,6,80,LOW 
                            SWAILDR, HIGH SWAILDR
       4C49 4420 2052 
       2020 2020 ??00 
       ???? 06?? ??80 
       00?? 
0094BE 2020 2020 4520 00324 SWFUN2          DB      "     ELE DR     ",0,LOW SWFUN3 ,HIGH SWFUN3 ,LOW SWFUN1 ,HIGH SWFUN1 ,6,80,LOW 
                            SWELEDR, HIGH SWELEDR
       454C 4420 2052 
       2020 2020 ??00 
       ???? 06?? ??80 
       00?? 
0094D8 2020 2020 5220 00325 SWFUN3          DB      "     RUD DR     ",0,LOW SWFUN4 ,HIGH SWFUN4 ,LOW SWFUN2 ,HIGH SWFUN2 ,6,80,LOW 
                            SWRUDDR, HIGH SWRUDDR
       4455 4420 2052 
       2020 2020 ??00 
       ???? 06?? ??80 
       00?? 
0094F2 2020 2020 5020 00326 SWFUN4          DB      "     PRESET     ",0,LOW SWFUN5 ,HIGH SWFUN5 ,LOW SWFUN3 ,HIGH SWFUN3 ,6,80,LOW 
                            SWPRESET, HIGH SWPRESET
       4552 4553 2054 
       2020 2020 ??00 
       ???? 06?? ??80 
       00?? 
00950C 2020 2020 494D 00327 SWFUN5          DB      "    MIXER  1    ",0,LOW SWFUN6 ,HIGH SWFUN6 ,LOW SWFUN4 ,HIGH SWFUN4 ,6,80,LOW 
                            SWMIX1, HIGH SWMIX1
       4558 2052 3120 
       2020 2020 ??00 
       ???? 06?? ??80 
       00?? 
009526 2020 2020 494D 00328 SWFUN6          DB      "    MIXER  2    ",0,LOW SWFUN7 ,HIGH SWFUN7 ,LOW SWFUN5 ,HIGH SWFUN5 ,6,80,LOW 
                            SWMIX2, HIGH SWMIX2
       4558 2052 3220 
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 433


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

       2020 2020 ??00 
       ???? 06?? ??80 
       00?? 
009540 2020 2020 494D 00329 SWFUN7          DB      "    MIXER  3    ",0,LOW SWFUN8 ,HIGH SWFUN8 ,LOW SWFUN6 ,HIGH SWFUN6 ,6,80,LOW 
                            SWMIX3, HIGH SWMIX3
       4558 2052 3320 
       2020 2020 ??00 
       ???? 06?? ??80 
       00?? 
00955A 2020 2020 2020 00330 SWFUN8          DB      "      CH5       ",0,LOW SWFUN9 ,HIGH SWFUN9 ,LOW SWFUN7 ,HIGH SWFUN7 ,6,80,LOW 
                            SWCH5, HIGH SWCH5
       4843 2035 2020 
       2020 2020 ??00 
       ???? 06?? ??80 
       00?? 
009574 2020 2020 5541 00331 SWFUN9          DB      "    AUTO TRIM   ",0,LOW SWFUN10,HIGH SWFUN10,LOW SWFUN8 ,HIGH SWFUN8 ,6,80,LOW 
                            SWATRIM, HIGH SWATRIM
       4F54 5420 4952 
       204D 2020 ??00 
       ???? 06?? ??80 
       00?? 
00958E 2020 2020 4320 00332 SWFUN10         DB      "     CH8 A      ",0,LOW SWFUN11,HIGH SWFUN11,LOW SWFUN9 ,HIGH SWFUN9 ,6,80,LOW 
                            SWCH8A, HIGH SWCH8A
       3848 4120 2020 
       2020 2020 ??00 
       ???? 06?? ??80 
       00?? 
0095A8 2020 2020 4320 00333 SWFUN11         DB      "     CH8 B      ",0,LOW SWFUN12,HIGH SWFUN12,LOW SWFUN10,HIGH SWFUN10,6,80,LOW 
                            SWCH8B, HIGH SWCH8B
       3848 4220 2020 
       2020 2020 ??00 
       ???? 06?? ??80 
       00?? 
0095C2 2020 2020 4320 00334 SWFUN12         DB      "     CH8 C      ",0,LOW SWFUN13,HIGH SWFUN13,LOW SWFUN11,HIGH SWFUN11,6,80,LOW 
                            SWCH8C, HIGH SWCH8C
       3848 4320 2020 
       2020 2020 ??00 
       ???? 06?? ??80 
       00?? 
0095DC 2020 2020 4E53 00335 SWFUN13         DB      "    SNAP  R     ",0,LOW SWFUN14,HIGH SWFUN14,LOW SWFUN12,HIGH SWFUN12,6,80,LOW 
                            SWSNAPR, HIGH SWSNAPR
       5041 2020 2052 
       2020 2020 ??00 
       ???? 06?? ??80 
       00?? 
0095F6 2020 2020 4E53 00336 SWFUN14         DB      "    SNAP  L     ",0,LOW SWFUN15,HIGH SWFUN15,LOW SWFUN13,HIGH SWFUN13,6,80,LOW 
                            SWSNAPL, HIGH SWSNAPL
       5041 2020 204C 
       2020 2020 ??00 
       ???? 06?? ??80 
       00?? 
009610 2020 4920 6C64 00337 SWFUN15         DB      "   Idle Up  1   ",0,LOW SWFUN16,HIGH SWFUN16,LOW SWFUN14,HIGH SWFUN14,6,80,LOW 
                            SWIDLEUP1, HIGH SWIDLEUP1
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 434


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

       2065 7055 2020 
       2031 2020 ??00 
       ???? 06?? ??80 
       00?? 
00962A 2020 4920 6C64 00338 SWFUN16         DB      "   Idle Up  2   ",0,LOW SWFUN17,HIGH SWFUN17,LOW SWFUN15,HIGH SWFUN15,6,80,LOW 
                            SWIDLEUP2, HIGH SWIDLEUP2
       2065 7055 2020 
       2032 2020 ??00 
       ???? 06?? ??80 
       00?? 
009644 2020 2020 2020 00339 SWFUN17         DB      "      CROW      ",0,LOW SWFUN18,HIGH SWFUN18,LOW SWFUN16,HIGH SWFUN16,6,80,LOW 
                            SWCROW, HIGH SWCROW
       5243 574F 2020 
       2020 2020 ??00 
       ???? 06?? ??80 
       00?? 
00965E 5420 6972 6767 00340 SWFUN18         DB      " Trigger Points ",0,LOW SWFUN19,HIGH SWFUN19,LOW SWFUN17,HIGH SWFUN17,9,80,LOW 
                            MTP1, HIGH MTP1
       7265 5020 696F 
       746E 2073 ??00 
       ???? 09?? ??80 
       00?? 
009678 5420 7268 746F 00341 SWFUN19         DB      " Throttle  hold ",0,LOW SWFUN20,HIGH SWFUN20,LOW SWFUN18,HIGH SWFUN18 ,6, 80,LO
                            W SWTHOLD, HIGH SWTHOLD
       6C74 2065 6820 
       6C6F 2064 ??00 
       ???? 06?? ??80 
       00?? 
009692 2020 7453 6E75 00342 SWFUN20         DB      "  Stunt mode 1  ",0,LOW SWFUN21,HIGH SWFUN21,LOW SWFUN19,HIGH SWFUN19 ,6, 80,LO
                            W SWSTUNT1, HIGH SWSTUNT1
       2074 6F6D 6564 
       3120 2020 ??00 
       ???? 06?? ??80 
       00?? 
0096AC 2020 7453 6E75 00343 SWFUN21         DB      "  Stunt mode 2  ",0,LOW SWFUN22,HIGH SWFUN22,LOW SWFUN20,HIGH SWFUN20 ,6, 80,LO
                            W SWSTUNT2, HIGH SWSTUNT2
       2074 6F6D 6564 
       3220 2020 ??00 
       ???? 06?? ??80 
       00?? 
0096C6 6449 656C 7055 00344 SWFUN22         DB      "IdleUp Norm Mode",0,LOW SWFUN23,HIGH SWFUN23,LOW SWFUN21,HIGH SWFUN21 ,6, 80,LO
                            W SWIDLEUPN, HIGH SWIDLEUPN
       4E20 726F 206D 
       6F4D 6564 ??00 
       ???? 06?? ??80 
       00?? 
0096E0 6449 656C 7055 00345 SWFUN23         DB      "IdleUp  ST1 Mode",0,LOW SWFUN24,HIGH SWFUN24,LOW SWFUN22,HIGH SWFUN22 ,6, 80,LO
                            W SWIDLEUPST1, HIGH SWIDLEUPST1
       2020 5453 2031 
       6F4D 6564 ??00 
       ???? 06?? ??80 
       00?? 
0096FA 6449 656C 7055 00346 SWFUN24         DB      "IdleUp  ST2 Mode",0,LOW SWFUN25,HIGH SWFUN25,LOW SWFUN23,HIGH SWFUN23 ,6, 80,LO
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 435


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                            W SWIDLEUPST2, HIGH SWIDLEUPST2
       2020 5453 2032 
       6F4D 6564 ??00 
       ???? 06?? ??80 
       00?? 
009714 5845 5449 2020 00347 SWFUN25         DB      "EXIT            ",0,LOW SWFUN1 ,HIGH SWFUN1 ,LOW SWFUN24,HIGH SWFUN24,3,0,LOW E
                            XIT, HIGH EXIT
       2020 2020 2020 
       2020 2020 ??00 
       ???? 03?? ??00 
       00?? 
                      00348 
00972E 6941 656C 6F72 00349 MTP1            DB      "Aileron Trig Pos",0,LOW MTP2 ,HIGH MTP2 ,LOW MTP5,HIGH MTP5,1,88,LOW ATP, HIGH 
                            ATP,LOW MPOS,HIGH MPOS
       206E 7254 6769 
       5020 736F ??00 
       ???? 01?? ??88 
       ???? 00?? 
00974A 6C45 7665 7461 00350 MTP2            DB      "Elevator Trg Pos",0,LOW MTP3 ,HIGH MTP3 ,LOW MTP1,HIGH MTP1,1,88,LOW ETP, HIGH 
                            ETP,LOW MPOS,HIGH MPOS
       726F 5420 6772 
       5020 736F ??00 
       ???? 01?? ??88 
       ???? 00?? 
009766 7552 6464 7265 00351 MTP3            DB      "Rudder  Trig Pos",0,LOW MTP4 ,HIGH MTP4 ,LOW MTP2,HIGH MTP2,1,88,LOW RTP, HIGH 
                            RTP,LOW MPOS,HIGH MPOS
       2020 7254 6769 
       5020 736F ??00 
       ???? 01?? ??88 
       ???? 00?? 
009782 6854 6F72 7474 00352 MTP4            DB      "Throttle Trg Pos",0,LOW MTP5 ,HIGH MTP5 ,LOW MTP3,HIGH MTP3,1,88,LOW TTP, HIGH 
                            TTP,LOW MPOS,HIGH MPOS
       656C 5420 6772 
       5020 736F ??00 
       ???? 01?? ??88 
       ???? 00?? 
00979E 5845 5449 2020 00353 MTP5            DB      "EXIT            ",0,LOW MTP1 ,HIGH MTP1 ,LOW MTP4,HIGH MTP4,3,0,LOW EXIT, HIGH 
                            EXIT
       2020 2020 2020 
       2020 2020 ??00 
       ???? 03?? ??00 
       00?? 
                      00354 
                      00355 ; This is the switch programmability table...
                      00356 
0097B8 2020 2020 2020 00357 SWMENU1         DB      "       ON       ",0,LOW SWMENU2 ,HIGH SWMENU2 ,LOW SWMENU37,HIGH SWMENU37,010,0
       4F20 204E 2020 
       2020 2020 ??00 
       ???? 10?? 0000 
0097D0 2020 2020 2020 00358 SWMENU2         DB      "       OFF      ",0,LOW SWMENU3 ,HIGH SWMENU3 ,LOW SWMENU1 ,HIGH SWMENU1 ,020,0
       4F20 4646 2020 
       2020 2020 ??00 
       ???? 20?? 0000 
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 436


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

0097E8 5753 2041 2020 00359 SWMENU3         DB      "SWA           ON",0,LOW SWMENU4 ,HIGH SWMENU4 ,LOW SWMENU2 ,HIGH SWMENU2 ,080,0
       2020 2020 2020 
       2020 4E4F ??00 
       ???? 80?? 0000 
009800 5753 2041 2020 00360 SWMENU4         DB      "SWA          OFF",0,LOW SWMENU5 ,HIGH SWMENU5 ,LOW SWMENU3 ,HIGH SWMENU3 ,000,0
       2020 2020 2020 
       4F20 4646 ??00 
       ???? 00?? 0000 
009818 5753 2042 2020 00361 SWMENU5         DB      "SWB           ON",0,LOW SWMENU6 ,HIGH SWMENU6 ,LOW SWMENU4 ,HIGH SWMENU4 ,081,0
       2020 2020 2020 
       2020 4E4F ??00 
       ???? 81?? 0000 
009830 5753 2042 2020 00362 SWMENU6         DB      "SWB          OFF",0,LOW SWMENU7 ,HIGH SWMENU7 ,LOW SWMENU5 ,HIGH SWMENU5 ,001,0
       2020 2020 2020 
       4F20 4646 ??00 
       ???? 01?? 0000 
009848 5753 2043 2020 00363 SWMENU7         DB      "SWC           ON",0,LOW SWMENU8 ,HIGH SWMENU8 ,LOW SWMENU6 ,HIGH SWMENU6 ,082,0
       2020 2020 2020 
       2020 4E4F ??00 
       ???? 82?? 0000 
009860 5753 2043 2020 00364 SWMENU8         DB      "SWC          OFF",0,LOW SWMENU9 ,HIGH SWMENU9 ,LOW SWMENU7 ,HIGH SWMENU7 ,002,0
       2020 2020 2020 
       4F20 4646 ??00 
       ???? 02?? 0000 
009878 5753 2044 2020 00365 SWMENU9         DB      "SWD        PRESS",0,LOW SWMENU10,HIGH SWMENU10,LOW SWMENU8 ,HIGH SWMENU8 ,083,0
       2020 2020 5020 
       4552 5353 ??00 
       ???? 83?? 0000 
009890 5753 2044 2020 00366 SWMENU10        DB      "SWD      RELEASE",0,LOW SWMENU11,HIGH SWMENU11,LOW SWMENU9 ,HIGH SWMENU9 ,003,0
       2020 5220 4C45 
       4145 4553 ??00 
       ???? 03?? 0000 
0098A8 5753 2045 2020 00367 SWMENU11        DB      "SWE           ON",0,LOW SWMENU12,HIGH SWMENU12,LOW SWMENU10,HIGH SWMENU10,084,0
       2020 2020 2020 
       2020 4E4F ??00 
       ???? 84?? 0000 
0098C0 5753 2045 2020 00368 SWMENU12        DB      "SWE          OFF",0,LOW SWMENU13,HIGH SWMENU13,LOW SWMENU11,HIGH SWMENU11,004,0
       2020 2020 2020 
       4F20 4646 ??00 
       ???? 04?? 0000 
0098D8 5753 2046 2020 00369 SWMENU13        DB      "SWF           ON",0,LOW SWMENU14,HIGH SWMENU14,LOW SWMENU12,HIGH SWMENU12,085,0
       2020 2020 2020 
       2020 4E4F ??00 
       ???? 85?? 0000 
0098F0 5753 2046 2020 00370 SWMENU14        DB      "SWF          OFF",0,LOW SWMENU15,HIGH SWMENU15,LOW SWMENU13,HIGH SWMENU13,005,0
       2020 2020 2020 
       4F20 4646 ??00 
       ???? 05?? 0000 
009908 5753 2047 2020 00371 SWMENU15        DB      "SWG           ON",0,LOW SWMENU16,HIGH SWMENU16,LOW SWMENU14,HIGH SWMENU14,086,0
       2020 2020 2020 
       2020 4E4F ??00 
       ???? 86?? 0000 
009920 5753 2047 2020 00372 SWMENU16        DB      "SWG          OFF",0,LOW SWMENU17,HIGH SWMENU17,LOW SWMENU15,HIGH SWMENU15,006,0
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 437


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

       2020 2020 2020 
       4F20 4646 ??00 
       ???? 06?? 0000 
009938 5753 2048 2020 00373 SWMENU17        DB      "SWH           ON",0,LOW SWMENU18,HIGH SWMENU18,LOW SWMENU16,HIGH SWMENU16,087,0
       2020 2020 2020 
       2020 4E4F ??00 
       ???? 87?? 0000 
009950 5753 2048 2020 00374 SWMENU18        DB      "SWH          OFF",0,LOW SWMENU19,HIGH SWMENU19,LOW SWMENU17,HIGH SWMENU17,007,0
       2020 2020 2020 
       4F20 4646 ??00 
       ???? 07?? 0000 
009968 5753 2049 2020 00375 SWMENU19        DB      "SWI        PRESS",0,LOW SWMENU20,HIGH SWMENU20,LOW SWMENU18,HIGH SWMENU18,089,0
       2020 2020 5020 
       4552 5353 ??00 
       ???? 89?? 0000 
009980 5753 2049 2020 00376 SWMENU20        DB      "SWI      RELEASE",0,LOW SWMENU21,HIGH SWMENU21,LOW SWMENU19,HIGH SWMENU19,009,0
       2020 5220 4C45 
       4145 4553 ??00 
       ???? 09?? 0000 
009998 5753 204A 2020 00377 SWMENU21        DB      "SWJ            A",0,LOW SWMENU22,HIGH SWMENU22,LOW SWMENU20,HIGH SWMENU20,08B,0
       2020 2020 2020 
       2020 4120 ??00 
       ???? 8B?? 0000 
0099B0 5753 204A 2020 00378 SWMENU22        DB      "SWJ            B",0,LOW SWMENU23,HIGH SWMENU23,LOW SWMENU21,HIGH SWMENU21,04B,0
       2020 2020 2020 
       2020 4220 ??00 
       ???? 4B?? 0000 
0099C8 5753 204A 2020 00379 SWMENU23        DB      "SWJ            C",0,LOW SWMENU24,HIGH SWMENU24,LOW SWMENU22,HIGH SWMENU22,08C,0
       2020 2020 2020 
       2020 4320 ??00 
       ???? 8C?? 0000 
0099E0 5753 204B 2020 00380 SWMENU24        DB      "SWK           ON",0,LOW SWMENU25,HIGH SWMENU25,LOW SWMENU23,HIGH SWMENU23,08D,0
       2020 2020 2020 
       2020 4E4F ??00 
       ???? 8D?? 0000 
0099F8 5753 204B 2020 00381 SWMENU25        DB      "SWK          OFF",0,LOW SWMENU26,HIGH SWMENU26,LOW SWMENU24,HIGH SWMENU24,00D,0
       2020 2020 2020 
       4F20 4646 ??00 
       ???? 0D?? 0000 
009A10 5753 204C 2020 00382 SWMENU26        DB      "SWL        PRESS",0,LOW SWMENU27,HIGH SWMENU27,LOW SWMENU25,HIGH SWMENU25,08E,0
       2020 2020 5020 
       4552 5353 ??00 
       ???? 8E?? 0000 
009A28 5753 204C 2020 00383 SWMENU27        DB      "SWL      RELEASE",0,LOW SWMENU28,HIGH SWMENU28,LOW SWMENU26,HIGH SWMENU26,00E,0
       2020 5220 4C45 
       4145 4553 ??00 
       ???? 0E?? 0000 
009A40 5753 204D 2020 00384 SWMENU28        DB      "SWM        PRESS",0,LOW SWMENU29,HIGH SWMENU29,LOW SWMENU27,HIGH SWMENU27,08F,0
       2020 2020 5020 
       4552 5353 ??00 
       ???? 8F?? 0000 
009A58 5753 204D 2020 00385 SWMENU29        DB      "SWM      RELEASE",0,LOW SWMENU30,HIGH SWMENU30,LOW SWMENU28,HIGH SWMENU28,00F,0
       2020 5220 4C45 
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 438


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

       4145 4553 ??00 
       ???? 0F?? 0000 
009A70 6941 656C 6F72 00386 SWMENU30        DB      "Aileron       ON",0,LOW SWMENU31,HIGH SWMENU31,LOW SWMENU29,HIGH SWMENU29,030,0
       206E 2020 2020 
       2020 4E4F ??00 
       ???? 30?? 0000 
009A88 6941 656C 6F72 00387 SWMENU31        DB      "Aileron      OFF",0,LOW SWMENU32,HIGH SWMENU32,LOW SWMENU30,HIGH SWMENU30,0B0,0
       206E 2020 2020 
       4F20 4646 ??00 
       ???? B0?? 0000 
009AA0 6C45 7665 7461 00388 SWMENU32        DB      "Elevator      ON",0,LOW SWMENU33,HIGH SWMENU33,LOW SWMENU31,HIGH SWMENU31,031,0
       726F 2020 2020 
       2020 4E4F ??00 
       ???? 31?? 0000 
009AB8 6C45 7665 7461 00389 SWMENU33        DB      "Elevator     OFF",0,LOW SWMENU34,HIGH SWMENU34,LOW SWMENU32,HIGH SWMENU32,0B1,0
       726F 2020 2020 
       4F20 4646 ??00 
       ???? B1?? 0000 
009AD0 7552 6464 7265 00390 SWMENU34        DB      "Rudder        ON",0,LOW SWMENU35,HIGH SWMENU35,LOW SWMENU33,HIGH SWMENU33,032,0
       2020 2020 2020 
       2020 4E4F ??00 
       ???? 32?? 0000 
009AE8 7552 6464 7265 00391 SWMENU35        DB      "Rudder       OFF",0,LOW SWMENU36,HIGH SWMENU36,LOW SWMENU34,HIGH SWMENU34,0B2,0
       2020 2020 2020 
       4F20 4646 ??00 
       ???? B2?? 0000 
009B00 6854 6F72 7474 00392 SWMENU36        DB      "Throttle      ON",0,LOW SWMENU37,HIGH SWMENU37,LOW SWMENU35,HIGH SWMENU35,033,0
       656C 2020 2020 
       2020 4E4F ??00 
       ???? 33?? 0000 
009B18 6854 6F72 7474 00393 SWMENU37        DB      "Throttle     OFF",0,LOW SWMENU1 ,HIGH SWMENU1 ,LOW SWMENU36,HIGH SWMENU36,0B3,0
       656C 2020 2020 
       4F20 4646 ??00 
       ???? B3?? 0000 
                      00394 
                      00395 ; The following tables support the options selection calibration menu.
                      00396 
009B30 2020 4120 7475 00397 COP1            DB      "   Auto  Trim   ",0,LOW COP2 , HIGH COP2 ,LOW COP13,HIGH COP13,9,080,LOW MATP1,
                             HIGH MATP1
       206F 5420 6972 
       206D 2020 ??00 
       ???? 09?? ??80 
       00?? 
009B4A 6552 6573 2074 00398 COP2            DB      "Reset Auto Trims",0,LOW COP3 , HIGH COP3 ,LOW COP1 ,HIGH COP1 ,3,08C,LOW YESNO,
                            HIGH YESNO,LOW MRST,HIGH MRST,LOW ATreset,HIGH ATreset
       7541 6F74 5420 
       6972 736D ??00 
       ???? 03?? ??8C 
       ???? ???? 00?? 
009B68 2020 5420 6972 00399 COP3            DB      "   Trim  Zero   ",0,LOW COP4 , HIGH COP4 ,LOW COP2 ,HIGH COP2 ,3,08C,LOW YESNO,
                            HIGH YESNO,LOW MZERO,HIGH MZERO,LOW TrimZero,HIGH TrimZero
       206D 5A20 7265 
       206F 2020 ??00 
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 439


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

       ???? 03?? ??8C 
       ???? ???? 00?? 
009B86 6C43 6165 2072 00400 COP4            DB      "Clear Trim Zeros",0,LOW COP5 , HIGH COP5 ,LOW COP3 ,HIGH COP3 ,3,08C,LOW YESNO,
                            HIGH YESNO,LOW MCLEAR,HIGH MCLEAR,LOW TrimZeroClear,HIGH TrimZeroClear
       7254 6D69 5A20 
       7265 736F ??00 
       ???? 03?? ??8C 
       ???? ???? 00?? 
009BA4 4120 746C 2020 00401 COP5            DB      " Alt   Aircraft ",0,LOW COP6 , HIGH COP6 ,LOW COP4 ,HIGH COP4 ,9,080,LOW AMENU1
                            , HIGH AMENU1
       4120 7269 7263 
       6661 2074 ??00 
       ???? 09?? ??80 
       00?? 
009BBE 4320 706F 2079 00402 COP6            DB      " Copy  Aircraft ",0,LOW COP7 , HIGH COP7 ,LOW COP5 ,HIGH COP5 ,5,08E,LOW Mto, H
                            IGH Mto,LOW MCAN, HIGH MCAN,LOW CopyAFT,HIGH CopyAFT,LOW SetAftRange,HIGH SetAftRange
       4120 7269 7263 
       6661 2074 ??00 
       ???? 05?? ??8E 
       ???? ???? ???? 
       00?? 
009BDE 2020 6553 2074 00403 COP7            DB      "  Set Defaults  ",0,LOW COP8 , HIGH COP8 ,LOW COP6 ,HIGH COP6 ,3,08C,LOW YESNO,
                             HIGH YESNO, LOW MRST, HIGH MRST, LOW SetDefault, HIGH SetDefault
       6544 6166 6C75 
       7374 2020 ??00 
       ???? 03?? ??8C 
       ???? ???? 00?? 
009BFC 754E 206D 7020 00404 COP8            DB      "Num  prop blades",0,LOW COP9 , HIGH COP9 ,LOW COP7 ,HIGH COP7 ,5,0C8,LOW NumBla
                            des,HIGH NumBlades,LOW MBLADES,HIGH MBLADES,1,0,5,0
       6F72 2070 6C62 
       6461 7365 ??00 
       ???? 05?? ??C8 
       ???? 01?? 0500 
       0000 
009C1C 6552 7274 6361 00405 COP9            DB      "Retracts Warning",0,LOW COP10, HIGH COP10,LOW COP8 ,HIGH COP8 ,3,088,LOW Retrac
                            tsWarning, HIGH RetractsWarning,LOW MENA,HIGH MENA
       7374 5720 7261 
       696E 676E ??00 
       ???? 03?? ??88 
       ???? 00?? 
009C38 2020 4220 6475 00406 COP10           DB      "   Buddy  Box   ",0,LOW COP11, HIGH COP11,LOW COP9 ,HIGH COP9 ,9,080,LOW MBB1, 
                            HIGH MBB1
       7964 2020 6F42 
       2078 2020 ??00 
       ???? 09?? ??80 
       00?? 
009C52 2020 2020 5420 00407 COP11           DB      "     Tables     ",0,LOW COP12, HIGH COP12,LOW COP10,HIGH COP10,9,080,LOW Tables
                            1, HIGH Tables1
       6261 656C 2073 
       2020 2020 ??00 
       ???? 09?? ??80 
       00?? 
009C6C 4120 5855 554F 00408 COP12           DB      " AUXOUT Control ",0,LOW COP13, HIGH COP13,LOW COP11,HIGH COP11,0,080,LOW MAUXOU
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 440


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                            T1, HIGH MAUXOUT1,LOW AUXMODE, HIGH AUXMODE
       2054 6F43 746E 
       6F72 206C ??00 
       ???? 00?? ??80 
       ???? 00?? 
009C88 5845 5449 2020 00409 COP13           DB      "EXIT            ",0,LOW COP1 , HIGH COP1 ,LOW COP12,HIGH COP12,3,0  ,LOW EXIT, 
                            HIGH EXIT
       2020 2020 2020 
       2020 2020 ??00 
       ???? 03?? ??00 
       00?? 
                      00410 
                      00411 ; Alternate aircraft menu
                      00412 
009CA2 4120 746C 2320 00413 AMENU1          DB      " Alt #1         ",0,LOW AMENU2 , HIGH AMENU2 ,LOW AMENU13,HIGH AMENU13,5,40,LOW
                             (AltAircraft+1),HIGH AltAircraft,0,0,0,0,D'96',0
       2031 2020 2020 
       2020 2020 ??00 
       ???? 05?? ??40 
       00?? 0000 6000 
       0000 
009CC2 4120 746C 2020 00414 AMENU2          DB      " Alt  #1 Switch ",0,LOW AMENU3 , HIGH AMENU3 ,LOW AMENU1 ,HIGH AMENU1 ,6,80,LOW
                             AltAircraft,  HIGH AltAircraft
       3123 5320 6977 
       6374 2068 ??00 
       ???? 06?? ??80 
       00?? 
009CDC 4120 746C 2320 00415 AMENU3          DB      " Alt #2         ",0,LOW AMENU4 , HIGH AMENU4 ,LOW AMENU2 ,HIGH AMENU2 ,5,40,LOW
                             (AltAircraft+3),HIGH AltAircraft,0,0,0,0,D'96',0
       2032 2020 2020 
       2020 2020 ??00 
       ???? 05?? ??40 
       00?? 0000 6000 
       0000 
009CFC 4120 746C 2020 00416 AMENU4          DB      " Alt  #2 Switch ",0,LOW AMENU5 , HIGH AMENU5 ,LOW AMENU3 ,HIGH AMENU3 ,6,80,LOW
                             (AltAircraft+2),HIGH AltAircraft
       3223 5320 6977 
       6374 2068 ??00 
       ???? 06?? ??80 
       00?? 
009D16 4120 746C 2320 00417 AMENU5          DB      " Alt #3         ",0,LOW AMENU6 , HIGH AMENU6 ,LOW AMENU4 ,HIGH AMENU4 ,5,40,LOW
                             (AltAircraft+5),HIGH AltAircraft,0,0,0,0,D'96',0
       2033 2020 2020 
       2020 2020 ??00 
       ???? 05?? ??40 
       00?? 0000 6000 
       0000 
009D36 4120 746C 2020 00418 AMENU6          DB      " Alt  #3 Switch ",0,LOW AMENU7 , HIGH AMENU7 ,LOW AMENU5 ,HIGH AMENU5 ,6,80,LOW
                             (AltAircraft+4),HIGH AltAircraft
       3323 5320 6977 
       6374 2068 ??00 
       ???? 06?? ??80 
       00?? 
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 441


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

009D50 4120 746C 2320 00419 AMENU7          DB      " Alt #4         ",0,LOW AMENU8 , HIGH AMENU8 ,LOW AMENU6 ,HIGH AMENU6 ,5,40,LOW
                             (AltAircraft+7),HIGH AltAircraft,0,0,0,0,D'96',0
       2034 2020 2020 
       2020 2020 ??00 
       ???? 05?? ??40 
       00?? 0000 6000 
       0000 
009D70 4120 746C 2020 00420 AMENU8          DB      " Alt  #4 Switch ",0,LOW AMENU9 , HIGH AMENU9 ,LOW AMENU7 ,HIGH AMENU7 ,6,80,LOW
                             (AltAircraft+6),HIGH AltAircraft
       3423 5320 6977 
       6374 2068 ??00 
       ???? 06?? ??80 
       00?? 
009D8A 4120 746C 2320 00421 AMENU9          DB      " Alt #5         ",0,LOW AMENU10, HIGH AMENU10,LOW AMENU8 ,HIGH AMENU8 ,5,40,LOW
                             (AltAircraft+9),HIGH AltAircraft,0,0,0,0,D'96',0
       2035 2020 2020 
       2020 2020 ??00 
       ???? 05?? ??40 
       00?? 0000 6000 
       0000 
009DAA 4120 746C 2020 00422 AMENU10         DB      " Alt  #5 Switch ",0,LOW AMENU11, HIGH AMENU11,LOW AMENU9 ,HIGH AMENU9 ,6,80,LOW
                             (AltAircraft+8),HIGH AltAircraft
       3523 5320 6977 
       6374 2068 ??00 
       ???? 06?? ??80 
       00?? 
009DC4 4120 746C 2320 00423 AMENU11         DB      " Alt #6         ",0,LOW AMENU12, HIGH AMENU12,LOW AMENU10,HIGH AMENU10,5,40,LOW
                             (AltAircraft+D'11'),HIGH AltAircraft,0,0,0,0,D'96',0
       2036 2020 2020 
       2020 2020 ??00 
       ???? 05?? ??40 
       00?? 0000 6000 
       0000 
009DE4 4120 746C 2020 00424 AMENU12         DB      " Alt  #6 Switch ",0,LOW AMENU13, HIGH AMENU13,LOW AMENU11,HIGH AMENU11,6,80,LOW
                             (AltAircraft+D'10'),HIGH AltAircraft
       3623 5320 6977 
       6374 2068 ??00 
       ???? 06?? ??80 
       00?? 
009DFE 5845 5449 2020 00425 AMENU13         DB      "EXIT            ",0,LOW AMENU1 , HIGH AMENU1 ,LOW AMENU12,HIGH AMENU12,3,0 ,LOW
                             EXIT, HIGH EXIT
       2020 2020 2020 
       2020 2020 ??00 
       ???? 03?? ??00 
       00?? 
                      00426 
                      00427 ; Autotrim tables.
                      00428 
009E18 5441 6D20 646F 00429 MATP1           DB      "AT mode         ",0,LOW MATP2, HIGH MATP2,LOW MATP6, HIGH MATP6,0,0,LOW ATMODE1
                            ,HIGH ATMODE1,LOW ATmode,HIGH ATmode
       2065 2020 2020 
       2020 2020 ??00 
       ???? 00?? ??00 
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 442


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

       ???? 00?? 
009E34 5441 6874 6572 00430 MATP2           DB      "ATthreshold     ",0,LOW MATP3, HIGH MATP3,LOW MATP1, HIGH MATP1,5,0,LOW ATthres
                            hold,HIGH ATthreshold
       6873 6C6F 2064 
       2020 2020 ??00 
       ???? 05?? ??00 
       00?? 
009E4E 5441 7320 6574 00431 MATP3           DB      "AT step         ",0,LOW MATP4, HIGH MATP4,LOW MATP2, HIGH MATP2,5,0,LOW AutoTri
                            mStep,HIGH AutoTrimStep
       2070 2020 2020 
       2020 2020 ??00 
       ???? 05?? ??00 
       00?? 
009E68 5441 7420 6369 00432 MATP4           DB      "AT ticks        ",0,LOW MATP5, HIGH MATP5,LOW MATP3, HIGH MATP3,5,0,LOW AutoTri
                            mTime,HIGH AutoTrimTime
       736B 2020 2020 
       2020 2020 ??00 
       ???? 05?? ??00 
       00?? 
009E82 6F74 5420 205A 00433 MATP5           DB      "to TZ           ",0,LOW MATP6, HIGH MATP6,LOW MATP4, HIGH MATP4,3,4,LOW YESNO,H
                            IGH YESNO,0,0,LOW AutoTrim2Zero,High AutoTrim2Zero
       2020 2020 2020 
       2020 2020 ??00 
       ???? 03?? ??04 
       00?? ??00 00?? 
009EA0 5845 5449 2020 00434 MATP6           DB      "EXIT            ",0,LOW MATP1, HIGH MATP1,LOW MATP5, HIGH MATP5,3,0,LOW EXIT,HI
                            GH EXIT
       2020 2020 2020 
       2020 2020 ??00 
       ???? 03?? ??00 
       00?? 
                      00435 
009EBA 5441 6D20 646F 00436 ATMODE1         DB      "AT mode      Off",0,LOW ATMODE2, HIGH ATMODE2,LOW ATMODE3, HIGH ATMODE3,2,0,LOW
                             ATmode,HIGH ATmode
       2065 2020 2020 
       4F20 6666 ??00 
       ???? 02?? ??00 
       00?? 
009ED4 5441 6D20 646F 00437 ATMODE2         DB      "AT mode      Inc",0,LOW ATMODE3, HIGH ATMODE3,LOW ATMODE1, HIGH ATMODE1,0,0,LOW
                             ATmode,HIGH ATmode
       2065 2020 2020 
       4920 636E ??00 
       ???? 00?? ??00 
       00?? 
009EEE 5441 6D20 646F 00438 ATMODE3         DB      "AT mode One Shot",0,LOW ATMODE1, HIGH ATMODE1,LOW ATMODE2, HIGH ATMODE2,1,0,LOW
                             ATmode,HIGH ATmode
       2065 6E4F 2065 
       6853 746F ??00 
       ???? 01?? ??00 
       00?? 
                      00439 
                      00440 ; Table used for selection of the AUXOUT pin function
                      00441 
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 443


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

009F08 2020 2020 2020 00442 MAUXOUT1        DB      "       CH1      ",0,LOW MAUXOUT2, HIGH MAUXOUT2,LOW MAUXOUT0, HIGH MAUXOUT0,1,0
       4320 3148 2020 
       2020 2020 ??00 
       ???? 01?? 0000 
009F20 2020 2020 2020 00443 MAUXOUT2        DB      "       CH2      ",0,LOW MAUXOUT3, HIGH MAUXOUT3,LOW MAUXOUT1, HIGH MAUXOUT1,3,0
       4320 3248 2020 
       2020 2020 ??00 
       ???? 03?? 0000 
009F38 2020 2020 2020 00444 MAUXOUT3        DB      "       CH3      ",0,LOW MAUXOUT4, HIGH MAUXOUT4,LOW MAUXOUT2, HIGH MAUXOUT2,5,0
       4320 3348 2020 
       2020 2020 ??00 
       ???? 05?? 0000 
009F50 2020 2020 2020 00445 MAUXOUT4        DB      "       CH4      ",0,LOW MAUXOUT5, HIGH MAUXOUT5,LOW MAUXOUT3, HIGH MAUXOUT3,7,0
       4320 3448 2020 
       2020 2020 ??00 
       ???? 07?? 0000 
009F68 2020 2020 2020 00446 MAUXOUT5        DB      "       CH5      ",0,LOW MAUXOUT6, HIGH MAUXOUT6,LOW MAUXOUT4, HIGH MAUXOUT4,9,0
       4320 3548 2020 
       2020 2020 ??00 
       ???? 09?? 0000 
009F80 2020 2020 2020 00447 MAUXOUT6        DB      "       CH6      ",0,LOW MAUXOUT7, HIGH MAUXOUT7,LOW MAUXOUT5, HIGH MAUXOUT5,0B,
                            0
       4320 3648 2020 
       2020 2020 ??00 
       ???? 0B?? 0000 
009F98 2020 2020 2020 00448 MAUXOUT7        DB      "       CH7      ",0,LOW MAUXOUT8, HIGH MAUXOUT8,LOW MAUXOUT6, HIGH MAUXOUT6,0D,
                            0
       4320 3748 2020 
       2020 2020 ??00 
       ???? 0D?? 0000 
009FB0 2020 2020 2020 00449 MAUXOUT8        DB      "       CH8      ",0,LOW MAUXOUT9, HIGH MAUXOUT9,LOW MAUXOUT7, HIGH MAUXOUT7,0F,
                            0
       4320 3848 2020 
       2020 2020 ??00 
       ???? 0F?? 0000 
009FC8 2020 2020 2020 00450 MAUXOUT9        DB      "       PPM      ",0,LOW MAUXOUT0, HIGH MAUXOUT0,LOW MAUXOUT8, HIGH MAUXOUT8,80,
                            0
       5020 4D50 2020 
       2020 2020 ??00 
       ???? 80?? 0000 
009FE0 2020 5050 204D 00451 MAUXOUT0        DB      "  PPM Inverted  ",0,LOW MAUXOUT1, HIGH MAUXOUT1,LOW MAUXOUT9, HIGH MAUXOUT9,81,
                            0
       6E49 6576 7472 
       6465 2020 ??00 
       ???? 81?? 0000 
                      00452 
                      00453 ; Buddy box options
                      00454 
009FF8 614D 7473 7265 00455 MBB1            DB      "Master ?        ",0,LOW MBB2, HIGH MBB2,LOW MBB4, HIGH MBB4,3,0,LOW Master, HIG
                            H Master
       3F20 2020 2020 
       2020 2020 ??00 
       ???? 03?? ??00 
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 444


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

       00?? 
00A012 2020 614D 7473 00456 MBB2            DB      "  Master  Mode  ",0,LOW MBB3, HIGH MBB3,LOW MBB1, HIGH MBB1,0,0,LOW MMM1, HIGH 
                            MMM1, LOW MasterMode, HIGH MasterMode
       7265 2020 6F4D 
       6564 2020 ??00 
       ???? 00?? ??00 
       ???? 00?? 
00A02E 7453 6475 6E65 00457 MBB3            DB      "Student ?       ",0,LOW MBB4, HIGH MBB4,LOW MBB2, HIGH MBB2,3,0,LOW Student, HI
                            GH Student
       2074 203F 2020 
       2020 2020 ??00 
       ???? 03?? ??00 
       00?? 
00A048 5845 5449 2020 00458 MBB4            DB      "EXIT            ",0,LOW MBB1, HIGH MBB1,LOW MBB3, HIGH MBB3,3,0,LOW EXIT,HIGH E
                            XIT
       2020 2020 2020 
       2020 2020 ??00 
       ???? 03?? ??00 
       00?? 
                      00459 
00A062 204D 6F4D 6564 00460 MMM1            DB      "M Mode=MicroStar",0,LOW MMM2, HIGH MMM2,LOW MMM2, HIGH MMM2,0,0
       4D3D 6369 6F72 
       7453 7261 ??00 
       ???? 00?? 0000 
00A07A 204D 6F4D 6564 00461 MMM2            DB      "M Mode=Futaba   ",0,LOW MMM1, HIGH MMM1,LOW MMM1, HIGH MMM1,1,0
       463D 7475 6261 
       2061 2020 ??00 
       ???? 01?? 0000 
                      00462 
                      00463 ; Table options
                      00464 
00A092 6941 6372 6172 00465 Tables1         DB      "Aircraft Table 1",0,LOW Tables2,HIGH Tables2,LOW Tables11,HIGH Tables11,9,86,LO
                            W MTABLE1,HIGH MTABLE1,LOW Atable1,HIGH Atable1,LOW Temp2Table
       7466 5420 6261 
       656C 3120 ??00 
       ???? 09?? ??86 
       ???? ???? 
00A0AE ???? 00??      00466                 DB      HIGH Temp2Table,LOW Table2Temp,HIGH Table2Temp
00A0B2 6941 6372 6172 00467 Tables2         DB      "Aircraft Table 2",0,LOW Tables3,HIGH Tables3,LOW Tables1,HIGH Tables1,9,86,LOW 
                            MTABLE1,HIGH MTABLE1,LOW Atable2,HIGH Atable2,LOW Temp2Table
       7466 5420 6261 
       656C 3220 ??00 
       ???? 09?? ??86 
       ???? ???? 
00A0CE ???? 00??      00468                 DB      HIGH Temp2Table,LOW Table2Temp,HIGH Table2Temp
00A0D2 6C47 626F 6C61 00469 Tables3         DB      "Global  Table  1",0,LOW Tables4,HIGH Tables4,LOW Tables2,HIGH Tables2,9,86,LOW 
                            MTABLE1,HIGH MTABLE1,LOW Table1,HIGH Table1,LOW Temp2Table
       2020 6154 6C62 
       2065 3120 ??00 
       ???? 09?? ??86 
       ???? ???? 
00A0EE ???? 00??      00470                 DB      HIGH Temp2Table,LOW Table2Temp,HIGH Table2Temp
00A0F2 6C47 626F 6C61 00471 Tables4         DB      "Global  Table  2",0,LOW Tables5,HIGH Tables5,LOW Tables3,HIGH Tables3,9,86,LOW 
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 445


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                            MTABLE1,HIGH MTABLE1,LOW Table2,HIGH Table2,LOW Temp2Table
       2020 6154 6C62 
       2065 3220 ??00 
       ???? 09?? ??86 
       ???? ???? 
00A10E ???? 00??      00472                 DB      HIGH Temp2Table,LOW Table2Temp,HIGH Table2Temp
00A112 6C47 626F 6C61 00473 Tables5         DB      "Global  Table  3",0,LOW Tables6,HIGH Tables6,LOW Tables4,HIGH Tables4,9,86,LOW 
                            MTABLE1,HIGH MTABLE1,LOW Table3,HIGH Table3,LOW Temp2Table
       2020 6154 6C62 
       2065 3320 ??00 
       ???? 09?? ??86 
       ???? ???? 
00A12E ???? 00??      00474                 DB      HIGH Temp2Table,LOW Table2Temp,HIGH Table2Temp
00A132 6C47 626F 6C61 00475 Tables6         DB      "Global  Table  4",0,LOW Tables7,HIGH Tables7,LOW Tables5,HIGH Tables5,9,86,LOW 
                            MTABLE1,HIGH MTABLE1,LOW Table4,HIGH Table4,LOW Temp2Table
       2020 6154 6C62 
       2065 3420 ??00 
       ???? 09?? ??86 
       ???? ???? 
00A14E ???? 00??      00476                 DB      HIGH Temp2Table,LOW Table2Temp,HIGH Table2Temp
00A152 6C47 626F 6C61 00477 Tables7         DB      "Global  Table  5",0,LOW Tables8,HIGH Tables8,LOW Tables6,HIGH Tables6,9,86,LOW 
                            MTABLE1,HIGH MTABLE1,LOW Table5,HIGH Table5,LOW Temp2Table
       2020 6154 6C62 
       2065 3520 ??00 
       ???? 09?? ??86 
       ???? ???? 
00A16E ???? 00??      00478                 DB      HIGH Temp2Table,LOW Table2Temp,HIGH Table2Temp
00A172 6C47 626F 6C61 00479 Tables8         DB      "Global  Table  6",0,LOW Tables9,HIGH Tables9,LOW Tables7,HIGH Tables7,9,86,LOW 
                            MTABLE1,HIGH MTABLE1,LOW Table6,HIGH Table6,LOW Temp2Table
       2020 6154 6C62 
       2065 3620 ??00 
       ???? 09?? ??86 
       ???? ???? 
00A18E ???? 00??      00480                 DB      HIGH Temp2Table,LOW Table2Temp,HIGH Table2Temp
00A192 6C47 626F 6C61 00481 Tables9         DB      "Global  Table  7",0,LOW Tables10,HIGH Tables10,LOW Tables8,HIGH Tables8,9,86,LO
                            W MTABLE1,HIGH MTABLE1,LOW Table7,HIGH Table7,LOW Temp2Table
       2020 6154 6C62 
       2065 3720 ??00 
       ???? 09?? ??86 
       ???? ???? 
00A1AE ???? 00??      00482                 DB      HIGH Temp2Table,LOW Table2Temp,HIGH Table2Temp
00A1B2 6C47 626F 6C61 00483 Tables10        DB      "Global  Table  8",0,LOW Tables11,HIGH Tables11,LOW Tables9,HIGH Tables9,9,86,LO
                            W MTABLE1,HIGH MTABLE1,LOW Table8,HIGH Table8,LOW Temp2Table
       2020 6154 6C62 
       2065 3820 ??00 
       ???? 09?? ??86 
       ???? ???? 
00A1CE ???? 00??      00484                 DB      HIGH Temp2Table,LOW Table2Temp,HIGH Table2Temp
00A1D2 5845 5449 2020 00485 Tables11        DB      "EXIT            ",0,LOW Tables1,HIGH Tables1,LOW Tables10,HIGH Tables10,3,0,LOW
                             EXIT,HIGH EXIT
       2020 2020 2020 
       2020 2020 ??00 
       ???? 03?? ??00 
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 446


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

       00?? 
                      00486 
00A1EC 4F50 2053 2030 00487 MTABLE1         DB      "POS 0           ",0,LOW MTABLE2 ,HIGH MTABLE2 ,LOW MTABLE12,HIGH MTABLE12,1,0,L
                            OW CalTable, HIGH CalTable
       2020 2020 2020 
       2020 2020 ??00 
       ???? 01?? ??00 
       00?? 
00A206 4F50 2053 2031 00488 MTABLE2         DB      "POS 1           ",0,LOW MTABLE3 ,HIGH MTABLE3 ,LOW MTABLE1 ,HIGH MTABLE1 ,1,0,L
                            OW (CalTable+1), HIGH CalTable
       2020 2020 2020 
       2020 2020 ??00 
       ???? 01?? ??00 
       00?? 
00A220 4F50 2053 2032 00489 MTABLE3         DB      "POS 2           ",0,LOW MTABLE4 ,HIGH MTABLE4 ,LOW MTABLE2 ,HIGH MTABLE2 ,1,0,L
                            OW (CalTable+2), HIGH CalTable
       2020 2020 2020 
       2020 2020 ??00 
       ???? 01?? ??00 
       00?? 
00A23A 4F50 2053 2033 00490 MTABLE4         DB      "POS 3           ",0,LOW MTABLE5 ,HIGH MTABLE5 ,LOW MTABLE3 ,HIGH MTABLE3 ,1,0,L
                            OW (CalTable+3), HIGH CalTable
       2020 2020 2020 
       2020 2020 ??00 
       ???? 01?? ??00 
       00?? 
00A254 4F50 2053 2034 00491 MTABLE5         DB      "POS 4           ",0,LOW MTABLE6 ,HIGH MTABLE6 ,LOW MTABLE4 ,HIGH MTABLE4 ,1,0,L
                            OW (CalTable+4), HIGH CalTable
       2020 2020 2020 
       2020 2020 ??00 
       ???? 01?? ??00 
       00?? 
00A26E 4F50 2053 2035 00492 MTABLE6         DB      "POS 5           ",0,LOW MTABLE7 ,HIGH MTABLE7 ,LOW MTABLE5 ,HIGH MTABLE5 ,1,0,L
                            OW (CalTable+5), HIGH CalTable
       2020 2020 2020 
       2020 2020 ??00 
       ???? 01?? ??00 
       00?? 
00A288 4F50 2053 2036 00493 MTABLE7         DB      "POS 6           ",0,LOW MTABLE8 ,HIGH MTABLE8 ,LOW MTABLE6 ,HIGH MTABLE6 ,1,0,L
                            OW (CalTable+6), HIGH CalTable
       2020 2020 2020 
       2020 2020 ??00 
       ???? 01?? ??00 
       00?? 
00A2A2 4F50 2053 2037 00494 MTABLE8         DB      "POS 7           ",0,LOW MTABLE9 ,HIGH MTABLE9 ,LOW MTABLE7 ,HIGH MTABLE7 ,1,0,L
                            OW (CalTable+7), HIGH CalTable
       2020 2020 2020 
       2020 2020 ??00 
       ???? 01?? ??00 
       00?? 
00A2BC 4F50 2053 2038 00495 MTABLE9         DB      "POS 8           ",0,LOW MTABLE10,HIGH MTABLE10,LOW MTABLE8 ,HIGH MTABLE8 ,1,0,L
                            OW (CalTable+8), HIGH CalTable
       2020 2020 2020 
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 447


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

       2020 2020 ??00 
       ???? 01?? ??00 
       00?? 
00A2D6 4F50 2053 2039 00496 MTABLE10        DB      "POS 9           ",0,LOW MTABLE11,HIGH MTABLE11,LOW MTABLE9 ,HIGH MTABLE9 ,1,0,L
                            OW (CalTable+9), HIGH CalTable
       2020 2020 2020 
       2020 2020 ??00 
       ???? 01?? ??00 
       00?? 
00A2F0 4F50 2053 3031 00497 MTABLE11        DB      "POS 10          ",0,LOW MTABLE12,HIGH MTABLE12,LOW MTABLE10,HIGH MTABLE10,1,0,L
                            OW (CalTable+0a), HIGH CalTable
       2020 2020 2020 
       2020 2020 ??00 
       ???? 01?? ??00 
       00?? 
00A30A 5845 5449 2020 00498 MTABLE12        DB      "EXIT            ",0,LOW MTABLE1 ,HIGH MTABLE1 ,LOW MTABLE11,HIGH MTABLE11,3,0,L
                            OW EXIT,HIGH EXIT
       2020 2020 2020 
       2020 2020 ??00 
       ???? 03?? ??00 
       00?? 
                      00499 
                      00500 ; The following tables support the system setup calibration menu.
                      00501 
00A324 5420 2058 6F56 00502 SYS1    DB      " TX Volt  Meter ",0,LOW SYS2, HIGH SYS2, LOW SYS22,HIGH SYS22,7,88 ,LOW TXvoltSet, HIGH
                             TXvoltSet, LOW MVOLTS, HIGH MVOLTS
       746C 2020 654D 
       6574 2072 ??00 
       ???? 07?? ??88 
       ???? 00?? 
00A340 5854 4120 616C 00503 SYS2    DB      "TX Alarm Voltage",0,LOW SYS3, HIGH SYS3, LOW SYS1 ,HIGH SYS1 ,8,0C8,LOW BattAlarm, HIGH
                             BattAlarm, LOW MVOLTS, HIGH MVOLTS, 0,0,0FF,00
       6D72 5620 6C6F 
       6174 6567 ??00 
       ???? 08?? ??C8 
       ???? 00?? FF00 
       0000 
00A360 6552 6573 2074 00504 SYS3    DB      "Reset Batt Timer",0,LOW SYS4, HIGH SYS4, LOW SYS2 ,HIGH SYS2 ,3,8C ,LOW YESNO, HIGH YES
                            NO, LOW MRST, HIGH MRST,LOW ResetBatTimer,HIGH ResetBatTimer 
       6142 7474 5420 
       6D69 7265 ??00 
       ???? 03?? ??8C 
       ???? ???? 00?? 
00A37E 5220 2058 6F56 00505 SYS4    DB      " RX Volt  Meter ",0,LOW SYS5, HIGH SYS5, LOW SYS3 ,HIGH SYS3 ,7,88 ,LOW RXvoltSet, HIGH
                             RXvoltSet, LOW MVOLTS, HIGH MVOLTS
       746C 2020 654D 
       6574 2072 ??00 
       ???? 07?? ??88 
       ???? 00?? 
00A39A 6553 7672 206F 00506 SYS5    DB      "Servo  Min Pulse",0,LOW SYS6, HIGH SYS6, LOW SYS4 ,HIGH SYS4 ,2,0C8,LOW ServoMin,HIGH S
                            ervoMin,LOW MSYNC,HIGH MSYNC,LOW D'1000',HIGH D'1000',LOW D'5000',HIGH D'5000'
       4D20 6E69 5020 
       6C75 6573 ??00 
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 448


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

       ???? 02?? ??C8 
       ???? E8?? 8803 
       0013 
00A3BA 6553 7672 206F 00507 SYS6    DB      "Servo  Max Pulse",0,LOW SYS7, HIGH SYS7, LOW SYS5 ,HIGH SYS5 ,2,0C8,LOW ServoMax,HIGH S
                            ervoMax,LOW MSYNC, HIGH MSYNC,LOW D'1000',HIGH D'1000',LOW D'5000',HIGH D'5000'
       4D20 7861 5020 
       6C75 6573 ??00 
       ???? 02?? ??C8 
       ???? E8?? 8803 
       0013 
00A3DA 754E 626D 7265 00508 SYS7    DB      "Number  Channels",0,LOW SYS8, HIGH SYS8, LOW SYS6 ,HIGH SYS6 ,5,0CE,LOW MaxChannels,HIG
                            H MaxChannels,LOW MNUMCH,HIGH MNUMCH,4,0,9,0, LOW PostChan
       2020 6843 6E61 
       656E 736C ??00 
       ???? 05?? ??CE 
       ???? 04?? 0900 
       ??00 
00A3FA ???? 00??      00509         DB                         HIGH PostChan, LOW PreChan, HIGH PreChan
00A3FE 2020 5320 6E79 00510 SYS8    DB      "   Sync width   ",0,LOW SYS9, HIGH SYS9, LOW SYS7 ,HIGH SYS7 ,2,0C8,LOW SyncWidth, HIGH
                             SyncWidth,LOW MSYNC,HIGH MSYNC,LOW D'200',HIGH D'200',LOW D'1500',HIGH D'1500'
       2063 6977 7464 
       2068 2020 ??00 
       ???? 02?? ??C8 
       ???? C8?? DC00 
       0005 
00A41E 2020 6853 6669 00511 SYS9    DB      "  Shift Invert  ",0,LOW SYS10,HIGH SYS10,LOW SYS8 ,HIGH SYS8 ,3,8C ,LOW SHIFT, HIGH SHI
                            FT,LOW MSHFINV, HIGH MSHFINV, LOW ATLpost, HIGH ATLpost
       2074 6E49 6576 
       7472 2020 ??00 
       ???? 03?? ??8C 
       ???? ???? 00?? 
00A43C 2020 6F46 6D72 00512 SYS10   DB      "  Format Flash  ",0,LOW SYS11,HIGH SYS11,LOW SYS9 ,HIGH SYS9 ,7,80 ,LOW FmtFlsh, HIGH F
                            mtFlsh
       7461 4620 616C 
       6873 2020 ??00 
       ???? 07?? ??80 
       00?? 
00A456 2020 2020 6F43 00513 SYS11   DB      "    Configure   ",0,LOW SYS12,HIGH SYS12,LOW SYS10,HIGH SYS10,9,84 ,LOW SCALCFG1, HIGH 
                            SCALCFG1,0,0, LOW postConfig, HIGH postConfig
       666E 6769 7275 
       2065 2020 ??00 
       ???? 09?? ??84 
       00?? ??00 00?? 
00A474 2020 6F4A 5379 00514 SYS12   DB      "  JoyStick Cal  ",0,LOW SYS13,HIGH SYS13,LOW SYS11,HIGH SYS11,9,80 ,LOW JSCAL1, HIGH JS
                            CAL1
       6974 6B63 4320 
       6C61 2020 ??00 
       ???? 09?? ??80 
       00?? 
00A48E 2020 4620 534D 00515 SYS13   DB      "   FMS UART 1   ",0,LOW SYS14,HIGH SYS14,LOW SYS12,HIGH SYS12,3,8C ,LOW FMSflagU1, HIGH
                             FMSflagU1, LOW MENA, HIGH MENA,LOW FMSenable,HIGH FMSenable
       5520 5241 2054 
       2031 2020 ??00 
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 449


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

       ???? 03?? ??8C 
       ???? ???? 00?? 
00A4AC 2020 4620 534D 00516 SYS14   DB      "   FMS UART 2   ",0,LOW SYS15,HIGH SYS15,LOW SYS13,HIGH SYS13,3,8C ,LOW FMSflag, HIGH F
                            MSflag, LOW MENA, HIGH MENA,LOW FMSenable,HIGH FMSenable
       5520 5241 2054 
       2032 2020 ??00 
       ???? 03?? ??8C 
       ???? ???? 00?? 
00A4CA 4620 6572 7571 00517 SYS15   DB      " Frequency Band ",0,LOW SYS16,HIGH SYS16,LOW SYS14,HIGH SYS14,0,84 ,LOW SFBAND1, HIGH S
                            FBAND1, LOW Fband, HIGH Fband, LOW PostBand, HIGH PostBand
       6E65 7963 4220 
       6E61 2064 ??00 
       ???? 00?? ??84 
       ???? ???? 00?? 
00A4E8 4220 7A75 657A 00518 SYS16   DB      " Buzzer  Invert ",0,LOW SYS17,HIGH SYS17,LOW SYS15,HIGH SYS15,3,88 ,LOW BuzPol,HIGH Buz
                            Pol,LOW MINVERT,HIGH MINVERT
       2072 4920 766E 
       7265 2074 ??00 
       ???? 03?? ??88 
       ???? 00?? 
00A504 2C41 2C45 2C52 00519 SYS17   DB      "A,E,R,TrmCtrBeep",0,LOW SYS18,HIGH SYS18,LOW SYS16,HIGH SYS16,3,88 ,LOW TrimCenterBeepF
                            lag,HIGH TrimCenterBeepFlag,LOW MENA,HIGH MENA
       7254 436D 7274 
       6542 7065 ??00 
       ???? 03?? ??88 
       ???? 00?? 
00A520 5420 7468 5420 00520 SYS18   DB      " Tht TrmCtrBeep ",0,LOW SYS19,HIGH SYS19,LOW SYS17,HIGH SYS17,3,88 ,LOW ThtTCenterBeepF
                            lag,HIGH ThtTCenterBeepFlag,LOW MENA,HIGH MENA
       6D72 7443 4272 
       6565 2070 ??00 
       ???? 03?? ??88 
       ???? 00?? 
00A53C 4843 2636 2037 00521 SYS19   DB      "CH6&7 TrmCtrBeep",0,LOW SYS20,HIGH SYS20,LOW SYS18,HIGH SYS18,3,88 ,LOW CH67CenterBeepF
                            lag,HIGH CH67CenterBeepFlag,LOW MENA,HIGH MENA
       7254 436D 7274 
       6542 7065 ??00 
       ???? 03?? ??88 
       ???? 00?? 
00A558 5444 6972 416D 00522 SYS20   DB      "DTrimAdjustDelay",0,LOW SYS21,HIGH SYS21,LOW SYS19,HIGH SYS19,5,0C8,LOW DTrimAdjustDela
                            y,HIGH DTrimAdjustDelay,LOW MDELAY,HIGH MDELAY,D'3',0,D'20',00
       6A64 7375 4474 
       6C65 7961 ??00 
       ???? 05?? ??C8 
       ???? 03?? 1400 
       0000 
00A578 2020 4F44 2047 00523 SYS21   DB      "  DOG contrast  ",0,LOW SYS22,HIGH SYS22,LOW SYS20,HIGH SYS20,5,0CC,LOW DOGcontrast,HIG
                            H DOGcontrast,LOW MCONT,HIGH MCONT,D'30',0,D'45',0,LOW SetDOGcontrast,HIGH SetDOGcontrast
       6F63 746E 6172 
       7473 2020 ??00 
       ???? 05?? ??CC 
       ???? 1E?? 2D00 
       ??00 00?? 
00A59A 5845 5449 2020 00524 SYS22   DB      "EXIT            ",0,LOW SYS1 ,HIGH SYS1, LOW SYS21,HIGH SYS21,3,0 , LOW EXIT,HIGH EXIT
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 450


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

       2020 2020 2020 
       2020 2020 ??00 
       ???? 03?? ??00 
       00?? 
                      00525 
00A5B4 2020 2020 4E20 00526 SFBAND1         DB      "     No  RF     ",0,LOW SFBAND2, HIGH SFBAND2,LOW SFBAND4, HIGH SFBAND4,0,0
       206F 5220 2046 
       2020 2020 ??00 
       ???? 00?? 0000 
00A5CC 2020 2020 3520 00527 SFBAND2         DB      "     50  MHz    ",0,LOW SFBAND3, HIGH SFBAND3,LOW SFBAND1, HIGH SFBAND1,1,0
       2030 4D20 7A48 
       2020 2020 ??00 
       ???? 01?? 0000 
00A5E4 2020 2020 3520 00528 SFBAND3         DB      "     53  MHz    ",0,LOW SFBAND4, HIGH SFBAND4,LOW SFBAND2, HIGH SFBAND2,2,0
       2033 4D20 7A48 
       2020 2020 ??00 
       ???? 02?? 0000 
00A5FC 2020 2020 3720 00529 SFBAND4         DB      "     72  MHz    ",0,LOW SFBAND1, HIGH SFBAND1,LOW SFBAND3, HIGH SFBAND3,3,0
       2032 4D20 7A48 
       2020 2020 ??00 
       ???? 03?? 0000 
                      00530 
                      00531 ; Transmitter configuration menus, these menus allow the pilot to define the transmitter output
                      00532 ; channel order and the trim assignment.
                      00533 
00A614 4320 6168 6E6E 00534 SCALCFG1        DB      " Channel  Order ",0,LOW SCALCFG2 ,HIGH SCALCFG2 ,LOW SCALCFG14,HIGH SCALCFG14,0
                            ,84,LOW SCHORD1, HIGH SCHORD1, LOW Atemp, HIGH Atemp, LOW PostSetOrder, HIGH PostSetOrder
       6C65 2020 724F 
       6564 2072 ??00 
       ???? 00?? ??84 
       ???? ???? 00?? 
00A632 754F 7074 7475 00535 SCALCFG2        DB      "Output channel 1",0,LOW SCALCFG3 ,HIGH SCALCFG3 ,LOW SCALCFG1 ,HIGH SCALCFG1 ,0
                            ,80,LOW SCALCH1, HIGH SCALCH1, LOW ChannelOrder, HIGH ChannelOrder
       6320 6168 6E6E 
       6C65 3120 ??00 
       ???? 00?? ??80 
       ???? 00?? 
00A64E 754F 7074 7475 00536 SCALCFG3        DB      "Output channel 2",0,LOW SCALCFG4 ,HIGH SCALCFG4 ,LOW SCALCFG2 ,HIGH SCALCFG2 ,0
                            ,80,LOW SCALCH1, HIGH SCALCH1, LOW (ChannelOrder+1), HIGH ChannelOrder
       6320 6168 6E6E 
       6C65 3220 ??00 
       ???? 00?? ??80 
       ???? 00?? 
00A66A 754F 7074 7475 00537 SCALCFG4        DB      "Output channel 3",0,LOW SCALCFG5 ,HIGH SCALCFG5 ,LOW SCALCFG3 ,HIGH SCALCFG3 ,0
                            ,80,LOW SCALCH1, HIGH SCALCH1, LOW (ChannelOrder+2), HIGH ChannelOrder
       6320 6168 6E6E 
       6C65 3320 ??00 
       ???? 00?? ??80 
       ???? 00?? 
00A686 754F 7074 7475 00538 SCALCFG5        DB      "Output channel 4",0,LOW SCALCFG6 ,HIGH SCALCFG6 ,LOW SCALCFG4 ,HIGH SCALCFG4 ,0
                            ,80,LOW SCALCH1, HIGH SCALCH1, LOW (ChannelOrder+3), HIGH ChannelOrder
       6320 6168 6E6E 
       6C65 3420 ??00 
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 451


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

       ???? 00?? ??80 
       ???? 00?? 
00A6A2 754F 7074 7475 00539 SCALCFG6        DB      "Output channel 5",0,LOW SCALCFG7 ,HIGH SCALCFG7 ,LOW SCALCFG5 ,HIGH SCALCFG5 ,0
                            ,80,LOW SCALCH1, HIGH SCALCH1, LOW (ChannelOrder+4), HIGH ChannelOrder
       6320 6168 6E6E 
       6C65 3520 ??00 
       ???? 00?? ??80 
       ???? 00?? 
00A6BE 754F 7074 7475 00540 SCALCFG7        DB      "Output channel 6",0,LOW SCALCFG8 ,HIGH SCALCFG8 ,LOW SCALCFG6 ,HIGH SCALCFG6 ,0
                            ,80,LOW SCALCH1, HIGH SCALCH1, LOW (ChannelOrder+5), HIGH ChannelOrder
       6320 6168 6E6E 
       6C65 3620 ??00 
       ???? 00?? ??80 
       ???? 00?? 
00A6DA 754F 7074 7475 00541 SCALCFG8        DB      "Output channel 7",0,LOW SCALCFG9 ,HIGH SCALCFG9 ,LOW SCALCFG7 ,HIGH SCALCFG7 ,0
                            ,80,LOW SCALCH1, HIGH SCALCH1, LOW (ChannelOrder+6), HIGH ChannelOrder
       6320 6168 6E6E 
       6C65 3720 ??00 
       ???? 00?? ??80 
       ???? 00?? 
00A6F6 754F 7074 7475 00542 SCALCFG9        DB      "Output channel 8",0,LOW SCALCFG10,HIGH SCALCFG10,LOW SCALCFG8 ,HIGH SCALCFG8 ,0
                            ,80,LOW SCALCH1, HIGH SCALCH1, LOW (ChannelOrder+7), HIGH ChannelOrder
       6320 6168 6E6E 
       6C65 3820 ??00 
       ???? 00?? ??80 
       ???? 00?? 
00A712 6553 656C 7463 00543 SCALCFG10       DB      "Select Ail  Trim",0,LOW SCALCFG11,HIGH SCALCFG11,LOW SCALCFG9 ,HIGH SCALCFG9 ,0
                            ,80,LOW SCALTRIM1, HIGH SCALTRIM1, LOW AilTrimCh, HIGH AilTrimCh
       4120 6C69 2020 
       7254 6D69 ??00 
       ???? 00?? ??80 
       ???? 00?? 
00A72E 6553 656C 7463 00544 SCALCFG11       DB      "Select Ele  Trim",0,LOW SCALCFG12,HIGH SCALCFG12,LOW SCALCFG10,HIGH SCALCFG10,0
                            ,80,LOW SCALTRIM1, HIGH SCALTRIM1, LOW EleTrimCh, HIGH EleTrimCh
       4520 656C 2020 
       7254 6D69 ??00 
       ???? 00?? ??80 
       ???? 00?? 
00A74A 6553 656C 7463 00545 SCALCFG12       DB      "Select Rud  Trim",0,LOW SCALCFG13,HIGH SCALCFG13,LOW SCALCFG11,HIGH SCALCFG11,0
                            ,80,LOW SCALTRIM1, HIGH SCALTRIM1, LOW RudTrimCh, HIGH RudTrimCh
       5220 6475 2020 
       7254 6D69 ??00 
       ???? 00?? ??80 
       ???? 00?? 
00A766 6553 656C 7463 00546 SCALCFG13       DB      "Select Tht  Trim",0,LOW SCALCFG14,HIGH SCALCFG14,LOW SCALCFG12,HIGH SCALCFG12,0
                            ,80,LOW SCALTRIM1, HIGH SCALTRIM1, LOW ThtTrimCh, HIGH ThtTrimCh
       5420 7468 2020 
       7254 6D69 ??00 
       ???? 00?? ??80 
       ???? 00?? 
00A782 5845 5449 2020 00547 SCALCFG14       DB      "EXIT            ",0,LOW SCALCFG1 ,HIGH SCALCFG1 ,LOW SCALCFG13,HIGH SCALCFG13,3
                            ,0,LOW EXIT, HIGH EXIT
       2020 2020 2020 
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 452


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

       2020 2020 ??00 
       ???? 03?? ??00 
       00?? 
                      00548 
00A79C 2020 2020 2020 00549 SCHORD1         DB      "       ACE      ",0,LOW SCHORD2, HIGH SCHORD2,LOW SCHORD4, HIGH SCHORD4,1,0
       4120 4543 2020 
       2020 2020 ??00 
       ???? 01?? 0000 
00A7B4 2020 2020 4620 00550 SCHORD2         DB      "     Futaba     ",0,LOW SCHORD3, HIGH SCHORD3,LOW SCHORD1, HIGH SCHORD1,2,0
       7475 6261 2061 
       2020 2020 ??00 
       ???? 02?? 0000 
00A7CC 2020 4120 7269 00551 SCHORD3         DB      "   Airtronics   ",0,LOW SCHORD4, HIGH SCHORD4,LOW SCHORD2, HIGH SCHORD2,3,0
       7274 6E6F 6369 
       2073 2020 ??00 
       ???? 03?? 0000 
00A7E4 2020 2020 2020 00552 SCHORD4         DB      "       JR       ",0,LOW SCHORD1, HIGH SCHORD1,LOW SCHORD3, HIGH SCHORD3,4,0
       4A20 2052 2020 
       2020 2020 ??00 
       ???? 04?? 0000 
                      00553 
00A7FC 2020 2020 6941 00554 SCALCH1         DB      "    Aileron     ",0,LOW SCALCH2, HIGH SCALCH2,LOW SCALCH8, HIGH SCALCH8,1,0,LOW
                             STRIM, HIGH STRIM
       656C 6F72 206E 
       2020 2020 ??00 
       ???? 01?? ??00 
       00?? 
00A816 2020 2020 6C45 00555 SCALCH2         DB      "    Elevator    ",0,LOW SCALCH3, HIGH SCALCH3,LOW SCALCH1, HIGH SCALCH1,2,0,LOW
                             STRIM, HIGH STRIM
       7665 7461 726F 
       2020 2020 ??00 
       ???? 02?? ??00 
       00?? 
00A830 2020 2020 5220 00556 SCALCH3         DB      "     Rudder     ",0,LOW SCALCH4, HIGH SCALCH4,LOW SCALCH2, HIGH SCALCH2,3,0,LOW
                             STRIM, HIGH STRIM
       6475 6564 2072 
       2020 2020 ??00 
       ???? 03?? ??00 
       00?? 
00A84A 2020 2020 6854 00557 SCALCH4         DB      "    Throttle    ",0,LOW SCALCH5, HIGH SCALCH5,LOW SCALCH3, HIGH SCALCH3,4,0,LOW
                             STRIM, HIGH STRIM
       6F72 7474 656C 
       2020 2020 ??00 
       ???? 04?? ??00 
       00?? 
00A864 2020 2020 2020 00558 SCALCH5         DB      "       CH5      ",0,LOW SCALCH6, HIGH SCALCH6,LOW SCALCH4, HIGH SCALCH4,5,0,LOW
                             STRIM, HIGH STRIM
       4320 3548 2020 
       2020 2020 ??00 
       ???? 05?? ??00 
       00?? 
00A87E 2020 2020 2020 00559 SCALCH6         DB      "       CH6      ",0,LOW SCALCH7, HIGH SCALCH7,LOW SCALCH5, HIGH SCALCH5,6,0,LOW
                             STRIM, HIGH STRIM
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 453


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

       4320 3648 2020 
       2020 2020 ??00 
       ???? 06?? ??00 
       00?? 
00A898 2020 2020 2020 00560 SCALCH7         DB      "       CH7      ",0,LOW SCALCH8, HIGH SCALCH8,LOW SCALCH6, HIGH SCALCH6,7,0,LOW
                             STRIM, HIGH STRIM
       4320 3748 2020 
       2020 2020 ??00 
       ???? 07?? ??00 
       00?? 
00A8B2 2020 2020 2020 00561 SCALCH8         DB      "       CH8      ",0,LOW SCALCH1, HIGH SCALCH1,LOW SCALCH7, HIGH SCALCH7,8,0,LOW
                             STRIM, HIGH STRIM
       4320 3848 2020 
       2020 2020 ??00 
       ???? 08?? ??00 
       00?? 
                      00562 
00A8CC 2020 2020 6F4E 00563 SCALTRIM1       DB      "    No  Trim    ",0,LOW SCALTRIM2, HIGH SCALTRIM2, LOW SCALTRIM9, HIGH SCALTRIM
                            9, 0,0,LOW STRIM, HIGH STRIM
       2020 7254 6D69 
       2020 2020 ??00 
       ???? 00?? ??00 
       00?? 
00A8E6 2020 2020 5420 00564 SCALTRIM2       DB      "     Trim 1     ",0,LOW SCALTRIM3, HIGH SCALTRIM3, LOW SCALTRIM1, HIGH SCALTRIM
                            1, 1,0,LOW STRIM, HIGH STRIM
       6972 206D 2031 
       2020 2020 ??00 
       ???? 01?? ??00 
       00?? 
00A900 2020 2020 5420 00565 SCALTRIM3       DB      "     Trim 2     ",0,LOW SCALTRIM4, HIGH SCALTRIM4, LOW SCALTRIM2, HIGH SCALTRIM
                            2, 2,0,LOW STRIM, HIGH STRIM
       6972 206D 2032 
       2020 2020 ??00 
       ???? 02?? ??00 
       00?? 
00A91A 2020 2020 5420 00566 SCALTRIM4       DB      "     Trim 3     ",0,LOW SCALTRIM5, HIGH SCALTRIM5, LOW SCALTRIM3, HIGH SCALTRIM
                            3, 3,0,LOW STRIM, HIGH STRIM
       6972 206D 2033 
       2020 2020 ??00 
       ???? 03?? ??00 
       00?? 
00A934 2020 2020 5420 00567 SCALTRIM5       DB      "     Trim 4     ",0,LOW SCALTRIM6, HIGH SCALTRIM6, LOW SCALTRIM4, HIGH SCALTRIM
                            4, 4,0,LOW STRIM, HIGH STRIM
       6972 206D 2034 
       2020 2020 ??00 
       ???? 04?? ??00 
       00?? 
00A94E 4420 6769 7469 00568 SCALTRIM6       DB      " Digital Trim 1 ",0,LOW SCALTRIM7, HIGH SCALTRIM7, LOW SCALTRIM5, HIGH SCALTRIM
                            5,10,0,LOW STRIM, HIGH STRIM
       6C61 5420 6972 
       206D 2031 ??00 
       ???? 10?? ??00 
       00?? 
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 454


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

00A968 4420 6769 7469 00569 SCALTRIM7       DB      " Digital Trim 2 ",0,LOW SCALTRIM8, HIGH SCALTRIM8, LOW SCALTRIM6, HIGH SCALTRIM
                            6,20,0,LOW STRIM, HIGH STRIM
       6C61 5420 6972 
       206D 2032 ??00 
       ???? 20?? ??00 
       00?? 
00A982 4420 6769 7469 00570 SCALTRIM8       DB      " Digital Trim 3 ",0,LOW SCALTRIM9, HIGH SCALTRIM9, LOW SCALTRIM7, HIGH SCALTRIM
                            7,30,0,LOW STRIM, HIGH STRIM
       6C61 5420 6972 
       206D 2033 ??00 
       ???? 30?? ??00 
       00?? 
00A99C 4420 6769 7469 00571 SCALTRIM9       DB      " Digital Trim 4 ",0,LOW SCALTRIM1, HIGH SCALTRIM1, LOW SCALTRIM8, HIGH SCALTRIM
                            8,40,0,LOW STRIM, HIGH STRIM
       6C61 5420 6972 
       206D 2034 ??00 
       ???? 40?? ??00 
       00?? 
                      00572 
                      00573 ; Joy stick calibration...
                      00574 
00A9B6 2020 2020 6941 00575 JSCAL1          DB      "    Aileron     ",0,LOW JSCAL2, HIGH JSCAL2, LOW JSCAL11,HIGH JSCAL11,7,80,LOW 
                            JScChan,HIGH JScChan,LOW AHG,4
       656C 6F72 206E 
       2020 2020 ??00 
       ???? 07?? ??80 
       ???? 0004 
00A9D2 2020 2020 6C45 00576 JSCAL2          DB      "    Elevator    ",0,LOW JSCAL3, HIGH JSCAL3, LOW JSCAL1, HIGH JSCAL1, 7,80,LOW 
                            JScChan,HIGH JScChan,LOW EHG,5
       7665 7461 726F 
       2020 2020 ??00 
       ???? 07?? ??80 
       ???? 0005 
00A9EE 2020 2020 7552 00577 JSCAL3          DB      "    Rudder      ",0,LOW JSCAL4, HIGH JSCAL4, LOW JSCAL2, HIGH JSCAL2, 7,80,LOW 
                            JScChan,HIGH JScChan,LOW RHG,6
       6464 7265 2020 
       2020 2020 ??00 
       ???? 07?? ??80 
       ???? 0006 
00AA0A 2020 2020 6854 00578 JSCAL4          DB      "    Throttle    ",0,LOW JSCAL5, HIGH JSCAL5, LOW JSCAL3, HIGH JSCAL3, 7,80,LOW 
                            JSncChan,HIGH JSncChan,LOW THG,7
       6F72 7474 656C 
       2020 2020 ??00 
       ???? 07?? ??80 
       ???? 0007 
00AA26 2020 2020 2020 00579 JSCAL5          DB      "      CH6       ",0,LOW JSCAL6, HIGH JSCAL6, LOW JSCAL4, HIGH JSCAL4, 7,80,LOW 
                            JStrimsChan,HIGH JStrimsChan,LOW CH6HG,0
       4843 2036 2020 
       2020 2020 ??00 
       ???? 07?? ??80 
       ???? 0000 
00AA42 2020 2020 2020 00580 JSCAL6          DB      "      CH7       ",0,LOW JSCAL7, HIGH JSCAL7, LOW JSCAL5, HIGH JSCAL5, 7,80,LOW 
                            JStrimsChan,HIGH JStrimsChan,LOW CH7HG,1
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 455


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

       4843 2037 2020 
       2020 2020 ??00 
       ???? 07?? ??80 
       ???? 0001 
00AA5E 2020 6941 656C 00581 JSCAL7          DB      "  Aileron trim  ",0,LOW JSCAL8, HIGH JSCAL8, LOW JSCAL6, HIGH JSCAL6, 7,80,LOW 
                            JStrimsChan,HIGH JStrimsChan,LOW AtrimHG,8
       6F72 206E 7274 
       6D69 2020 ??00 
       ???? 07?? ??80 
       ???? 0008 
00AA7A 4520 656C 6176 00582 JSCAL8          DB      " Elevator  trim ",0,LOW JSCAL9, HIGH JSCAL9, LOW JSCAL7, HIGH JSCAL7, 7,80,LOW 
                            JStrimsChan,HIGH JStrimsChan,LOW EtrimHG,9
       6F74 2072 7420 
       6972 206D ??00 
       ???? 07?? ??80 
       ???? 0009 
00AA96 2020 7552 6464 00583 JSCAL9          DB      "  Rudder  trim  ",0,LOW JSCAL10,HIGH JSCAL10,LOW JSCAL8, HIGH JSCAL8, 7,80,LOW 
                            JStrimsChan,HIGH JStrimsChan,LOW RtrimHG,0A
       7265 2020 7274 
       6D69 2020 ??00 
       ???? 07?? ??80 
       ???? 000A 
00AAB2 5420 7268 746F 00584 JSCAL10         DB      " Throttle  trim ",0,LOW JSCAL11,HIGH JSCAL11,LOW JSCAL9, HIGH JSCAL9, 7,80,LOW 
                            JStrimsChan,HIGH JStrimsChan,LOW TtrimHG,0B
       6C74 2065 7420 
       6972 206D ??00 
       ???? 07?? ??80 
       ???? 000B 
00AACE 7845 7469 2020 00585 JSCAL11         DB      "Exit            ",0,LOW JSCAL1 ,HIGH JSCAL1 ,LOW JSCAL10,HIGH JSCAL10,3,0,LOW E
                            XIT, HIGH EXIT
       2020 2020 2020 
       2020 2020 ??00 
       ???? 03?? ??00 
       00?? 
                      00586 
00AAE8 2020 2020 6543 00587 JCALMES14       DB      "    Center      ",0
       746E 7265 2020 
       2020 2020 0000 
00AAFA 2020 5220 6769 00588 JCALMES15       DB      "   Right/Down   ",0
       7468 442F 776F 
       206E 2020 0000 
00AB0C 2020 2020 654C 00589 JCALMES16       DB      "    Left/Up     ",0
       7466 552F 2070 
       2020 2020 0000 
                      00590 
                      00591 ; The following table support preliminary control remapping using translation tables. This function
                      00592 ; is performed before any trims are applied and it is not switch selectable. This is designed
                      00593 ; to perform a preliminary remaping of a control channel before any other action is taken.
00AB1E 2020 6941 656C 00594 PRMAP1          DB      "  Aileron Remap ",0,LOW PRMAP2,HIGH PRMAP2,LOW PRMAP7,HIGH PRMAP7,0, 80,LOW MTB
                            L1,HIGH MTBL1,LOW AILremap,HIGH AILremap
       6F72 206E 6552 
       616D 2070 ??00 
       ???? 00?? ??80 
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 456


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

       ???? 00?? 
00AB3A 4520 656C 6176 00595 PRMAP2          DB      " Elevator Remap ",0,LOW PRMAP3,HIGH PRMAP3,LOW PRMAP1,HIGH PRMAP1,0, 80,LOW MTB
                            L1,HIGH MTBL1,LOW ELEremap,HIGH ELEremap
       6F74 2072 6552 
       616D 2070 ??00 
       ???? 00?? ??80 
       ???? 00?? 
00AB56 2020 7552 6464 00596 PRMAP3          DB      "  Rudder  Remap ",0,LOW PRMAP4,HIGH PRMAP4,LOW PRMAP2,HIGH PRMAP2,0, 80,LOW MTB
                            L1,HIGH MTBL1,LOW RUDremap,HIGH RUDremap
       7265 2020 6552 
       616D 2070 ??00 
       ???? 00?? ??80 
       ???? 00?? 
00AB72 5420 7268 746F 00597 PRMAP4          DB      " Throttle Remap ",0,LOW PRMAP5,HIGH PRMAP5,LOW PRMAP3,HIGH PRMAP3,0, 80,LOW MTB
                            L1,HIGH MTBL1,LOW THTremap,HIGH THTremap
       6C74 2065 6552 
       616D 2070 ??00 
       ???? 00?? ??80 
       ???? 00?? 
00AB8E 2020 2020 4843 00598 PRMAP5          DB      "    CH6 Remap   ",0,LOW PRMAP6,HIGH PRMAP6,LOW PRMAP4,HIGH PRMAP4,0, 80,LOW MTB
                            L1,HIGH MTBL1,LOW CH6remap,HIGH CH6remap
       2036 6552 616D 
       2070 2020 ??00 
       ???? 00?? ??80 
       ???? 00?? 
00ABAA 2020 2020 4843 00599 PRMAP6          DB      "    CH7 Remap   ",0,LOW PRMAP7,HIGH PRMAP7,LOW PRMAP5,HIGH PRMAP5,0, 80,LOW MTB
                            L1,HIGH MTBL1,LOW CH7remap,HIGH CH7remap
       2037 6552 616D 
       2070 2020 ??00 
       ???? 00?? ??80 
       ???? 00?? 
00ABC6 5845 5449 2020 00600 PRMAP7          DB      "EXIT            ",0,LOW PRMAP1,HIGH PRMAP1,LOW PRMAP6,HIGH PRMAP6,3 , 0,LOW EXI
                            T,HIGH EXIT
       2020 2020 2020 
       2020 2020 ??00 
       ???? 03?? ??00 
       00?? 
                      00601 
                      00602 ; The following tables support the advance setup calibration menu.
                      00603 
00ABE0 4620 6172 696D 00604 ADV1            DB      " Framing   Rate ",0,LOW ADV2, HIGH ADV2, LOW ADV6 ,HIGH ADV6 ,05,0C8,LOW TicksP
                            er, HIGH TicksPer, LOW MHZ, HIGH MHZ,D'32',0,D'50',00
       676E 2020 5220 
       7461 2065 ??00 
       ???? 05?? ??C8 
       ???? 20?? 3200 
       0000 
00AC00 4620 6172 656D 00605 ADV2            DB      " FrameRateDefect",0,LOW ADV3, HIGH ADV3, LOW ADV1 ,HIGH ADV1 ,0B,088,LOW FrameD
                            efect, HIGH FrameDefect, LOW MDEFECT, HIGH MDEFECT
       6152 6574 6544 
       6566 7463 ??00 
       ???? 0B?? ??88 
       ???? 00?? 
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 457


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

00AC1C 5020 4C4C 2020 00606 ADV3            DB      " PLL  Ref  Freq ",0,LOW ADV4, HIGH ADV4, LOW ADV2 ,HIGH ADV2 ,0C,8E ,LOW Rreg50
                            , HIGH Rreg50, LOW MKHZ, HIGH MKHZ,LOW PostRef,HIGH PostRef,LOW PreRef,HIGH PreRef 
       6552 2066 4620 
       6572 2071 ??00 
       ???? 0C?? ??8E 
       ???? ???? ???? 
       00?? 
00AC3C 2020 6553 646E 00607 ADV4            DB      "  Send  Serial  ",0,LOW ADV5, HIGH ADV5, LOW ADV3 ,HIGH ADV3 ,3 ,8C ,LOW Serial
                            Send, HIGH SerialSend,LOW MENA,HIGH MENA, LOW USART2init, HIGH USART2init
       2020 6553 6972 
       6C61 2020 ??00 
       ???? 03?? ??8C 
       ???? ???? 00?? 
00AC5A 4320 6E6F 7274 00608 ADV5            DB      " Control  Remap ",0,LOW ADV6, HIGH ADV6, LOW ADV4 ,HIGH ADV4 ,9, 80 ,LOW PRMAP1
                            , HIGH PRMAP1
       6C6F 2020 6552 
       616D 2070 ??00 
       ???? 09?? ??80 
       00?? 
00AC74 5845 5449 2020 00609 ADV6            DB      "EXIT            ",0,LOW ADV1 ,HIGH ADV1, LOW ADV5 ,HIGH ADV5 ,3 ,0  ,LOW EXIT,H
                            IGH EXIT
       2020 2020 2020 
       2020 2020 ??00 
       ???? 03?? ??00 
       00?? 
                      00610 
                      00611 ; The following tables support helicopter calibration and setup menus
                      00612 
00AC8E 6548 696C 6F63 00613 HELI1           DB      "Helicopter  Mode",0,LOW HELI2, HIGH HELI2, LOW HELI11,HIGH HELI11,3, 88,LOW Hen
                            able, HIGH Henable,LOW MENA,HIGH MENA
       7470 7265 2020 
       6F4D 6564 ??00 
       ???? 03?? ??88 
       ???? 00?? 
00ACAA 4720 7279 206F 00614 HELI2           DB      " Gyro Sens Tune ",0,LOW HELI3, HIGH HELI3, LOW HELI1 ,HIGH HELI1 ,3, 88,LOW Gyr
                            oTune, HIGH GyroTune,LOW MENA,HIGH MENA
       6553 736E 5420 
       6E75 2065 ??00 
       ???? 03?? ??88 
       ???? 00?? 
00ACC6 2020 2020 2020 00615 HELI3           DB      "      CCPM      ",0,LOW HELI4, HIGH HELI4, LOW HELI2 ,HIGH HELI2 ,0, 80,LOW MCC
                            PM1, HIGH MCCPM1,LOW CCPMmode, HIGH CCPMmode
       4343 4D50 2020 
       2020 2020 ??00 
       ???? 00?? ??80 
       ???? 00?? 
00ACE2 6941 656C 6F72 00616 HELI4           DB      "Aileron  Reverse",0,LOW HELI5, HIGH HELI5, LOW HELI3 ,HIGH HELI3 ,3, 88,LOW HAr
                            ev, HIGH HArev,LOW MENA,HIGH MENA
       206E 5220 7665 
       7265 6573 ??00 
       ???? 03?? ??88 
       ???? 00?? 
00ACFE 6C45 7665 7461 00617 HELI5           DB      "Elevator Reverse",0,LOW HELI6, HIGH HELI6, LOW HELI4 ,HIGH HELI4 ,3, 88,LOW HEr
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 458


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                            ev, HIGH HErev,LOW MENA,HIGH MENA
       726F 5220 7665 
       7265 6573 ??00 
       ???? 03?? ??88 
       ???? 00?? 
00AD1A 5020 7469 6863 00618 HELI6           DB      " Pitch  Reverse ",0,LOW HELI7, HIGH HELI7, LOW HELI5 ,HIGH HELI5 ,3, 88,LOW HPr
                            ev, HIGH HPrev,LOW MENA,HIGH MENA
       2020 6552 6576 
       7372 2065 ??00 
       ???? 03?? ??88 
       ???? 00?? 
00AD36 2020 6F4E 6D72 00619 HELI7           DB      "  Normal  Mode  ",0,LOW HELI8, HIGH HELI8, LOW HELI6 ,HIGH HELI6 ,9, 80,LOW MNO
                            RM1, HIGH MNORM1
       6C61 2020 6F4D 
       6564 2020 ??00 
       ???? 09?? ??80 
       00?? 
00AD50 6854 6F72 7474 00620 HELI8           DB      "ThrottleHoldMode",0,LOW HELI9, HIGH HELI9, LOW HELI7 ,HIGH HELI7 ,9, 80,LOW MTH
                            OLD1, HIGH MTHOLD1
       656C 6F48 646C 
       6F4D 6564 ??00 
       ???? 09?? ??80 
       00?? 
00AD6A 2020 7453 6E75 00621 HELI9           DB      "  Stunt mode 1  ",0,LOW HELI10,HIGH HELI10,LOW HELI8 ,HIGH HELI8 ,9, 80,LOW MST
                            UNT11, HIGH MSTUNT11
       2074 6F6D 6564 
       3120 2020 ??00 
       ???? 09?? ??80 
       00?? 
00AD84 2020 7453 6E75 00622 HELI10          DB      "  Stunt mode 2  ",0,LOW HELI11,HIGH HELI11,LOW HELI9 ,HIGH HELI9 ,9, 80,LOW MST
                            UNT21, HIGH MSTUNT21
       2074 6F6D 6564 
       3220 2020 ??00 
       ???? 09?? ??80 
       00?? 
00AD9E 5845 5449 2020 00623 HELI11          DB      "EXIT            ",0,LOW HELI1, HIGH HELI1, LOW HELI10,HIGH HELI10,3,  0,LOW EXI
                            T, HIGH EXIT
       2020 2020 2020 
       2020 2020 ??00 
       ???? 03?? ??00 
       00?? 
                      00624 
00ADB8 2020 2020 2020 00625 MCCPM1          DB      "       Off      ",0,LOW MCCPM2, HIGH MCCPM2, LOW MCCPM4, HIGH MCCPM4,0,0
       4F20 6666 2020 
       2020 2020 ??00 
       ???? 00?? 0000 
00ADD0 2020 3320 7320 00626 MCCPM2          DB      "   3 servo 120  ",0,LOW MCCPM3, HIGH MCCPM3, LOW MCCPM1, HIGH MCCPM1,1,0
       7265 6F76 3120 
       3032 2020 ??00 
       ???? 01?? 0000 
00ADE8 2020 3320 7320 00627 MCCPM3          DB      "   3 servo 140  ",0,LOW MCCPM4, HIGH MCCPM4, LOW MCCPM2, HIGH MCCPM2,2,0
       7265 6F76 3120 
       3034 2020 ??00 
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 459


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

       ???? 02?? 0000 
00AE00 2020 3320 7320 00628 MCCPM4          DB      "   3 servo  90  ",0,LOW MCCPM1, HIGH MCCPM1, LOW MCCPM3, HIGH MCCPM3,3,0
       7265 6F76 2020 
       3039 2020 ??00 
       ???? 03?? 0000 
                      00629 
00AE18 6449 656C 7055 00630 MNORM1          DB      "IdleUp  Norm  SW",0,LOW MNORM2, HIGH MNORM2, LOW MNORM6 ,HIGH MNORM6 ,6, 80,LOW
                             SWIDLEUPN, HIGH SWIDLEUPN
       2020 6F4E 6D72 
       2020 5753 ??00 
       ???? 06?? ??80 
       00?? 
00AE32 6449 656C 7055 00631 MNORM2          DB      "IdleUp  Norm Pos",0,LOW MNORM3, HIGH MNORM3, LOW MNORM1 ,HIGH MNORM1 ,1,0C8,LOW
                             IdleUpNorm, HIGH IdleUpNorm, LOW MPOS, HIGH MPOS,0,0,D'100',0
       2020 6F4E 6D72 
       5020 736F ??00 
       ???? 01?? ??C8 
       ???? 00?? 6400 
       0000 
00AE52 5420 7268 746F 00632 MNORM3          DB      " Throttle Table ",0,LOW MNORM4, HIGH MNORM4, LOW MNORM2 ,HIGH MNORM2 ,0, 80,LOW
                             MTBL1,HIGH MTBL1,LOW HTht,HIGH HTht
       6C74 2065 6154 
       6C62 2065 ??00 
       ???? 00?? ??80 
       ???? 00?? 
00AE6E 2020 6950 6374 00633 MNORM4          DB      "  Pitch  Table  ",0,LOW MNORM5, HIGH MNORM5, LOW MNORM3 ,HIGH MNORM3 ,0, 80,LOW
                             MTBL1,HIGH MTBL1,LOW HPitch,HIGH HPitch
       2068 5420 6261 
       656C 2020 ??00 
       ???? 00?? ??80 
       ???? 00?? 
00AE8A 7947 6F72 5320 00634 MNORM5          DB      "Gyro Sensitivity",0,LOW MNORM6, HIGH MNORM6, LOW MNORM4 ,HIGH MNORM4 ,1,0C8,LOW
                             HSen, HIGH HSen, LOW MPOS, HIGH MPOS,0,0,D'100',0
       6E65 6973 6974 
       6976 7974 ??00 
       ???? 01?? ??C8 
       ???? 00?? 6400 
       0000 
00AEAA 5845 5449 2020 00635 MNORM6          DB      "EXIT            ",0,LOW MNORM1, HIGH MNORM1, LOW MNORM5 ,HIGH MNORM5 ,3,  0,LOW
                             EXIT, HIGH EXIT
       2020 2020 2020 
       2020 2020 ??00 
       ???? 03?? ??00 
       00?? 
                      00636 
00AEC4 6854 6F72 7474 00637 MTHOLD1         DB      "Throttle hold SW",0,LOW MTHOLD2, HIGH MTHOLD2, LOW MTHOLD6 ,HIGH MTHOLD6 ,6, 80
                            ,LOW SWTHOLD, HIGH SWTHOLD
       656C 6820 6C6F 
       2064 5753 ??00 
       ???? 06?? ??80 
       00?? 
00AEDE 4820 6C6F 2064 00638 MTHOLD2         DB      " Hold  Position ",0,LOW MTHOLD3, HIGH MTHOLD3, LOW MTHOLD1 ,HIGH MTHOLD1 ,1,0C8
                            ,LOW THOLDp, HIGH THOLDp, LOW MPOS, HIGH MPOS,0,0,D'100',0
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 460


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

       5020 736F 7469 
       6F69 206E ??00 
       ???? 01?? ??C8 
       ???? 00?? 6400 
       0000 
00AEFE 7254 6E61 6973 00639 MTHOLD3         DB      "Transition  Time",0,LOW MTHOLD4, HIGH MTHOLD4, LOW MTHOLD2 ,HIGH MTHOLD2 ,8, 8E
                            ,LOW TtransistionT,HIGH TtransistionT,LOW MTSEC,HIGH MTSEC,LOW PostTTT
       6974 6E6F 2020 
       6954 656D ??00 
       ???? 08?? ??8E 
       ???? ???? 
00AF1A ???? 00??      00640                 DB                           HIGH PostTTT, LOW PreTTT, HIGH PreTTT
00AF1E 2020 6950 6374 00641 MTHOLD4         DB      "  Pitch  Table  ",0,LOW MTHOLD5, HIGH MTHOLD5, LOW MTHOLD3 ,HIGH MTHOLD3 ,0, 80
                            ,LOW MTBL1,HIGH MTBL1,LOW HthtPitch,HIGH HthtPitch
       2068 5420 6261 
       656C 2020 ??00 
       ???? 00?? ??80 
       ???? 00?? 
00AF3A 7947 6F72 5320 00642 MTHOLD5         DB      "Gyro Sensitivity",0,LOW MTHOLD6, HIGH MTHOLD6, LOW MTHOLD4 ,HIGH MTHOLD4 ,1,0C8
                            ,LOW HthtSen, HIGH HthtSen, LOW MPOS, HIGH MPOS,0,0,D'100',0
       6E65 6973 6974 
       6976 7974 ??00 
       ???? 01?? ??C8 
       ???? 00?? 6400 
       0000 
00AF5A 5845 5449 2020 00643 MTHOLD6         DB      "EXIT            ",0,LOW MTHOLD1, HIGH MTHOLD1, LOW MTHOLD5 ,HIGH MTHOLD5 ,3,  0
                            ,LOW EXIT, HIGH EXIT
       2020 2020 2020 
       2020 2020 ??00 
       ???? 03?? ??00 
       00?? 
                      00644 
00AF74 7453 6E75 2074 00645 MSTUNT11        DB      "Stunt  mode 1 SW",0,LOW MSTUNT12, HIGH MSTUNT12, LOW MSTUNT17 ,HIGH MSTUNT17 ,6
                            , 80,LOW SWSTUNT1, HIGH SWSTUNT1
       6D20 646F 2065 
       2031 5753 ??00 
       ???? 06?? ??80 
       00?? 
00AF8E 6449 656C 7055 00646 MSTUNT12        DB      "IdleUp  ST 1  SW",0,LOW MSTUNT13, HIGH MSTUNT13, LOW MSTUNT11 ,HIGH MSTUNT11 ,6
                            , 80,LOW SWIDLEUPST1, HIGH SWIDLEUPST1
       2020 5453 3120 
       2020 5753 ??00 
       ???? 06?? ??80 
       00?? 
00AFA8 6449 656C 7055 00647 MSTUNT13        DB      "IdleUp  ST 1 Pos",0,LOW MSTUNT14, HIGH MSTUNT14, LOW MSTUNT12 ,HIGH MSTUNT12 ,1
                            ,0C8,LOW IdleUpST1, HIGH IdleUpST1, LOW MPOS, HIGH MPOS,0,0,D'100',0
       2020 5453 3120 
       5020 736F ??00 
       ???? 01?? ??C8 
       ???? 00?? 6400 
       0000 
00AFC8 5420 7268 746F 00648 MSTUNT14        DB      " Throttle Table ",0,LOW MSTUNT15, HIGH MSTUNT15, LOW MSTUNT13 ,HIGH MSTUNT13 ,0
                            , 80,LOW MTBL1,HIGH MTBL1,LOW Hst1Tht,HIGH Hst1Tht
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 461


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

       6C74 2065 6154 
       6C62 2065 ??00 
       ???? 00?? ??80 
       ???? 00?? 
00AFE4 2020 6950 6374 00649 MSTUNT15        DB      "  Pitch  Table  ",0,LOW MSTUNT16, HIGH MSTUNT16, LOW MSTUNT14 ,HIGH MSTUNT14 ,0
                            , 80,LOW MTBL1,HIGH MTBL1,LOW Hst1Pitch,HIGH Hst1Pitch
       2068 5420 6261 
       656C 2020 ??00 
       ???? 00?? ??80 
       ???? 00?? 
00B000 7947 6F72 5320 00650 MSTUNT16        DB      "Gyro Sensitivity",0,LOW MSTUNT17, HIGH MSTUNT17, LOW MSTUNT15 ,HIGH MSTUNT15 ,1
                            ,0C8,LOW Hst1Sen, HIGH Hst1Sen, LOW MPOS, HIGH MPOS,0,0,D'100',0
       6E65 6973 6974 
       6976 7974 ??00 
       ???? 01?? ??C8 
       ???? 00?? 6400 
       0000 
00B020 5845 5449 2020 00651 MSTUNT17        DB      "EXIT            ",0,LOW MSTUNT11, HIGH MSTUNT11, LOW MSTUNT16 ,HIGH MSTUNT16 ,3
                            ,  0,LOW EXIT, HIGH EXIT
       2020 2020 2020 
       2020 2020 ??00 
       ???? 03?? ??00 
       00?? 
                      00652 
00B03A 7453 6E75 2074 00653 MSTUNT21        DB      "Stunt  mode 2 SW",0,LOW MSTUNT22, HIGH MSTUNT22, LOW MSTUNT27 ,HIGH MSTUNT27 ,6
                            , 80,LOW SWSTUNT2, HIGH SWSTUNT2
       6D20 646F 2065 
       2032 5753 ??00 
       ???? 06?? ??80 
       00?? 
00B054 6449 656C 7055 00654 MSTUNT22        DB      "IdleUp  ST 2  SW",0,LOW MSTUNT23, HIGH MSTUNT23, LOW MSTUNT21 ,HIGH MSTUNT21 ,6
                            , 80,LOW SWIDLEUPST2, HIGH SWIDLEUPST2
       2020 5453 3220 
       2020 5753 ??00 
       ???? 06?? ??80 
       00?? 
00B06E 6449 656C 7055 00655 MSTUNT23        DB      "IdleUp  ST 2 Pos",0,LOW MSTUNT24, HIGH MSTUNT24, LOW MSTUNT22 ,HIGH MSTUNT22 ,1
                            ,0C8,LOW IdleUpST2, HIGH IdleUpST2, LOW MPOS, HIGH MPOS,0,0,D'100',0
       2020 5453 3220 
       5020 736F ??00 
       ???? 01?? ??C8 
       ???? 00?? 6400 
       0000 
00B08E 5420 7268 746F 00656 MSTUNT24        DB      " Throttle Table ",0,LOW MSTUNT25, HIGH MSTUNT25, LOW MSTUNT23 ,HIGH MSTUNT23 ,0
                            , 80,LOW MTBL1,HIGH MTBL1,LOW Hst2Tht,HIGH Hst2Tht
       6C74 2065 6154 
       6C62 2065 ??00 
       ???? 00?? ??80 
       ???? 00?? 
00B0AA 2020 6950 6374 00657 MSTUNT25        DB      "  Pitch  Table  ",0,LOW MSTUNT26, HIGH MSTUNT26, LOW MSTUNT24 ,HIGH MSTUNT24 ,0
                            , 80,LOW MTBL1,HIGH MTBL1,LOW Hst2Pitch,HIGH Hst2Pitch
       2068 5420 6261 
       656C 2020 ??00 
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 462


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

       ???? 00?? ??80 
       ???? 00?? 
00B0C6 7947 6F72 5320 00658 MSTUNT26        DB      "Gyro Sensitivity",0,LOW MSTUNT27, HIGH MSTUNT27, LOW MSTUNT25 ,HIGH MSTUNT25 ,1
                            ,0C8,LOW Hst2Sen, HIGH Hst2Sen, LOW MPOS, HIGH MPOS,0,0,D'100',0
       6E65 6973 6974 
       6976 7974 ??00 
       ???? 01?? ??C8 
       ???? 00?? 6400 
       0000 
00B0E6 5845 5449 2020 00659 MSTUNT27        DB      "EXIT            ",0,LOW MSTUNT21, HIGH MSTUNT21, LOW MSTUNT26 ,HIGH MSTUNT26 ,3
                            ,  0,LOW EXIT, HIGH EXIT
       2020 2020 2020 
       2020 2020 ??00 
       ???? 03?? ??00 
       00?? 
                      00660 
                      00661 
                      06284 endif
                      06285 endif
                      06286 endif
                      06287 ;
                      06288 ; The following default tables are loaded instead of the Sprom for general setup parameters
                      06289 ; and aircraft specific setting. These are loaded if the Preset and Auto Trim buttons are
                      06290 ; held down at power up. These tables also hold the default data used to format the SPROM.
                      06291 ;
                      06292 ifdef   MicroProStar
                      06293 ; General default setting for MicrProStar
                      06294 DFTgeneral      DB 01,00,0F,00,0D2,00,00,00,0F,00,0D2,00,00,00,01E,00
                      06295                 DB 0D2,00,00,072,05,0AF,00,020,0C,0C9,00,0F6,00,088,0C,0E1
                      06296                 DB 00,02E,01,089,0C,0E5,00,087,00,015,08,0B6,0FE,0EB,0B,0C6
                      06297                 DB 0FE,0DD,0B,053,01,0FD,0B,02D,01,092,0B,035,01,099,0B,030
                      06298                 DB 01,09F,0B,00,00,08,00,01,04,09,010,019,024,031,040,051
                      06299                 DB 064,00,013,024,033,040,04B,054,05B,060,063,064,00,01,02,03
                      06300                 DB 06,0C,015,022,033,049,064,00,01B,031,042,04F,058,05E,061,062
                      06301                 DB 063,064,00,0A,014,01E,028,032,03C,046,050,05A,064,00,014,028
                      06302                 DB 03C,050,064,050,03C,028,014,00,00,05,0A,0F,014,019,028,037
                      06303                 DB 046,055,064,00,0F,01E,02D,03C,04B,050,055,05A,05F,064,0A,0A
                      06304                 DB 00,00,010,0BC,02,0FF,00,0A5,0E7,070,02,0F3,00,00,08,07
                      06305                 DB 068,010,01,02,03,04,00,00,00,058,01,090,091,083,082,094
                      06306                 DB 095,096,097,0B4,0B5,0B6,0B7,08C,08D,0E,0F,00,00,00,00,00
                      06307                 DB 00,00,00,00,028,00,00,00,00,0A,00,00,08,032,030,06F
                      06308                 DB 030,24,00,00,00,00,00,00,00,00,00,00,00,00,00,00
                      06309                 DB 00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00
                      06310 ; Aircraft default settings for MicroProStar
                      06311 DFTaircraft     DB 04D,04F,044,045,04C,020,030,031,020,020,020,020,020,020,020,020
                      06312                 DB 00,0CD,00,0B8,0B,0CD,00,03C,019,00,00,00,0CD,00,0B8,0B
                      06313                 DB 0CD,00,03C,019,00,00,00,0CD,00,0B8,0B,0CD,00,03C,019,00
                      06314                 DB 00,00,09A,01,098,08,019,01,0D0,07,0CD,00,0B8,0B,0CD,00
                      06315                 DB 0B8,0B,0CD,00,0B8,0B,0CD,00,0B8,0B,0CD,00,032,0FF,032,00
                      06316                 DB 032,00,032,00,0CE,0FF,0CE,00,0CE,00,0CE,00,00,00,00,0A
                      06317                 DB 0A,00,00,00,0A,0A,00,00,00,0A,0A,00,00,00,0A,0A
                      06318                 DB 00,00,00,0A,0A,00,00,00,0A,0A,00,00,00,0A,0A,00
                      06319                 DB 00,00,0A,0A,00,00,00,0A,0A,00,00,00,0A,0A,00,00
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 463


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      06320                 DB 00,0A,0A,00,00,00,0A,0A,00,00,00,00,00,00,00,0A
                      06321                 DB 00,00,00,00,00,02,00,00,00,00,00,00,00,0FF,080,081
                      06322                 DB 082,083,084,085,086,087,089,08B,04B,08C,08D,08E,08F,01,00,08
                      06323                 DB 010,00,087,04B,08C,084,00,020,00,00,00,00,00,0FF,08D,00
                      06324                 DB 020,00,020,00,020,00,020,00,020,00,00,01,04,09,010,019
                      06325                 DB 024,031,040,051,064,00,013,024,033,040,04B,054,05B,060,063,064
                      06326                 DB 00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00
                      06327 
                      06328 DFTaircraft2    DB 02,01,03,04,05,06,07,08,00,00,00,00,00,00,00,00
                      06329                 DB 00,00,00,00,00,00,00,00,00,0D0,07,0D0,07,00,00,00
                      06330                 DB 00,00,00,00,00,00,00,028,00,00,032,010,020,020,00,087
                      06331                 DB 00,00,00,020,032,00,00,020,00,020,032,00,00,020,00,0D0
                      06332                 DB 07,0D0,07,00,00,00,00,00,00,10,00,00,00,00,00,00
                      06333                 DB 00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00
                      06334                 DB 00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00
                      06335                 DB 00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00
                      06336                 DB 00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00
                      06337                 DB 00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00
                      06338                 DB 00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00
                      06339                 DB 00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00
                      06340                 DB 00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00
                      06341                 DB 00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00
                      06342                 DB 00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00
                      06343                 DB 00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00
                      06344 else
                      06345 ; General default settings for MicroStar
00B100 0001 000F 00D2 06346 DFTgeneral      DB 01,00,0F,00,0D2,00,00,00,0F,00,0D2,00,00,00,01E,00                   ;200
       0000 000F 00D2 
       0000 001E 
00B110 00D2 A000 8904 06347                 DB 0D2,00,00,0A0,04,089,00,0B,07,0B4,00,09E,00,05E,06,0D6               ;210
       0B00 B407 9E00 
       5E00 D606 
00B120 8600 5A00 C606 06348                 DB 00,086,00,05A,06,0C6,00,057,00,0CC,01,021,01,04C,04,02E              ;220
       5700 CC00 2101 
       4C01 2E04 
00B130 FB01 3503 0B01 06349                 DB 01,0FB,03,035,01,0B,04,0C,01,09C,04,08C,00,0DC,08,08F                ;230
       0C04 9C01 8C04 
       DC00 8F08 
00B140 C100 0008 0800 06350                 DB 00,0C1,08,00,00,08,00,01,04,09,010,019,024,031,040,051               ;240
       0100 0904 1910 
       3124 5140 
00B150 0064 2413 4033 06351                 DB 064,00,013,024,033,040,04B,054,05B,060,063,064,00,01,02,03           ;250
       544B 605B 6463 
       0100 0302 
00B160 0C06 2215 4933 06352                 DB 06,0C,015,022,033,049,064,00,01B,031,042,04F,058,05E,061,062         ;260
       0064 311B 4F42 
       5E58 6261 
00B170 6463 0A00 1E14 06353                 DB 063,064,00,0A,014,01E,028,032,03C,046,050,05A,064,00,014,028         ;270
       3228 463C 5A50 
       0064 2814 
00B180 503C 5064 283C 06354                 DB 03C,050,064,050,03C,028,014,00,00,05,0A,0F,014,019,028,037           ;280
       0014 0500 0F0A 
       1914 3728 
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 464


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

00B190 5546 0064 1E0F 06355                 DB 046,055,064,00,0F,01E,02D,03C,04B,050,055,05A,05F,064,0A,0A          ;290
       3C2D 504B 5A55 
       645F 0A0A 
00B1A0 0000 BC10 FF02 06356                 DB 00,00,010,0BC,02,0FF,00,0A5,0E7,070,02,0F3,00,00,08,07               ;2A0
       A500 70E7 F302 
       0000 0708 
00B1B0 1194 0201 0403 06357                 DB 094,011,01,02,03,04,00,00,00,058,01,00,01,02,083,04                  ;2B0
       0000 5800 0001 
       0201 0483 
00B1C0 0605 0807 0A09 06358                 DB 05,06,07,08,09,0A,0B,08C,08D,0E,0F,00,00,00,00,00                    ;2C0
       8C0B 0E8D 000F 
       0000 0000 
00B1D0 0000 0000 0028 06359                 DB 00,00,00,00,028,00,00,00,00,0A,00,00,08,00,00,00                     ;2D0
       0000 0A00 0000 
       0008 0000 
00B1E0 2430 0000 0000 06360                 DB 30,24,00,00,00,00,00,00,00,00,00,00,00,00,00,00                      ;2E0
       0000 0000 0000 
       0000 0000 
00B1F0 0000 0000 0000 06361                 DB 00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00                      ;2F0
       0000 0000 0000 
       0000 0000 
                      06362 ; Aircraft default settings for MicroStar
00B200 4F4D 4544 204C 06363 DFTaircraft     DB 04D,04F,044,045,04C,020,030,031,020,020,020,020,020,020,020,020      ;300
       3130 2020 2020 
       2020 2020 
00B210 CD00 B800 CD0B 06364                 DB 00,0CD,00,0B8,0B,0CD,00,03C,019,00,00,00,0CD,00,0B8,0B               ;310
       3C00 0019 0000 
       00CD 0BB8 
00B220 00CD 193C 0000 06365                 DB 0CD,00,03C,019,00,00,00,0CD,00,0B8,0B,0CD,00,03C,019,00              ;320
       CD00 B800 CD0B 
       3C00 0019 
00B230 0000 019A 0898 06366                 DB 00,00,09A,01,098,08,019,01,0D0,07,0CD,00,0B8,0B,0CD,00               ;330
       0119 07D0 00CD 
       0BB8 00CD 
00B240 0BB8 00CD 0BB8 06367                 DB 0B8,0B,0CD,00,0B8,0B,0CD,00,0B8,0B,0CD,00,032,0FF,032,00             ;340
       00CD 0BB8 00CD 
       FF32 0032 
00B250 0032 0032 FFCE 06368                 DB 032,00,032,00,0CE,0FF,0CE,00,0CE,00,0CE,00,00,00,00,014              ;350
       00CE 00CE 00CE 
       0000 1400 
00B260 0014 0000 0A0A 06369                 DB 014,00,00,00,0A,0A,00,00,00,0A,0A,00,00,00,0A,0A                     ;360
       0000 0A00 000A 
       0000 0A0A 
00B270 0000 01F4 000A 06370                 DB 00,00,0F4,01,0A,00,00,00,0A,0A,00,00,00,0A,0A,00                     ;370
       0000 0A0A 0000 
       0A00 000A 
00B280 0000 0A0A 0000 06371                 DB 00,00,0A,0A,00,00,00,0A,0A,00,00,00,0A,0A,00,00                      ;380
       0A00 000A 0000 
       0A0A 0000 
00B290 0A00 000A 0000 06372                 DB 00,0A,0A,00,00,00,0A,0A,00,00,00,00,00,00,00,0A                      ;390
       0A0A 0000 0000 
       0000 0A00 
00B2A0 0000 0000 0200 06373                 DB 00,00,00,00,00,02,00,00,00,00,00,00,00,0FF,080,081                   ;3A0
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 465


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

       0000 0000 0000 
       FF00 8180 
00B2B0 8382 8584 8786 06374                 DB 082,083,084,085,086,087,089,08B,04B,08C,08D,08E,08F,01,00,08         ;3B0
       8B89 8C4B 8E8D 
       018F 0800 
00B2C0 0010 4B87 848C 06375                 DB 010,00,087,04B,08C,084,00,020,00,00,00,00,00,0FF,08D,00              ;3C0
       2000 0000 0000 
       FF00 008D 
00B2D0 0020 0020 0020 06376                 DB 020,00,020,00,020,00,020,00,020,00,00,01,04,09,010,019               ;3D0
       0020 0020 0100 
       0904 1910 
00B2E0 3124 5140 0064 06377                 DB 024,031,040,051,064,00,013,024,033,040,04B,054,05B,060,063,064       ;3E0
       2413 4033 544B 
       605B 6463 
00B2F0 0000 0000 0000 06378                 DB 00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00                      ;3F0
       0000 0000 0000 
       0000 0000 
                      06379 
00B300 0102 0403 0605 06380 DFTaircraft2    DB 02,01,03,04,05,06,07,08,00,00,00,00,00,00,00,00                      ;400
       0807 0000 0000 
       0000 0000 
00B310 0000 0000 0000 06381                 DB 00,00,00,00,00,00,00,00,00,0D0,07,0D0,07,00,00,00                    ;410
       0000 D000 D007 
       0007 0000 
00B320 0000 0000 0000 06382                 DB 00,00,00,00,00,00,00,0B1,02,00,032,010,020,020,00,087                ;420
       B100 0002 1032 
       2020 8700 
00B330 0000 2000 0032 06383                 DB 00,00,00,020,032,00,00,020,00,020,032,00,00,020,00,0D0               ;430
       2000 2000 0032 
       2000 D000 
00B340 D007 0007 0000 06384                 DB 07,0D0,07,00,00,00,00,00,00,10,00,00,00,00,00,00                     ;440
       0000 1000 0000 
       0000 0000 
00B350 0000 0000 0000 06385                 DB 00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00                      ;450
       0000 0000 0000 
       0000 0000 
00B360 0000 0000 0000 06386                 DB 00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00                      ;460
       0000 0000 0000 
       0000 0000 
00B370 0000 0000 0000 06387                 DB 00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00                      ;470
       0000 0000 0000 
       0000 0000 
00B380 0000 0000 0000 06388                 DB 00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00                      ;480
       0000 0000 0000 
       0000 0000 
00B390 0000 0000 0000 06389                 DB 00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00                      ;490
       0000 0000 0000 
       0000 0000 
00B3A0 0000 0000 0000 06390                 DB 00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00                      ;4A0
       0000 0000 0000 
       0000 0000 
00B3B0 0000 0000 0000 06391                 DB 00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00                      ;4B0
       0000 0000 0000 
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 466


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

       0000 0000 
00B3C0 0000 0000 0000 06392                 DB 00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00                      ;4C0
       0000 0000 0000 
       0000 0000 
00B3D0 0000 0000 0000 06393                 DB 00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00                      ;4D0
       0000 0000 0000 
       0000 0000 
00B3E0 0000 0000 0000 06394                 DB 00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00                      ;4E0
       0000 0000 0000 
       0000 0000 
00B3F0 0000 0000 0000 06395                 DB 00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00                      ;4F0
       0000 0000 0000 
       0000 0000 
                      06396 
                      06397 endif
                      06398 
                      06399 ; This area is reserved to store the general and aircraft configuration data. 
                      06400 
                      06401 ConfigLoc       org     0x10000
                      06402 
                      06403                 cblock  0x10000
  00010000            06404                         CFGgeneral
                      06405                 endc
                      06406                 cblock  0x10000 + D'256'
  00010100            06407                         CFGaircraft
                      06408                 endc
                      06409 
                      06410 ;CFGgeneral     res     D'256'
                      06411 
                      06412 ;CFGaircraft    res     (D'256') * 2 * NumAircraft
                      06413                 
                      06414                 END     ;required directive
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 467


SYMBOL TABLE
  LABEL                             VALUE 

A                                 00000000
A16                               00000000
A17                               00000001
A18                               00000002
A19                               00000003
AARGB0                            CEXreg+2
AARGB1                            CEXreg+1
AARGB2                            CEXreg
AAT                               00000319
AAload                            00004F16
AAloop                            00004ED2
AAnext                            00004EEC
AAselected                        00004F04
AB                                00000313
ABDEN                             00000000
ABDOVF                            00000007
ACCESS                            00000000
ACESHIFT                          00001446
ACFTPOS                           0000000D
ACK                               0000000C
ACKDT                             00000005
ACKEN                             00000004
ACKSTAT                           00000006
ACQT0                             00000003
ACQT1                             00000004
ACQT2                             00000005
ACT                               00000217
AD0                               00000000
AD1                               00000001
AD10                              00000002
AD11                              00000003
AD12                              00000004
AD13                              00000005
AD14                              00000006
AD15                              00000007
AD2                               00000002
AD3                               00000003
AD4                               00000004
AD5                               00000005
AD6                               00000006
AD7                               00000007
AD8                               00000000
AD9                               00000001
ADCON0                            00000FC2
ADCON1                            00000FC1
ADCON2                            00000FC0
ADCS0                             00000000
ADCS1                             00000001
ADCS2                             00000002
ADCaddTbl                         000002BB
ADCail                            00000004
ADCailTrim                        00000008
ADCch6                            00000000
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 468


SYMBOL TABLE
  LABEL                             VALUE 

ADCch7                            00000001
ADCele                            00000005
ADCeleTrim                        00000009
ADCfixThres                       000002DC
ADCfixed                          00000D56
ADCfixed1                         00000DC6
ADCfixed2                         00000E20
ADCgnd                            00000002
ADClookup                         00000462
ADCread                           00000CCC
ADCread0                          00000D1E
ADCread00                         00000CE8
ADCread1                          00000D14
ADCread2                          00000D4C
ADCreadChan                       00000CF2
ADCrec                            0000000D
ADCref                            00000003
ADCrud                            00000006
ADCrudTrim                        0000000A
ADCsum                            00000161
ADCtest                           0000000C
ADCthr                            00000007
ADCthrTrim                        0000000B
ADDEN                             00000003
ADFM                              00000007
ADIE                              00000006
ADIF                              00000006
ADIP                              00000006
ADJ1                              00005D6E
ADJ2                              00005D5C
ADJ3                              00005D76
ADJbyte                           00005C4E
ADJbyte1                          00005CD2
ADJbyte2                          00005CB0
ADJbyte3                          00005CEC
ADJbyteloop                       00005C56
ADJint1                           00005F28
ADJint2                           00005F04
ADJint3                           00005F46
ADJinteger                        00005EBE
ADJpercent                        00005D02
ADJuS                             00005DBC
ADJuSa                            00005DE0
ADJuSz                            00005DC4
ADJus1                            00005E62
ADJus2                            00005E38
ADJus3                            00005E86
ADJus3a                           00005E9C
ADJus3b                           00005EAE
ADJvolt                           00005C42
ADON                              00000000
ADR1                              0000383A
ADR2                              00003878
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 469


SYMBOL TABLE
  LABEL                             VALUE 

ADR3                              000038B6
ADRES                             00000FC3
ADRESH                            00000FC4
ADRESL                            00000FC3
ADV1                              0000ABE0
ADV2                              0000AC00
ADV3                              0000AC1C
ADV4                              0000AC3C
ADV5                              0000AC5A
ADV6                              0000AC74
AERPost                           00006950
AERPre                            00006904
AEX1                              0000374E
AEX1a                             0000375E
AEXHI                             0000031A
AEXLOW                            0000031B
AFM0                              00004B10
AFM0z                             0000493A
AFM1                              00004974
AFM2                              000049AE
AFM2a                             00004A80
AFM2aa                            00004ABA
AFM2aaa                           00004AC2
AFM2b                             00004A3C
AFM2c                             00004A1E
AFM2d                             00004A66
AFM2e                             00004AEE
AFM3                              00004AEE
AFM4a                             00004B2E
AFM4c                             00004B40
AFM5                              00004B6A
AHG                               00000215
AHnoRev                           000052B4
AHnotHold                         0000528C
AHtrim                            000052A0
AILremap                          00000443
AL1                               0000443E
ALE                               00000000
ALG                               00000219
ALR                               00000317
ALTAFK                            00000005
ALUSTA                            STATUS
AM1H                              00000311
AM2H                              00000315
AMENU1                            00009CA2
AMENU10                           00009DAA
AMENU11                           00009DC4
AMENU12                           00009DE4
AMENU13                           00009DFE
AMENU2                            00009CC2
AMENU3                            00009CDC
AMENU4                            00009CFC
AMENU5                            00009D16
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 470


SYMBOL TABLE
  LABEL                             VALUE 

AMENU6                            00009D36
AMENU7                            00009D50
AMENU8                            00009D70
AMENU9                            00009D8A
AN0                               00000000
AN1                               00000001
AN10                              00000005
AN11                              00000006
AN12                              00000004
AN13                              00000005
AN14                              00000006
AN15                              00000007
AN2                               00000002
AN3                               00000003
AN4                               00000005
AN5                               00000000
AN6                               00000001
AN7                               00000002
AN8                               00000003
AN9                               00000004
APT                               00000318
APdone                            00004826
APmix2                            000047AE
APmix3                            000047F0
AS10                              00003E14
AS10a                             00003E46
AS10b                             00003E6A
AS10c                             00003E8E
AS11                              00003EAC
AS9a                              00003DAE
AS9b                              00003DD2
AS9c                              00003DF6
ASR0                              00003F02
ASR1                              00003F76
ASR2                              00003FEA
ASR5final                         00003F26
ASR8final                         00003F9A
ASRCH8                            00003F2E
ASRTfinal                         0000400E
ASRdone                           00004020
ASRtht                            00003FA2
AT1                               00003C20
AT2                               00003C54
ATLpost                           00006172
ATMODE1                           00009EBA
ATMODE2                           00009ED4
ATMODE3                           00009EEE
ATP                               000003C9
ATRM                              000000DE
ATRST                             000000E4
ATmode                            000002B6
ATpos                             00000134
ATreset                           00006EFA
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 471


SYMBOL TABLE
  LABEL                             VALUE 

ATthreshold                       000002E0
AUTOT                             00000001
AUXMODE                           000002BA
AUXOUT                            00000000
AUXSTATE                          000000EB
AUXhi                             00001066
AXreg                             0000000D
AXregS                            0000012C
AXregSave                         00000164
Accept                            00005B12
Accept1                           00005B5C
Accept2                           00005B80
AcceptLoop                        00005B2E
ActiveDisplayLine                 00000160
Adapter                           00000502
AddCorrection                     
AddressOK                         000015FE
AdvanceRecord                     00005898
AilCenter                         000000CB
AilDR                             00000000
AilMes                            00002F72
AilPost                           00006946
AilPre                            000068F4
AilRudNeg                         00000411
AilRudPos                         00000410
AilTrimCh                         000002B2
Aileron                           0000607C
Aileron1                          000060AE
Aileron2                          000060C2
Aircraft                          00000200
AircraftName                      000064D8
AltAircraft                       000003CE
AlternateAircraft                 00004EA2
Apos                              00000075
AposM                             00000093
ApplyDualRates                    000037FC
ApplyExpo                         00003722
ApplyFixedMixers                  00004B00
ApplyFixedMixersPrior             00004AF0
ApplyHelicopter                   00005236
ApplyLimit                        0000441E
ApplyMix                          00000600
ApplyMixReplace                   00000666
ApplyMixers                       00004778
ApplySlewRate                     00003EBA
ApplySnap                         00003D72
ApplySubTrims                     00003C60
ApplySymSet                       00006872
ApplyToAll                        00006140
ApplyTrims                        00003A74
Areg                              0000000A
Atable1                           000003DA
Atable2                           000003E5
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 472


SYMBOL TABLE
  LABEL                             VALUE 

Atemp                             0000001F
Atrim                             00000085
AtrimCT                           0000022D
AtrimHG                           0000022B
AtrimLast                         0000014B
AutoLimit                         000041AA
AutoLimit1                        000041BC
AutoLimit2                        000041DA
AutoLimit3                        000041D0
AutoTrim                          00004022
AutoTrim0                         00004064
AutoTrim1a                        0000409E
AutoTrim1b                        000040C2
AutoTrim1c                        000040B2
AutoTrim1d                        000040CC
AutoTrim1e                        00004082
AutoTrim1plim                     000040B8
AutoTrim2                         000040D0
AutoTrim2Zero                     00006FAA
AutoTrim2a                        0000410A
AutoTrim2b                        0000412E
AutoTrim2c                        0000411E
AutoTrim2d                        00004138
AutoTrim2e                        000040EE
AutoTrim2plim                     00004124
AutoTrim3                         0000413C
AutoTrim3a                        00004176
AutoTrim3b                        0000419A
AutoTrim3c                        0000418A
AutoTrim3d                        000041A4
AutoTrim3e                        0000415A
AutoTrim3plim                     00004190
AutoTrim4                         000041A8
AutoTrimMonitor                   000031D8
AutoTrimOStime                    00000028
AutoTrimStep                      0000029E
AutoTrimTime                      0000029F
AuxServoChanMode                  00000F1A
AuxStateClr                       00000F28
BA0                               00000004
BANKED                            00000001
BARGB0                            DEXreg+1
BARGB1                            DEXreg
BAUDCON                           00000F7E
BAUDCON1                          00000F7E
BAUDCON2                          00000F7C
BCL1IE                            00000003
BCL1IF                            00000003
BCL1IP                            00000003
BCL2IE                            00000006
BCL2IF                            00000006
BCL2IP                            00000006
BCLIE                             00000003
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 473


SYMBOL TABLE
  LABEL                             VALUE 

BCLIF                             00000003
BCLIP                             00000003
BF                                00000000
BGST                              00000005
BID0                              00005002
BID1                              00005056
BID2                              000050AA
BID3                              000050F8
BID4                              00005126
BID5                              00005154
BID6                              00005182
BIDAUTOT                          000050FA
BIDELE                            00005024
BIDEXIT                           00005186
BIDNEXT                           00005184
BIDPRESET                         000050CC
BIDRUD                            00005078
BIDSNAPL                          00005156
BIDSNAPR                          00005128
BNK1                              00000100
BNK2                              00000200
BNK3                              00000300
BNK4                              00000400
BOR                               00000000
BRG16                             00000003
BRGH                              00000002
BSR                               00000FE0
BTflag                            000002B8
BUZZER                            00000004
BXreg                             0000000F
BXregS                            0000012E
BXregSave                         00000166
BYTEPOS                           0000000D
Backup                            00000600
BackupAircraft                    00004646
BattAlarm                         000002B9
BatteryTimer                      00000500
Beep                              00001180
BeepCtr                           0000005E
BeepCyl                           0000005F
BeepTicks                         0000005D
BladeDet                          000000C9
BladeTime                         000000C7
BlkBuf                            00000588
BlkMove                           00004F3C
BlkMove1                          00004F50
Breg                              0000000B
Btemp                             00000020
Buffer                            00000025
ButtonID                          00004FCA
ButtonIDinit                      00004F62
BuzInited                         00000290
BuzInvert                         0000119E
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 474


SYMBOL TABLE
  LABEL                             VALUE 

BuzOK                             00000028
BuzPol                            000002D2
C                                 00000000
C1608S                            00002282
C1608SOK                          0000237C
C1608SX                           00002278
C1608SX1                          00002390
C1608SX2                          000023BA
C1608SX3                          000023C2
C1608SX4                          000023CC
C1INV                             00000004
C1OUT_CMCON                       00000006
C1OUT_PORTF                       00000002
C2416S                            00002430
C2416SOK                          0000271E
C2416SX                           00002426
C2416SX1                          0000273A
C2416SX2                          0000276C
C2416SX3                          00002776
C2416SX4                          00002782
C2INV                             00000005
C2OUT_CMCON                       00000007
C2OUT_PORTF                       00000001
CA1608S                           0000226A
CA2416S                           00002414
CALLF                             
CALLFF                            
CALLFL                            
CALLFW                            
CALMES0                           0000810A
CALMES1                           0000811C
CALMES10                          000081DC
CALMES11                          000081F4
CALMES12                          0000820C
CALMES13                          00008224
CALMES14                          0000823C
CALMES2                           00008134
CALMES3                           0000814C
CALMES4                           00008164
CALMES5                           0000817C
CALMES6                           00008194
CALMES7                           000081AC
CALMES8                           000081C4
CALexit                           0000567C
CALmode                           000005C8
CALoptions                        00000300
CAN0                              000064EA
CAN1                              00006532
CAN2                              0000654A
CAN3                              00006560
CAN4                              00006572
CANa                              00006516
CCP1                              00000002
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 475


SYMBOL TABLE
  LABEL                             VALUE 

CCP1CON                           00000FBD
CCP1IE                            00000002
CCP1IF                            00000002
CCP1IP                            00000002
CCP1M0                            00000000
CCP1M1                            00000001
CCP1M2                            00000002
CCP1M3                            00000003
CCP1X                             00000005
CCP1Y                             00000004
CCP2CON                           00000FBA
CCP2IE                            00000000
CCP2IF                            00000000
CCP2IP                            00000000
CCP2M0                            00000000
CCP2M1                            00000001
CCP2M2                            00000002
CCP2M3                            00000003
CCP2X                             00000005
CCP2Y                             00000004
CCP2_PORTB                        00000003
CCP2_PORTC                        00000001
CCP2_PORTE                        00000007
CCP3                              00000000
CCP3CON                           00000FB7
CCP3IE                            00000000
CCP3IF                            00000000
CCP3IP                            00000000
CCP3M0                            00000000
CCP3M1                            00000001
CCP3M2                            00000002
CCP3M3                            00000003
CCP3X                             00000005
CCP3Y                             00000004
CCP4                              00000003
CCP4CON                           00000F73
CCP4IE                            00000001
CCP4IF                            00000001
CCP4IP                            00000001
CCP4M0                            00000000
CCP4M1                            00000001
CCP4M2                            00000002
CCP4M3                            00000003
CCP5                              00000004
CCP5CON                           00000F70
CCP5IE                            00000002
CCP5IF                            00000002
CCP5IP                            00000002
CCP5M0                            00000000
CCP5M1                            00000001
CCP5M2                            00000002
CCP5M3                            00000003
CCPM1                             00004B90
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 476


SYMBOL TABLE
  LABEL                             VALUE 

CCPM2                             00004BA4
CCPMmixer                         00004B6C
CCPMmode                          0000041D
CCPR1                             00000FBE
CCPR1H                            00000FBF
CCPR1L                            00000FBE
CCPR2                             00000FBB
CCPR2H                            00000FBC
CCPR2L                            00000FBB
CCPR3                             00000FB8
CCPR3H                            00000FB9
CCPR3L                            00000FB8
CCPR4                             00000F74
CCPR4H                            00000F75
CCPR4L                            00000F74
CCPR5                             00000F71
CCPR5H                            00000F72
CCPR5L                            00000F71
CE                                00000005
CENTER                            000000D8
CEXreg                            00000013
CEXregSave                        00000168
CFGMEM1                           00000000
CFGMEM2                           00000002
CFGS                              00000006
CFGaircraft                       00010100
CFGgeneral                        00010000
CH5                               00000007
CH50MHZPOS                        00000004
CH50POS                           0000000E
CH53POS                           00000008
CH567Post                         00006ABC
CH567Pre                          00006A72
CH5BH                             0000033C
CH5MH                             0000033A
CH5Mes                            00002FB2
CH5Post                           00006AB2
CH5Pre                            00006A62
CH5_Done                          000035FA
CH5_OFF                           000035F0
CH5pos                            0000007D
CH5posActual                      0000008F
CH5posM                           0000009B
CH5stepSize                       00000419
CH67CenterBeepFlag                000002D8
CH6BH                             00000340
CH6CT                             0000023D
CH6HG                             0000023B
CH6Last                           00000153
CH6MH                             0000033E
CH6Mes                            00002FC2
CH6Post                           00006AD8
CH6Pre                            00006A8A
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 477


SYMBOL TABLE
  LABEL                             VALUE 

CH6pos                            0000007F
CH6posM                           0000009D
CH6remap                          00000447
CH6save                           00004372
CH72MHZPOS                        00000004
CH72POS                           0000000D
CH7BH                             00000344
CH7CT                             00000241
CH7HG                             0000023F
CH7Last                           00000155
CH7MH                             00000342
CH7Mes                            00002FD2
CH7Post                           00006AE6
CH7Pre                            00006A9E
CH7pos                            00000081
CH7posM                           0000009F
CH7remap                          00000448
CH7save                           000043A4
CH8A                              00000003
CH8C                              00000004
CH8Mes                            00002FE2
CH8Post                           00006B16
CH8Pre                            00006AF4
CH8_A                             00000346
CH8_B                             00000348
CH8_C                             0000034A
CH8_Done                          000036B2
CH8_b                             0000369A
CH8_c                             0000367E
CH8pos                            00000083
CH8posActual                      00000091
CH8posM                           000000A1
CH8stepSize                       0000041B
CHS0                              00000002
CHS1                              00000003
CHS2                              00000004
CHS3                              00000005
CHtimes                           0000003A
CIS                               00000003
CK                                00000006
CK1                               00000006
CK2                               00000001
CKE                               00000006
CKP                               00000004
CLK                               00000005
CM0                               00000000
CM1                               00000001
CM2                               00000002
CMA1                              00006E5A
CMA2                              00006E6A
CMCON                             00000FB4
CMIE                              00000006
CMIF                              00000006
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 478


SYMBOL TABLE
  LABEL                             VALUE 

CMIP                              00000006
CN1                               000033B2
CNTmode                           000003BD
COP1                              00009B30
COP10                             00009C38
COP11                             00009C52
COP12                             00009C6C
COP13                             00009C88
COP2                              00009B4A
COP3                              00009B68
COP4                              00009B86
COP5                              00009BA4
COP6                              00009BBE
COP7                              00009BDE
COP8                              00009BFC
COP9                              00009C1C
CREN                              00000004
CROWENA                           000003C6
CS                                00000002
CSP1                              00004212
CSP2                              00004226
CSP3                              00004264
CSP4                              00004278
CSP5                              000042B6
CSP6                              000042CA
CSP7                              000043CE
CSP8                              000043DA
CSP9                              0000441C
CSRC                              00000007
CUI2                              000063B0
CUI2a                             000063BA
CUI3                              00006320
CUI4                              00006380
CUI4a                             0000638C
CUI5                              00006348
CURSOROFF                         0000000C
CURSORON                          0000000E
CVMPOS                            0000000B
CVR0                              00000000
CVR1                              00000001
CVR2                              00000002
CVR3                              00000003
CVRCON                            00000FB5
CVREF                             00000005
CVREN                             00000007
CVROE                             00000006
CVRR                              00000005
CVRSS                             00000004
CXreg                             00000011
CXregS                            00000130
CalAdvanced                       0000628E
CalAircraftName                   0000619A
CalHelicopter                     000062AA
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 479


SYMBOL TABLE
  LABEL                             VALUE 

CalMenu                           00000120
CalMenu1                          00000122
CalMenu2                          00000124
CalMixers                         00006216
CalModeProcess                    000056F0
CalNotSel                         00000610
CalOption                         0000011E
CalOptions                        0000624E
CalSaveAndExit                    00005690
CalSaveExit                       000061CC
CalSelectAircraft                 00006196
CalSelectFrequency                0000628A
CalServoUpdate                    000000F6
CalServos                         000061FA
CalSnap                           000061DE
CalSwitch                         00006232
CalSystemSetup                    0000626E
CalTable                          000000D6
CalTimer                          000061B4
CalUI                             000062E6
CalVolt1                          0000749C
CalVolt2                          000074B0
CalVoltMeter                      00007418
CalculateFixedMixers              00004828
CalculateNormalizedPositions      000033FA
CalculateServoPositions           000041EE
Calibration                       000056C6
CallBXreg                         000058EA
CenterBeep                        000038B8
CenterNormalize                   00003378
ChannelOrder                      00000400
CheckSum                          0000006A
Cmd                               00000037
CmdEnd                            00001D12
Cmode                             00000056
Cnt                               000000BD
ConfigLoc                         00010000
Convert2Gains                     0000674E
Convert2GainsNC                   000067E0
Convert2Times                     000065D6
Convert2TimesNC                   000066B4
CopyAFT                           00006F7E
CopyAFTgo                         00006F8A
Creg                              0000000C
Ct                                0000006F
Ctemp                             000000A3
CycleCounts                       00000038
D                                 00000005
DATA_ADDRESS                      00000005
DC                                00000001
DC1B0                             00000004
DC1B1                             00000005
DC2B0                             00000004
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 480


SYMBOL TABLE
  LABEL                             VALUE 

DC2B1                             00000005
DC3B0                             00000004
DC3B1                             00000005
DC4B0                             00000004
DC4B1                             00000005
DC5B0                             00000004
DC5B1                             00000005
DCCP4X                            00000005
DCCP4Y                            00000004
DCCP5X                            00000005
DCCP5Y                            00000004
DDRA                              TRISA
DDRB                              TRISB
DDRC                              TRISC
DDRD                              TRISD
DDRE                              TRISE
DDRF                              00000F97
DDRG                              00000F98
DDRH                              00000F99
DDRJ                              00000F9A
DEXreg                            00000017
DF0                               00007574
DF50MHz                           000075B0
DF72MHz                           0000761A
DFTaircraft                       0000B200
DFTaircraft2                      0000B300
DFTgeneral                        0000B100
DIFFA                             0000039C
DOGcontrast                       000002E1
DONE                              00000001
DPflag                            000000EE
DRP                               000000DC
DSP3d1                            000008AC
DT1                               00000007
DT2                               00000002
DTL0                              00007B4E
DTail                             00000580
DTailA                            0000041E
DTdataAil                         00000142
DTdataEle                         00000144
DTdataRud                         00000146
DTdataTht                         00000148
DTdisplay                         0000014A
DTele                             00000582
DTeleA                            00000420
DTmess                            00007B6A
DTrim0                            00007B1A
DTrim1                            00007B12
DTrim2                            00007ADA
DTrimAdjustDelay                  000002D9
DTrud                             00000584
DTrudA                            00000422
DTtht                             00000586
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 481


SYMBOL TABLE
  LABEL                             VALUE 

DTthtA                            00000424
DUALA                             0000039A
DUALAILM1                         00009298
DUALAILM2                         000092B2
DUALAILM3                         000092CC
DUALAILM4                         000092E6
DUALAILM5                         00009300
DUALAILM6                         0000931A
DWNMins                           000003BF
DWNSecs                           000003BE
DXreg                             000000D4
DXregS                            00000132
D_A                               00000005
Debug                             0000044C
DefaultAircraft                   000000AB
Delay1mS                          0000145C
Delay1mS0                         0000145E
Delay2uS                          00001452
DigitalTrim                       00007AC4
DigitalTrimInit                   00007894
DigitalTrimLimit                  00007B2C
DispAircraftDone                  000007E6
DispBT                            0000074A
DispNoBT                          0000075C
DispNoSaveBT                      0000078E
DispNotStudent                    000007DE
Display                           0000067A
DisplayAircraftName               00000658
DisplayCalibration                000056E2
DisplayFrequency                  00007550
DisplayLine                       000002DB
DisplayMode                       000002DA
DisplayModeDone                   0000068E
DisplayServoMS                    00003152
DisplayTrim                       00007BAA
Divide168                         00002246
Divide2416                        000023E8
Divide3232u                       000027AE
Dmins                             0000005B
Dog162                            00000503
DriveCh                           000000BE
Dsecs                             0000005A
DsecsLatch                        0000005C
Dsp1                              00000816
Dsp2                              00000814
Dsp3                              0000087C
Dsp3a                             0000083A
Dsp3b                             00000850
Dsp3c                             00000866
Dsp3d                             000008CE
Dsp3d1a                           000008C6
Dst                               000000B9
Dtemp                             000000A4
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 482


SYMBOL TABLE
  LABEL                             VALUE 

DualE                             00000417
DualLine                          
EAT                               00000324
EB                                0000031E
EBDIS                             00000007
ECCP1                             00000002
ECCP1AS                           00000FB6
ECCP1AS0                          00000004
ECCP1AS1                          00000005
ECCP1AS2                          00000006
ECCP1ASE                          00000007
ECCP1CON                          00000FBD
ECCP1DEL                          00000F79
ECCP2AS                           00000F68
ECCP2AS0                          00000004
ECCP2AS1                          00000005
ECCP2AS2                          00000006
ECCP2ASE                          00000007
ECCP2CON                          00000FBA
ECCP2DEL                          00000F67
ECCP2_PORTB                       00000003
ECCP2_PORTC                       00000001
ECCP2_PORTE                       00000007
ECCP3                             00000000
ECCP3AS                           00000F6A
ECCP3AS0                          00000004
ECCP3AS1                          00000005
ECCP3AS2                          00000006
ECCP3ASE                          00000007
ECCP3CON                          00000FB7
ECCP3DEL                          00000F69
ECCPAS0                           00000004
ECCPAS1                           00000005
ECCPAS2                           00000006
ECCPASE                           00000007
ECT                               0000021D
EEADR                             00000FA9
EEADRH                            00000FAA
EECON1                            00000FA6
EECON2                            00000FA7
EEDATA                            00000FA8
EEIE                              00000004
EEIF                              00000004
EEIP                              00000004
EEPGD                             00000007
EEPROMnext                        00001482
EEPROMnextRB                      000014A8
EEPROMnextWB                      00001530
EEPROMread                        00001472
EEPROMreadBlock                   00001492
EEPROMreadByte                    000014BA
EEPROMwriteBWait                  00001548
EEPROMwriteBlock                  00001518
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 483


SYMBOL TABLE
  LABEL                             VALUE 

EEPROMwriteByte                   000014D0
EEPROMwriteByteWait               000014F4
EEPROMwriteWord                   000014FE
EEX1                              00003796
EEX1a                             000037A6
EEXHI                             00000325
EEXLOW                            00000326
EEXreg                            0000001B
EHG                               0000021B
ELEVON                            00000399
ELEremap                          00000444
ELG                               0000021F
ELR                               00000322
EM1H                              0000031C
EM2H                              00000320
ENA                               00000003
EOT                               000000ED
EPT                               00000323
ETP                               000003CA
ETpos                             00000136
EXIT                              000000D3
EXPOHI                            000000DF
EXPOLOW                           000000E0
EleCenter                         000000CD
EleDR                             00000001
EleMes                            00002F82
ElePost                           00006974
ElePre                            0000691E
EleTrimCh                         000002B3
Elevator                          000060C8
Elevator1                         0000610E
Elevator2                         0000613A
EnaSecSprom                       000000CF
EndAuxState                       00000F2A
Epos                              00000077
EposM                             00000095
Etemp                             000000A5
Etrim                             00000087
EtrimCT                           00000231
EtrimHG                           0000022F
EtrimLast                         0000014D
Expo                              000036B4
ExpoPos                           000036EE
F                                 00000001
FAST                              00000001
FCF                               0000010B
FCN                               0000010E
FERR                              00000002
FLT0                              00000000
FLTS                              00000002
FMIX1                             00008D50
FMIX10                            00008E70
FMIX11                            00008E90
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 484


SYMBOL TABLE
  LABEL                             VALUE 

FMIX12                            00008EB0
FMIX13                            00008ED0
FMIX14                            00008EEA
FMIX15                            00008F0A
FMIX16                            00008F2A
FMIX17                            00008F4A
FMIX18                            00008F66
FMIX19                            00008F82
FMIX2                             00008D70
FMIX20                            00008F9E
FMIX21                            00008FB8
FMIX22                            00008FD4
FMIX23                            00008FEE
FMIX24                            0000900A
FMIX3                             00008D90
FMIX4                             00008DB0
FMIX5                             00008DD0
FMIX6                             00008DF0
FMIX7                             00008E10
FMIX8                             00008E30
FMIX9                             00008E50
FMIXOP1                           00009192
FMIXOP10                          0000927E
FMIXOP2                           000091AC
FMIXOP3                           000091C8
FMIXOP4                           000091E2
FMIXOP5                           000091FC
FMIXOP6                           00009216
FMIXOP7                           00009230
FMIXOP8                           0000924A
FMIXOP9                           00009264
FMIXST1                           00009144
FMIXST2                           0000915E
FMIXST3                           00009178
FMS                               0000218A
FMSNotZ                           00002176
FMScNotZ                          00002136
FMScenter                         0000211C
FMSdiv4                           0000214E
FMSdiv8                           0000214A
FMSenable                         000070B2
FMSenable1                        000070C0
FMSflag                           000000EF
FMSflagU1                         000000F0
FMSinit                           000020EC
FMSinit1                          00002108
FMSnonCenter                      00002164
FMSsend                           00002158
FPFLAGS                           00000023
FPgain                            0000039D
FPgainN                           0000039B
FREE                              00000004
FS03                              000015B6
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 485


SYMBOL TABLE
  LABEL                             VALUE 

FS04                              000015D4
FSR0                              00000000
FSR0H                             00000FEA
FSR0L                             00000FE9
FSR1                              00000001
FSR1H                             00000FE2
FSR1Hsave                         00000022
FSR1L                             00000FE1
FSR1Lsave                         00000021
FSR2                              00000002
FSR2H                             00000FDA
FSR2L                             00000FD9
FSexit                            000015DC
FXD1608S                          00002246
FXD2416S                          000023E8
FXD3232U                          000027AE
Fband                             000002D1
FilterTC                          00000030
FindSelection                     0000588C
FixedFirst                        000003A4
FlashAllAircraft                  000015EA
FlashAllAircraftNext              00001632
FlashErase                        000016B0
FlashRead                         00001682
FlashRead1                        0000169A
FlashWrite                        000016EA
FlashWrite_8720                   00001762
FmtFlsh                           00007110
FormatFlash                       00001558
FormatIt                          00000248
FormatOK                          00000250
FrameDefect                       000002D5
Freg                              00000106
Freg50                            00000204
Freg53                            0000020A
Freg72                            00000210
Ftemp                             000000A6
FutabaDone                        0000054A
FutabaMode                        0000052E
FutabaStudent                     000000F5
GCEN                              00000007
GIE                               00000007
GIEH                              00000007
GIEL                              00000006
GO                                00000001
GOTOF                             
GO_DONE                           00000001
GTP_Norm                          000054EA
GTP_Save                          000054F0
GTP_Stunt1                        000054D4
GTP_Stunt2                        000054BE
GetFrom                           00000500
Gh                                0000006D
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 486


SYMBOL TABLE
  LABEL                             VALUE 

Gl                                00000071
Gversion                          000002DD
GyroTune                          000000FB
GyroTuneProcess                   0000546E
HArev                             0000044A
HCGtbl                            00001A30
HELI1                             0000AC8E
HELI10                            0000AD84
HELI11                            0000AD9E
HELI2                             0000ACAA
HELI3                             0000ACC6
HELI4                             0000ACE2
HELI5                             0000ACFE
HELI6                             0000AD1A
HELI7                             0000AD36
HELI8                             0000AD50
HELI9                             0000AD6A
HErev                             0000044B
HICUR                             00000010
HIGHISRS                          0000021C
HIGHISRS0                         0000023A
HIGHISRS1                         00000246
HIUP_NORM                         00005342
HIUP_SET                          00005352
HIUP_ST1                          00005320
HLVDCON                           00000FD2
HLVDEN                            00000004
HLVDIE                            00000002
HLVDIF                            00000002
HLVDIN                            00000005
HLVDIP                            00000002
HLVDL0                            00000000
HLVDL1                            00000001
HLVDL2                            00000002
HLVDL3                            00000003
HMD_S1                            00005554
HMD_S2                            00005566
HMD_TH                            00005542
HPitch                            0000042C
HPrev                             00000429
HPrevDone                         000053C2
HSen                              0000042A
HTht                              0000042B
HelicopterModeDisplay             0000550A
Henable                           00000426
HsetIdleUp                        000052FE
HsetPitch                         00005374
HsetSensitivity                   00005406
HsetThrottle                      000053C4
Hst1Pitch                         00000436
Hst1Sen                           00000434
Hst1Tht                           00000435
Hst2Pitch                         0000043C
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 487


SYMBOL TABLE
  LABEL                             VALUE 

Hst2Sen                           0000043A
Hst2Tht                           0000043B
HthtPitch                         00000432
HthtSen                           00000431
I2C_DAT                           00000005
I2C_READ                          00000002
I2C_START                         00000003
I2C_STOP                          00000004
IBF                               00000007
IBOV                              00000005
IDAILHI                           00008056
IDAILLOW                          00008068
IDAUTOT                           000080E6
IDELEHI                           0000807A
IDELELOW                          0000808C
IDLEN                             00000007
IDLEUP                            000003A0
IDLEUP1                           00009334
IDLEUP2                           0000934E
IDLEUP3                           00009368
IDLEUP4                           00009382
IDLEUPpA                          000003A1
IDLEUPpB                          000003A2
IDPRESET                          000080F8
IDRUDHI                           0000809E
IDRUDLOW                          000080B0
IDSNAPL                           000080D4
IDSNAPR                           000080C2
INDF0                             00000FEF
INDF1                             00000FE7
INDF2                             00000FDF
INT0                              00000000
INT0E                             00000004
INT0F                             00000001
INT0IE                            00000004
INT0IF                            00000001
INT1                              00000001
INT1E                             00000003
INT1F                             00000000
INT1IE                            00000003
INT1IF                            00000000
INT1IP                            00000006
INT1ISR                           000013EE
INT1ISR_EXIT                      0000144E
INT1P                             00000006
INT2                              00000002
INT2E                             00000004
INT2F                             00000001
INT2IE                            00000004
INT2IF                            00000001
INT2IP                            00000007
INT2P                             00000007
INT3                              00000003
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 488


SYMBOL TABLE
  LABEL                             VALUE 

INT3E                             00000005
INT3F                             00000002
INT3IE                            00000005
INT3IF                            00000002
INT3IP                            00000001
INT3P                             00000001
INTCON                            00000FF2
INTCON2                           00000FF1
INTCON3                           00000FF0
INTEDG0                           00000006
INTEDG1                           00000005
INTEDG2                           00000004
INTEDG3                           00000003
INTPOS                            0000000B
INTSRC                            00000007
IOFS                              00000002
IPEN                              00000007
IPR1                              00000F9F
IPR2                              00000FA2
IPR3                              00000FA5
IRCF0                             00000004
IRCF1                             00000005
IRCF2                             00000006
IRVST                             00000005
ISRtemp                           0000002F
IVRST                             00000005
IdleUpNorm                        0000042E
IdleUpST1                         00000438
IdleUpST2                         0000043E
IncTime                           000000F7
Input                             00005902
Input1                            0000594C
Input2                            00005960
Input3                            000059B4
Input4                            000059DE
Input5                            00005A00
Input6                            00005A24
Input7                            00005A50
Input8                            00005A5E
Input8a                           00005AB8
Input9                            00005A80
InputB                            00005AC2
InputC                            00005AD6
InputD                            00005B10
Int2Str                           00001BE8
JCALMES14                         0000AAE8
JCALMES15                         0000AAFA
JCALMES16                         0000AB0C
JSCAL1                            0000A9B6
JSCAL10                           0000AAB2
JSCAL11                           0000AACE
JSCAL2                            0000A9D2
JSCAL3                            0000A9EE
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 489


SYMBOL TABLE
  LABEL                             VALUE 

JSCAL4                            0000AA0A
JSCAL5                            0000AA26
JSCAL6                            0000AA42
JSCAL7                            0000AA5E
JSCAL8                            0000AA7A
JSCAL9                            0000AA96
JScChan                           000072D4
JSncChan                          00007204
JStrimsChan                       00007116
KBI0                              00000004
KBI1                              00000005
KBI2                              00000006
KBI3                              00000007
LATA                              00000F89
LATA0                             00000000
LATA1                             00000001
LATA2                             00000002
LATA3                             00000003
LATA4                             00000004
LATA5                             00000005
LATA6                             00000006
LATA7                             00000007
LATB                              00000F8A
LATB0                             00000000
LATB1                             00000001
LATB2                             00000002
LATB3                             00000003
LATB4                             00000004
LATB5                             00000005
LATB6                             00000006
LATB7                             00000007
LATC                              00000F8B
LATC0                             00000000
LATC1                             00000001
LATC2                             00000002
LATC3                             00000003
LATC4                             00000004
LATC5                             00000005
LATC6                             00000006
LATC7                             00000007
LATD                              00000F8C
LATD0                             00000000
LATD1                             00000001
LATD2                             00000002
LATD3                             00000003
LATD4                             00000004
LATD5                             00000005
LATD6                             00000006
LATD7                             00000007
LATE                              00000F8D
LATE0                             00000000
LATE1                             00000001
LATE2                             00000002
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 490


SYMBOL TABLE
  LABEL                             VALUE 

LATE3                             00000003
LATE4                             00000004
LATE5                             00000005
LATE6                             00000006
LATE7                             00000007
LATF                              00000F8E
LATF0                             00000000
LATF1                             00000001
LATF2                             00000002
LATF3                             00000003
LATF4                             00000004
LATF5                             00000005
LATF6                             00000006
LATF7                             00000007
LATG                              00000F8F
LATG0                             00000000
LATG1                             00000001
LATG2                             00000002
LATG3                             00000003
LATG4                             00000004
LATG5                             00000005
LATH                              00000F90
LATH0                             00000000
LATH1                             00000001
LATH2                             00000002
LATH3                             00000003
LATH4                             00000004
LATH5                             00000005
LATH6                             00000006
LATH7                             00000007
LATJ                              00000F91
LATJ0                             00000000
LATJ1                             00000001
LATJ2                             00000002
LATJ3                             00000003
LATJ4                             00000004
LATJ5                             00000005
LATJ6                             00000006
LATJ7                             00000007
LB                                00000006
LCD52display                      
LCDCTRL                           00000F81
LCDCTRLDIR                        00000F93
LCDDATA                           00000F88
LCDDATADIR                        00000F9A
LCDRIGHT                          00000008
LCDbinary                         00001ADA
LCDbinary0                        00001AE0
LCDbusy                           000019C4
LCDbusyA                          000019F0
LCDcgFlag                         0000015F
LCDhex                            00001AF4
LCDinit                           000017E2
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 491


SYMBOL TABLE
  LABEL                             VALUE 

LCDinitDone                       000018E6
LCDint                            00001B50
LCDint1                           00001B8C
LCDint2                           00001B84
LCDint3                           00001B7C
LCDint4                           00001B74
LCDintA                           00001B5A
LCDintB                           00001B60
LCDintC                           00001B66
LCDintD                           00001B6C
LCDintZS                          00001B94
LCDmS                             000031A8
LCDmSfix                          0000319C
LCDportOut                        000019FC
LCDsR00                           00001916
LCDsR01                           0000191C
LCDsR02                           00001928
LCDsR03                           00001936
LCDsR04                           00001944
LCDsR05                           00001952
LCDsR06                           00001960
LCDsR07                           0000196E
LCDsendAX                         00001A78
LCDsendAXLine2                    00001A8E
LCDsendCMD                        00001998
LCDsendDXLine2                    00001AA4
LCDsendData                       0000197A
LCDsendMess                       00001ABA
LCDsendMessN                      00001AC0
LCDsign                           00001B28
LCDspecialRemap                   0000190C
LCDwait                           000019B6
LCDwreg                           00000141
LED1                              00000003
LED2                              00000002
LINE1                             00000080
LINE2                             000000C0
LINE3                             000000C0
LOWISR2                           00000298
LOWISR3                           000002A4
LOWISRS                           0000025A
LOWISRS0                          0000027A
LOWISRS1                          00000286
LSB                               00000000
LTUP                              000000DA
LVDCON                            00000FD2
LVDEN                             00000004
LVDIE                             00000002
LVDIF                             00000002
LVDIN                             00000005
LVDIP                             00000002
LVDL0                             00000000
LVDL1                             00000001
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 492


SYMBOL TABLE
  LABEL                             VALUE 

LVDL2                             00000002
LVDL3                             00000003
LVV0                              00000000
LVV1                              00000001
LVV2                              00000002
LVV3                              00000003
LValarm                           00000111
Limit16                           00005D8A
Limit16a                          00005DA4
Limit16b                          00005DBA
Limit8                            00005C36
LoadAircraft                      00004596
LoadAircraftDefaults              0000783A
LoadAircraftName                  000044EC
LoadDefaults                      0000780E
LoadDefaults1                     00007826
LoadDefaults2                     00007852
LoadDefaults3                     0000787E
LoadGeneral                       00004480
M1Adl                             00000360
M1Afrom                           0000035C
M1Ato                             0000035D
M1Aur                             0000035F
M1Azp                             0000035E
M1Bdl                             00000365
M1Bfrom                           00000361
M1Bto                             00000362
M1Bur                             00000364
M1Bzp                             00000363
M1Cdl                             0000036A
M1Cfrom                           00000366
M1Cto                             00000367
M1Cur                             00000369
M1Czp                             00000368
M1Ddl                             0000036F
M1Dfrom                           0000036B
M1Dto                             0000036C
M1Dur                             0000036E
M1Dzp                             0000036D
M2Adl                             00000374
M2Afrom                           00000370
M2Ato                             00000371
M2Aur                             00000373
M2Azp                             00000372
M2Bdl                             00000379
M2Bfrom                           00000375
M2Bto                             00000376
M2Bur                             00000378
M2Bzp                             00000377
M2Cdl                             0000037E
M2Cfrom                           0000037A
M2Cto                             0000037B
M2Cur                             0000037D
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 493


SYMBOL TABLE
  LABEL                             VALUE 

M2Czp                             0000037C
M2Ddl                             00000383
M2Dfrom                           0000037F
M2Dto                             00000380
M2Dur                             00000382
M2Dzp                             00000381
M2Mloop                           0000470A
M2Mnext                           0000476A
M2MtryCH5                         0000473A
M2MtryCH8                         00004754
M3Adl                             00000388
M3Afrom                           00000384
M3Ato                             00000385
M3Aur                             00000387
M3Azp                             00000386
M3Bdl                             0000038D
M3Bfrom                           00000389
M3Bto                             0000038A
M3Bur                             0000038C
M3Bzp                             0000038B
M3Cdl                             00000392
M3Cfrom                           0000038E
M3Cto                             0000038F
M3Cur                             00000391
M3Czp                             00000390
M3Ddl                             00000397
M3Dfrom                           00000393
M3Dto                             00000394
M3Dur                             00000396
M3Dzp                             00000395
MAFTN                             0000829C
MATP1                             00009E18
MATP2                             00009E34
MATP3                             00009E4E
MATP4                             00009E68
MATP5                             00009E82
MATP6                             00009EA0
MAUXOUT0                          00009FE0
MAUXOUT1                          00009F08
MAUXOUT2                          00009F20
MAUXOUT3                          00009F38
MAUXOUT4                          00009F50
MAUXOUT5                          00009F68
MAUXOUT6                          00009F80
MAUXOUT7                          00009F98
MAUXOUT8                          00009FB0
MAUXOUT9                          00009FC8
MApos                             000000B1
MBB1                              00009FF8
MBB2                              0000A012
MBB3                              0000A02E
MBB4                              0000A048
MBLADES                           000082C0
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 494


SYMBOL TABLE
  LABEL                             VALUE 

MCAN                              000082AE
MCCPM1                            0000ADB8
MCCPM2                            0000ADD0
MCCPM3                            0000ADE8
MCCPM4                            0000AE00
MCLEAR                            0000828A
MCLR                              00000005
MCONT                             0000831A
MDEFECT                           00008398
MDELAY                            000083BC
MEMCON                            00000F9C
MENA                              00008254
MES0                              00007E7C
MES1                              00007E8E
MES10                             00007F26
MES11                             00007F38
MES12                             00007F42
MES14                             00007F48
MES15                             00007F5A
MES16                             00007F6C
MES17                             00007F7E
MES19                             00007F90
MES2                              00007EA0
MES20                             00007FA2
MES22                             00007FB4
MES23                             00007FC6
MES24                             00007FD8
MES25                             00007FEA
MES26                             00007FFC
MES27                             0000800E
MES28                             00008020
MES29                             00008032
MES3                              00007EB2
MES30                             00008044
MES4                              00007EC4
MES5                              00007ED6
MES6                              00007EE8
MES7                              00007EFA
MES8                              00007F0C
MES9                              00007F1E
MEpos                             000000B3
MGAIN                             00008350
MHZ                               00008386
MINVERT                           00008362
MIX1                              00000004
MIX2                              00000005
MIX3                              00000006
MIXORD                            000082D2
MIXSEL1                           00009024
MIXSEL10                          000090FC
MIXSEL11                          00009114
MIXSEL12                          0000912C
MIXSEL2                           0000903C
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 495


SYMBOL TABLE
  LABEL                             VALUE 

MIXSEL3                           00009054
MIXSEL4                           0000906C
MIXSEL5                           00009084
MIXSEL6                           0000909C
MIXSEL7                           000090B4
MIXSEL8                           000090CC
MIXSEL9                           000090E4
MKHZ                              000083AA
MMM1                              0000A062
MMM2                              0000A07A
MNORM1                            0000AE18
MNORM2                            0000AE32
MNORM3                            0000AE52
MNORM4                            0000AE6E
MNORM5                            0000AE8A
MNORM6                            0000AEAA
MNUMCH                            00008308
MOD                               00000007
MOVE                              
MOVE16                            
MOVE24                            
MOVE32                            
MOVEB                             
MOVEBI                            
MOVEC                             
MOVEC24                           
MOVEC32                           
MOVEIB                            
MOVEIW                            
MOVEWI                            
MOVFP                             MOVF
MOVLR                             MOVLB
MOVPF                             MOVFF
MPOS                              0000833E
MRST                              00008266
MRpos                             000000B5
MS1a                              00001FB2
MS2                               00001FBE
MS2a                              00001FE0
MS3                               00001FEC
MS3a                              0000200E
MS4                               0000201A
MS4a                              0000203C
MS5                               00002048
MSB                               00000007
MSHFINV                           0000832C
MSTUNT11                          0000AF74
MSTUNT12                          0000AF8E
MSTUNT13                          0000AFA8
MSTUNT14                          0000AFC8
MSTUNT15                          0000AFE4
MSTUNT16                          0000B000
MSTUNT17                          0000B020
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 496


SYMBOL TABLE
  LABEL                             VALUE 

MSTUNT21                          0000B03A
MSTUNT22                          0000B054
MSTUNT23                          0000B06E
MSTUNT24                          0000B08E
MSTUNT25                          0000B0AA
MSTUNT26                          0000B0C6
MSTUNT27                          0000B0E6
MSYNC                             000082F6
MTABLE1                           0000A1EC
MTABLE10                          0000A2D6
MTABLE11                          0000A2F0
MTABLE12                          0000A30A
MTABLE2                           0000A206
MTABLE3                           0000A220
MTABLE4                           0000A23A
MTABLE5                           0000A254
MTABLE6                           0000A26E
MTABLE7                           0000A288
MTABLE8                           0000A2A2
MTABLE9                           0000A2BC
MTBL1                             0000939C
MTBL10                            00009474
MTBL11                            0000948C
MTBL2                             000093B4
MTBL3                             000093CC
MTBL4                             000093E4
MTBL5                             000093FC
MTBL6                             00009414
MTBL7                             0000942C
MTBL8                             00009444
MTBL9                             0000945C
MTHOLD1                           0000AEC4
MTHOLD2                           0000AEDE
MTHOLD3                           0000AEFE
MTHOLD4                           0000AF1E
MTHOLD5                           0000AF3A
MTHOLD6                           0000AF5A
MTIMER1                           000083CE
MTIMER2                           000083EA
MTIMER3                           0000840A
MTIMER4                           0000842A
MTIMER5                           00008444
MTIMER6                           0000845E
MTP1                              0000972E
MTP2                              0000974A
MTP3                              00009766
MTP4                              00009782
MTP5                              0000979E
MTSEC                             00008374
MTpos                             000000B7
MVOLTS                            000082E4
MZERO                             00008278
Master                            000002A1
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 497


SYMBOL TABLE
  LABEL                             VALUE 

MasterISR                         00001F7E
MasterMode                        000002B7
MasterPos                         000000AF
MasterState                       000000AE
MasterState1                      00001F8C
MaxByte                           000000C1
MaxChannels                       00000449
MaxTime                           000000C1
MaxValue                          000000C1
MessBank                          00000066
MessCHK                           00000069
MessLen                           00000068
MessLoc                           00000067
MessStart                         00000064
MessState                         00000063
MessType                          00000065
Mfrom                             000000E2
MinByte                           000000BF
MinTime                           000000BF
MinValue                          000000BF
Mins                              00000059
MixNeg                            00004E38
MixNoIdN                          00004E74
MixNoIdP                          00004E0A
Mixer                             00004D76
Mng                               000000E6
Mni                               000000E8
Mode                              00000036
ModelChannel                      000003AD
Mon1                              000030EE
Mon2                              000030F6
MonChan                           0000015E
MonFlag                           0000015D
Monitor                           00003072
MonitorPulseWidth                 00003106
Move2Mix                          000046B4
MoveMixer                         00006CE8
Mpg                               000000E5
Mpi                               000000E7
Mreplace                          000000E9
Mtbl                              000000EA
Mto                               000000E3
Mult1                             000021F2
Mult1616                          000021E0
Mult1616u                         00002202
Mult2                             00002200
Mzp                               000000E4
N                                 00000004
NADD221                           00002802
NADD2210                          00002A30
NADD2211                          00002A6E
NADD2212                          00002AAC
NADD2213                          00002AEA
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 498


SYMBOL TABLE
  LABEL                             VALUE 

NADD2214                          00002B28
NADD2215                          00002B66
NADD2216                          00002BA4
NADD2217                          00002BE2
NADD2218                          00002C20
NADD2219                          00002C5E
NADD222                           00002840
NADD2220                          00002C9C
NADD2221                          00002CDA
NADD2222                          00002D18
NADD2223                          00002D56
NADD2224                          00002D94
NADD2225                          00002DD2
NADD2226                          00002E10
NADD2227                          00002E4E
NADD2228                          00002E8C
NADD2229                          00002ECA
NADD223                           0000287E
NADD2230                          00002F08
NADD2231                          00002F46
NADD224                           000028BC
NADD225                           000028FA
NADD226                           00002938
NADD227                           00002976
NADD228                           000029B4
NADD229                           000029F2
NAK                               0000000D
NAN                               00000004
NDIV3232                          
NEXT                              00001AC2
NOK22                             00002F70
NOK221                            00002814
NOK2210                           00002A42
NOK2211                           00002A80
NOK2212                           00002ABE
NOK2213                           00002AFC
NOK2214                           00002B3A
NOK2215                           00002B78
NOK2216                           00002BB6
NOK2217                           00002BF4
NOK2218                           00002C32
NOK2219                           00002C70
NOK222                            00002852
NOK2220                           00002CAE
NOK2221                           00002CEC
NOK2222                           00002D2A
NOK2223                           00002D68
NOK2224                           00002DA6
NOK2225                           00002DE4
NOK2226                           00002E22
NOK2227                           00002E60
NOK2228                           00002E9E
NOK2229                           00002EDC
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 499


SYMBOL TABLE
  LABEL                             VALUE 

NOK223                            00002890
NOK2230                           00002F1A
NOK2231                           00002F58
NOK224                            000028CE
NOK225                            0000290C
NOK226                            0000294A
NOK227                            00002988
NOK228                            000029C6
NOK229                            00002A04
NOMINALBAT                        00000800
NOT_A                             00000005
NOT_ADDRESS                       00000005
NOT_BOR                           00000000
NOT_CE                            00000005
NOT_CS                            00000002
NOT_DONE                          00000001
NOT_LB                            00000006
NOT_MCLR                          00000005
NOT_OE                            00000001
NOT_PD                            00000002
NOT_POR                           00000001
NOT_RBPU                          00000007
NOT_RC8                           00000006
NOT_RD                            00000000
NOT_RI                            00000004
NOT_SS1                           00000007
NOT_SS2                           00000007
NOT_T1SYNC                        00000002
NOT_T3SYNC                        00000002
NOT_TO                            00000003
NOT_TX8                           00000006
NOT_UB                            00000007
NOT_W                             00000002
NOT_WR                            00000001
NOT_WRH                           00000003
NOT_WRITE                         00000002
NOT_WRL                           00000002
NPOS                              0000000F
NRWwfo                            000003D4
NUMFREQ                           00000110
Name                              00000300
NextRecord                        000058B8
NextTime                          00000050
Next_Char                         0000066C
NoAT                              000068E2
NoAddCorrection                   
NoAlarm                           00000B74
NoDog                             00001884
NoDriveCh                         00005976
NoRetractWarn                     0000041E
NoStackOverflow                   00000498
NoTach                            0000142A
NonCenterNormalize                000033D0
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 500


SYMBOL TABLE
  LABEL                             VALUE 

Not31                             00001CBE
Not32                             00001CD2
Not33                             00001CE2
Not34                             00001CF2
NotOverrunTest                    0000103A
NotPPM                            00001068
NotRTDWN                          000068B8
Npos                              00000073
Nreg                              00000100
NumAircraft                       00000060
NumAlt                            00000006
NumBlades                         000003A5
NumChan                           0000004F
OBF                               00000006
OE                                00000001
OERR                              00000001
OFFSET                            00000200
ONTIMEPOS                         0000000B
OPTION                            00000002
OPTION_BUTTON                     PORTE,OPTION
OSCCON                            00000FD3
OSCFIE                            00000007
OSCFIF                            00000007
OSCFIP                            00000007
OSCTUNE                           00000F9B
OSTS                              00000003
OV                                00000003
OVERRUN                           000000C3
Option                            0000445C
Option1                           0000447C
P                                 00000004
P1A                               00000002
P1B_PORTE                         00000006
P1B_PORTH                         00000007
P1C_PORTE                         00000005
P1C_PORTH                         00000006
P1D                               00000004
P1DC0                             00000000
P1DC1                             00000001
P1DC2                             00000002
P1DC3                             00000003
P1DC4                             00000004
P1DC5                             00000005
P1DC6                             00000006
P1M0                              00000006
P1M1                              00000007
P1RSEN                            00000007
P2A_PORTB                         00000003
P2A_PORTC                         00000001
P2A_PORTE                         00000007
P2B                               00000002
P2C                               00000001
P2D                               00000000
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 501


SYMBOL TABLE
  LABEL                             VALUE 

P2DC0                             00000000
P2DC1                             00000001
P2DC2                             00000002
P2DC3                             00000003
P2DC4                             00000004
P2DC5                             00000005
P2DC6                             00000006
P2M0                              00000006
P2M1                              00000007
P2RSEN                            00000007
P3A                               00000000
P3B_PORTE                         00000004
P3B_PORTH                         00000005
P3C_PORTE                         00000003
P3C_PORTH                         00000004
P3D                               00000003
P3DC0                             00000000
P3DC1                             00000001
P3DC2                             00000002
P3DC3                             00000003
P3DC4                             00000004
P3DC5                             00000005
P3DC6                             00000006
P3M0                              00000006
P3M1                              00000007
P3RSEN                            00000007
PB0                               00007E54
PB1                               00007E6C
PB2                               00007E76
PB3                               00007DD8
PC                                00000FF9
PCFG0                             00000000
PCFG1                             00000001
PCFG2                             00000002
PCFG3                             00000003
PCL                               00000FF9
PCLATH                            00000FFA
PCLATU                            00000FFB
PD                                00000002
PD0                               00007924
PD1                               00007996
PD2                               00007A08
PD3                               00007A7A
PDC0                              00000000
PDC1                              00000001
PDC2                              00000002
PDC3                              00000003
PDC4                              00000004
PDC5                              00000005
PDC6                              00000006
PDF                               00000109
PDele                             00007936
PDexit                            00007A88
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 502


SYMBOL TABLE
  LABEL                             VALUE 

PDrud                             000079A8
PDtht                             00007A1A
PEIE                              00000006
PEN                               00000002
PERCENTPOS                        0000000B
PIC18F8723                        000000F8
PIE1                              00000F9D
PIE2                              00000FA0
PIE3                              00000FA3
PIR1                              00000F9E
PIR2                              00000FA1
PIR3                              00000FA4
PLB0                              00007D82
PLB1                              00007D9C
PLB2                              00007DA6
PLB3                              00007CFA
PLB4                              00007CD6
PLLCS                             00000003
PLLCalNreg                        000011F8
PLLEN                             00000006
PLLRST                            00000006
PLLinit                           00001304
PLLinit0                          0000135E
PLLinit1                          000013A4
PLLinit2                          000013EC
PLLinitWORD                       000002AB
PLLpowerDown                      000011C8
PLLsend                           000011AA
PLLsend1                          000011B8
PLLsend2                          000011BA
PLLsetup                          00001274
PLUSW0                            00000FEB
PLUSW1                            00000FE3
PLUSW2                            00000FDB
PMUL                              0000010F
POPREGS                           
POPREGSLOW                        
POR                               00000001
PORTA                             00000F80
PORTB                             00000F81
PORTC                             00000F82
PORTD                             00000F83
PORTDimage                        00000030
PORTDlast                         00000031
PORTDlatch                        00000032
PORTDlatchLow                     000000F9
PORTE                             00000F84
PORTEimage                        00000033
PORTElast                         00000034
PORTElatch                        00000035
PORTElatchLow                     000000FA
PORTF                             00000F85
PORTG                             00000F86
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 503


SYMBOL TABLE
  LABEL                             VALUE 

PORTH                             00000F87
PORTJ                             00000F88
POSTDEC0                          00000FED
POSTDEC1                          00000FE5
POSTDEC2                          00000FDD
POSTINC0                          00000FEE
POSTINC1                          00000FE6
POSTINC2                          00000FDE
PR2                               00000FCB
PR4                               00000F77
PRB0                              00007C98
PRB1                              00007CB0
PRB2                              00007CBA
PRB3                              00007C1C
PREINC0                           00000FEC
PREINC1                           00000FE4
PREINC2                           00000FDC
PRESET                            00000003
PRMAP1                            0000AB1E
PRMAP2                            0000AB3A
PRMAP3                            0000AB56
PRMAP4                            0000AB72
PRMAP5                            0000AB8E
PRMAP6                            0000ABAA
PRMAP7                            0000ABC6
PROD                              00000FF3
PRODH                             00000FF4
PRODL                             00000FF3
PROGRAM_LOOP                      00001798
PROGRAM_MEMORY                    000017A8
PRSEN                             00000007
PSA                               00000003
PSO1                              000074F8
PSO2                              00007516
PSO3                              00007534
PSP0                              00000000
PSP1                              00000001
PSP2                              00000002
PSP3                              00000003
PSP4                              00000004
PSP5                              00000005
PSP6                              00000006
PSP7                              00000007
PSPCON                            00000FB0
PSPIE                             00000007
PSPIF                             00000007
PSPIP                             00000007
PSPMODE                           00000004
PSS1AC0                           00000002
PSS1AC1                           00000003
PSS1BD0                           00000000
PSS1BD1                           00000001
PSS2AC0                           00000002
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 504


SYMBOL TABLE
  LABEL                             VALUE 

PSS2AC1                           00000003
PSS2BD0                           00000000
PSS2BD1                           00000001
PSS3AC0                           00000002
PSS3AC1                           00000003
PSS3BD0                           00000000
PSS3BD1                           00000001
PSSAC0                            00000002
PSSAC1                            00000003
PSSBD0                            00000000
PSSBD1                            00000001
PUSHREGS                          
PUSHREGSLOW                       
PaintBar                          00007DB2
PaintLeftBar                      00007CC0
PaintRightBar                     00007BF6
Pos                               0000006B
PostA2R                           00006E88
PostBand                          000074BC
PostCH5                           00006C32
PostCH8                           00006C78
PostCall                          000000F1
PostCallLevel1                    00000126
PostCallLevel2                    00000128
PostCallLevel3                    0000012A
PostChan                          0000708E
PostMix                           00006E3C
PostR2A                           00006E9C
PostR2E                           00006EB0
PostRef                           00007782
PostSetOrder                      000074C8
PostTTT                           000055B4
PreA2R                            00006E7E
PreCH5                            00006C48
PreCH8                            00006C8E
PreCall                           000000F3
PreChan                           000070AA
PreMix                            00006DEA
PreR2A                            00006E92
PreR2E                            00006EA6
PreRef                            00007722
PreTTT                            00005584
Preset                            000056AE
Preset1                           000056C2
Pressed                           
PrintMess                         
PrintMessN                        
ProcessCommand                    00001CAC
ProcessDtrims                     000078C4
ProcessorType                     00000C82
Pstate                            0000004E
Psum                              00000052
R                                 00000002
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 505


SYMBOL TABLE
  LABEL                             VALUE 

R1000_1                           000065C8
R256_1                            000065A2
RA0                               00000000
RA1                               00000001
RA2                               00000002
RA3                               00000003
RA4                               00000004
RA5                               00000005
RA6                               00000006
RA7                               00000007
RAT                               0000032F
RB                                00000329
RB0                               00000000
RB1                               00000001
RB2                               00000002
RB3                               00000003
RB4                               00000004
RB5                               00000005
RB6                               00000006
RB7                               00000007
RBIE                              00000003
RBIF                              00000000
RBIP                              00000000
RBPU                              00000007
RC0                               00000000
RC1                               00000001
RC1IE                             00000005
RC1IF                             00000005
RC1IP                             00000005
RC2                               00000002
RC2IE                             00000005
RC2IF                             00000005
RC2IP                             00000005
RC3                               00000003
RC4                               00000004
RC5                               00000005
RC6                               00000006
RC7                               00000007
RC8_9                             00000006
RC9                               00000006
RCD8                              00000000
RCEN                              00000003
RCIDL                             00000006
RCIE                              00000005
RCIF                              00000005
RCIP                              00000005
RCMT                              00000006
RCON                              00000FD0
RCREG                             00000FAE
RCREG1                            00000FAE
RCREG2                            00000F6E
RCSTA                             00000FAB
RCSTA1                            00000FAB
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 506


SYMBOL TABLE
  LABEL                             VALUE 

RCSTA2                            00000F6B
RCT                               00000223
RD                                00000000
RD0                               00000000
RD1                               00000001
RD16                              00000007
RD2                               00000002
RD256a                            00000CB0
RD3                               00000003
RD4                               00000004
RD5                               00000005
RD6                               00000006
RD7                               00000007
RE0                               00000000
RE1                               00000001
RE2                               00000002
RE3                               00000003
RE4                               00000004
RE5                               00000005
RE6                               00000006
RE7                               00000007
READ_WRITE                        00000002
RECCOMM                           00000002
RECMESS                           00000001
RECVPOS                           0000000B
REMB0                             EEXreg+1
REMB1                             EEXreg
REX1                              000037DE
REX1a                             000037EE
REXHI                             00000330
REXLOW                            00000331
RF0                               00000000
RF1                               00000001
RF2                               00000002
RF3                               00000003
RF4                               00000004
RF5                               00000005
RF6                               00000006
RF7                               00000007
RFask                             0000042C
RG0                               00000000
RG1                               00000001
RG2                               00000002
RG3                               00000003
RG4                               00000004
RG5                               00000005
RH0                               00000000
RH1                               00000001
RH2                               00000002
RH3                               00000003
RH4                               00000004
RH5                               00000005
RH6                               00000006
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 507


SYMBOL TABLE
  LABEL                             VALUE 

RH7                               00000007
RHG                               00000221
RI                                00000004
RJ0                               00000000
RJ1                               00000001
RJ2                               00000002
RJ3                               00000003
RJ4                               00000004
RJ5                               00000005
RJ6                               00000006
RJ7                               00000007
RLG                               00000225
RLR                               0000032D
RM1H                              00000327
RM2H                              0000032B
RPT                               0000032E
RS                                00000005
RSEN                              00000001
RTC                               0000101C
RTC1                              000010F6
RTC1NotMaster                     00001108
RTC1a                             000010D4
RTC1b                             0000109E
RTC1c                             000010A0
RTC1d                             000010C4
RTC2                              0000116C
RTCioBusy                         0000114A
RTCx                              0000104C
RTCy                              00001052
RTDWN                             000000D6
RTP                               000003CB
RTpos                             00000138
RUDremap                          00000445
RUNCAL                            00000000
RUNmode                           000004D8
RUNmode2                          000005C4
RUNmode3                          000005A4
RUNmodeNotMaster                  0000053E
RW                                00000004
RX                                00000007
RX1                               00000007
RX2                               00000002
RX9                               00000006
RX9D                              00000000
RXvoltSet                         000070E2
R_W                               00000002
ReadADC256                        00000CA4
RecVADC                           0000015B
RecVoltage                        00000C00
Release                           
Reload                            000004CA
RemoveLeadingZeros                00001BBC
Reserved                          00000310
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 508


SYMBOL TABLE
  LABEL                             VALUE 

ResetBatTimer                     000070FE
RetractsWarning                   000003A6
Round1000                         000065B0
Round256                          0000658C
Rpos                              00000079
RposM                             00000097
Rreg                              00000103
Rreg50                            00000201
Rreg53                            00000207
Rreg72                            0000020D
Rtrim                             00000089
RtrimCT                           00000235
RtrimHG                           00000233
RtrimLast                         0000014F
RudAilNeg                         00000413
RudAilPos                         00000412
RudDR                             00000002
RudEleNeg                         00000415
RudElePos                         00000414
RudMes                            00002F92
RudPost                           00006982
RudPre                            00006932
RudTrimCh                         000002B4
S                                 00000003
S1_Mode                           0000557C
S2_Mode                           00005580
SA1                               0000645E
SA2                               0000647A
SA3                               00006440
SA4                               000063F4
SADD4610                          00002562
SADD4611                          00002582
SADD4612                          000025A2
SADD4613                          000025C2
SADD4614                          000025E2
SADD4615                          00002602
SADD4616                          00002622
SADD4617                          00002642
SADD4618                          00002662
SADD4619                          00002682
SADD462                           00002462
SADD4620                          000026A2
SADD4621                          000026C2
SADD4622                          000026E2
SADD4623                          00002702
SADD463                           00002482
SADD464                           000024A2
SADD465                           000024C2
SADD466                           000024E2
SADD467                           00002502
SADD468                           00002522
SADD469                           00002542
SBOREN                            00000006
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 509


SYMBOL TABLE
  LABEL                             VALUE 

SCALCFG1                          0000A614
SCALCFG10                         0000A712
SCALCFG11                         0000A72E
SCALCFG12                         0000A74A
SCALCFG13                         0000A766
SCALCFG14                         0000A782
SCALCFG2                          0000A632
SCALCFG3                          0000A64E
SCALCFG4                          0000A66A
SCALCFG5                          0000A686
SCALCFG6                          0000A6A2
SCALCFG7                          0000A6BE
SCALCFG8                          0000A6DA
SCALCFG9                          0000A6F6
SCALCH1                           0000A7FC
SCALCH2                           0000A816
SCALCH3                           0000A830
SCALCH4                           0000A84A
SCALCH5                           0000A864
SCALCH6                           0000A87E
SCALCH7                           0000A898
SCALCH8                           0000A8B2
SCALMES1                          000087DE
SCALMES10                         000088D8
SCALMES2                          000087FC
SCALMES3                          0000881A
SCALMES4                          00008838
SCALMES5                          00008856
SCALMES6                          00008870
SCALMES7                          0000888A
SCALMES8                          000088A4
SCALMES9                          000088BE
SCALT1                            000088F2
SCALT2                            00008910
SCALT3                            0000892E
SCALT4                            0000894C
SCALT5                            00008966
SCALT6                            00008982
SCALT7                            000089A0
SCALTMODE1                        000089BA
SCALTMODE2                        000089D2
SCALTMODE3                        000089EA
SCALTRIM1                         0000A8CC
SCALTRIM2                         0000A8E6
SCALTRIM3                         0000A900
SCALTRIM4                         0000A91A
SCALTRIM5                         0000A934
SCALTRIM6                         0000A94E
SCALTRIM7                         0000A968
SCALTRIM8                         0000A982
SCALTRIM9                         0000A99C
SCH51                             00008A02
SCH52                             00008A20
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 510


SYMBOL TABLE
  LABEL                             VALUE 

SCH53                             00008A3E
SCH54                             00008A5C
SCH55                             00008A7C
SCH671                            00008A96
SCH672                            00008AB4
SCH673                            00008AD2
SCH674                            00008AF0
SCH81                             00008B0A
SCH82                             00008B28
SCH83                             00008B46
SCH84                             00008B64
SCH85                             00008B82
SCH86                             00008BA2
SCHNMES1                          000086AA
SCHNMES10                         000087C4
SCHNMES2                          000086CA
SCHNMES3                          000086EA
SCHNMES4                          0000870A
SCHNMES5                          0000872A
SCHNMES6                          0000874A
SCHNMES7                          0000876A
SCHNMES8                          0000878A
SCHNMES9                          000087AA
SCHORD1                           0000A79C
SCHORD2                           0000A7B4
SCHORD3                           0000A7CC
SCHORD4                           0000A7E4
SCK                               00000003
SCK1                              00000003
SCK2                              00000006
SCKP                              00000004
SCL                               00000003
SCL1                              00000003
SCL2                              00000006
SCP_RevDone                       00006B80
SCS0                              00000000
SCS1                              00000001
SDA                               00000004
SDA1                              00000004
SDA2                              00000005
SDI                               00000004
SDI1                              00000004
SDI2                              00000005
SDIV1608                          
SDIV2416                          
SDIbit                            00000004
SDO                               00000005
SDO1                              00000005
SDO2                              00000004
SDObit                            00000007
SELCHPOS                          0000000C
SEN                               00000000
SENDB                             00000003
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 511


SYMBOL TABLE
  LABEL                             VALUE 

SENDMESS                          00000002
SERVOSEL1                         00008CE4
SERVOSEL2                         00008CF0
SERVOSEL3                         00008CFC
SERVOSEL4                         00008D08
SERVOSEL5                         00008D14
SERVOSEL6                         00008D20
SERVOSEL7                         00008D2C
SERVOSEL8                         00008D38
SERVOSEL9                         00008D44
SF0                               000076B6
SF1                               000076CE
SF2                               000076EE
SF3                               0000770E
SF4                               0000768C
SFBAND1                           0000A5B4
SFBAND2                           0000A5CC
SFBAND3                           0000A5E4
SFBAND4                           0000A5FC
SHIFT                             000003CD
SIGN                              00000024
SL_A                              00000354
SL_E                              00000356
SL_R                              00000358
SL_T                              0000035A
SMP                               00000007
SNAP1                             000084C0
SNAP10                            000085C8
SNAP11                            000085E8
SNAP12                            00008608
SNAP13                            00008628
SNAP14                            00008642
SNAP15                            0000865C
SNAP16                            00008676
SNAP17                            00008690
SNAP2                             000084E0
SNAP3                             00008500
SNAP4                             00008520
SNAP5                             00008540
SNAP6                             0000855A
SNAP7                             00008574
SNAP8                             0000858E
SNAP9                             000085A8
SNAPL                             00000007
SNAPR                             00000006
SNCP_RevDone                      00006BCC
SOK46                             00002718
SOK4610                           00002568
SOK4611                           00002588
SOK4612                           000025A8
SOK4613                           000025C8
SOK4614                           000025E8
SOK4615                           00002608
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 512


SYMBOL TABLE
  LABEL                             VALUE 

SOK4616                           00002628
SOK4617                           00002648
SOK4618                           00002668
SOK4619                           00002688
SOK462                            00002468
SOK4620                           000026A8
SOK4621                           000026C8
SOK4622                           000026E8
SOK4623                           00002708
SOK463                            00002488
SOK464                            000024A8
SOK465                            000024C8
SOK466                            000024E8
SOK467                            00002508
SOK468                            00002528
SOK469                            00002548
SOT                               000000AA
SP0                               00000000
SP1                               00000001
SP2                               00000002
SP3                               00000003
SP4                               00000004
SPBRG                             00000FAF
SPBRG1                            00000FAF
SPBRG2                            00000F6F
SPBRGH                            00000F7F
SPBRGH1                           00000F7F
SPBRGH2                           00000F7D
SPEN                              00000007
SPROMAircraft                     000000AC
SREN                              00000005
SR_A                              0000034C
SR_E                              0000034E
SR_R                              00000350
SR_T                              00000352
SS1                               00000007
SS2                               00000007
SSP1ADD                           00000FC8
SSP1BUF                           00000FC9
SSP1CON1                          00000FC6
SSP1CON2                          00000FC5
SSP1IE                            00000003
SSP1IF                            00000003
SSP1IP                            00000003
SSP1STAT                          00000FC7
SSP2ADD                           00000F65
SSP2BUF                           00000F66
SSP2CON1                          00000F63
SSP2CON2                          00000F62
SSP2IE                            00000007
SSP2IF                            00000007
SSP2IP                            00000007
SSP2STAT                          00000F64
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 513


SYMBOL TABLE
  LABEL                             VALUE 

SSPADD                            00000FC8
SSPBUF                            00000FC9
SSPCON1                           00000FC6
SSPCON2                           00000FC5
SSPDdone                          000020D6
SSPDnext                          00002064
SSPEN                             00000005
SSPIE                             00000003
SSPIF                             00000003
SSPIP                             00000003
SSPM0                             00000000
SSPM1                             00000001
SSPM2                             00000002
SSPM3                             00000003
SSPOV                             00000006
SSPSTAT                           00000FC7
ST00                              0000521A
ST01                              000051E6
ST1                               0000035E
STATUS                            00000FD8
STKFUL                            00000007
STKOVF                            00000007
STKPTR                            00000FFC
STKPTR0                           00000000
STKPTR1                           00000001
STKPTR2                           00000002
STKPTR3                           00000003
STKPTR4                           00000004
STKUNF                            00000006
STMENU1                           00008BBC
STMENU10                          00008CCA
STMENU2                           00008BDA
STMENU3                           00008BF8
STMENU4                           00008C16
STMENU5                           00008C34
STMENU6                           00008C52
STMENU7                           00008C70
STMENU8                           00008C8E
STMENU9                           00008CAC
STRIM                             000000E2
STgo                              000051FE
STreset                           00006CBE
SV1Mes                            00002FF2
SV2Mes                            00003002
SV3Mes                            00003012
SV4Mes                            00003022
SV5Mes                            00003032
SV6Mes                            00003042
SV7Mes                            00003052
SV8Mes                            00003062
SWAILDR                           000003AE
SWATRIM                           000003B6
SWCH5                             000003B5
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 514


SYMBOL TABLE
  LABEL                             VALUE 

SWCH8A                            000003B7
SWCH8B                            000003B8
SWCH8C                            000003B9
SWCROW                            000003C5
SWDTE                             00000000
SWDTEN                            00000000
SWELEDR                           000003AF
SWFUN1                            000094A4
SWFUN10                           0000958E
SWFUN11                           000095A8
SWFUN12                           000095C2
SWFUN13                           000095DC
SWFUN14                           000095F6
SWFUN15                           00009610
SWFUN16                           0000962A
SWFUN17                           00009644
SWFUN18                           0000965E
SWFUN19                           00009678
SWFUN2                            000094BE
SWFUN20                           00009692
SWFUN21                           000096AC
SWFUN22                           000096C6
SWFUN23                           000096E0
SWFUN24                           000096FA
SWFUN25                           00009714
SWFUN3                            000094D8
SWFUN4                            000094F2
SWFUN5                            0000950C
SWFUN6                            00009526
SWFUN7                            00009540
SWFUN8                            0000955A
SWFUN9                            00009574
SWID                              000000C5
SWIDLEUP1                         000003C3
SWIDLEUP2                         000003C4
SWIDLEUPN                         0000042D
SWIDLEUPST1                       00000437
SWIDLEUPST2                       0000043D
SWMENU1                           000097B8
SWMENU10                          00009890
SWMENU11                          000098A8
SWMENU12                          000098C0
SWMENU13                          000098D8
SWMENU14                          000098F0
SWMENU15                          00009908
SWMENU16                          00009920
SWMENU17                          00009938
SWMENU18                          00009950
SWMENU19                          00009968
SWMENU2                           000097D0
SWMENU20                          00009980
SWMENU21                          00009998
SWMENU22                          000099B0
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 515


SYMBOL TABLE
  LABEL                             VALUE 

SWMENU23                          000099C8
SWMENU24                          000099E0
SWMENU25                          000099F8
SWMENU26                          00009A10
SWMENU27                          00009A28
SWMENU28                          00009A40
SWMENU29                          00009A58
SWMENU3                           000097E8
SWMENU30                          00009A70
SWMENU31                          00009A88
SWMENU32                          00009AA0
SWMENU33                          00009AB8
SWMENU34                          00009AD0
SWMENU35                          00009AE8
SWMENU36                          00009B00
SWMENU37                          00009B18
SWMENU4                           00009800
SWMENU5                           00009818
SWMENU6                           00009830
SWMENU7                           00009848
SWMENU8                           00009860
SWMENU9                           00009878
SWMIX1                            000003B2
SWMIX2                            000003B3
SWMIX3                            000003B4
SWPRESET                          000003B1
SWRUDDR                           000003B0
SWSNAPL                           000003BC
SWSNAPR                           000003BB
SWSTUNT1                          00000433
SWSTUNT2                          00000439
SWTHOLD                           0000042F
SWselect                          000000D6
SYNC                              00000004
SYS1                              0000A324
SYS10                             0000A43C
SYS11                             0000A456
SYS12                             0000A474
SYS13                             0000A48E
SYS14                             0000A4AC
SYS15                             0000A4CA
SYS16                             0000A4E8
SYS17                             0000A504
SYS18                             0000A520
SYS19                             0000A53C
SYS2                              0000A340
SYS20                             0000A558
SYS21                             0000A578
SYS22                             0000A59A
SYS3                              0000A360
SYS4                              0000A37E
SYS5                              0000A39A
SYS6                              0000A3BA
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 516


SYMBOL TABLE
  LABEL                             VALUE 

SYS7                              0000A3DA
SYS8                              0000A3FE
SYS9                              0000A41E
SaveAircraft                      000045EC
SaveAircraftName                  0000451C
SaveAircraftPage1                 00004680
SaveFSR1H                         0000013F
SaveFSR1L                         0000013E
SaveGeneral                       000044CA
Secs                              00000058
SelFreq                           000002A5
SelFun1                           0000579A
SelFun2                           000057A8
SelFun3                           000057C2
SelFun4                           00005762
SelFun4a                          0000583A
SelFun5                           0000584C
SelFun5a                          0000585E
SelFun6                           00005868
SelFun7                           00005872
SelSprom                          000000EC
SelectAircraft                    000063CC
SelectChannel                     00005FE4
SelectChannel1                    0000602C
SelectChannel2                    0000603A
SelectChannel3                    00006054
SelectChannel4                    00005FFE
SelectFrequency                   0000768C
SelectOutputChannel               00000400
SelectTrim                        0000033A
SelectionFunction                 00005754
SendStudent                       00001EF8
SerLim                            00006B3C
SerialSend                        000002D6
SerialSendPositionData            0000204A
ServoMax                          000002B0
ServoMin                          000002AE
ServoREV                          000000E2
SetAftRange                       00006F70
SetDOGcontrast                    00001C7A
SetDefault                        0000706C
SetSUflag                         0000574E
ShowDP                            00005C92
ShowLine1                         
ShowLine2                         
Signature                         000002A7
SingleLine                        
Src                               000000BB
SrevCPost                         00006B4E
SrevNCPost                        00006B9A
Startup1                          0000045E
Startup2                          0000044C
State                             
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 517


SYMBOL TABLE
  LABEL                             VALUE 

StickThres                        00000190
Student                           000002A0
SubTrim                           00000408
SwitchTest                        0000518E
SymSet                            000000C4
Sync                              00000054
SyncUp                            00000000
SyncUp1                           0000000A
SyncWidth                         000002A3
T08BIT                            00000006
T0CKI                             00000004
T0CON                             00000FD5
T0CS                              00000005
T0IE                              00000005
T0IF                              00000002
T0IP                              00000002
T0PS0                             00000000
T0PS1                             00000001
T0PS2                             00000002
T0PS3                             00000003
T0SE                              00000004
T13CKI                            00000000
T1CKPS0                           00000004
T1CKPS1                           00000005
T1CON                             00000FCD
T1INSYNC                          00000002
T1OSCEN                           00000003
T1OSI                             00000001
T1OSO                             00000000
T1RUN                             00000006
T1SYNC                            00000002
T2CKPS0                           00000000
T2CKPS1                           00000001
T2CON                             00000FCA
T2OUTPS0                          00000003
T2OUTPS1                          00000004
T2OUTPS2                          00000005
T2OUTPS3                          00000006
T3CCP1                            00000003
T3CCP2                            00000006
T3CKPS0                           00000004
T3CKPS1                           00000005
T3CON                             00000FB1
T3INSYNC                          00000002
T3SYNC                            00000002
T4CKPS0                           00000000
T4CKPS1                           00000001
T4CON                             00000F76
T4OUTPS0                          00000003
T4OUTPS1                          00000004
T4OUTPS2                          00000005
T4OUTPS3                          00000006
TABLAT                            00000FF5
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 518


SYMBOL TABLE
  LABEL                             VALUE 

TACHENA                           00000001
TACHIN                            00000001
TACHRPMPOS                        0000000B
TAltA1                            0000013C
TAltA2                            0000013D
TBH                               00000334
TBLPTR                            00000FF6
TBLPTRH                           00000FF7
TBLPTRL                           00000FF6
TBLPTRU                           00000FF8
TCT                               00000229
TE1                               00000946
TE2                               00000940
TEMP                              TEMPB3
TEMPB3                            000000AA
TEMP_ALUSTA                       00000001
TEMP_ALUSTA_L                     00000006
TEMP_BSR                          00000002
TEMP_BSR_L                        00000007
TEMP_PRODH                        00000004
TEMP_PRODH_L                      00000009
TEMP_PRODL                        00000003
TEMP_PRODL_L                      00000008
TEMP_WREG                         00000000
TEMP_WREG_L                       00000005
TESTCHPOS                         00000007
TESTVALPOS                        0000000C
TEnaSW                            000003C0
THG                               00000227
THOLDp                            00000430
THTremap                          00000446
TH_Mode                           00005578
TIMER3ISR                         00000F06
TIMER3ISR0                        00000F88
TIMER3ISR1                        00000FB2
TIMER3ISR1a                       00000FE2
TIMER3ISR2                        0000100A
TIMER3ISR3                        00001016
TMH                               00000332
TMODE                             00000337
TMODES1                           00008478
TMODES2                           00008490
TMODES3                           000084A8
TMR0H                             00000FD7
TMR0IE                            00000005
TMR0IF                            00000002
TMR0IP                            00000002
TMR0L                             00000FD6
TMR0ON                            00000007
TMR1CS                            00000001
TMR1H                             00000FCF
TMR1IE                            00000000
TMR1IF                            00000000
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 519


SYMBOL TABLE
  LABEL                             VALUE 

TMR1IP                            00000000
TMR1L                             00000FCE
TMR1ON                            00000000
TMR2                              00000FCC
TMR2IE                            00000001
TMR2IF                            00000001
TMR2IP                            00000001
TMR2ON                            00000002
TMR3CS                            00000001
TMR3H                             00000FB3
TMR3IE                            00000001
TMR3IF                            00000001
TMR3IP                            00000001
TMR3L                             00000FB2
TMR3ON                            00000000
TMR4                              00000F78
TMR4IE                            00000003
TMR4IF                            00000003
TMR4IP                            00000003
TMR4ON                            00000002
TMR4intNum                        000000FF
TO                                00000003
TOS                               00000FFD
TOSH                              00000FFE
TOSL                              00000FFD
TOSU                              00000FFF
TPT                               00000336
TP_RevDone                        00006C18
TRIMP                             000000DD
TRISA                             00000F92
TRISA0                            00000000
TRISA1                            00000001
TRISA2                            00000002
TRISA3                            00000003
TRISA4                            00000004
TRISA5                            00000005
TRISA6                            00000006
TRISA7                            00000007
TRISB                             00000F93
TRISB0                            00000000
TRISB1                            00000001
TRISB2                            00000002
TRISB3                            00000003
TRISB4                            00000004
TRISB5                            00000005
TRISB6                            00000006
TRISB7                            00000007
TRISC                             00000F94
TRISC0                            00000000
TRISC1                            00000001
TRISC2                            00000002
TRISC3                            00000003
TRISC4                            00000004
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 520


SYMBOL TABLE
  LABEL                             VALUE 

TRISC5                            00000005
TRISC6                            00000006
TRISC7                            00000007
TRISD                             00000F95
TRISD0                            00000000
TRISD1                            00000001
TRISD2                            00000002
TRISD3                            00000003
TRISD4                            00000004
TRISD5                            00000005
TRISD6                            00000006
TRISD7                            00000007
TRISE                             00000F96
TRISE0                            00000000
TRISE1                            00000001
TRISE2                            00000002
TRISE3                            00000003
TRISE4                            00000004
TRISE5                            00000005
TRISE6                            00000006
TRISE7                            00000007
TRISF                             00000F97
TRISF0                            00000000
TRISF1                            00000001
TRISF2                            00000002
TRISF3                            00000003
TRISF4                            00000004
TRISF5                            00000005
TRISF6                            00000006
TRISF7                            00000007
TRISG                             00000F98
TRISG0                            00000000
TRISG1                            00000001
TRISG2                            00000002
TRISG3                            00000003
TRISG4                            00000004
TRISH                             00000F99
TRISH0                            00000000
TRISH1                            00000001
TRISH2                            00000002
TRISH3                            00000003
TRISH4                            00000004
TRISH5                            00000005
TRISH6                            00000006
TRISH7                            00000007
TRISJ                             00000F9A
TRISJ0                            00000000
TRISJ1                            00000001
TRISJ2                            00000002
TRISJ3                            00000003
TRISJ4                            00000004
TRISJ5                            00000005
TRISJ6                            00000006
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 521


SYMBOL TABLE
  LABEL                             VALUE 

TRISJ7                            00000007
TRMT                              00000001
TT0                               00007AB6
TTBH                              0000011A
TTMH                              0000011C
TTP                               000003CC
TTexit                            00003362
TTflag                            000000D2
TTgo                              00003316
TTinited                          000032E6
TTpos                             0000013A
TTsave                            0000336E
TTup                              00003308
TUN0                              00000000
TUN1                              00000001
TUN2                              00000002
TUN3                              00000003
TUN4                              00000004
TX                                00000006
TX1                               00000006
TX1IE                             00000004
TX1IF                             00000004
TX1IP                             00000004
TX2                               00000001
TX2IE                             00000004
TX2IF                             00000004
TX2IP                             00000004
TX8_9                             00000006
TX9                               00000006
TX9D                              00000000
TXD8                              00000000
TXEN                              00000005
TXIE                              00000004
TXIF                              00000004
TXIP                              00000004
TXREG                             00000FAD
TXREG1                            00000FAD
TXREG2                            00000F6D
TXSTA                             00000FAC
TXSTA1                            00000FAC
TXSTA2                            00000F6C
TXvoltSet                         000070C6
Table1                            00000246
Table2                            00000251
Table2Temp                        00006ED6
Table3                            0000025C
Table4                            00000267
Table5                            00000272
Table6                            0000027D
Table7                            00000288
Table8                            00000293
Tables1                           0000A092
Tables10                          0000A1B2
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 522


SYMBOL TABLE
  LABEL                             VALUE 

Tables11                          0000A1D2
Tables2                           0000A0B2
Tables3                           0000A0D2
Tables4                           0000A0F2
Tables5                           0000A112
Tables6                           0000A132
Tables7                           0000A152
Tables8                           0000A172
Tables9                           0000A192
TachInit                          000055CA
TachRead                          000055D0
TackDisplay                       000055D4
Temp2Table                        00006EBA
TempBlock                         00000112
TestIO                            0000096E
TestIO1                           00000A58
TestIO2                           00000A96
TestIOa                           000009B2
TestTrim                          00007A8A
TholdState                        000000FE
ThrottleAdjustMessage             0000094C
ThrottleTrim                      0000325E
ThtEle                            00000416
ThtMes                            00002FA2
ThtPost                           000069FC
ThtPre                            00006990
ThtTCenterBeepFlag                000002D7
ThtTrimCh                         000002B5
Tick                              00000057
TicksPer                          000002D4
TimeOut                           00000060
TimeOut1                          00000061
TimeOut2                          00000062
TimeOut3                          000000A7
TimeOut4                          000000A8
TimeOut5                          000000A9
Timer3Init                        00000E66
TimerCount                        000000ED
TimerEnable                       000008FA
TimerOff                          0000140E
Tnorm                             00000427
Tpos                              0000007B
TposActual                        000000FC
TposM                             00000099
Tpreset                           00000338
Trans1                            00004C62
Trans2                            00004CE4
Trans3                            00004CD2
Trans4                            00004CBE
Trans5                            00004C96
TransFilter                       00000BA2
TransVoltage                      00000B08
Translation                       00004C40
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 523


SYMBOL TABLE
  LABEL                             VALUE 

TrevPost                          00006BE6
TrimBeepSignChange                00000157
TrimCenterBeepFlag                000002D3
TrimZero                          00006F0A
TrimZeroAil                       000003A7
TrimZeroClear                     00006F5A
TrimZeroEle                       000003A9
TrimZeroRud                       000003AB
TstepSize                         0000043F
Tthres                            000003C1
TtransistionT                     00000441
Ttrim                             0000008B
TtrimCT                           00000239
TtrimHG                           00000237
TtrimLast                         00000151
U2set                             00001D78
UA                                00000001
UB                                00000007
UI1                               00001DF0
UI1a                              00001DF8
UI2                               00001E18
UL1                               00003A38
ULP0                              0000397E
ULP1                              000039BE
UR1                               00001E48
UR2                               00001E5C
UR3                               00001E70
UR4                               00001E84
UR5                               00001E96
UR5a                              00001EAA
UR6                               00001EAE
UR6a                              00001ED6
UR6b                              00001EEA
UR7                               00001EF4
US1                               00001DB6
USART1in                          00001DDA
USART1init                        00001D3A
USART1rec                         00001E22
USART1reset                       00001D16
USART1send                        00001DA0
USART1sendChar                    00001D56
USART2init                        00001D62
USART2reset                       00001D2A
USART2sendChar                    00001D94
USART2sendEmpty                   00001D8C
USC1                              00001D56
USC2                              00001D94
USE2                              00001D8C
Umins                             000000D1
Units                             00000140
UpdateLast                        00003A12
UpdateLastPos                     000038D6
UseDefaults                       00000272
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 524


SYMBOL TABLE
  LABEL                             VALUE 

UseGeneral                        0000022E
Usecs                             000000D0
VCFG0                             00000004
VCFG1                             00000005
VDIRMAG                           00000007
VREFM                             00000002
VREFP                             00000003
VRmonG                            000002A9
VTAIL                             00000398
Vbat                              0000008D
Vbat256                           0000016C
VerSel1                           00005F84
VerSel2                           00005F92
VerSel3                           00005FAC
VerSel4                           00005F56
Version                           00000158
VerticalSelection                 00005F56
VmonG                             00000213
VoltageLimit                      00002260
W                                 00000000
WAIT0                             00000004
WAIT1                             00000005
WCOL                              00000007
WDTCON                            00000FD1
WM0                               00000000
WM1                               00000001
WR                                00000001
WREG                              00000FE8
WREN                              00000002
WRERR                             00000003
WRH                               00000003
WRITE_BUFFER_BACK                 0000178A
WRITE_BYTE_TO_HREGS               00001722
WRITE_WORD_TO_HREGS               0000179C
WRL                               00000002
WUE                               00000001
YESNO                             000000E1
YNPOS                             0000000C
YPOS                              00000008
YesNo                             00005BA4
YesNo1                            00005BEE
YesNo2                            00005C12
YesNoLoop                         00005BC0
Z                                 00000002
_.code_01CE                       000001CE
_.code_01F0                       000001F0
_.code_0212                       00000212
_.code_0226                       00000226
_.code_0300                       00000300
_.code_0322                       00000322
_.code_034A                       0000034A
_.code_036C                       0000036C
_.code_03DE                       000003DE
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 525


SYMBOL TABLE
  LABEL                             VALUE 

_.code_0400                       00000400
_.code_0414                       00000414
_.code_0978                       00000978
_.code_098C                       0000098C
_.code_099A                       0000099A
_.code_09AE                       000009AE
_.code_0A04                       00000A04
_.code_0A26                       00000A26
_.code_0A3A                       00000A3A
_.code_0ABE                       00000ABE
_.code_0AE0                       00000AE0
_.code_0AF4                       00000AF4
_.code_3268                       00003268
_.code_328A                       0000328A
_.code_7150                       00007150
_.code_718E                       0000718E
_.code_7230                       00007230
_.code_7266                       00007266
_.code_72A8                       000072A8
_.code_7300                       00007300
_.code_7336                       00007336
_.code_736C                       0000736C
_.code_73AE                       000073AE
_.code_73EC                       000073EC
_ADDRBW_ADDR12BIT_3L              000000DF
_ADDRBW_ADDR16BIT_3L              000000EF
_ADDRBW_ADDR20BIT_3L              000000FF
_ADDRBW_ADDR8BIT_3L               000000CF
_BBSIZ_BB2K_4L                    000000CF
_BBSIZ_BB4K_4L                    000000DF
_BBSIZ_BB8K_4L                    000000FF
_BOREN_NOSLP_2L                   000000FD
_BOREN_OFF_2L                     000000F9
_BOREN_ON_2L                      000000FB
_BOREN_SBORDIS_2L                 000000FF
_BORV_0_2L                        000000E7
_BORV_1_2L                        000000EF
_BORV_2_2L                        000000F7
_BORV_3_2L                        000000FF
_C                                ALUSTA,0
_CCP2MX_PORTBE_3H                 000000FE
_CCP2MX_PORTC_3H                  000000FF
_CONFIG1H                         00300001
_CONFIG2H                         00300003
_CONFIG2L                         00300002
_CONFIG3H                         00300005
_CONFIG3L                         00300004
_CONFIG4L                         00300006
_CONFIG5H                         00300009
_CONFIG5L                         00300008
_CONFIG6H                         0030000B
_CONFIG6L                         0030000A
_CONFIG7H                         0030000D
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 526


SYMBOL TABLE
  LABEL                             VALUE 

_CONFIG7L                         0030000C
_CP0_OFF_5L                       000000FF
_CP0_ON_5L                        000000FE
_CP1_OFF_5L                       000000FF
_CP1_ON_5L                        000000FD
_CP2_OFF_5L                       000000FF
_CP2_ON_5L                        000000FB
_CP3_OFF_5L                       000000FF
_CP3_ON_5L                        000000F7
_CP4_OFF_5L                       000000FF
_CP4_ON_5L                        000000EF
_CP5_OFF_5L                       000000FF
_CP5_ON_5L                        000000DF
_CP6_OFF_5L                       000000FF
_CP6_ON_5L                        000000BF
_CP7_OFF_5L                       000000FF
_CP7_ON_5L                        0000007F
_CPB_OFF_5H                       000000FF
_CPB_ON_5H                        000000BF
_CPD_OFF_5H                       000000FF
_CPD_ON_5H                        0000007F
_DATABW_DATA16BIT_3L              000000FF
_DATABW_DATA8BIT_3L               000000BF
_DC                               ALUSTA,1
_DEBUG_OFF_4L                     000000FF
_DEBUG_ON_4L                      0000007F
_DEVID1                           003FFFFE
_DEVID2                           003FFFFF
_EBTR0_OFF_7L                     000000FF
_EBTR0_ON_7L                      000000FE
_EBTR1_OFF_7L                     000000FF
_EBTR1_ON_7L                      000000FD
_EBTR2_OFF_7L                     000000FF
_EBTR2_ON_7L                      000000FB
_EBTR3_OFF_7L                     000000FF
_EBTR3_ON_7L                      000000F7
_EBTR4_OFF_7L                     000000FF
_EBTR4_ON_7L                      000000EF
_EBTR5_OFF_7L                     000000FF
_EBTR5_ON_7L                      000000DF
_EBTR6_OFF_7L                     000000FF
_EBTR6_ON_7L                      000000BF
_EBTR7_OFF_7L                     000000FF
_EBTR7_ON_7L                      0000007F
_EBTRB_OFF_7H                     000000FF
_EBTRB_ON_7H                      000000BF
_ECCPMX_PORTE_3H                  000000FF
_ECCPMX_PORTH_3H                  000000FD
_FCMEN_OFF_1H                     000000BF
_FCMEN_ON_1H                      000000FF
_IDLOC0                           00200000
_IDLOC1                           00200001
_IDLOC2                           00200002
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 527


SYMBOL TABLE
  LABEL                             VALUE 

_IDLOC3                           00200003
_IDLOC4                           00200004
_IDLOC5                           00200005
_IDLOC6                           00200006
_IDLOC7                           00200007
_IESO_OFF_1H                      0000007F
_IESO_ON_1H                       000000FF
_LPT1OSC_OFF_3H                   000000FB
_LPT1OSC_ON_3H                    000000FF
_LVP_OFF_4L                       000000FB
_LVP_ON_4L                        000000FF
_MCLRE_OFF_3H                     0000007F
_MCLRE_ON_3H                      000000FF
_MODE_EM_3L                       000000FC
_MODE_MC_3L                       000000FF
_MODE_MPB_3L                      000000FD
_MODE_MP_3L                       000000FE
_OSC_ECIO6_1H                     000000F5
_OSC_EC_1H                        000000F4
_OSC_HSPLL_1H                     000000F6
_OSC_HS_1H                        000000F2
_OSC_INTIO67_1H                   000000F8
_OSC_INTIO7_1H                    000000F9
_OSC_LP_1H                        000000F0
_OSC_RCIO6_1H                     000000F7
_OSC_RC_1H                        000000F3
_OSC_XT_1H                        000000F1
_OV                               ALUSTA,3
_PWRT_OFF_2L                      000000FF
_PWRT_ON_2L                       000000FE
_STVREN_OFF_4L                    000000FE
_STVREN_ON_4L                     000000FF
_WAIT_OFF_3L                      000000FF
_WAIT_ON_3L                       0000007F
_WDTPS_1024_2H                    000000F5
_WDTPS_128_2H                     000000EF
_WDTPS_16384_2H                   000000FD
_WDTPS_16_2H                      000000E9
_WDTPS_1_2H                       000000E1
_WDTPS_2048_2H                    000000F7
_WDTPS_256_2H                     000000F1
_WDTPS_2_2H                       000000E3
_WDTPS_32768_2H                   000000FF
_WDTPS_32_2H                      000000EB
_WDTPS_4096_2H                    000000F9
_WDTPS_4_2H                       000000E5
_WDTPS_512_2H                     000000F3
_WDTPS_64_2H                      000000ED
_WDTPS_8192_2H                    000000FB
_WDTPS_8_2H                       000000E7
_WDT_OFF_2H                       000000FE
_WDT_ON_2H                        000000FF
_WRT0_OFF_6L                      000000FF
MPASM  5.52                      ../MSTAR.ASM   10-12-2013  7:23:08         PAGE 528


SYMBOL TABLE
  LABEL                             VALUE 

_WRT0_ON_6L                       000000FE
_WRT1_OFF_6L                      000000FF
_WRT1_ON_6L                       000000FD
_WRT2_OFF_6L                      000000FF
_WRT2_ON_6L                       000000FB
_WRT3_OFF_6L                      000000FF
_WRT3_ON_6L                       000000F7
_WRT4_OFF_6L                      000000FF
_WRT4_ON_6L                       000000EF
_WRT5_OFF_6L                      000000FF
_WRT5_ON_6L                       000000DF
_WRT6_OFF_6L                      000000FF
_WRT6_ON_6L                       000000BF
_WRT7_OFF_6L                      000000FF
_WRT7_ON_6L                       0000007F
_WRTB_OFF_6H                      000000FF
_WRTB_ON_6H                       000000BF
_WRTC_OFF_6H                      000000FF
_WRTC_ON_6H                       000000DF
_WRTD_OFF_6H                      000000FF
_WRTD_ON_6H                       0000007F
_XINST_OFF_4L                     000000BF
_XINST_ON_4L                      000000FF
_Z                                ALUSTA,2
__18F8722                         00000001
chAIL                             0000003E
chCH5                             00000044
chCH6                             00000046
chCH7                             00000048
chCH8                             0000004A
chELE                             0000003C
chRUD                             00000040
chTHT                             00000042
i                                 00000020
main                              0000048A
mainStartup                       0000033A
modeCAL                           00000002
modeRUN                           00000001
postConfig                        00007078
start                             00000012
uSPOS                             00000009

Errors   :     0
Warnings :     0 reported,   626 suppressed
Messages :     0 reported,     6 suppressed

